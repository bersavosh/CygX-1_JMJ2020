SUBROUTINE aadjust(ig,aa,fjumparr,ave,trgt,ifjump)
!
!  This routine is used by hammerELC to adjust its step size
!  to get a jump fraction of trgt.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ifjump
   INTEGER, INTENT(IN)                      :: ig
   REAL(KIND=dp), INTENT(IN OUT)            :: aa
   REAL(KIND=dp), INTENT(IN)                :: fjumparr(ifjump)
   REAL(KIND=dp), INTENT(OUT)               :: ave
   REAL(KIND=dp), INTENT(IN)                :: trgt
!
   REAL(KIND=dp)  :: diff,summ,offset
!
   INTEGER :: i,icount
!
   summ=0.0_dp
   icount=0
   DO i=ig-50,ig
      summ=summ+fjumparr(i)
      icount=icount+1
   END DO
   ave=summ/REAL(icount,KIND=dp)
   diff=trgt-ave
!
!          if((diff.gt.0.3d0).and.(diff.lt.0.4d0))return
!
   IF(aa > 1.55_dp)THEN
      offset=aa
      offset=offset*(1.0_dp-diff)
      aa=offset
      IF(aa > 4.0_dp)aa=4.0_dp
      IF(aa < 1.005_dp)aa=1.01_dp
   ELSE
      offset=aa-1.0_dp
      offset=offset*(1.0_dp-diff)
      aa=offset+1.0_dp
      IF(aa > 4.0_dp)aa=4.0_dp
      IF(aa < 1.005_dp)aa=1.01_dp
   END IF
!
   RETURN
!
END SUBROUTINE aadjust
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE adjmut(np,fitns,ifit,pmutmn,pmutmx,pmut)
!
!  Used by geneticELC to tune the mutation rate.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: np
   REAL(KIND=dp), INTENT(IN)                :: fitns(np)
   INTEGER, INTENT(IN)                      :: ifit(np)
   REAL(KIND=dp), INTENT(IN)                :: pmutmn
   REAL(KIND=dp), INTENT(IN)                :: pmutmx
   REAL(KIND=dp), INTENT(IN OUT)            :: pmut
!
   REAL(KIND=dp)    :: rat,rprod,rdiflo,rdifhi,delta,rdif
!
   rdiflo=0.05_dp
   rdifhi=0.25_dp
   delta=1.5_dp
!
   rdif=ABS(fitns(ifit(np))-fitns(ifit(np/2)))/  &
      ABS(fitns(ifit(np))+fitns(ifit(np/2)))
!
   IF(rdif <= rdiflo)THEN
      rprod=pmut*delta
      IF(pmutmx < rprod)pmut=pmutmx
      IF(rprod <= pmutmx)pmut=rprod
   END IF
   IF(rdif >= rdifhi)THEN
      rat=pmut/delta
      IF(pmutmn > rat)pmut=pmutmn
      IF(rat >= pmutmn)pmut=rat
   END IF
!
   RETURN
!
END SUBROUTINE adjmut
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE assignvar(nvarmax,svar,var,fill1,fill2,omega1,  &
   omega2,q,finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,  &
   separ,gamma,t3,g3,sa3,ecc,argper,pshift,spot1parm,spot2parm,  &
   spotdparm,period,t0,alb1,alb2,dwavex,dwavey,primmass,primk,  &
   primrad,ratrad,frac1,frac2,ecosw,temprat,bigi,bigbeta,  &
   density,tconj,beam1,beam2,contam,ocose,osine,  &
   isw29,tertperiod,tertt0,tertecos,tertesin,tertincl,tertomega,  &
   tertq,tgrav1,tgrav2,tertconj,omegadot,contams0,contams1,  &
   contams2,contams3,p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,  &
   p2omega,p2q,p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,  &
   p3incl,p3omega,p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,  &
   p4esin,p4incl,p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,  &
   p5ecos,p5esin,p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,  &
   p6t0,p6ecos,p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,  &
   p7period,p7t0,p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,  &
   p8tconj,p8period,p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,  &
   p8ratrad,sw72,sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,  &
   sdarkint3,sdarkint4,sdarkint5,tertratrad,p1mtc,p1ptc,p2mtc,  &
   p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,  &
   p7ptc,p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,  &
   bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
   b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
   omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
   raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
   sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
   t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,  &
   sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
   sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
   sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
   angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
   angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,fillsum,filldiff,binqtc,p1qtc,p2qtc,p3qtc,  &
   p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
   t4off,t5off,t6off,t7off,t8off,iGR,tesscontam)
!
!   November 12, 1999
!
!   This routine will determine which variables need to be changed
!   based on the string codes in svar(1:Nvarmax)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvarmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvarmax)
   REAL(KIND=dp), INTENT(IN)                :: var(nvarmax)
   REAL(KIND=dp), INTENT(OUT)               :: fill1
   REAL(KIND=dp), INTENT(IN OUT)            :: fill2
   REAL(KIND=dp), INTENT(OUT)               :: omega1
   REAL(KIND=dp), INTENT(OUT)               :: omega2
   REAL(KIND=dp), INTENT(OUT)               :: q
   REAL(KIND=dp), INTENT(OUT)               :: finc
   REAL(KIND=dp), INTENT(OUT)               :: teff1
   REAL(KIND=dp), INTENT(OUT)               :: teff2
   REAL(KIND=dp), INTENT(OUT)               :: betarim
   REAL(KIND=dp), INTENT(OUT)               :: rinner
   REAL(KIND=dp), INTENT(OUT)               :: router
   REAL(KIND=dp), INTENT(OUT)               :: tdisk
   REAL(KIND=dp), INTENT(OUT)               :: xi
   REAL(KIND=dp), INTENT(OUT)               :: rlx
   REAL(KIND=dp), INTENT(OUT)               :: separ
   REAL(KIND=dp), INTENT(OUT)               :: gamma
   REAL(KIND=dp), INTENT(OUT)               :: t3
   REAL(KIND=dp), INTENT(OUT)               :: g3
   REAL(KIND=dp), INTENT(OUT)               :: sa3
   REAL(KIND=dp), INTENT(OUT)               :: ecc
   REAL(KIND=dp), INTENT(OUT)               :: argper
   REAL(KIND=dp), INTENT(OUT)               :: pshift
   REAL(KIND=dp), INTENT(OUT)               :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: period
   REAL(KIND=dp), INTENT(OUT)               :: t0
   REAL(KIND=dp), INTENT(OUT)               :: alb1
   REAL(KIND=dp), INTENT(OUT)               :: alb2
   REAL(KIND=dp), INTENT(OUT)               :: dwavex(8,10)
   REAL(KIND=dp), INTENT(OUT)               :: dwavey(8,10)
   REAL(KIND=dp), INTENT(OUT)               :: primmass
   REAL(KIND=dp), INTENT(OUT)               :: primk
   REAL(KIND=dp), INTENT(OUT)               :: primrad
   REAL(KIND=dp), INTENT(OUT)               :: ratrad
   REAL(KIND=dp), INTENT(OUT)               :: frac1
   REAL(KIND=dp), INTENT(OUT)               :: frac2
   REAL(KIND=dp), INTENT(OUT)               :: ecosw
   REAL(KIND=dp), INTENT(OUT)               :: temprat
   REAL(KIND=dp), INTENT(OUT)               :: bigi
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta
   REAL(KIND=dp), INTENT(OUT)               :: density
   REAL(KIND=dp), INTENT(OUT)               :: tconj
   REAL(KIND=dp), INTENT(OUT)               :: beam1
   REAL(KIND=dp), INTENT(OUT)               :: beam2
   REAL(KIND=dp), INTENT(OUT)               :: contam
   REAL(KIND=dp), INTENT(OUT)               :: ocose
   REAL(KIND=dp), INTENT(OUT)               :: osine
   INTEGER, INTENT(IN)                      :: isw29
   REAL(KIND=dp), INTENT(OUT)               :: tertperiod
   REAL(KIND=dp), INTENT(OUT)               :: tertt0
   REAL(KIND=dp), INTENT(OUT)               :: tertecos
   REAL(KIND=dp), INTENT(OUT)               :: tertesin
   REAL(KIND=dp), INTENT(OUT)               :: tertincl
   REAL(KIND=dp), INTENT(OUT)               :: tertomega
   REAL(KIND=dp), INTENT(OUT)               :: tertq
   REAL(KIND=dp), INTENT(OUT)               :: tgrav1
   REAL(KIND=dp), INTENT(OUT)               :: tgrav2
   REAL(KIND=dp), INTENT(OUT)               :: tertconj
   REAL(KIND=dp), INTENT(OUT)               :: omegadot
   REAL(KIND=dp), INTENT(OUT)               :: contams0
   REAL(KIND=dp), INTENT(OUT)               :: contams1
   REAL(KIND=dp), INTENT(OUT)               :: contams2
   REAL(KIND=dp), INTENT(OUT)               :: contams3
   REAL(KIND=dp), INTENT(OUT)               :: p2tconj
   REAL(KIND=dp), INTENT(OUT)               :: p2period
   REAL(KIND=dp), INTENT(OUT)               :: p2t0
   REAL(KIND=dp), INTENT(OUT)               :: p2ecos
   REAL(KIND=dp), INTENT(OUT)               :: p2esin
   REAL(KIND=dp), INTENT(OUT)               :: p2incl
   REAL(KIND=dp), INTENT(OUT)               :: p2omega
   REAL(KIND=dp), INTENT(OUT)               :: p2q
   REAL(KIND=dp), INTENT(OUT)               :: p2ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p3tconj
   REAL(KIND=dp), INTENT(OUT)               :: p3period
   REAL(KIND=dp), INTENT(OUT)               :: p3t0
   REAL(KIND=dp), INTENT(OUT)               :: p3ecos
   REAL(KIND=dp), INTENT(OUT)               :: p3esin
   REAL(KIND=dp), INTENT(OUT)               :: p3incl
   REAL(KIND=dp), INTENT(OUT)               :: p3omega
   REAL(KIND=dp), INTENT(OUT)               :: p3q
   REAL(KIND=dp), INTENT(OUT)               :: p3ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p4tconj
   REAL(KIND=dp), INTENT(OUT)               :: p4period
   REAL(KIND=dp), INTENT(OUT)               :: p4t0
   REAL(KIND=dp), INTENT(OUT)               :: p4ecos
   REAL(KIND=dp), INTENT(OUT)               :: p4esin
   REAL(KIND=dp), INTENT(OUT)               :: p4incl
   REAL(KIND=dp), INTENT(OUT)               :: p4omega
   REAL(KIND=dp), INTENT(OUT)               :: p4q
   REAL(KIND=dp), INTENT(OUT)               :: p4ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p5tconj
   REAL(KIND=dp), INTENT(OUT)               :: p5period
   REAL(KIND=dp), INTENT(OUT)               :: p5t0
   REAL(KIND=dp), INTENT(OUT)               :: p5ecos
   REAL(KIND=dp), INTENT(OUT)               :: p5esin
   REAL(KIND=dp), INTENT(OUT)               :: p5incl
   REAL(KIND=dp), INTENT(OUT)               :: p5omega
   REAL(KIND=dp), INTENT(OUT)               :: p5q
   REAL(KIND=dp), INTENT(OUT)               :: p5ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p6tconj
   REAL(KIND=dp), INTENT(OUT)               :: p6period
   REAL(KIND=dp), INTENT(OUT)               :: p6t0
   REAL(KIND=dp), INTENT(OUT)               :: p6ecos
   REAL(KIND=dp), INTENT(OUT)               :: p6esin
   REAL(KIND=dp), INTENT(OUT)               :: p6incl
   REAL(KIND=dp), INTENT(OUT)               :: p6omega
   REAL(KIND=dp), INTENT(OUT)               :: p6q
   REAL(KIND=dp), INTENT(OUT)               :: p6ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p7tconj
   REAL(KIND=dp), INTENT(OUT)               :: p7period
   REAL(KIND=dp), INTENT(OUT)               :: p7t0
   REAL(KIND=dp), INTENT(OUT)               :: p7ecos
   REAL(KIND=dp), INTENT(OUT)               :: p7esin
   REAL(KIND=dp), INTENT(OUT)               :: p7incl
   REAL(KIND=dp), INTENT(OUT)               :: p7omega
   REAL(KIND=dp), INTENT(OUT)               :: p7q
   REAL(KIND=dp), INTENT(OUT)               :: p7ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p8tconj
   REAL(KIND=dp), INTENT(OUT)               :: p8period
   REAL(KIND=dp), INTENT(OUT)               :: p8t0
   REAL(KIND=dp), INTENT(OUT)               :: p8ecos
   REAL(KIND=dp), INTENT(OUT)               :: p8esin
   REAL(KIND=dp), INTENT(OUT)               :: p8incl
   REAL(KIND=dp), INTENT(OUT)               :: p8omega
   REAL(KIND=dp), INTENT(OUT)               :: p8q
   REAL(KIND=dp), INTENT(OUT)               :: p8ratrad
   REAL(KIND=dp), INTENT(OUT)               :: sw72
   REAL(KIND=dp), INTENT(OUT)               :: sw73
   REAL(KIND=dp), INTENT(OUT)               :: sw49
   REAL(KIND=dp), INTENT(OUT)               :: sw80
   REAL(KIND=dp), INTENT(OUT)               :: sw81
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint1(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint2(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint3(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint4(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint5(8)
   REAL(KIND=dp), INTENT(OUT)               :: tertratrad
   REAL(KIND=dp), INTENT(OUT)               :: p1mtc
   REAL(KIND=dp), INTENT(OUT)               :: p1ptc
   REAL(KIND=dp), INTENT(OUT)               :: p2mtc
   REAL(KIND=dp), INTENT(OUT)               :: p2ptc
   REAL(KIND=dp), INTENT(OUT)               :: p3mtc
   REAL(KIND=dp), INTENT(OUT)               :: p3ptc
   REAL(KIND=dp), INTENT(OUT)               :: p4mtc
   REAL(KIND=dp), INTENT(OUT)               :: p4ptc
   REAL(KIND=dp), INTENT(OUT)               :: p5mtc
   REAL(KIND=dp), INTENT(OUT)               :: p5ptc
   REAL(KIND=dp), INTENT(OUT)               :: p6mtc
   REAL(KIND=dp), INTENT(OUT)               :: p6ptc
   REAL(KIND=dp), INTENT(OUT)               :: p7mtc
   REAL(KIND=dp), INTENT(OUT)               :: p7ptc
   REAL(KIND=dp), INTENT(OUT)               :: p8mtc
   REAL(KIND=dp), INTENT(OUT)               :: p8ptc
   REAL(KIND=dp), INTENT(OUT)               :: pbmtc
   REAL(KIND=dp), INTENT(OUT)               :: pbptc
   REAL(KIND=dp), INTENT(OUT)               :: bigi2
   REAL(KIND=dp), INTENT(OUT)               :: bigi3
   REAL(KIND=dp), INTENT(OUT)               :: bigi4
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta2
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta3
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta4
   REAL(KIND=dp), INTENT(OUT)               :: bin2q
   REAL(KIND=dp), INTENT(OUT)               :: b2massdiff
   REAL(KIND=dp), INTENT(OUT)               :: b2masssum
   REAL(KIND=dp), INTENT(OUT)               :: b2raddiff
   REAL(KIND=dp), INTENT(OUT)               :: b2radsum
   REAL(KIND=dp), INTENT(OUT)               :: bin2ratrad
   REAL(KIND=dp), INTENT(OUT)               :: g10
   REAL(KIND=dp), INTENT(OUT)               :: g6
   REAL(KIND=dp), INTENT(OUT)               :: g7
   REAL(KIND=dp), INTENT(OUT)               :: g8
   REAL(KIND=dp), INTENT(OUT)               :: g9
   REAL(KIND=dp), INTENT(OUT)               :: massdiff
   REAL(KIND=dp), INTENT(OUT)               :: masssum
   REAL(KIND=dp), INTENT(OUT)               :: omega3
   REAL(KIND=dp), INTENT(OUT)               :: omega4
   REAL(KIND=dp), INTENT(OUT)               :: omega5
   REAL(KIND=dp), INTENT(OUT)               :: omega6
   REAL(KIND=dp), INTENT(OUT)               :: omega7
   REAL(KIND=dp), INTENT(OUT)               :: omega8
   REAL(KIND=dp), INTENT(OUT)               :: omega9
   REAL(KIND=dp), INTENT(OUT)               :: omega10
   REAL(KIND=dp), INTENT(OUT)               :: raddiff
   REAL(KIND=dp), INTENT(OUT)               :: radsum
   REAL(KIND=dp), INTENT(OUT)               :: rk3
   REAL(KIND=dp), INTENT(OUT)               :: rk4
   REAL(KIND=dp), INTENT(OUT)               :: rk5
   REAL(KIND=dp), INTENT(OUT)               :: rk6
   REAL(KIND=dp), INTENT(OUT)               :: rk7
   REAL(KIND=dp), INTENT(OUT)               :: rk8
   REAL(KIND=dp), INTENT(OUT)               :: rk9
   REAL(KIND=dp), INTENT(OUT)               :: rk10
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint6(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint7(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint8(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint9(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint10(8)
   REAL(KIND=dp), INTENT(OUT)               :: secmass
   REAL(KIND=dp), INTENT(OUT)               :: secrad
   REAL(KIND=dp), INTENT(OUT)               :: t10
   REAL(KIND=dp), INTENT(OUT)               :: t6
   REAL(KIND=dp), INTENT(OUT)               :: t7
   REAL(KIND=dp), INTENT(OUT)               :: t8
   REAL(KIND=dp), INTENT(OUT)               :: t9
   REAL(KIND=dp), INTENT(OUT)               :: fracsum
   REAL(KIND=dp), INTENT(OUT)               :: fracdiff
   REAL(KIND=dp), INTENT(OUT)               :: bin2m3
   REAL(KIND=dp), INTENT(OUT)               :: bin2m4
   REAL(KIND=dp), INTENT(OUT)               :: bin2r3
   REAL(KIND=dp), INTENT(OUT)               :: bin2r4
   REAL(KIND=dp), INTENT(OUT)               :: sqecos
   REAL(KIND=dp), INTENT(OUT)               :: sqesin
   REAL(KIND=dp), INTENT(OUT)               :: sqtertecos
   REAL(KIND=dp), INTENT(OUT)               :: sqtertesin
   REAL(KIND=dp), INTENT(OUT)               :: sqp2ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp2esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp3ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp3esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp4ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp4esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp5ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp5esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp6ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp6esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp7ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp7esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp8ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp8esin
   REAL(KIND=dp), INTENT(OUT)               :: angsum1
   REAL(KIND=dp), INTENT(OUT)               :: angdiff1
   REAL(KIND=dp), INTENT(OUT)               :: angsum2
   REAL(KIND=dp), INTENT(OUT)               :: angdiff2
   REAL(KIND=dp), INTENT(OUT)               :: angsum3
   REAL(KIND=dp), INTENT(OUT)               :: angdiff3
   REAL(KIND=dp), INTENT(OUT)               :: angsum4
   REAL(KIND=dp), INTENT(OUT)               :: angdiff4
   REAL(KIND=dp), INTENT(OUT)               :: angsum5
   REAL(KIND=dp), INTENT(OUT)               :: angdiff5
   REAL(KIND=dp), INTENT(OUT)               :: angsum6
   REAL(KIND=dp), INTENT(OUT)               :: angdiff6
   REAL(KIND=dp), INTENT(OUT)               :: angsum7
   REAL(KIND=dp), INTENT(OUT)               :: angdiff7
   REAL(KIND=dp), INTENT(OUT)               :: angsum8
   REAL(KIND=dp), INTENT(OUT)               :: angdiff8
   REAL(KIND=dp), INTENT(OUT)               :: fillsum
   REAL(KIND=dp), INTENT(OUT)               :: filldiff
   REAL(KIND=dp), INTENT(OUT)               :: binqtc
   REAL(KIND=dp), INTENT(OUT)               :: p1qtc
   REAL(KIND=dp), INTENT(OUT)               :: p2qtc
   REAL(KIND=dp), INTENT(OUT)               :: p3qtc
   REAL(KIND=dp), INTENT(OUT)               :: p4qtc
   REAL(KIND=dp), INTENT(OUT)               :: p5qtc
   REAL(KIND=dp), INTENT(OUT)               :: p6qtc
   REAL(KIND=dp), INTENT(OUT)               :: p7qtc
   REAL(KIND=dp), INTENT(OUT)               :: p8qtc
   REAL(KIND=dp), INTENT(OUT)               :: tbinoff
   REAL(KIND=dp), INTENT(OUT)               :: t1off
   REAL(KIND=dp), INTENT(OUT)               :: t2off
   REAL(KIND=dp), INTENT(OUT)               :: t3off
   REAL(KIND=dp), INTENT(OUT)               :: t4off
   REAL(KIND=dp), INTENT(OUT)               :: t5off
   REAL(KIND=dp), INTENT(OUT)               :: t6off
   REAL(KIND=dp), INTENT(OUT)               :: t7off
   REAL(KIND=dp), INTENT(OUT)               :: t8off
   INTEGER, INTENT(IN)                      :: iGR
   REAL(KIND=dp), INTENT(OUT)               :: tesscontam
!
   INTEGER :: i,kk,icnvrt
!
   REAL(KIND=dp)  :: g4,g5
!
!   loop over the gridloop.opt variables and match the tag codes
!   to the variables
!
   DO  i=1,nvarmax
      kk=icnvrt(svar(i)(1:2))
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
      IF(kk == 48)THEN
         binqtc=var(i)
      END IF
!
!  tag ct, tesscontam
!
      IF(kk == 83)THEN
         tesscontam=var(i)
      END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
      IF(kk == 3528)THEN
         p1qtc=var(i)
      END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
      IF(kk == 3560)THEN
         p2qtc=var(i)
      END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
      IF(kk == 3592)THEN
         p3qtc=var(i)
      END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
      IF(kk == 3624)THEN
         p4qtc=var(i)
      END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
      IF(kk == 3656)THEN
         p5qtc=var(i)
      END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
      IF(kk == 3688)THEN
         p6qtc=var(i)
      END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
      IF(kk == 3720)THEN
         p7qtc=var(i)
      END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
      IF(kk == 3752)THEN
         p8qtc=var(i)
      END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
      IF(kk == 51)THEN
         tbinoff=var(i)
      END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
      IF(kk == 3531)THEN
         t1off=var(i)
      END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
      IF(kk == 3563)THEN
         t2off=var(i)
      END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
      IF(kk == 3595)THEN
         t3off=var(i)
      END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
      IF(kk == 3627)THEN
         t4off=var(i)
      END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
      IF(kk == 3659)THEN
         t5off=var(i)
      END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
      IF(kk == 3691)THEN
         t6off=var(i)
      END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
      IF(kk == 3723)THEN
         t7off=var(i)
      END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
      IF(kk == 3755)THEN
         t8off=var(i)
      END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
      IF(kk == 581)THEN
         fillsum=var(i)
      END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
      IF(kk == 579)THEN
         filldiff=var(i)
      END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
      IF(kk == 3512)THEN
         angsum1=var(i)
      END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
      IF(kk == 3544)THEN
         angsum2=var(i)
      END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
      IF(kk == 3576)THEN
         angsum3=var(i)
      END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
      IF(kk == 3608)THEN
         angsum4=var(i)
      END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
      IF(kk == 3640)THEN
         angsum5=var(i)
      END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
      IF(kk == 3672)THEN
         angsum6=var(i)
      END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
      IF(kk == 3704)THEN
         angsum7=var(i)
      END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
      IF(kk == 3736)THEN
         angsum8=var(i)
      END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
      IF(kk == 3515)THEN
         angdiff1=var(i)
      END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
      IF(kk == 3547)THEN
         angdiff2=var(i)
      END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
      IF(kk == 3579)THEN
         angdiff3=var(i)
      END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
      IF(kk == 3611)THEN
         angdiff4=var(i)
      END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
      IF(kk == 3643)THEN
         angdiff5=var(i)
      END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
      IF(kk == 3675)THEN
         angdiff6=var(i)
      END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
      IF(kk == 3707)THEN
         angdiff7=var(i)
      END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
      IF(kk == 3739)THEN
         angdiff8=var(i)
      END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
      IF(kk == 178)THEN
         fracsum=var(i)
      END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
      IF(kk == 163)THEN
         fracdiff=var(i)
      END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
      IF(kk == 4790)THEN
         bin2m3=var(i)
      END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
      IF(kk == 4791)THEN
         bin2m4=var(i)
      END IF
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4792)THEN
         bin2r3=var(i)
      END IF
!
!  tag 90, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4783)THEN
         bin2r4=var(i)
      END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 50)THEN
         sqesin=var(i)
      END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 34)THEN
         sqecos=var(i)
      END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3530)THEN
         sqtertesin=var(i)
      END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3514)THEN
         sqtertecos=var(i)
      END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3562)THEN
         sqp2esin=var(i)
      END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3546)THEN
         sqp2ecos=var(i)
      END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3594)THEN
         sqp3esin=var(i)
      END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3578)THEN
         sqp3ecos=var(i)
      END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3626)THEN
         sqp4esin=var(i)
      END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3610)THEN
         sqp4ecos=var(i)
      END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3658)THEN
         sqp5esin=var(i)
      END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3642)THEN
         sqp5ecos=var(i)
      END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3690)THEN
         sqp6esin=var(i)
      END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3674)THEN
         sqp6ecos=var(i)
      END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3722)THEN
         sqp7esin=var(i)
      END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3706)THEN
         sqp7ecos=var(i)
      END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3754)THEN
         sqp8esin=var(i)
      END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3738)THEN
         sqp8ecos=var(i)
      END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
      IF(kk == 3524)THEN
         p1mtc=var(i)
      END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
      IF(kk == 3527)THEN
         p1ptc=var(i)
      END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
      IF(kk == 3556)THEN
         p2mtc=var(i)
      END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
      IF(kk == 3559)THEN
         p2ptc=var(i)
      END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
      IF(kk == 3588)THEN
         p3mtc=var(i)
      END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
      IF(kk == 3591)THEN
         p3ptc=var(i)
      END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
      IF(kk == 3620)THEN
         p4mtc=var(i)
      END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
      IF(kk == 3623)THEN
         p4ptc=var(i)
      END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
      IF(kk == 3652)THEN
         p5mtc=var(i)
      END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
      IF(kk == 3655)THEN
         p5ptc=var(i)
      END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
      IF(kk == 3684)THEN
         p6mtc=var(i)
      END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
      IF(kk == 3687)THEN
         p6ptc=var(i)
      END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
      IF(kk == 3716)THEN
         p7mtc=var(i)
      END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
      IF(kk == 3719)THEN
         p7ptc=var(i)
      END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
      IF(kk == 3748)THEN
         p8mtc=var(i)
      END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
      IF(kk == 3751)THEN
         p8ptc=var(i)
      END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
      IF(kk == 44)THEN
         pbmtc=var(i)
      END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
      IF(kk == 47)THEN
         pbptc=var(i)
      END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
      IF(kk == 40)THEN
         bigi2=var(i)
      END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
      IF(kk == 33)THEN
         bigbeta2=var(i)
      END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
      IF(kk == 72)THEN
         bigi3=var(i)
      END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
      IF(kk == 65)THEN
         bigbeta3=var(i)
      END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
      IF(kk == 104)THEN
         bigi4=var(i)
      END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
      IF(kk == 97)THEN
         bigbeta4=var(i)
      END IF
!
!  tag 91, b2masssum (M3+M4 in binary+binary)
!
      IF(kk == 4784)THEN
         b2masssum=var(i)
      END IF
!
!  tag 92, b2massdiff (M3-M4 in binary+binary)
!
      IF(kk == 4785)THEN
         b2massdiff=var(i)
      END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
      IF(kk == 4786)THEN
         bin2q=var(i)
      END IF
!
!  tag 94, b2radsum (R3+R4 in binary+binary)
!
      IF(kk == 4787)THEN
         b2radsum=var(i)
      END IF
!
!  tag 95, b2raddiff (R3-R4 in binary+binary)
!
      IF(kk == 4788)THEN
         b2raddiff=var(i)
      END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
      IF(kk == 4789)THEN
         bin2ratrad=var(i)
      END IF
!
!   tag g4, g4
!
      IF(kk == 1211)THEN
         g4=var(i)
      END IF
!
!   tag g5, g5
!
      IF(kk == 1212)THEN
         g5=var(i)
      END IF
!
!   tag g6, g6
!
      IF(kk == 1213)THEN
         g6=var(i)
      END IF
!
!   tag g7, g7
!
      IF(kk == 1214)THEN
         g7=var(i)
      END IF
!
!   tag g8, g8
!
      IF(kk == 1215)THEN
         g8=var(i)
      END IF
!
!   tag g9, g9
!
      IF(kk == 1216)THEN
         g9=var(i)
      END IF
!
!   tag g0, g10
!
      IF(kk == 1207)THEN
         g10=var(i)
      END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
      IF(kk == 387)THEN
         massdiff=var(i)
      END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
      IF(kk == 402)THEN
         masssum=var(i)
      END IF
!
!   tag o3, omega3
!
      IF(kk == 1466)THEN
         omega3=var(i)
      END IF
!
!   tag o4, omega4
!
      IF(kk == 1467)THEN
         omega4=var(i)
      END IF
!
!   tag o5, omega5
!
      IF(kk == 1468)THEN
         omega5=var(i)
      END IF
!
!   tag o6, omega6
!
      IF(kk == 1469)THEN
         omega6=var(i)
      END IF
!
!   tag o7, omega7
!
      IF(kk == 1470)THEN
         omega7=var(i)
      END IF
!
!   tag o8, omega8
!
      IF(kk == 1471)THEN
         omega8=var(i)
      END IF
!
!   tag o9, omega9
!
      IF(kk == 1472)THEN
         omega9=var(i)
      END IF
!
!   tag o0, omega10
!
      IF(kk == 1463)THEN
         omega10=var(i)
      END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
      IF(kk == 562)THEN
         radsum=var(i)
      END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
      IF(kk == 547)THEN
         raddiff=var(i)
      END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
      IF(kk == 1018)THEN
         rk3=var(i)
      END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
      IF(kk == 1019)THEN
         rk4=var(i)
      END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
      IF(kk == 1020)THEN
         rk5=var(i)
      END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
      IF(kk == 1021)THEN
         rk6=var(i)
      END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
      IF(kk == 1022)THEN
         rk7=var(i)
      END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
      IF(kk == 1023)THEN
         rk8=var(i)
      END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
      IF(kk == 1024)THEN
         rk9=var(i)
      END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
      IF(kk == 1015)THEN
         rk10=var(i)
      END IF
!
!   tag sm, secmass
!
      IF(kk == 588)THEN
         secmass=var(i)
      END IF
!
!   tag sr, secrad
!
      IF(kk == 593)THEN
         secrad=var(i)
      END IF
!
!   tag t6, t6 (Teff6)
!
      IF(kk == 1629)THEN
         t6=var(i)
      END IF
!
!   tag t7, t7 (Teff7)
!
      IF(kk == 1630)THEN
         t7=var(i)
      END IF
!
!   tag t8, t8 (Teff8)
!
      IF(kk == 1631)THEN
         t8=var(i)
      END IF
!
!   tag t9, t9 (Teff9)
!
      IF(kk == 1632)THEN
         t9=var(i)
      END IF
!
!   tag ta, t10 (Teff10)
!
      IF(kk == 608)THEN
         t10=var(i)
      END IF
!
!  tag 61, flux star 6, band 1
!
      IF(kk == 4688)THEN
         sdarkint6(1)=var(i)
         IF(sdarkint6(1) < 0.0_dp)sdarkint6(1)=0.0_dp
      END IF
!
!  tag 62, flux star 6, band 2
!
      IF(kk == 4689)THEN
         sdarkint6(2)=var(i)
         IF(sdarkint6(2) < 0.0_dp)sdarkint6(2)=0.0_dp
      END IF
!
!  tag 63, flux star 6, band 3
!
      IF(kk == 4690)THEN
         sdarkint6(3)=var(i)
         IF(sdarkint6(3) < 0.0_dp)sdarkint6(3)=0.0_dp
      END IF
!
!  tag 64, flux star 6, band 4
!
      IF(kk == 4691)THEN
         sdarkint6(4)=var(i)
         IF(sdarkint6(4) < 0.0_dp)sdarkint6(4)=0.0_dp
      END IF
!
!  tag 65, flux star 6, band 5
!
      IF(kk == 4692)THEN
         sdarkint6(5)=var(i)
         IF(sdarkint6(5) < 0.0_dp)sdarkint6(5)=0.0_dp
      END IF
!
!  tag 66, flux star 6, band 6
!
      IF(kk == 4693)THEN
         sdarkint6(6)=var(i)
         IF(sdarkint6(6) < 0.0_dp)sdarkint6(6)=0.0_dp
      END IF
!
!  tag 67, flux star 6, band 7
!
      IF(kk == 4694)THEN
         sdarkint6(7)=var(i)
         IF(sdarkint6(7) < 0.0_dp)sdarkint6(7)=0.0_dp
      END IF
!
!  tag 68, flux star 6, band 8
!
      IF(kk == 4695)THEN
         sdarkint6(8)=var(i)
         IF(sdarkint6(8) < 0.0_dp)sdarkint6(8)=0.0_dp
      END IF
!
!  tag 71, flux star 7, band 1
!
      IF(kk == 4720)THEN
         sdarkint7(1)=var(i)
         IF(sdarkint7(1) < 0.0_dp)sdarkint7(1)=0.0_dp
      END IF
!
!  tag 72, flux star 7, band 2
!
      IF(kk == 4721)THEN
         sdarkint7(2)=var(i)
         IF(sdarkint7(2) < 0.0_dp)sdarkint7(2)=0.0_dp
      END IF
!
!  tag 73, flux star 7, band 3
!
      IF(kk == 4722)THEN
         sdarkint7(3)=var(i)
         IF(sdarkint7(3) < 0.0_dp)sdarkint7(3)=0.0_dp
      END IF
!
!  tag 74, flux star 7, band 4
!
      IF(kk == 4723)THEN
         sdarkint7(4)=var(i)
         IF(sdarkint7(4) < 0.0_dp)sdarkint7(4)=0.0_dp
      END IF
!
!  tag 75, flux star 7, band 5
!
      IF(kk == 4724)THEN
         sdarkint7(5)=var(i)
         IF(sdarkint7(5) < 0.0_dp)sdarkint7(5)=0.0_dp
      END IF
!
!  tag 76, flux star 7, band 6
!
      IF(kk == 4725)THEN
         sdarkint7(6)=var(i)
         IF(sdarkint7(6) < 0.0_dp)sdarkint7(6)=0.0_dp
      END IF
!
!  tag 77, flux star 7, band 7
!
      IF(kk == 4726)THEN
         sdarkint7(7)=var(i)
         IF(sdarkint7(7) < 0.0_dp)sdarkint7(7)=0.0_dp
      END IF
!
!  tag 78, flux star 7, band 8
!
      IF(kk == 4727)THEN
         sdarkint7(8)=var(i)
         IF(sdarkint7(8) < 0.0_dp)sdarkint7(8)=0.0_dp
      END IF
!
!  tag 81, flux star 8, band 1
!
      IF(kk == 4752)THEN
         sdarkint8(1)=var(i)
         IF(sdarkint8(1) < 0.0_dp)sdarkint8(1)=0.0_dp
      END IF
!
!  tag 82, flux star 8, band 2
!
      IF(kk == 4753)THEN
         sdarkint8(2)=var(i)
         IF(sdarkint8(2) < 0.0_dp)sdarkint8(2)=0.0_dp
      END IF
!
!  tag 83, flux star 8, band 3
!
      IF(kk == 4754)THEN
         sdarkint8(3)=var(i)
         IF(sdarkint8(3) < 0.0_dp)sdarkint8(3)=0.0_dp
      END IF
!
!  tag 84, flux star 8, band 4
!
      IF(kk == 4755)THEN
         sdarkint8(4)=var(i)
         IF(sdarkint8(4) < 0.0_dp)sdarkint8(4)=0.0_dp
      END IF
!
!  tag 85, flux star 8, band 5
!
      IF(kk == 4756)THEN
         sdarkint8(5)=var(i)
         IF(sdarkint8(5) < 0.0_dp)sdarkint8(5)=0.0_dp
      END IF
!
!  tag 86, flux star 8, band 6
!
      IF(kk == 4757)THEN
         sdarkint8(6)=var(i)
         IF(sdarkint8(6) < 0.0_dp)sdarkint8(6)=0.0_dp
      END IF
!
!  tag 87, flux star 8, band 7
!
      IF(kk == 4758)THEN
         sdarkint8(7)=var(i)
         IF(sdarkint8(7) < 0.0_dp)sdarkint8(7)=0.0_dp
      END IF
!
!  tag 88, flux star 8, band 8
!
      IF(kk == 4759)THEN
         sdarkint8(8)=var(i)
         IF(sdarkint8(8) < 0.0_dp)sdarkint8(8)=0.0_dp
      END IF
!
!  tag 91, flux star 9, band 1
!
      IF(kk == 2784)THEN
         sdarkint9(1)=var(i)
         IF(sdarkint9(1) < 0.0_dp)sdarkint9(1)=0.0_dp
      END IF
!
!  tag 92, flux star 9, band 2
!
      IF(kk == 2785)THEN
         sdarkint9(2)=var(i)
         IF(sdarkint9(2) < 0.0_dp)sdarkint9(2)=0.0_dp
      END IF
!
!  tag 93, flux star 9, band 3
!
      IF(kk == 2786)THEN
         sdarkint9(3)=var(i)
         IF(sdarkint9(3) < 0.0_dp)sdarkint9(3)=0.0_dp
      END IF
!
!  tag 94, flux star 9, band 4
!
      IF(kk == 2787)THEN
         sdarkint9(4)=var(i)
         IF(sdarkint9(4) < 0.0_dp)sdarkint9(4)=0.0_dp
      END IF
!
!  tag 95, flux star 9, band 5
!
      IF(kk == 2788)THEN
         sdarkint9(5)=var(i)
         IF(sdarkint9(5) < 0.0_dp)sdarkint9(5)=0.0_dp
      END IF
!
!  tag 96, flux star 9, band 6
!
      IF(kk == 2789)THEN
         sdarkint9(6)=var(i)
         IF(sdarkint9(6) < 0.0_dp)sdarkint9(6)=0.0_dp
      END IF
!
!  tag 97, flux star 9, band 7
!
      IF(kk == 2790)THEN
         sdarkint9(7)=var(i)
         IF(sdarkint9(7) < 0.0_dp)sdarkint9(7)=0.0_dp
      END IF
!
!  tag 98, flux star 9, band 8
!
      IF(kk == 2791)THEN
         sdarkint9(8)=var(i)
         IF(sdarkint9(8) < 0.0_dp)sdarkint9(8)=0.0_dp
      END IF
!
!  tag 01, flux star 10, band 1
!
      IF(kk == 4496)THEN
         sdarkint10(1)=var(i)
         IF(sdarkint10(1) < 0.0_dp)sdarkint10(1)=0.0_dp
      END IF
!
!  tag 02, flux star 10, band 2
!
      IF(kk == 4497)THEN
         sdarkint10(2)=var(i)
         IF(sdarkint10(2) < 0.0_dp)sdarkint10(2)=0.0_dp
      END IF
!
!  tag 03, flux star 10, band 3
!
      IF(kk == 4498)THEN
         sdarkint10(3)=var(i)
         IF(sdarkint10(3) < 0.0_dp)sdarkint10(3)=0.0_dp
      END IF
!
!  tag 04, flux star 10, band 4
!
      IF(kk == 4499)THEN
         sdarkint10(4)=var(i)
         IF(sdarkint10(4) < 0.0_dp)sdarkint10(4)=0.0_dp
      END IF
!
!  tag 05, flux star 10, band 5
!
      IF(kk == 4500)THEN
         sdarkint10(5)=var(i)
         IF(sdarkint10(5) < 0.0_dp)sdarkint10(5)=0.0_dp
      END IF
!
!  tag 06, flux star 10, band 6
!
      IF(kk == 4501)THEN
         sdarkint10(6)=var(i)
         IF(sdarkint10(6) < 0.0_dp)sdarkint10(6)=0.0_dp
      END IF
!
!  tag 07, flux star 10, band 7
!
      IF(kk == 4502)THEN
         sdarkint10(7)=var(i)
         IF(sdarkint10(7) < 0.0_dp)sdarkint10(7)=0.0_dp
      END IF
!
!  tag 08, flux star 10, band 8
!
      IF(kk == 4503)THEN
         sdarkint10(8)=var(i)
         IF(sdarkint10(8) < 0.0_dp)sdarkint10(8)=0.0_dp
      END IF
!
!  tag 11, flux star 1, band 1
!
      IF(kk == 4528)THEN
         sdarkint1(1)=var(i)
         IF(sdarkint1(1) < 0.0_dp)sdarkint1(1)=0.0_dp
      END IF
!
!  tag 12, flux star 1, band 2
!
      IF(kk == 4529)THEN
         sdarkint1(2)=var(i)
         IF(sdarkint1(2) < 0.0_dp)sdarkint1(2)=0.0_dp
      END IF
!
!  tag 13, flux star 1, band 3
!
      IF(kk == 4530)THEN
         sdarkint1(3)=var(i)
         IF(sdarkint1(3) < 0.0_dp)sdarkint1(3)=0.0_dp
      END IF
!
!  tag 14, flux star 1, band 4
!
      IF(kk == 4531)THEN
         sdarkint1(4)=var(i)
         IF(sdarkint1(4) < 0.0_dp)sdarkint1(4)=0.0_dp
      END IF
!
!  tag 15, flux star 1, band 5
!
      IF(kk == 4532)THEN
         sdarkint1(5)=var(i)
         IF(sdarkint1(5) < 0.0_dp)sdarkint1(5)=0.0_dp
      END IF
!
!  tag 16, flux star 1, band 6
!
      IF(kk == 4533)THEN
         sdarkint1(6)=var(i)
         IF(sdarkint1(6) < 0.0_dp)sdarkint1(6)=0.0_dp
      END IF
!
!  tag 17, flux star 1, band 7
!
      IF(kk == 4534)THEN
         sdarkint1(7)=var(i)
         IF(sdarkint1(7) < 0.0_dp)sdarkint1(7)=0.0_dp
      END IF
!
!  tag 18, flux star 1, band 8
!
      IF(kk == 4535)THEN
         sdarkint1(8)=var(i)
         IF(sdarkint1(8) < 0.0_dp)sdarkint1(8)=0.0_dp
      END IF
!
!  tag 21, flux star 2, band 1
!
      IF(kk == 4560)THEN
         sdarkint2(1)=var(i)
         IF(sdarkint2(1) < 0.0_dp)sdarkint2(1)=0.0_dp
      END IF
!
!  tag 22, flux star 2, band 2
!
      IF(kk == 4561)THEN
         sdarkint2(2)=var(i)
         IF(sdarkint2(2) < 0.0_dp)sdarkint2(2)=0.0_dp
      END IF
!
!  tag 23, flux star 2, band 3
!
      IF(kk == 4562)THEN
         sdarkint2(3)=var(i)
         IF(sdarkint2(3) < 0.0_dp)sdarkint2(3)=0.0_dp
      END IF
!
!  tag 24, flux star 2, band 4
!
      IF(kk == 4563)THEN
         sdarkint2(4)=var(i)
         IF(sdarkint2(4) < 0.0_dp)sdarkint2(4)=0.0_dp
      END IF
!
!  tag 25, flux star 2, band 5
!
      IF(kk == 4564)THEN
         sdarkint2(5)=var(i)
         IF(sdarkint2(5) < 0.0_dp)sdarkint2(5)=0.0_dp
      END IF
!
!  tag 26, flux star 2, band 6
!
      IF(kk == 4565)THEN
         sdarkint2(6)=var(i)
         IF(sdarkint2(6) < 0.0_dp)sdarkint2(6)=0.0_dp
      END IF
!
!  tag 27, flux star 2, band 7
!
      IF(kk == 4566)THEN
         sdarkint2(7)=var(i)
         IF(sdarkint2(7) < 0.0_dp)sdarkint2(7)=0.0_dp
      END IF
!
!  tag 28, flux star 2, band 8
!
      IF(kk == 4567)THEN
         sdarkint2(8)=var(i)
         IF(sdarkint2(8) < 0.0_dp)sdarkint2(8)=0.0_dp
      END IF
!
!  tag 31, flux star 3, band 1
!
      IF(kk == 4592)THEN
         sdarkint3(1)=var(i)
         IF(sdarkint3(1) < 0.0_dp)sdarkint3(1)=0.0_dp
      END IF
!
!  tag 32, flux star 3, band 2
!
      IF(kk == 4593)THEN
         sdarkint3(2)=var(i)
         IF(sdarkint3(2) < 0.0_dp)sdarkint3(2)=0.0_dp
      END IF
!
!  tag 33, flux star 3, band 3
!
      IF(kk == 4594)THEN
         sdarkint3(3)=var(i)
         IF(sdarkint3(3) < 0.0_dp)sdarkint3(3)=0.0_dp
      END IF
!
!  tag 34, flux star 3, band 4
!
      IF(kk == 4595)THEN
         sdarkint3(4)=var(i)
         IF(sdarkint3(4) < 0.0_dp)sdarkint3(4)=0.0_dp
      END IF
!
!  tag 35, flux star 3, band 5
!
      IF(kk == 4596)THEN
         sdarkint3(5)=var(i)
         IF(sdarkint3(5) < 0.0_dp)sdarkint3(5)=0.0_dp
      END IF
!
!  tag 36, flux star 3, band 6
!
      IF(kk == 4597)THEN
         sdarkint3(6)=var(i)
         IF(sdarkint3(6) < 0.0_dp)sdarkint3(6)=0.0_dp
      END IF
!
!  tag 37, flux star 3, band 7
!
      IF(kk == 4598)THEN
         sdarkint3(7)=var(i)
         IF(sdarkint3(7) < 0.0_dp)sdarkint3(7)=0.0_dp
      END IF
!
!  tag 38, flux star 3, band 8
!
      IF(kk == 4599)THEN
         sdarkint3(8)=var(i)
         IF(sdarkint3(8) < 0.0_dp)sdarkint3(8)=0.0_dp
      END IF
!
!  tag 41, flux star 4, band 1
!
      IF(kk == 4624)THEN
         sdarkint4(1)=var(i)
         IF(sdarkint4(1) < 0.0_dp)sdarkint4(1)=0.0_dp
      END IF
!
!  tag 42, flux star 4, band 2
!
      IF(kk == 4625)THEN
         sdarkint4(2)=var(i)
         IF(sdarkint4(2) < 0.0_dp)sdarkint4(2)=0.0_dp
      END IF
!
!  tag 43, flux star 4, band 3
!
      IF(kk == 4626)THEN
         sdarkint4(3)=var(i)
         IF(sdarkint4(3) < 0.0_dp)sdarkint4(3)=0.0_dp
      END IF
!
!  tag 44, flux star 4, band 4
!
      IF(kk == 4627)THEN
         sdarkint4(4)=var(i)
         IF(sdarkint4(4) < 0.0_dp)sdarkint4(4)=0.0_dp
      END IF
!
!  tag 45, flux star 4, band 5
!
      IF(kk == 4628)THEN
         sdarkint4(5)=var(i)
         IF(sdarkint4(5) < 0.0_dp)sdarkint4(5)=0.0_dp
      END IF
!
!  tag 46, flux star 4, band 6
!
      IF(kk == 4629)THEN
         sdarkint4(6)=var(i)
         IF(sdarkint4(6) < 0.0_dp)sdarkint4(6)=0.0_dp
      END IF
!
!  tag 47, flux star 4, band 7
!
      IF(kk == 4630)THEN
         sdarkint4(7)=var(i)
         IF(sdarkint4(7) < 0.0_dp)sdarkint4(7)=0.0_dp
      END IF
!
!  tag 48, flux star 4, band 8
!
      IF(kk == 4631)THEN
         sdarkint4(8)=var(i)
         IF(sdarkint4(8) < 0.0_dp)sdarkint4(8)=0.0_dp
      END IF
!
!  tag 51, flux star 5, band 1
!
      IF(kk == 4656)THEN
         sdarkint5(1)=var(i)
         IF(sdarkint5(1) < 0.0_dp)sdarkint5(1)=0.0_dp
      END IF
!
!  tag 52, flux star 5, band 2
!
      IF(kk == 4657)THEN
         sdarkint5(2)=var(i)
         IF(sdarkint5(2) < 0.0_dp)sdarkint5(2)=0.0_dp
      END IF
!
!  tag 53, flux star 5, band 3
!
      IF(kk == 4658)THEN
         sdarkint5(3)=var(i)
         IF(sdarkint5(3) < 0.0_dp)sdarkint5(3)=0.0_dp
      END IF
!
!  tag 54, flux star 5, band 4
!
      IF(kk == 4659)THEN
         sdarkint5(4)=var(i)
         IF(sdarkint5(4) < 0.0_dp)sdarkint5(4)=0.0_dp
      END IF
!
!  tag 55, flux star 5, band 5
!
      IF(kk == 4660)THEN
         sdarkint5(5)=var(i)
         IF(sdarkint5(5) < 0.0_dp)sdarkint5(5)=0.0_dp
      END IF
!
!  tag 56, flux star 5, band 6
!
      IF(kk == 4661)THEN
         sdarkint5(6)=var(i)
         IF(sdarkint5(6) < 0.0_dp)sdarkint5(6)=0.0_dp
      END IF
!
!  tag 57, flux star 5, band 7
!
      IF(kk == 4662)THEN
         sdarkint5(7)=var(i)
         IF(sdarkint5(7) < 0.0_dp)sdarkint5(7)=0.0_dp
      END IF
!
!  tag 58, flux star 5, band 8
!
      IF(kk == 4663)THEN
         sdarkint5(8)=var(i)
         IF(sdarkint5(8) < 0.0_dp)sdarkint5(8)=0.0_dp
      END IF
!
!  tag a1, tidal apsidal constant, star 1
!
      IF(kk == 1016)THEN
         sw72=var(i)
         IF(sw72 < 0.0_dp)sw72=0.0_dp
         IF(iGR == 4)sw73=sw72
      END IF
!
!  tag a2, tidal apsidal constant, star 2
!
      IF(kk == 1017)THEN
         sw73=var(i)
         IF(sw73 < 0.0_dp)sw73=0.0_dp
      END IF
!
!  tag Ob, nodal angle of binary
!
      IF(kk == 449)THEN
         sw49=var(i)
      END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
!
      IF(kk == 649)THEN
         p2tconj=var(i)
      END IF
!
!  tag ut, P2period
!
      IF(kk == 659)THEN
         p2period=var(i)
      END IF
!
!  tag uu, P2T0
!
      IF(kk == 660)THEN
         p2t0=var(i)
      END IF
!
!  tag uv, P2ecos
!
      IF(kk == 661)THEN
         p2ecos=var(i)
      END IF
!
!  tag uw, P2esin
!
      IF(kk == 662)THEN
         p2esin=var(i)
      END IF
!
!  tag ux, P2incl
!
      IF(kk == 663)THEN
         p2incl=var(i)
      END IF
!
!  tag uy, P2Omega
!
      IF(kk == 664)THEN
         p2omega=var(i)
      END IF
!
!  tag uz, P2Q
!
      IF(kk == 665)THEN
         p2q=var(i)
      END IF
!
!  tag ub, P2ratrad
!
      IF(kk == 641)THEN
         p2ratrad=var(i)
      END IF
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
      IF(kk == 681)THEN
         p3tconj=var(i)
      END IF
!
!  tag vt, P3period
!
      IF(kk == 691)THEN
         p3period=var(i)
      END IF
!
!  tag vu, P3T0
!
      IF(kk == 692)THEN
         p3t0=var(i)
      END IF
!
!  tag vv, P3ecos
!
      IF(kk == 693)THEN
         p3ecos=var(i)
      END IF
!
!  tag vw, P3esin
!
      IF(kk == 694)THEN
         p3esin=var(i)
      END IF
!
!  tag vx, P3incl
!
      IF(kk == 695)THEN
         p3incl=var(i)
      END IF
!
!  tag vy, P3Omega
!
      IF(kk == 696)THEN
         p3omega=var(i)
      END IF
!
!  tag vz, P3Q
!
      IF(kk == 697)THEN
         p3q=var(i)
      END IF
!
!  tag vb, P3ratrad
!
      IF(kk == 673)THEN
         p3ratrad=var(i)
      END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
      IF(kk == 713)THEN
         p4tconj=var(i)
      END IF
!
!  tag wt, P4period
!
      IF(kk == 723)THEN
         p4period=var(i)
      END IF
!
!  tag wu, P4T0
!
      IF(kk == 724)THEN
         p4t0=var(i)
      END IF
!
!  tag wv, P4ecos
!
      IF(kk == 725)THEN
         p4ecos=var(i)
      END IF
!
!  tag ww, P4esin
!
      IF(kk == 726)THEN
         p4esin=var(i)
      END IF
!
!  tag wx, P4incl
!
      IF(kk == 727)THEN
         p4incl=var(i)
      END IF
!
!  tag wy, P4Omega
!
      IF(kk == 728)THEN
         p4omega=var(i)
      END IF
!
!  tag wz, P4Q
!
      IF(kk == 729)THEN
         p4q=var(i)
      END IF
!
!  tag wb, P4ratrad
!
      IF(kk == 705)THEN
         p4ratrad=var(i)
      END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
      IF(kk == 745)THEN
         p5tconj=var(i)
      END IF
!
!  tag xt, P5period
!
      IF(kk == 755)THEN
         p5period=var(i)
      END IF
!
!  tag xu, P5T0
!
      IF(kk == 756)THEN
         p5t0=var(i)
      END IF
!
!  tag xv, P5ecos
!
      IF(kk == 757)THEN
         p5ecos=var(i)
      END IF
!
!  tag xw, P5esin
!
      IF(kk == 758)THEN
         p5esin=var(i)
      END IF
!
!  tag xx, P5incl
!
      IF(kk == 759)THEN
         p5incl=var(i)
      END IF
!
!  tag xy, P5Omega
!
      IF(kk == 760)THEN
         p5omega=var(i)
      END IF
!
!  tag xz, P5Q
!
      IF(kk == 761)THEN
         p5q=var(i)
      END IF
!
!  tag xb, P5ratrad
!
      IF(kk == 737)THEN
         p5ratrad=var(i)
      END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
      IF(kk == 585)THEN
         p6tconj=var(i)
      END IF
!
!  tag st, P6period
!
      IF(kk == 595)THEN
         p6period=var(i)
      END IF
!
!  tag su, P6T0
!
      IF(kk == 596)THEN
         p6t0=var(i)
      END IF
!
!  tag sv, P6ecos
!
      IF(kk == 597)THEN
         p6ecos=var(i)
      END IF
!
!  tag sw, P6esin
!
      IF(kk == 598)THEN
         p6esin=var(i)
      END IF
!
!  tag sx, P6incl
!
      IF(kk == 599)THEN
         p6incl=var(i)
      END IF
!
!  tag sy, P6Omega
!
      IF(kk == 600)THEN
         p6omega=var(i)
      END IF
!
!  tag sz, P6Q
!
      IF(kk == 601)THEN
         p6q=var(i)
      END IF
!
!  tag sb, P6ratrad
!
      IF(kk == 577)THEN
         p6ratrad=var(i)
      END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
      IF(kk == 233)THEN
         p7tconj=var(i)
      END IF
!
!  tag ht, P7period
!
      IF(kk == 243)THEN
         p7period=var(i)
      END IF
!
!  tag hu, P7T0
!
      IF(kk == 244)THEN
         p7t0=var(i)
      END IF
!
!  tag hv, P7ecos
!
      IF(kk == 245)THEN
         p7ecos=var(i)
      END IF
!
!  tag hw, P7esin
!
      IF(kk == 246)THEN
         p7esin=var(i)
      END IF
!
!  tag hx, P7incl
!
      IF(kk == 247)THEN
         p7incl=var(i)
      END IF
!
!  tag hy, P7Omega
!
      IF(kk == 248)THEN
         p7omega=var(i)
      END IF
!
!  tag hz, P7Q
!
      IF(kk == 249)THEN
         p7q=var(i)
      END IF
!
!  tag hb, P7ratrad
!
      IF(kk == 225)THEN
         p7ratrad=var(i)
      END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
      IF(kk == 329)THEN
         p8tconj=var(i)
      END IF
!
!  tag kt, P8period
!
      IF(kk == 339)THEN
         p8period=var(i)
      END IF
!
!  tag ku, P8T0
!
      IF(kk == 340)THEN
         p8t0=var(i)
      END IF
!
!  tag kv, P8ecos
!
      IF(kk == 341)THEN
         p8ecos=var(i)
      END IF
!
!  tag kw, P8esin
!
      IF(kk == 342)THEN
         p8esin=var(i)
      END IF
!
!  tag kx, P8incl
!
      IF(kk == 343)THEN
         p8incl=var(i)
      END IF
!
!  tag ky, P8Omega
!
      IF(kk == 344)THEN
         p8omega=var(i)
      END IF
!
!  tag kz, P8Q
!
      IF(kk == 345)THEN
         p8q=var(i)
      END IF
!
!  tag kb, P8ratrad
!
      IF(kk == 42)THEN
         p8ratrad=var(i)
      END IF
!
!  tag s0, seasonal contamination season 0
!
      IF(kk == 1591)THEN
         contams0=var(i)
         IF(contams0 < 0.0_dp)contams0=0.0_dp
      END IF
!
!  tag s1, seasonal contamination season 1
!
      IF(kk == 1592)THEN
         contams1=var(i)
         IF(contams1 < 0.0_dp)contams1=0.0_dp
      END IF
!
!  tag s2, seasonal contamination season 2
!
      IF(kk == 1593)THEN
         contams2=var(i)
         IF(contams2 < 0.0_dp)contams2=0.0_dp
      END IF
!
!  tag s3, seasonal contamination s3
!
      IF(kk == 1594)THEN
         contams3=var(i)
         IF(contams3 < 0.0_dp)contams3=0.0_dp
      END IF
!
!  tag do, omegadot
!
      IF(kk == 110)THEN
         omegadot=var(i)
      END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
      IF(kk == 1208)THEN
         tgrav1=var(i)
      END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
      IF(kk == 1209)THEN
         tgrav2=var(i)
      END IF
!
!  tag tj, tertconj, third body conjunction
!
      IF(kk == 617)THEN
         tertconj=var(i)
      END IF
!
!  tag tt, tertperiod, third body perioe
!
      IF(kk == 627)THEN
         tertperiod=var(i)
      END IF
!
!  tag tu, tertT0, third body periastron
!
      IF(kk == 628)THEN
         tertt0=var(i)
      END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3
!
      IF(kk == 629)THEN
         tertecos=var(i)
      END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3
!
      IF(kk == 630)THEN
         tertesin=var(i)
      END IF
!
!  tag tx, tertincl, inclination for body 3
!
      IF(kk == 631)THEN
         tertincl=var(i)
      END IF
!
!  tag ty, tertOmega, Omega for body 3
!
      IF(kk == 632)THEN
         tertomega=var(i)
      END IF
!
!  tag tz, tertQ, third body mass ratio
!
      IF(kk == 633)THEN
         tertq=var(i)
      END IF
!
!  tag tb, tertratrad, third body radius ratio
!
      IF(kk == 609)THEN
         tertratrad=var(i)
      END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
      IF((isw29 > 0).AND.(kk == 450))THEN
         ocose=var(i)
      END IF
!
!  tag os, osine, e*sin(omega) for binary
!
      IF((isw29 > 0).AND.(kk == 466))THEN
         osine=var(i)
      END IF
!
!  tag co, contam, Kepler contamination
!
      IF(kk == 78)THEN
         contam=var(i)
      END IF
!
!  tag e1, beam1, Doppler beaming coefficient star 1
!
      IF(kk == 1144)THEN
         beam1=var(i)
      END IF
!
!  tag e2, beam2, Doppler beaming coefficient star 2
!
      IF(kk == 1145)THEN
         beam2=var(i)
      END IF
!
!  tag tc, Tconj, conjunction time for binary
!
      IF(kk == 610)THEN
         tconj=var(i)
      END IF
!
!  tag de, density for primary star
!
      IF(kk == 100)THEN
         density=var(i)
      END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
      IF(kk == 8)THEN
         bigi=var(i)
      END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
      IF(kk == 1)THEN
         bigbeta=var(i)
      END IF
!
!  tag dp, ecosw, phase difference of secondary eclipse
!
      IF(kk == 111)THEN
         ecosw=var(i)
      END IF
!
!  tag te, temprat, temperature ratio star 2 to star 1
!
      IF(kk == 612)THEN
         temprat=var(i)
      END IF
!
!  tag pm, primmass, primary mass in solar masses
!
      IF(kk == 492)THEN
         primmass=var(i)
         IF(primmass < 0.0_dp)primmass=0.0_dp
      END IF
!
!  tag pr, primrad, primary radius in solar masses
!
      IF(kk == 497)THEN
         primrad=var(i)
         IF(primrad < 0.0_dp)primrad=0.0_dp
      END IF
!
!  tag pk, primK, K-velocity of primary in km/sec
!
      IF(kk == 490)THEN
         primk=var(i)
         IF(primk < 0.0_dp)primk=0.0_dp
      END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
      IF(kk == 544)THEN
         ratrad=var(i)
         IF(ratrad < 0.0_dp)ratrad=0.0_dp
      END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
      IF(kk == 1528)THEN
         frac1=var(i)
         IF(frac1 < 0.0_dp)frac1=0.0_dp
      END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
      IF(kk == 1529)THEN
         frac2=var(i)
!              if(frac2.lt.0.0d0)frac2=0.0d0
      END IF
!
!  tag l1, alb1, star 1 albedo
!
      IF(kk == 1368)THEN
         alb1=var(i)
         IF(alb1 < 0.0_dp)alb1=0.0_dp
      END IF
!
!  tag l2, alb2, star 2 albedo
!
      IF(kk == 1369)THEN
         alb2=var(i)
         IF(alb2 < 0.0_dp)alb2=0.0_dp
      END IF
!
!  tag pe, period, binary period in days
!
      IF(kk == 484)THEN
         period=var(i)
      END IF
!
!  tag t0, T0, time of periastron passage of binary
!
      IF(kk == 1623)THEN
         t0=var(i)
      END IF
!
!  tag d1, temperature factor spot 1 on disk
!
      IF(kk == 1112)THEN
         spotdparm(1,1)=var(i)
         IF(spotdparm(1,1) <= -10.0_dp)spotdparm(1,1)=-1.0_dp
      END IF
!
!  tag d5, temperature factor spot 2 on disk
!
      IF(kk == 1116)THEN
         spotdparm(2,1)=var(i)
         IF(spotdparm(2,1) <= -10.0_dp)spotdparm(2,1)=-1.0_dp
      END IF
!
!  tag d2, azimuth spot 1 on disk
!
      IF(kk == 1113)THEN
         spotdparm(1,2)=MOD(var(i),360.0_dp)
         spotdparm(1,2)=var(i)
      END IF
!
!  tag d6, azimuth spot 2 on disk
!
      IF(kk == 1117)THEN
         spotdparm(2,2)=MOD(var(i),360.0_dp)
         spotdparm(2,2)=var(i)
      END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
      IF(kk == 1114)THEN
         spotdparm(1,3)=var(i)
         IF(spotdparm(1,3) > 1.0_dp)spotdparm(1,3)=1.0_dp
         IF(spotdparm(1,3) < 0.0_dp)spotdparm(1,3)=0.0_dp
      END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
      IF(kk == 1118)THEN
         spotdparm(2,3)=var(i)
         IF(spotdparm(2,3) > 1.0_dp)spotdparm(2,3)=1.0_dp
         IF(spotdparm(2,3) < 0.0_dp)spotdparm(2,3)=0.0_dp
      END IF
!
!  tag d4, angular width of spot 1 on disk
!
      IF(kk == 1115)THEN
         spotdparm(1,4)=var(i)
         IF(spotdparm(1,4) < 0.0_dp)spotdparm(1,4)=0.0_dp
      END IF
!
!  tag d8, angular width of spot 2 on disk
!
      IF(kk == 1119)THEN
         spotdparm(2,4)=var(i)
         IF(spotdparm(2,4) < 0.0_dp)spotdparm(2,4)=0.0_dp
      END IF
!
!  tag c1, temperature factor spot 1, star 2
!
      IF(kk == 1080)THEN
         spot2parm(1,1)=var(i)
      END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
      IF(kk == 1084)THEN
         spot2parm(2,1)=var(i)
      END IF
!
!  tag b1, temperature factor spot 1, star 1
!
      IF(kk == 1048)THEN
         spot1parm(1,1)=var(i)
      END IF
!
!  tag b5, temperature factor spot 2, star 1
!
      IF(kk == 1052)THEN
         spot1parm(2,1)=var(i)
      END IF
!
!  tag c2, latitude spot 1, star 2
!
      IF(kk == 1081)THEN
         spot2parm(1,2)=MOD(var(i),180.0_dp)
      END IF
!
!  tag c6, latitude spot 2, star 2
!
      IF(kk == 1085)THEN
         spot2parm(2,2)=MOD(var(i),180.0_dp)
      END IF
!
!  tag b2, latitude spot 1, star 1
!
      IF(kk == 1049)THEN
         spot1parm(1,2)=MOD(var(i),180.0_dp)
      END IF
!
!  tag b6,  latitude spot 2, star 1
!
      IF(kk == 1053)THEN
         spot1parm(2,2)=MOD(var(i),180.0_dp)
      END IF
!
!  tag c3, longitude spot 1, star 2
!
      IF(kk == 1082)THEN
         spot2parm(1,3)=MOD(var(i),360.0_dp)
      END IF
!
!  tag c7, longitude spot 2, star 2
!
      IF(kk == 1086)THEN
         spot2parm(2,3)=MOD(var(i),360.0_dp)
      END IF
!
!  tag b3, longitude spot 1, star 1
!
      IF(kk == 1050)THEN
         spot1parm(1,3)=MOD(var(i),360.0_dp)
      END IF
!
!  tag b7, longitude spot 2, star 1
!
      IF(kk == 1054)THEN
         spot1parm(2,3)=MOD(var(i),360.0_dp)
      END IF
!
!  tag c4, radius spot 1, star 2
!
      IF(kk == 1083)THEN
         spot2parm(1,4)=var(i)
      END IF
!
!  tag c8, radius spot 2, star 2
!
      IF(kk == 1087)THEN
         spot2parm(2,4)=var(i)
      END IF
!
!  tag b4, radius spot 1, star 1
!
      IF(kk == 1051)THEN
         spot1parm(1,4)=var(i)
      END IF
!
!  tag b8,  radius spot 2, star 1
!
      IF(kk == 1055)THEN
         spot1parm(2,4)=var(i)
      END IF
!
!  tag ps, pshift
!
      IF(kk == 498)THEN
         pshift=var(i)
         IF(pshift > 1.0_dp)pshift=1.0_dp
         IF(pshift < -1.0_dp)pshift=-1.0_dp
      END IF
!
!  tag in, finc, inclination of binary
!
      IF(kk == 269)THEN
         finc=var(i)
!              if(finc.gt.90.0)finc=90.0
         IF(finc < 0.0_dp)finc=0.0_dp
      END IF
!
!  tag ma, Q, mass ratio of binary
!
      IF(kk == 384)THEN
         q=var(i)
         IF(q <= 0.0_dp)q=0.001_dp
      END IF
!
!  tag ec, ecc, eccentricity of binary
!
      IF(kk == 130)THEN
         ecc=var(i)
         IF(ecc <= 0.0_dp)ecc=0.000_dp
         IF(ecc >= 1.0_dp)ecc=0.9999_dp
      END IF
!
!  tag ar, argper, argument of periastron of binary
!
      IF(kk == 17)THEN
         argper=var(i)
!              if(argper.le.0.0d0)argper=0.000d0
!              if(argper.gt.360.0d0)argper=360.0d0
      END IF
!
!  tag f1, fill1, Roche lobe filling factor star 1
!
      IF(kk == 1176)THEN
         fill1=var(i)
         IF(fill1 > 1.0_dp)fill1=1.0_dp
      END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
      IF(kk == 552)THEN
         rinner=var(i)
         IF((rinner < fill2).AND.(teff2 > 0.0_dp))rinner=fill2
      END IF
!
!  tag f2, fill 2, Roche lobe filling factor star 2
!
      IF(kk == 1177)THEN
         fill2=var(i)
         IF(fill2 > 1.0_dp)fill2=1.0_dp
         IF(teff2 > 0.0_dp)rinner=fill2
         IF(fill2 < 0.0_dp)THEN
            fill2=0.000001_dp
            rinner=fill2
         END IF
      END IF
!
!  tag o1, omega1, spin rate of star 1
!
      IF(kk == 1464)THEN
         omega1=var(i)
      END IF
!
!  tag o2, omega2, spin rate of star 2
!
      IF(kk == 1465)THEN
         omega2=var(i)
      END IF
!
!  tag ro, router, outer radius of accretion disk
!
      IF(kk == 558)THEN
         router=var(i)
         IF(router > 1.0_dp)router=1.0_dp
      END IF
!
!  tag td, Tdisk, temperature of inner disk
!
      IF(kk == 611)THEN
         tdisk=var(i)
         IF(tdisk < 100.0_dp)tdisk=100.0_dp
      END IF
!
!  tag be, betarim, opening angle of disk
!
      IF(kk == 36)THEN
         betarim=var(i)
         IF(betarim < 0.0_dp)betarim=0.0_dp
      END IF
!
!  tag t1, Teff1, temperature of star 1
!
      IF(kk == 1624)THEN
         teff1=var(i)
         IF(teff1 < 100.0_dp)teff1=100.0_dp
      END IF
!
!  tag t2, Teff2, temperature of star 2
!
      IF(kk == 1625)THEN
         teff2=var(i)
         IF(teff2 < 100.0_dp)teff2=100.0_dp
      END IF
!
!  tag xi, xi, power-law exponent on disk temperature profile
!
      IF(kk == 744)THEN
         xi=var(i)
      END IF
!
!  tag lx, rLx, log of the X-ray luminosity
!
      IF(kk == 375)THEN
         rlx=var(i)
         IF(rlx < 0.0_dp)rlx=0.0_dp
      END IF
!
!  tag se, separ, binary semimajor axis
!
      IF(kk == 580)THEN
         separ=var(i)
         IF(separ < 0.01_dp)separ=0.01_dp
      END IF
!
!  tag ga, gamma, gamma-velocity of binary
!
      IF(kk == 192)THEN
         gamma=var(i)
      END IF
!
!  tag t3, Teff3, temperature of star 3
!
      IF(kk == 1626)THEN
         t3=var(i)
         IF(t3 < 0.01_dp)t3=0.01_dp
      END IF
!
!  tag t4, Teff4, temperature of star 4
!
      IF(kk == 1627)THEN
         sw80=var(i)
         IF(sw80 < 0.01_dp)sw80=0.01_dp
      END IF
!
!  tag t5, Teff5, temperature of star 5
!
      IF(kk == 1628)THEN
         sw81=var(i)
         IF(sw81 < 0.01_dp)sw81=0.01_dp
      END IF
!
!  tag g3, g3, log(g) of star 3
!
      IF(kk == 1210)THEN
         g3=var(i)
         IF(g3 < 0.01_dp)g3=0.01_dp
      END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
      IF(kk == 576)THEN
         sa3=var(i)
      END IF
!
!   Here are the assignments for the limb darkening parameters.
!   use tags x1, x2, to x8 for the x-coefficient for star 1
!   and y1, y2, to y8 for the y-coefficient for star 1.
!
!   Use z1, z2, to z8 for the x-coefficient for star 2 and
!   use w1, w2, to w8 for the y-coefficient for star 2.
!
      IF(kk == 1752)dwavex(1,1)=var(i)
      IF(kk == 1753)dwavex(2,1)=var(i)
      IF(kk == 1754)dwavex(3,1)=var(i)
      IF(kk == 1755)dwavex(4,1)=var(i)
      IF(kk == 1756)dwavex(5,1)=var(i)
      IF(kk == 1757)dwavex(6,1)=var(i)
      IF(kk == 1758)dwavex(7,1)=var(i)
      IF(kk == 1759)dwavex(8,1)=var(i)
!
      IF(kk == 1784)dwavey(1,1)=var(i)
      IF(kk == 1785)dwavey(2,1)=var(i)
      IF(kk == 1786)dwavey(3,1)=var(i)
      IF(kk == 1787)dwavey(4,1)=var(i)
      IF(kk == 1788)dwavey(5,1)=var(i)
      IF(kk == 1789)dwavey(6,1)=var(i)
      IF(kk == 1790)dwavey(7,1)=var(i)
      IF(kk == 1791)dwavey(8,1)=var(i)
!
      IF(kk == 1816)dwavex(1,2)=var(i)
      IF(kk == 1817)dwavex(2,2)=var(i)
      IF(kk == 1818)dwavex(3,2)=var(i)
      IF(kk == 1819)dwavex(4,2)=var(i)
      IF(kk == 1820)dwavex(5,2)=var(i)
      IF(kk == 1821)dwavex(6,2)=var(i)
      IF(kk == 1822)dwavex(7,2)=var(i)
      IF(kk == 1823)dwavex(8,2)=var(i)
!
      IF(kk == 1720)dwavey(1,2)=var(i)
      IF(kk == 1721)dwavey(2,2)=var(i)
      IF(kk == 1722)dwavey(3,2)=var(i)
      IF(kk == 1723)dwavey(4,2)=var(i)
      IF(kk == 1724)dwavey(5,2)=var(i)
      IF(kk == 1725)dwavey(6,2)=var(i)
      IF(kk == 1726)dwavey(7,2)=var(i)
      IF(kk == 1727)dwavey(8,2)=var(i)
!
!   body 3 limb darkening, use tags m1 through m8
!   for the first coefficient, and tags n1 through
!   n8 for the second coefficient
!
      IF(kk == 1400)dwavex(1,3)=var(i)
      IF(kk == 1401)dwavex(2,3)=var(i)
      IF(kk == 1402)dwavex(3,3)=var(i)
      IF(kk == 1403)dwavex(4,3)=var(i)
      IF(kk == 1404)dwavex(5,3)=var(i)
      IF(kk == 1405)dwavex(6,3)=var(i)
      IF(kk == 1406)dwavex(7,3)=var(i)
      IF(kk == 1407)dwavex(8,3)=var(i)
!
      IF(kk == 1432)dwavey(1,3)=var(i)
      IF(kk == 1433)dwavey(2,3)=var(i)
      IF(kk == 1434)dwavey(3,3)=var(i)
      IF(kk == 1435)dwavey(4,3)=var(i)
      IF(kk == 1436)dwavey(5,3)=var(i)
      IF(kk == 1437)dwavey(6,3)=var(i)
      IF(kk == 1438)dwavey(7,3)=var(i)
      IF(kk == 1439)dwavey(8,3)=var(i)
!
!   body 4 limb darkening, use tags i1 through i8
!   for the first coefficient, and tags j1 through
!   j8 for the second coefficient
!
      IF(kk == 1272)dwavex(1,4)=var(i)
      IF(kk == 1273)dwavex(2,4)=var(i)
      IF(kk == 1274)dwavex(3,4)=var(i)
      IF(kk == 1275)dwavex(4,4)=var(i)
      IF(kk == 1276)dwavex(5,4)=var(i)
      IF(kk == 1277)dwavex(6,4)=var(i)
      IF(kk == 1278)dwavex(7,4)=var(i)
      IF(kk == 1279)dwavex(8,4)=var(i)
!
      IF(kk == 1304)dwavey(1,4)=var(i)
      IF(kk == 1305)dwavey(2,4)=var(i)
      IF(kk == 1306)dwavey(3,4)=var(i)
      IF(kk == 1307)dwavey(4,4)=var(i)
      IF(kk == 1308)dwavey(5,4)=var(i)
      IF(kk == 1309)dwavey(6,4)=var(i)
      IF(kk == 1310)dwavey(7,4)=var(i)
      IF(kk == 1311)dwavey(8,4)=var(i)
!
!   body 5 limb darkening, use tags k1 through k8
!   for the first coefficient, and tags p1 through
!   p8 for the second coefficient
!
      IF(kk == 1336)dwavex(1,5)=var(i)
      IF(kk == 1337)dwavex(2,5)=var(i)
      IF(kk == 1338)dwavex(3,5)=var(i)
      IF(kk == 1339)dwavex(4,5)=var(i)
      IF(kk == 1340)dwavex(5,5)=var(i)
      IF(kk == 1341)dwavex(6,5)=var(i)
      IF(kk == 1342)dwavex(7,5)=var(i)
      IF(kk == 1343)dwavex(8,5)=var(i)
!
      IF(kk == 1496)dwavey(1,5)=var(i)
      IF(kk == 1497)dwavey(2,5)=var(i)
      IF(kk == 1498)dwavey(3,5)=var(i)
      IF(kk == 1499)dwavey(4,5)=var(i)
      IF(kk == 1500)dwavey(5,5)=var(i)
      IF(kk == 1501)dwavey(6,5)=var(i)
      IF(kk == 1502)dwavey(7,5)=var(i)
      IF(kk == 1503)dwavey(8,5)=var(i)
!
   END DO
!
   RETURN
!
END SUBROUTINE assignvar
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checkfluxfit(islc,nmodel,xmodel,yinput,ndata,xdata,  &
   ydata,errbar,chisq,zero,ifixgamma,itime,res)
!
!  May 5, 2017
!
!  This routine will scale the light curve model for light curves
!  that are in flux units.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: islc
   INTEGER, INTENT(IN)                      :: nmodel
   REAL(KIND=dp), INTENT(IN)                :: xmodel(nmodel)
   REAL(KIND=dp), INTENT(IN)                :: yinput(nmodel)
   INTEGER, INTENT(IN)                      :: ndata
   REAL(KIND=dp), INTENT(IN)                :: xdata(ndata)
   REAL(KIND=dp), INTENT(IN)                :: ydata(ndata)
   REAL(KIND=dp), INTENT(IN)                :: errbar(ndata)
   REAL(KIND=dp), INTENT(OUT)               :: chisq
   REAL(KIND=dp), INTENT(IN OUT)            :: zero
   INTEGER, INTENT(IN)                      :: ifixgamma
   INTEGER, INTENT(IN)                      :: itime
   REAL(KIND=dp), INTENT(OUT)               :: res(ndata)
!
   REAL(KIND=dp)   :: ymin,ymax,qqq,savezero
   REAL(KIND=dp)   :: rmodelave,dataave,step,chi1,chi2,chi3,small,zerosmall
   REAL(KIND=dp)   :: zero1,zero2,zero3,fn,diff,csave,zsave,diff23,chi4
!
   REAL(KIND=dp), DIMENSION(nmodel*3) :: ymodel,xpad,ypad
   REAL(KIND=dp), DIMENSION(ndata)    :: yinter,ydummy
!
   INTEGER :: jj,i,mmodel,ii
!
!   COMMON /medblock/ rmed
!
   IF(itime <= 1)THEN
      CALL addpad(nmodel,xmodel,yinput,xpad,ypad)
      mmodel=nmodel*3
   ELSE
      DO jj=1,nmodel
         xpad(jj)=xmodel(jj)
         ypad(jj)=yinput(jj)
      END DO
      mmodel=nmodel
   END IF
!
   DO  i=1,mmodel
      ymodel(i)=ypad(i)
   END DO
!
!   Find the maximum and minimum y-values of the data
!
   ymin=1.0E+75_dp
   ymax=-1.0E+75_dp
   DO  i=1,ndata
      IF(ydata(i) < ymin)ymin=ydata(i)
      IF(ydata(i) > ymax)ymax=ydata(i)
   END DO
!
!   Interpolate the model so that we have y-values at all observed phases.
!
   ii=mmodel/2
   DO  i=1,ndata
      CALL hermint(mmodel,xpad,ymodel,xdata(i),qqq,ii)
      yinter(i)=qqq
   END DO
!
!   Now find the optimal zero point that will give the lowest chi^2.
!
   CALL getmean(ndata,ydata,dataave)
   CALL getmean(ndata,yinter,rmodelave)
   savezero=zero
   zero=(dataave/rmodelave)
   step=ABS(rmodelave-(dataave))/1000.0_dp
!
   chi1=0.0_dp
   chi2=0.0_dp
   chi3=0.0_dp
   small=1.0E+75_dp
   zerosmall=1.0E+70_dp
!
   DO  i=1,40
      zero1=zero
      CALL scale(ndata,yinter,ydummy,zero1)
      CALL getchi(ndata,ydata,errbar,ydummy,chi1)
      IF(chi1 < small)THEN
         small=chi1
         zerosmall=zero1
      END IF
      fn=0.0_dp
      zero2=zero*(1.0_dp+step)
      CALL scale(ndata,yinter,ydummy,zero2)
      CALL getchi(ndata,ydata,errbar,ydummy,chi2)
      IF(chi2 < small)THEN
         small=chi2
         zerosmall=zero2
      END IF
      diff=chi1-chi2
      IF(diff > 0.0_dp)GO TO 40
      step=-step
!
      csave=chi1
      chi1=chi2
      chi2=csave
      zsave=zero1
      zero1=zero2
      zero2=zsave
!
40    fn=fn+1.0_dp
!
      zero3=zero2*(1.0_dp+step)
      CALL scale(ndata,yinter,ydummy,zero3)
      CALL getchi(ndata,ydata,errbar,ydummy,chi3)
      IF(chi3 < small)THEN
         small=chi3
         zerosmall=zero3
      END IF
      diff23=chi3-chi2
      IF(diff23 < 0.0_dp)THEN
         chi1=chi2
         chi2=chi3
         zero1=zero2
         zero2=zero3
         zero=zero3
         GO TO 40
      END IF
!
!         find the minimum of parabola defined by the last three points
!
      IF(ABS(chi3-chi2) <= EPSILON(chi3))EXIT
      step=step*(1.0_dp/(1.0_dp+(chi1-chi2)/(chi3-chi2))+0.5_dp)
      zero=zero2/(1.0_dp-step)
      step=step*fn/3.0_dp
      CALL scale(ndata,yinter,ydummy,zero)
      CALL getchi(ndata,ydata,errbar,ydummy,chi4)
      IF(chi4 < small)THEN
         small=chi4
         zerosmall=zero
      END IF
!
   END DO
!
   zero=zerosmall
!
   IF((islc <= 0).AND.(ifixgamma == 0))zero=savezero
   CALL scale(ndata,yinter,ydummy,zero)
   CALL getchi(ndata,ydata,errbar,ydummy,chi3)
!
   chisq=chi3
!
!   UPDATE October 31, 2011
!
!   compute the residuals
!
   DO ii=1,ndata
      res(ii)=ydata(ii)-ydummy(ii)
   END DO
!
   RETURN
!
END SUBROUTINE checkfluxfit
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checkgridloop(nvmax,svar,temprat,isw29,ilaw,isw86,  &
   iidint,isw27,isw34,isw28,pbmtc,pbptc,binqtc,p1qtc,p1mtc,  &
   p1ptc,p2qtc,p2mtc,p2ptc,p3qtc,p3mtc,p3ptc,p4qtc,p4mtc,p4ptc,  &
   p5qtc,p5mtc,p5ptc,p6qtc,p6mtc,p6ptc,p7qtc,p7mtc,p7ptc,p8qtc,  &
   p8mtc,p8ptc,isw80,isw30,angsum1,angdiff1,angsum2,angdiff2,  &
   angsum3,angdiff3,angsum4,angdiff4,angsum5,angdiff5,angsum6,  &
   angdiff6,angsum7,angdiff7,angsum8,angdiff8,sqecos,sqesin,  &
   primmass,secmass,q,masssum,primk,primrad,secrad,radsum,  &
   ratrad,fracsum,frac1,frac2,fillsum,filldiff,sqtertesin,  &
   sqtertecos,sqp2ecos,sqp2esin,sqp3ecos,sqp3esin,sqp4ecos,  &
   sqp4esin,sqp5ecos,sqp5esin,sqp6ecos,sqp6esin,sqp7ecos,  &
   sqp7esin,sqp8ecos,sqp8esin,b2masssum,bin2q,b2radsum,  &
   bin2ratrad,bin2m3,bin2m4,bin2r3,bin2r4,iGR,iversion,itconj)
!
!   This routine will attempt to catch common mistakes
!   in gridloop.opt, like fitting for T1 and T2 when temprat
!   is not zero.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                     :: nvmax
   CHARACTER(LEN=40), INTENT(IN)           :: svar(nvmax)
   REAL(KIND=dp), INTENT(IN)               :: temprat
   INTEGER, INTENT(IN)                     :: isw29
   INTEGER, INTENT(IN)                     :: ilaw
   INTEGER, INTENT(IN)                     :: isw86
   INTEGER, INTENT(IN)                     :: iidint
   INTEGER, INTENT(IN)                     :: isw27
   INTEGER, INTENT(IN)                     :: isw34
   INTEGER, INTENT(IN)                     :: isw28
   REAL(KIND=dp), INTENT(IN)               :: pbmtc
   REAL(KIND=dp), INTENT(IN)               :: pbptc
   REAL(KIND=dp), INTENT(IN)               :: binqtc
   REAL(KIND=dp), INTENT(IN)               :: p1qtc
   REAL(KIND=dp), INTENT(IN)               :: p1mtc
   REAL(KIND=dp), INTENT(IN)               :: p1ptc
   REAL(KIND=dp), INTENT(IN)               :: p2qtc
   REAL(KIND=dp), INTENT(IN)               :: p2mtc
   REAL(KIND=dp), INTENT(IN)               :: p2ptc
   REAL(KIND=dp), INTENT(IN)               :: p3qtc
   REAL(KIND=dp), INTENT(IN)               :: p3mtc
   REAL(KIND=dp), INTENT(IN)               :: p3ptc
   REAL(KIND=dp), INTENT(IN)               :: p4qtc
   REAL(KIND=dp), INTENT(IN)               :: p4mtc
   REAL(KIND=dp), INTENT(IN)               :: p4ptc
   REAL(KIND=dp), INTENT(IN)               :: p5qtc
   REAL(KIND=dp), INTENT(IN)               :: p5mtc
   REAL(KIND=dp), INTENT(IN)               :: p5ptc
   REAL(KIND=dp), INTENT(IN)               :: p6qtc
   REAL(KIND=dp), INTENT(IN)               :: p6mtc
   REAL(KIND=dp), INTENT(IN)               :: p6ptc
   REAL(KIND=dp), INTENT(IN)               :: p7qtc
   REAL(KIND=dp), INTENT(IN)               :: p7mtc
   REAL(KIND=dp), INTENT(IN)               :: p7ptc
   REAL(KIND=dp), INTENT(IN)               :: p8qtc
   REAL(KIND=dp), INTENT(IN)               :: p8mtc
   REAL(KIND=dp), INTENT(IN)               :: p8ptc
   INTEGER, INTENT(IN)                     :: isw80
   INTEGER, INTENT(IN)                     :: isw30
   REAL(KIND=dp), INTENT(IN)               :: angsum1
   REAL(KIND=dp), INTENT(IN)               :: angdiff1
   REAL(KIND=dp), INTENT(IN)               :: angsum2
   REAL(KIND=dp), INTENT(IN)               :: angdiff2
   REAL(KIND=dp), INTENT(IN)               :: angsum3
   REAL(KIND=dp), INTENT(IN)               :: angdiff3
   REAL(KIND=dp), INTENT(IN)               :: angsum4
   REAL(KIND=dp), INTENT(IN)               :: angdiff4
   REAL(KIND=dp), INTENT(IN)               :: angsum5
   REAL(KIND=dp), INTENT(IN)               :: angdiff5
   REAL(KIND=dp), INTENT(IN)               :: angsum6
   REAL(KIND=dp), INTENT(IN)               :: angdiff6
   REAL(KIND=dp), INTENT(IN)               :: angsum7
   REAL(KIND=dp), INTENT(IN)               :: angdiff7
   REAL(KIND=dp), INTENT(IN)               :: angsum8
   REAL(KIND=dp), INTENT(IN)               :: angdiff8
   REAL(KIND=dp), INTENT(IN)               :: sqecos
   REAL(KIND=dp), INTENT(IN)               :: sqesin
   REAL(KIND=dp), INTENT(IN)               :: primmass
   REAL(KIND=dp), INTENT(IN)               :: secmass
   REAL(KIND=dp), INTENT(IN)               :: q
   REAL(KIND=dp), INTENT(IN)               :: masssum
   REAL(KIND=dp), INTENT(IN)               :: primk
   REAL(KIND=dp), INTENT(IN)               :: primrad
   REAL(KIND=dp), INTENT(IN)               :: secrad
   REAL(KIND=dp), INTENT(IN)               :: radsum
   REAL(KIND=dp), INTENT(IN)               :: ratrad
   REAL(KIND=dp), INTENT(IN)               :: fracsum
   REAL(KIND=dp), INTENT(IN)               :: frac1
   REAL(KIND=dp), INTENT(IN)               :: frac2
   REAL(KIND=dp), INTENT(IN)               :: fillsum
   REAL(KIND=dp), INTENT(IN)               :: filldiff
   REAL(KIND=dp), INTENT(IN)               :: sqtertesin
   REAL(KIND=dp), INTENT(IN)               :: sqtertecos
   REAL(KIND=dp), INTENT(IN)               :: sqp2ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp2esin
   REAL(KIND=dp), INTENT(IN)               :: sqp3ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp3esin
   REAL(KIND=dp), INTENT(IN)               :: sqp4ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp4esin
   REAL(KIND=dp), INTENT(IN)               :: sqp5ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp5esin
   REAL(KIND=dp), INTENT(IN)               :: sqp6ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp6esin
   REAL(KIND=dp), INTENT(IN)               :: sqp7ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp7esin
   REAL(KIND=dp), INTENT(IN)               :: sqp8ecos
   REAL(KIND=dp), INTENT(IN)               :: sqp8esin
   REAL(KIND=dp), INTENT(IN)               :: b2masssum
   REAL(KIND=dp), INTENT(IN)               :: bin2q
   REAL(KIND=dp), INTENT(IN)               :: b2radsum
   REAL(KIND=dp), INTENT(IN)               :: bin2ratrad
   REAL(KIND=dp), INTENT(IN)               :: bin2m3
   REAL(KIND=dp), INTENT(IN)               :: bin2m4
   REAL(KIND=dp), INTENT(IN)               :: bin2r3
   REAL(KIND=dp), INTENT(IN)               :: bin2r4
   INTEGER, INTENT(IN)                     :: iGR
   INTEGER, INTENT(IN)                     :: iversion
   INTEGER, INTENT(IN)                     :: itconj
!
   INTEGER :: icnvrt,i,kk,icount
!
   CHARACTER(LEN=1) :: bell
!
!   Check for body 3 tags when Nbody < 3
!
   IF(isw30 < 3)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tj, tertconj
!
         IF(kk == 617)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tt, tertperiod
!
         IF(kk == 627)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tu, tertT0
!
         IF(kk == 628)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tv, tertecos
!
         IF(kk == 629)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tw, tertesin
!
         IF(kk == 630)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tx, tertincl
!
         IF(kk == 631)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ty, tertOmega
!
         IF(kk == 632)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1m, P1mTc
!
         IF(kk == 3524)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1p, P1pTc
!
         IF(kk == 3527)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1q, P1qTc
!
         IF(kk == 3528)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1t, T1off
!
         IF(kk == 3531)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1s, sqteretesin
!
         IF(kk == 3530)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1c, sqtertecos
!
         IF(kk == 3514)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1a, angsum1
!
         IF(kk == 3512)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 1d, angdiff1
!
         IF(kk == 3515)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o3, omega3
!
         IF(kk == 1466)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ci, axis_I3
!
         IF(kk == 72)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag cb, axis_beta3
!
         IF(kk == 65)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a3, rk3
!
         IF(kk == 1018)THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags m1 to m8
!
         IF((kk >= 1400).AND.(kk <= 1407))THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags n1 to n8
!
         IF((kk >= 1432).AND.(kk <= 1439))THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 31 to 38
!
         IF((kk >= 4592).AND.(kk <= 4599))THEN
            WRITE(*,50)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
   END IF
!
!   Check for body 4 tags when Nbody < 4
!
   IF(isw30 < 4)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag uj, P2tconj
!
         IF(kk == 649)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ut, P2period
!
         IF(kk == 659)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uu, P2T0
!
         IF(kk == 660)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uv, P2ecos
!
         IF(kk == 661)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uw, P2esin
!
         IF(kk == 662)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ux, P2incl
!
         IF(kk == 663)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uy, P2Omega
!
         IF(kk == 664)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2m, P2mTc
!
         IF(kk == 3556)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2p, P2pTc
!
         IF(kk == 3559)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2q, P2qTc
!
         IF(kk == 3560)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2t, T2off
!
         IF(kk == 3563)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2s, sqP2esin
!
         IF(kk == 3562)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2c, sqP2ecos
!
         IF(kk == 3546)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2a, angsum2
!
         IF(kk == 3544)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 2d, angdiff2
!
         IF(kk == 3547)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a4, rk4
!
         IF(kk == 1019)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag T4, teff4
!
         IF(kk == 1627)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g4, g4
!
         IF(kk == 1211)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o4, g4
!
         IF(kk == 1467)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag di, axis_I4
!
         IF(kk == 104)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag db, axis_beta4
!
         IF(kk == 97)THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags i1 to i8, ld coefficients
!
         IF((kk >= 1272).AND.(kk <= 1279))THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags j1 to j8, ld coefficients
!
         IF((kk >= 1304).AND.(kk <= 1311))THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 41 to 48, body 4 fluxes
!
         IF((kk >= 4624).AND.(kk <= 4631))THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 90 to 98, binary+binary parameters
!
         IF((kk >= 4783).AND.(kk <= 4792))THEN
            WRITE(*,60)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
   END IF
!
!   Check for body 5 tags when Nbody < 5
!
   IF(isw30 < 5)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag vj, P3tconj
!
         IF(kk == 681)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vt, P3period
!
         IF(kk == 691)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vu, P3T0
!
         IF(kk == 692)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vv, P3ecos
!
         IF(kk == 693)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vw, P3esin
!
         IF(kk == 694)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vx, P3incl
!
         IF(kk == 695)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vy, P3Omega
!
         IF(kk == 696)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vz, P3Q
!
         IF(kk == 697)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag vb, P3ratrad
!
         IF(kk == 673)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3m, P3mTc
!
         IF(kk == 3588)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3p, P3pTc
!
         IF(kk == 3591)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3q, P3qTc
!
         IF(kk == 3592)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3t, T3off
!
         IF(kk == 3595)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3c, sqP3tecos
!
         IF(kk == 3578)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3s, sqP3tesin
!
         IF(kk == 3594)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3a, angsum3
!
         IF(kk == 3576)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 3d, angdiff3
!
         IF(kk == 3579)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag t5, Teff5
!
         IF(kk == 1628)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g5, g5
!
         IF(kk == 1212)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o5, omega5
!
         IF(kk == 1468)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a5, rk5
!
         IF(kk == 1020)THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags k1 to k8, body 5 limb darkening
!
         IF((kk >= 1336).AND.(kk <= 1343))THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags p1 to p8, body 5 limb darkening
!
         IF((kk >= 1496).AND.(kk <= 1503))THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 51 to 58, body 5 fluxes
!
         IF((kk >= 4656).AND.(kk <= 4663))THEN
            WRITE(*,70)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
   END IF
!
!   Check for body 6 tags when Nbody < 6
!
   IF(isw30 < 6)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag wj, P4tconj
!
         IF(kk == 713)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wt, P4period
!
         IF(kk == 723)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wu, P4T0
!
         IF(kk == 724)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wv, P4ecos
!
         IF(kk == 725)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ww, P4esin
!
         IF(kk == 726)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wx, P4incl
!
         IF(kk == 727)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wy, P4Omega
!
         IF(kk == 728)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wz, P4Q
!
         IF(kk == 729)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag wb, P4ratrad
!
         IF(kk == 705)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4m, P4mTc
!
         IF(kk == 3620)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4p, P4pTc
!
         IF(kk == 3623)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4q, P4qTc
!
         IF(kk == 3624)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4t, T4off
!
         IF(kk == 3627)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4s, sqP4tesin
!
         IF(kk == 3626)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4c, sqP4tecos
!
         IF(kk == 3610)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4a, angsum4
!
         IF(kk == 3608)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 4d, angdiff4
!
         IF(kk == 3611)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag t6, t6 (Teff6)
!
         IF(kk == 1629)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g6, g6
!
         IF(kk == 1213)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o6, omega6
!
         IF(kk == 1469)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a6, rk6
!
         IF(kk == 1021)THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 61 to 68
!
         IF((kk >= 4688).AND.(kk <= 4695))THEN
            WRITE(*,80)bell,svar(i)(1:2)
            STOP
         END IF

      END DO
   END IF
!
!   Check for body 7 tags when Nbody < 7
!
   IF(isw30 < 7)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag xj, P5tconj
!
         IF(kk == 745)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xt, P5period
!
         IF(kk == 755)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xu, P5T0
!
         IF(kk == 756)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xv, P5ecos
!
         IF(kk == 757)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xw, P5esin
!
         IF(kk == 758)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xx, P5incl
!
         IF(kk == 759)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xy, P5Omega
!
         IF(kk == 760)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xz, P5Q
!
         IF(kk == 761)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag xb, P5ratrad
!
         IF(kk == 737)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5m, P5mTc
!
         IF(kk == 3652)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5p, P5pTc
!
         IF(kk == 3655)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5q, P5qTc
!
         IF(kk == 3656)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5t, T5off
!
         IF(kk == 3659)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5s, sqP5tesin
!
         IF(kk == 3658)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5c, sqP5tecos
!
         IF(kk == 3642)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5a, angsum5
!
         IF(kk == 3640)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 5d, angdiff5
!
         IF(kk == 3643)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag t7, t7 (Teff7)
!
         IF(kk == 1630)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g7, g7
!
         IF(kk == 1214)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o7, omega7
!
         IF(kk == 1470)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a7, rk7
!
         IF(kk == 1022)THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 71 to 78
!
         IF((kk >= 4720).AND.(kk <= 4727))THEN
            WRITE(*,90)bell,svar(i)(1:2)
            STOP
         END IF

      END DO
   END IF
!
!   Check for body 8 tags when Nbody < 8
!
   IF(isw30 < 8)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag sj, P6tconj
!
         IF(kk == 585)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag st, P6period
!
         IF(kk == 595)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag su, P6T0
!
         IF(kk == 596)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sv, P6ecos
!
         IF(kk == 597)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sw, P6esin
!
         IF(kk == 598)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sx, P6incl
!
         IF(kk == 599)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sy, P6Omega
!
         IF(kk == 600)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sz, P6Q
!
         IF(kk == 601)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sb, P6ratrad
!
         IF(kk == 577)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6m, P6mTc
!
         IF(kk == 3684)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6p, P6pTc
!
         IF(kk == 3687)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6q, P6qTc
!
         IF(kk == 3688)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6t, T6off
!
         IF(kk == 3691)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6s, sqP6tesin
!
         IF(kk == 3690)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6c, sqP6tecos
!
         IF(kk == 3674)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6a, angsum6
!
         IF(kk == 3672)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 6d, angdiff6
!
         IF(kk == 3675)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag t8, t8 (Teff8)
!
         IF(kk == 1631)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g8, g8
!
         IF(kk == 1215)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o8, omega8
!
         IF(kk == 1471)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a8, rk8
!
         IF(kk == 1023)THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 81 to 88
!
         IF((kk >= 4752).AND.(kk <= 4759))THEN
            WRITE(*,100)bell,svar(i)(1:2)
            STOP
         END IF

      END DO
   END IF
!
!   Check for body 9 tags when Nbody < 9
!
   IF(isw30 < 9)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag hj, P7tconj
!
         IF(kk == 233)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ht, P7period
!
         IF(kk == 243)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hu, P7T0
!
         IF(kk == 244)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hv, P7ecos
!
         IF(kk == 245)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hw, P7esin
!
         IF(kk == 246)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hx, P7incl
!
         IF(kk == 247)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hy, P7Omega
!
         IF(kk == 248)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hz, P7Q
!
         IF(kk == 249)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag hb, P7ratrad
!
         IF(kk == 225)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7m, P7mTc
!
         IF(kk == 3716)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7p, P7pTc
!
         IF(kk == 3719)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7q, P7qTc
!
         IF(kk == 3720)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7t, T7off
!
         IF(kk == 3723)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7s, sqP7tesin
!
         IF(kk == 3722)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7c, sqP7tecos
!
         IF(kk == 3706)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7a, angsum7
!
         IF(kk == 3704)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 7d, angdiff7
!
         IF(kk == 3707)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag t9, t9 (Teff9)
!
         IF(kk == 1632)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g9, g9
!
         IF(kk == 1216)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o9, omega9
!
         IF(kk == 1472)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag a9, rk9
!
         IF(kk == 1024)THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 91 to 98
!
         IF((kk >= 2784).AND.(kk <= 2791))THEN
            WRITE(*,110)bell,svar(i)(1:2)
            STOP
         END IF

      END DO
   END IF
!
!   Check for body 10 tags when Nbody < 10
!
   IF(isw30 < 10)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag kj, P8tconj
!
         IF(kk == 329)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kt, P8period
!
         IF(kk == 339)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ku, P8T0
!
         IF(kk == 340)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kv, P8ecos
!
         IF(kk == 341)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kw, P8esin
!
         IF(kk == 342)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kx, P8incl
!
         IF(kk == 343)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ky, P8Omega
!
         IF(kk == 344)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kz, P8Q
!
         IF(kk == 345)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag kb, P8ratrad
!
         IF(kk == 42)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8m, P8mTc
!
         IF(kk == 3748)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8p, P8pTc
!
         IF(kk == 3751)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8q, P8qTc
!
         IF(kk == 3752)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8t, T8off
!
         IF(kk == 3755)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8s, sqP8tesin
!
         IF(kk == 3754)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8c, sqP8tecos
!
         IF(kk == 3738)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8a, angsum8
!
         IF(kk == 3736)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 8d, angdiff8
!
         IF(kk == 3732)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag g0, g10
!
         IF(kk == 1207)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag o0, omega10
!
         IF(kk == 1463)THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tags 01 to 08
!
         IF((kk >= 4496).AND.(kk <= 4503))THEN
            WRITE(*,120)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
   END IF
!
!   Flag fitting for tesscontam when iversion=0
!
   icount=0
   bell=CHAR(7)
!
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag ct, tesscontam
!
      IF(kk == 83)icount=icount+1
   END DO
!
!   If ct appears, and iversion = 0, stop
!
   IF((icount >= 1).AND.(iversion == 0))THEN
      WRITE(*,4130)bell
      STOP
   END IF
!
!   Flag fitting for rk1 and rk2 when iGR = 4
!
   icount=0
   bell=CHAR(7)
!
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag a1, rk1
!
      IF(kk == 1016)icount=icount+1
!
!   tag a2, rk22
!
      IF(kk == 1017)icount=icount+1
   END DO
!
!   If both rk1 and rk2 appear, and iGR = 4, stop
!
   IF((icount == 2).AND.(iGR == 4))THEN
      WRITE(*,3130)bell
      STOP
   END IF
!
!   Flag fitting for T1 and T2 when temprat is not zero
!
   icount=0
   bell=CHAR(7)
!
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag t1, teff1
!
      IF(kk == 1624)icount=icount+1
!
!   tag t2, teff2
!
      IF(kk == 1625)icount=icount+1
   END DO
!
!   If both t1 and t2 appear, and temprat > 0, stop
!
   IF((icount == 2).AND.(temprat > 0.0_dp))THEN
      WRITE(*,130)bell
      STOP
   END IF
!
!   Flag fitting for T2 when temprat is not zero
!
   icount=0
   bell=CHAR(7)
!
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag t2, teff2
!
      IF(kk == 1625)icount=icount+1
   END DO
!
!   If t2 appears, and temprat > 0, stop
!
   IF((icount == 1).AND.(temprat > 0.0_dp))THEN
      WRITE(*,140)bell
      STOP
   END IF
!
!   If isw29 > 0, then the user is fitting for e*cos(omega)
!   and e*sin(omega).  Check to see if ecc and/or argper are
!   in the variable list.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag ec, ecc
!
      IF(kk == 130)icount=icount+1
!
!   tag ar, argper
!
      IF(kk == 17)icount=icount+1
   END DO
!
!   If icount > 0 and isw29 > 0, then stop
!
   IF((isw29 > 0).AND.(icount > 0))THEN
      WRITE(*,150)bell
      STOP
   END IF
!
!   If isw29 = 0, then the user is fitting for ecc
!   and argper.  Check to see if sqecos and/or sqesin are
!   in the variable list.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag bc, sqecos
!
      IF(kk == 34)icount=icount+1
!
!   tag bs, sqesin
!
      IF(kk == 50)icount=icount+1
   END DO
!
!   If icount > 0 and isw29 = 0, then stop
!
   IF((isw29 == 0).AND.(icount > 0))THEN
      WRITE(*,160)bell
      STOP
   END IF
!
!   If isw29 = 0, then the user is fitting for ecc
!   and argper.  Check to see if ocose and/or osine are
!   in the variable list.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag oc, ocose
!
      IF(kk == 450)icount=icount+1
!
!   tag os, osine
!
      IF(kk == 466)icount=icount+1
   END DO
!
!   If icount > 0 and isw29 = 0, then stop
!
   IF((isw29 == 0).AND.(icount > 0))THEN
      WRITE(*,170)bell
      STOP
   END IF
!
!   If sqecos or sqesin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqecos) > EPSILON(sqecos)).AND.(icount > 0))THEN
      WRITE(*,180)bell
      STOP
   END IF
   IF((ABS(sqesin) > EPSILON(sqesin)).AND.(icount > 0))THEN
      WRITE(*,180)bell
      STOP
   END IF
!
!   If fitting for tertecos and tertesin, make sure
!   sqtertecos and sqtertesin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tv, tertecos
!
      IF(kk == 629)icount=icount+1
!
!   tag tw, tertesin
!
      IF(kk == 630)icount=icount+1
   END DO
!
!   If sqtertecos or sqtertesin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqtertecos) > EPSILON(sqtertecos)).AND.(icount > 0))THEN
      WRITE(*,190)bell
      STOP
   END IF
   IF((ABS(sqtertesin) > EPSILON(sqtertesin)).AND.(icount > 0))THEN
      WRITE(*,190)bell
      STOP
   END IF
!
!   If fitting for P2ecos and P2esin, make sure
!   sqP2ecos and sqP2esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag uv, P2ecos
!
      IF(kk == 661)icount=icount+1
!
!   tag uw, P2esin
!
      IF(kk == 662)icount=icount+1
   END DO
!
!   If sqP2ecos or sqP2esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp2ecos) > EPSILON(sqp2ecos)).AND.(icount > 0))THEN
      WRITE(*,200)bell
      STOP
   END IF
   IF((ABS(sqp2esin) > EPSILON(sqp2esin)).AND.(icount > 0))THEN
      WRITE(*,200)bell
      STOP
   END IF
!
!   If fitting for P3ecos and P3esin, make sure
!   sqP3ecos and sqP3esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag vv, P3ecos
!
      IF(kk == 693)icount=icount+1
!
!   tag vw, P3esin
!
      IF(kk == 694)icount=icount+1
   END DO
!
!   If sqP3ecos or sqP3esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp3ecos) > EPSILON(sqp3ecos)).AND.(icount > 0))THEN
      WRITE(*,210)bell
      STOP
   END IF
   IF((ABS(sqp3esin) > EPSILON(sqp3esin)).AND.(icount > 0))THEN
      WRITE(*,210)bell
      STOP
   END IF
!
!   If fitting for P4ecos and P4esin, make sure
!   sqP4ecos and sqP4esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag wv, P4ecos
!
      IF(kk == 725)icount=icount+1
!
!   tag vw, P4esin
!
      IF(kk == 726)icount=icount+1
   END DO
!
!   If sqP4ecos or sqP4esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp4ecos) > EPSILON(sqp4ecos)).AND.(icount > 0))THEN
      WRITE(*,220)bell
      STOP
   END IF
   IF((ABS(sqp4esin) > EPSILON(sqp4esin)).AND.(icount > 0))THEN
      WRITE(*,220)bell
      STOP
   END IF
!
!   If fitting for P5ecos and P5esin, make sure
!   sqP5ecos and sqP5esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag xv, P5ecos
!
      IF(kk == 757)icount=icount+1
!
!   tag xw, P5esin
!
      IF(kk == 758)icount=icount+1
   END DO
!
!   If sqP5ecos or sqP5esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp5ecos) > EPSILON(sqp5ecos)).AND.(icount > 0))THEN
      WRITE(*,230)bell
      STOP
   END IF
   IF((ABS(sqp5esin) > EPSILON(sqp5esin)).AND.(icount > 0))THEN
      WRITE(*,230)bell
      STOP
   END IF
!
!   If fitting for P6ecos and P6esin, make sure
!   sqP6ecos and sqP6esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag sv, P6ecos
!
      IF(kk == 597)icount=icount+1
!
!   tag sw, P6esin
!
      IF(kk == 598)icount=icount+1
   END DO
!
!   If sqP6ecos or sqP6esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp6ecos) > EPSILON(sqp6ecos)).AND.(icount > 0))THEN
      WRITE(*,240)bell
      STOP
   END IF
   IF((ABS(sqp6esin) > EPSILON(sqp6esin)).AND.(icount > 0))THEN
      WRITE(*,240)bell
      STOP
   END IF
!
!   If fitting for P7ecos and P7esin, make sure
!   sqP7ecos and sqP7esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag hv, P7ecos
!
      IF(kk == 245)icount=icount+1
!
!   tag hw, P7esin
!
      IF(kk == 246)icount=icount+1
   END DO
!
!   If sqP7ecos or sqP7esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp7ecos) > EPSILON(sqp7ecos)).AND.(icount > 0))THEN
      WRITE(*,250)bell
      STOP
   END IF
   IF((ABS(sqp7esin) > EPSILON(sqp7esin)).AND.(icount > 0))THEN
      WRITE(*,250)bell
      STOP
   END IF
!
!   If fitting for P8ecos and P8esin, make sure
!   sqP8ecos and sqP8esin are zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag kv, P8ecos
!
      IF(kk == 341)icount=icount+1
!
!   tag kw, P8esin
!
      IF(kk == 342)icount=icount+1
   END DO
!
!   If sqP8ecos or sqP8esin are not zero, and icount > 0
!   then stop
!
   IF((ABS(sqp8ecos) > EPSILON(sqp8ecos)).AND.(icount > 0))THEN
      WRITE(*,260)bell
      STOP
   END IF
   IF((ABS(sqp8esin) > EPSILON(sqp8esin)).AND.(icount > 0))THEN
      WRITE(*,260)bell
      STOP
   END IF
!
!   If ilaw is 1 or 11, then check for y-coefficients
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
      IF((kk >= 1784).AND.(kk <= 1791))icount=icount+1
      IF((kk >= 1720).AND.(kk <= 1727))icount=icount+1
      IF((kk >= 1432).AND.(kk <= 1439))icount=icount+1
      IF((kk >= 1304).AND.(kk <= 1311))icount=icount+1
      IF((kk >= 1496).AND.(kk <= 1503))icount=icount+1
   END DO
!
!   If icount > 0 and ilaw = 0, then stop
!
   IF((ilaw == 1).AND.(icount > 0))THEN
      WRITE(*,270)bell
      STOP
   END IF
   IF((ilaw == 11).AND.(icount > 0))THEN
      WRITE(*,270)bell
      STOP
   END IF
!
!   Check to see if user is fitting for fluxes when the flux
!   flag is zero
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
      IF((kk >= 4688).AND.(kk <= 4695))icount=icount+1
      IF((kk >= 4720).AND.(kk <= 4727))icount=icount+1
      IF((kk >= 4752).AND.(kk <= 4759))icount=icount+1
      IF((kk >= 2784).AND.(kk <= 2791))icount=icount+1
      IF((kk >= 4496).AND.(kk <= 4503))icount=icount+1
      IF((kk >= 4528).AND.(kk <= 4535))icount=icount+1
      IF((kk >= 4560).AND.(kk <= 4567))icount=icount+1
      IF((kk >= 4592).AND.(kk <= 4599))icount=icount+1
      IF((kk >= 4624).AND.(kk <= 4631))icount=icount+1
      IF((kk >= 4656).AND.(kk <= 4663))icount=icount+1
   END DO
!
!   if isw86=0, and icount>0, stop
!
   IF((isw86 == 0).AND.(icount > 0))THEN
      WRITE(*,280)bell
      STOP
   END IF
!
!   Check for fitting parameters not compatible with Nterms > 0
!
!   Check to see if the user is fitting for accretion disk
!   parameters when Nterms > 0
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag be, betarim
!
      IF(kk == 36)icount=icount+1
!
!   tag td, Tdisk
!
      IF(kk == 611)icount=icount+1
!
!   tag ro, router
!
      IF(kk == 558)icount=icount+1
!
!   tag ri, rinner
!
      IF(kk == 552)icount=icount+1
!
!   tag xi, xi
!
      IF(kk == 744)icount=icount+1
!
!   tags d1 to d8, disk spot parameters
!
      IF((kk >= 1112).AND.(kk <= 1119))icount=icount+1
   END DO
!
!   If icount > 0 and isw27 > 0 stop
!
   IF((isw27 > 0).AND.(icount > 0))THEN
      WRITE(*,290)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag lx, rLx, log of X-ray luminosity
!
      IF(kk == 375)icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,300)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag g1, Tgrav1
!
      IF(kk == 1208)icount=icount+1
!
!   tag g2, Tgrav2
!
      IF(kk == 1209)icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,310)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag f1, fill1
!
      IF(kk == 1176)icount=icount+1
!
!   tag f2, fill2
!
      IF(kk == 1177)icount=icount+1
!
!   tag sf, fillsum
!
      IF(kk == 581)icount=icount+1
!
!   tag sd, filldiff
!
      IF(kk == 579)icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,320)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tags b1 to b8, star 1 spot parms
!
      IF((kk >= 1048).AND.(kk <= 1055))icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,330)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tags c1 to c8, star 2 spot parms
!
      IF((kk >= 1080).AND.(kk <= 1087))icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,340)bell
      STOP
   END IF
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag l1, alb1
!
      IF(kk == 1368)icount=icount+1
!
!   tag l2, alb2
!
      IF(kk == 1369)icount=icount+1
   END DO
!
!   if isw27 > 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw27 > 0))THEN
      WRITE(*,350)bell
      STOP
   END IF
!
!   Check to see if the user is fitting for accretion disk
!   parameters when iidint=0
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag be, betarim
!
      IF(kk == 36)icount=icount+1
!
!   tag td, Tdisk
!
      IF(kk == 611)icount=icount+1
!
!   tag ro, router
!
      IF(kk == 558)icount=icount+1
!
!   tag r1, rinner
!
      IF(kk == 552)icount=icount+1
!
!   tag xi, xi
!
      IF(kk == 744)icount=icount+1
!
!   tags d1 to d8, disk spot parameters
!
      IF((kk >= 1112).AND.(kk <= 1119))icount=icount+1
   END DO
!
!   If icount > 0 and iidint=0 stop
!
   IF((iidint == 0).AND.(icount > 0))THEN
      WRITE(*,360)bell
      STOP
   END IF
!
!   Check to see if fitting for seasonal contamination
!   with Iseason=0
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tags s0 to s3, seasonal contamination
!
      IF((kk >= 1591).AND.(kk <= 1594))icount=icount+1
   END DO
!
!   if isw34 = 0 and icount > 0, then stop
!
   IF((icount > 0).AND.(isw34 == 0))THEN
      WRITE(*,370)bell
      STOP
   END IF
!
!   Check if fitting for Tconj when isw28=0
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tc, Tconj
!
      IF(kk == 610)icount=icount+1
   END DO
!
!   If isw28 = 0 and icount > 0 stop
!
   IF((icount > 0).AND.(isw28 == 0))THEN
      WRITE(*,380)bell
      STOP
   END IF
!
!   Check if fitting for T0 when isw28>0
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag t0, T0
!
      IF(kk == 1623)icount=icount+1
   END DO
!
!   If isw28 > 0 and icount > 0 stop
!
   IF((icount > 0).AND.(isw28 > 0))THEN
      WRITE(*,390)bell
      STOP
   END IF
!
!   If fitting for period or Tconj, can't have PbmTc or
!   PbpTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tc, Tconj
!
      IF(kk == 610)icount=icount+1
!
!   tag pe, period
!
      IF(kk == 484)icount=icount+1
   END DO
!
!   If icount > 0 and either of PbmTc or PbpTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(pbmtc) > EPSILON(pbmtc)))THEN
      WRITE(*,400)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(pbptc) > EPSILON(pbptc)))THEN
      WRITE(*,400)bell
      STOP
   END IF
!
!   If -1 < binqTc < 1, then you can't fit for Tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tc, Tconj
!
      IF(kk == 610)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < binqTc < 1
!   then stop.
!
   IF((icount > 0).AND.((binqtc >= 1.0_dp).AND.(binqtc <= 1.0_dp)) )THEN
      WRITE(*,410)bell
      STOP
   END IF
!
!   If fitting for tertperiod or tertconj, can't have
!   P1mTc or P1pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tt, tertperiod
!
      IF(kk == 627)icount=icount+1
!
!   tag tj, tertconj
!
      IF(kk == 617)icount=icount+1
   END DO
!
!   If icount > 0 and either of P1mTc or P1pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p1mtc) > EPSILON(p1mtc)))THEN
      WRITE(*,420)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p1ptc) > EPSILON(p1ptc)))THEN
      WRITE(*,420)bell
      STOP
   END IF
!
!   If -1 < P1qTc < 1, then you can't fit for Tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tj, tertconj
!
      IF(kk == 617)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P1qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p1qtc >= 1.0_dp).AND.(p1qtc <= 1.0_dp))) THEN
      WRITE(*,430)bell
      STOP
   END IF
!
!   If fitting for P2period or P2tconj, can't have
!   P2mTc or P2pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag ut, P2period
!
      IF(kk == 659)icount=icount+1
!
!   tag uj, P2tconj
!
      IF(kk == 649)icount=icount+1
   END DO
!
!   If icount > 0 and either of P2mTc or P2pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p2mtc) > EPSILON(p2mtc)))THEN
      WRITE(*,440)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p2ptc) > EPSILON(p2ptc)))THEN
      WRITE(*,440)bell
      STOP
   END IF
!
!   If -1 < P2qTc < 1, then you can't fit for P2tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag uj, P2conj
!
      IF(kk == 649)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P2qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p2qtc >= 1.0_dp).AND.(p2qtc <= 1.0_dp))) THEN
      WRITE(*,450)bell
      STOP
   END IF
!
!   If fitting for P3period or P3tconj, can't have
!   P3mTc or P3pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag vt, P3period
!
      IF(kk == 691)icount=icount+1
!
!   tag vj, P3tconj
!
      IF(kk == 681)icount=icount+1
   END DO
!
!   If icount > 0 and either of P3mTc or P3pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p3mtc) > EPSILON(p3mtc)))THEN
      WRITE(*,460)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p3ptc) > EPSILON(p3ptc)))THEN
      WRITE(*,460)bell
      STOP
   END IF
!
!   If -1 < P3qTc < 1, then you can't fit for P3tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag vj, P3tconj
!
      IF(kk == 681)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P3qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p3qtc >= 1.0_dp).AND.(p3qtc <= 1.0_dp))) THEN
      WRITE(*,470)bell
      STOP
   END IF
!
!   If fitting for P4period or P4tconj, can't have
!   P4mTc or P4pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag wt, P4period
!
      IF(kk == 723)icount=icount+1
!
!   tag wj, P4tconj
!
      IF(kk == 713)icount=icount+1
   END DO
!
!   If icount > 0 and either of P4mTc or P4pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p4mtc) > EPSILON(p4mtc)))THEN
      WRITE(*,480)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p4ptc) > EPSILON(p4ptc)))THEN
      WRITE(*,480)bell
      STOP
   END IF
!
!   If -1 < P4qTc < 1, then you can't fit for P4tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag wj, P4tconj
!
      IF(kk == 713)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P4qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p4qtc >= 1.0_dp).AND.(p4qtc <= 1.0_dp))) THEN
      WRITE(*,490)bell
      STOP
   END IF
!
!   If fitting for P5period or P5tconj, can't have
!   P5mTc or P5pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag xt, P5period
!
      IF(kk == 755)icount=icount+1
!
!   tag xj, P5tconj
!
      IF(kk == 745)icount=icount+1
   END DO
!
!   If icount > 0 and either of P5mTc or P5pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p5mtc) > EPSILON(p5mtc)))THEN
      WRITE(*,500)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p5ptc) > EPSILON(p5ptc)))THEN
      WRITE(*,500)bell
      STOP
   END IF
!
!   If -1 < P5qTc < 1, then you can't fit for P5tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag xj, P5tconj
!
      IF(kk == 745)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P5qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p5qtc >= 1.0_dp).AND.(p5qtc <= 1.0_dp))) THEN
      WRITE(*,510)bell
      STOP
   END IF
!
!   If fitting for P6period or P6tconj, can't have
!   P6mTc or P6pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag st, P6period
!
      IF(kk == 595)icount=icount+1
!
!   tag sj, P6tconj
!
      IF(kk == 585)icount=icount+1
   END DO
!
!   If icount > 0 and either of P6mTc or P6pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p6mtc) > EPSILON(p6mtc)))THEN
      WRITE(*,520)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p6ptc) > EPSILON(p6ptc)))THEN
      WRITE(*,520)bell
      STOP
   END IF
!
!   If -1 < P6qTc < 1, then you can't fit for P6tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag sj, P6tconj
!
      IF(kk == 585)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P6qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p6qtc >= 1.0_dp).AND.(p6qtc <= 1.0_dp))) THEN
      WRITE(*,530)bell
      STOP
   END IF
!
!   If fitting for P7period or P7tconj, can't have
!   P7mTc or P7pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag ht, P7period
!
      IF(kk == 243)icount=icount+1
!
!   tag hj, P7tconj
!
      IF(kk == 233)icount=icount+1
   END DO
!
!   If icount > 0 and either of P7mTc or P7pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p7mtc) > EPSILON(p7mtc)))THEN
      WRITE(*,540)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p7ptc) > EPSILON(p7ptc)))THEN
      WRITE(*,540)bell
      STOP
   END IF
!
!   If -1 < P7qTc < 1, then you can't fit for P7tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag hj, P7tconj
!
      IF(kk == 233)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P7qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p7qtc >= 1.0_dp).AND.(p7qtc <= 1.0_dp))) THEN
      WRITE(*,550)bell
      STOP
   END IF
!
!   If fitting for P8period or P8tconj, can't have
!   P8mTc or P8pTc not zero.
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag kt, P8period
!
      IF(kk == 339)icount=icount+1
!
!   tag kj, P8tconj
!
      IF(kk == 329)icount=icount+1
   END DO
!
!   If icount > 0 and either of P8mTc or P8pTc are
!   not zero, then stop.
!
   IF((icount > 0).AND.(ABS(p8mtc) > EPSILON(p8mtc)))THEN
      WRITE(*,560)bell
      STOP
   END IF
   IF((icount > 0).AND.(ABS(p8ptc) > EPSILON(p8ptc)))THEN
      WRITE(*,560)bell
      STOP
   END IF
!
!   If -1 < P8qTc < 1, then you can't fit for P8tconj
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag kj, P8tconj
!
      IF(kk == 329)icount=icount+1
   END DO
!
!   If icount > 0 and -1 < P8qTc < 1
!   then stop.
!
   IF((icount > 0).AND.((p8qtc >= 1.0_dp).AND.(p8qtc <= 1.0_dp))) THEN
      WRITE(*,570)bell
      STOP
   END IF
!
!   Check to see if fitting binary+binary parameters without
!   the binary+binary flag (isw80)
!
   IF(isw80 == 0)THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tags 90 to 99
!
         IF((kk >= 4783).AND.(kk <= 4792))THEN
            WRITE(*,580)bell,svar(i)(1:2)
            STOP
         END IF
      END DO
!
   END IF
!
!   If angsum1 or angdiff1 are not zero, cannot fit for
!   tertincl or tertOmega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag tx, tertincl
!
      IF(kk == 631)icount=icount+1
!
!   tag ty, tertOmega
!
      IF(kk == 631)icount=icount+1
   END DO
!
!   If angsum1 or angdiff1 are not zero and icount > 0, stop
!

   IF((ABS(angsum1) > EPSILON(angsum1)).AND.(icount > 0))THEN
      WRITE(*,590)bell
      STOP
   END IF
   IF((ABS(angdiff1) > EPSILON(angdiff1)).AND.(icount > 0))THEN
      WRITE(*,590)bell
      STOP
   END IF
!
!   If angsum2 or angdiff2 are not zero, cannot fit for
!   P2incl or P2Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag ux, P2incl
!
      IF(kk == 663)icount=icount+1
!
!   tag uy, P2Omega
!
      IF(kk == 664)icount=icount+1
   END DO
!
!   If angsum2 or angdeiff2 are not zero and icount > 0, stop
!

   IF((ABS(angsum2) > EPSILON(angsum2)).AND.(icount > 0))THEN
      WRITE(*,600)bell
      STOP
   END IF
   IF((ABS(angdiff2) > EPSILON(angdiff2)).AND.(icount > 0))THEN
      WRITE(*,600)bell
      STOP
   END IF
!
!   If angsum3 or angdiff3 are not zero, cannot fit for
!   P3incl or P3Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag vx, P3incl
!
      IF(kk == 695)icount=icount+1
!
!   tag vy, P3Omega
!
      IF(kk == 696)icount=icount+1
   END DO
!
!   If angsum3 or angdiff3 are not zero and icount > 0, stop
!

   IF((ABS(angsum3) > EPSILON(angsum3)).AND.(icount > 0))THEN
      WRITE(*,610)bell
      STOP
   END IF
   IF((ABS(angdiff3) > EPSILON(angdiff3)).AND.(icount > 0))THEN
      WRITE(*,610)bell
      STOP
   END IF
!
!   If angsum4 or angdiff4 are not zero, cannot fit for
!   P4incl or P4Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag wx, P4incl
!
      IF(kk == 727)icount=icount+1
!
!   tag wy, P4Omega
!
      IF(kk == 728)icount=icount+1
   END DO
!
!   If angsum4 or angdiff4 are not zero and icount > 0, stop
!

   IF((ABS(angsum4) > EPSILON(angsum4)).AND.(icount > 0))THEN
      WRITE(*,620)bell
      STOP
   END IF
   IF((ABS(angdiff4) > EPSILON(angdiff4)).AND.(icount > 0))THEN
      WRITE(*,620)bell
      STOP
   END IF
!
!   If angsum5 or angdiff5 are not zero, cannot fit for
!   P5incl or P5Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag xx, P5incl
!
      IF(kk == 759)icount=icount+1
!
!   tag xy, P5Omega
!
      IF(kk == 760)icount=icount+1
   END DO
!
!   If angsum5 or angdiff5 are not zero and icount > 0, stop
!

   IF((ABS(angsum5) > EPSILON(angsum5)).AND.(icount > 0))THEN
      WRITE(*,630)bell
      STOP
   END IF
   IF((ABS(angdiff5) > EPSILON(angdiff5)).AND.(icount > 0))THEN
      WRITE(*,630)bell
      STOP
   END IF
!
!   If angsum6 or angdiff6 are not zero, cannot fit for
!   P6incl or P6Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag sx, P6incl
!
      IF(kk == 799)icount=icount+1
!
!   tag sy, P6Omega
!
      IF(kk == 600)icount=icount+1
   END DO
!
!   If angsum6 or angdiff6 are not zero and icount > 0, stop
!

   IF((ABS(angsum6) > EPSILON(angsum6)).AND.(icount > 0))THEN
      WRITE(*,640)bell
      STOP
   END IF
   IF((ABS(angdiff6) > EPSILON(angdiff6)).AND.(icount > 0))THEN
      WRITE(*,640)bell
      STOP
   END IF
!
!   If angsum7 or angdiff7 are not zero, cannot fit for
!   P7incl or P7Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag hx, P7incl
!
      IF(kk == 247)icount=icount+1
!
!   tag hy, P7Omega
!
      IF(kk == 248)icount=icount+1
   END DO
!
!   If angsum7 or angdiff7 are not zero and icount > 0, stop
!

   IF((ABS(angsum7) > EPSILON(angsum7)).AND.(icount > 0))THEN
      WRITE(*,650)bell
      STOP
   END IF
   IF((ABS(angdiff7) > EPSILON(angdiff7)).AND.(icount > 0))THEN
      WRITE(*,650)bell
      STOP
   END IF
!
!   If angsum8 or angdiff8 are not zero, cannot fit for
!   P8incl or P8Omega
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag kx, P8incl
!
      IF(kk == 343)icount=icount+1
!
!   tag ky, P8Omega
!
      IF(kk == 344)icount=icount+1
   END DO
!
!   If angsum8 or angdiff8 are not zero and icount > 0, stop
!

   IF((ABS(angsum8) > EPSILON(angsum8)).AND.(icount > 0))THEN
      WRITE(*,660)bell
      STOP
   END IF
   IF((ABS(angdiff8) > EPSILON(angdiff8)).AND.(icount > 0))THEN
      WRITE(*,660)bell
      STOP
   END IF
!
!   If both primmass > 0 and secmass > 0, then the user
!   cannot fit for Q, masssum, massdiff, primK, separ
!
   IF((primmass > 0.0_dp).AND.(secmass > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag ms, masssum
!
         IF(kk == 402)THEN
            WRITE(*,670)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag md, massdiff
!
         IF(kk == 387)THEN
            WRITE(*,670)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ma, Q
!
         IF(kk == 384)THEN
            WRITE(*,670)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag pk, primK
!
         IF(kk == 490)THEN
            WRITE(*,670)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 10
   END IF
!
!   If masssum > 0 and Q=0,
!   then check for primmass, secmass, primK, Q
!
   IF((masssum > 0.0_dp).AND.(ABS(q) <= EPSILON(q)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pk, primK
!
         IF(kk == 490)THEN
            WRITE(*,680)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag pm, primmass
!
         IF(kk == 492)THEN
            WRITE(*,680)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sm, secmass
!
         IF(kk == 588)THEN
            WRITE(*,680)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ma, Q
!
         IF(kk == 384)THEN
            WRITE(*,680)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 10
   END IF
!
!   If masssum > 0 and Q>0,
!   then check for primmass, secmass, primK, massdiff
!
   IF((masssum > 0.0_dp).AND.(q > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pk, primK
!
         IF(kk == 490)THEN
            WRITE(*,690)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag pm, primmass
!
         IF(kk == 492)THEN
            WRITE(*,690)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sm, secmass
!
         IF(kk == 588)THEN
            WRITE(*,690)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag md, massdiff
!
         IF(kk == 387)THEN
            WRITE(*,690)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 10
   END IF
!
!   If primmass > 0 and Q>0, primK=0 and secmass=0
!   then check for masssum, secmass, primK, massdiff
!
   IF((primmass > 0.0_dp).AND.(q > 0.0_dp).AND.(ABS(primk) <= &
          EPSILON(primk)).AND.(ABS(secmass) <= EPSILON(secmass)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag ms, masssum
!
         IF(kk == 402)THEN
            WRITE(*,700)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag md, massdiff
!
         IF(kk == 387)THEN
            WRITE(*,700)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sm, secmass
!
         IF(kk == 588)THEN
            WRITE(*,700)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag pk, primK
!
         IF(kk == 490)THEN
            WRITE(*,700)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 10
   END IF
!
!   If secmass > 0 and Q>0, primK=0 and primmass=0
!   then check for masssum, secmass, primK, massdiff
!
   IF((secmass > 0.0_dp).AND.(q > 0.0_dp).AND.(ABS(primk) <= EPSILON(primk))  &
         .AND.(ABS(primmass) <= EPSILON(primmass)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag ms, masssum
!
         IF(kk == 402)THEN
            WRITE(*,710)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag md, massdiff
!
         IF(kk == 387)THEN
            WRITE(*,710)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag pk, primK
!
         IF(kk == 490)THEN
            WRITE(*,710)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 10
   END IF
!
10 CONTINUE
!
!   If primrad > 0 and secrad > 0, ignore radsum, raddiff,
!   ratrad, fracsum, fracdiff, frac1, frac2, fillsum, filldiff
!   fill1 fill2
!
   IF((primrad > 0.0_dp).AND.(secrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag rs, radsum
!
         IF(kk == 562)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag rd, raddiff
!
         IF(kk == 547)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ra, ratrad
!
         IF(kk == 547)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fs, fracsum
!
         IF(kk == 178)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fd, fracdiff
!
         IF(kk == 163)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,720)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If radsum > 0 and ratrad = 0, ignore primrad, secrad,
!   fracsum, fracdiff, frac1, frac2, fillsum, filldiff
!   fill1 fill2
!
   IF((radsum > 0.0_dp).AND.(ABS(ratrad) <= EPSILON(ratrad)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fs, fracsum
!
         IF(kk == 178)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fd, fracdiff
!
         IF(kk == 163)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,730)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If radsum > 0 and ratrad > 0, ignore primrad, secrad,
!   fracsum, fracdiff, frac1, frac2, fillsum, filldiff
!   fill1 fill2
!
   IF((radsum > 0.0_dp).AND.(ratrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fs, fracsum
!
         IF(kk == 178)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag fd, fracdiff
!
         IF(kk == 163)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,740)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If fracsum > 0 and ratrad = 0, ignore primrad, secrad,
!   frac1, frac2, fillsum, filldiff
!   fill1 fill2
!
   IF((fracsum > 0.0_dp).AND.(ABS(ratrad) <= EPSILON(ratrad)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,750)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If fracsum > 0 and ratrad > 0, ignore primrad, secrad,
!   frac1, frac2, fillsum, filldiff
!   fill1 fill2
!
   IF((fracsum > 0.0_dp).AND.(ratrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,760)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If frac1 > 0 and frac2 > 0, ignore primrad, secrad,
!   fillsum, filldiff, ratrad
!   fill1 fill2
!
   IF((frac1 > 0.0_dp).AND.(frac2 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ra, ratrad
!
         IF(kk == 544)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,770)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If frac1 > 0 and ratrad > 0 and frac2 = 0, ignore primrad,
!   secrad, fillsum, filldiff, ratrad
!   fill1 fill2
!
   IF((frac1 > 0.0_dp).AND.(frac2 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,780)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If frac1 > 0 and secrad > 0, ignore primrad,
!   fillsum, filldiff,
!   fill1 fill2
!
   IF((frac1 > 0.0_dp).AND.(secrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 479)THEN
            WRITE(*,790)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,790)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,790)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,790)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,790)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If primrad > 0 and frac2 > 0, ignore secrad,
!   fillsum, filldiff,
!   fill1 fill2
!
   IF((primrad > 0.0_dp).AND.(frac2 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,800)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,800)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,800)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,800)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,800)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If primrad > 0 and ratrad > 0, ignore secrad,
!   frac1, frac2, fillsum, filldiff,
!   fill1 fill2
!
   IF((primrad > 0.0_dp).AND.(ratrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,810)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If secrad > 0 and ratrad > 0, ignore primrad,
!   frac1, frac2, fillsum, filldiff,
!   fill1 fill2
!
   IF((secrad > 0.0_dp).AND.(ratrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 497)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sf, fillsum
!
         IF(kk == 581)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sd, filldiff
!
         IF(kk == 579)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
!   If fillsum > 0 and filldiff > 0, ignore primrad,
!   secrad, frac1, frac2,
!   fill1 fill2
!
   IF((fillsum > 0.0_dp).AND.(filldiff > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag pr, primrad
!
         IF(kk == 497)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag sr, secrad
!
         IF(kk == 593)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q1, frac1
!
         IF(kk == 1528)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag q2, frac2
!
         IF(kk == 1529)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f1, fill1
!
         IF(kk == 1176)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag f2, fill2
!
         IF(kk == 1177)THEN
            WRITE(*,820)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 20
   END IF
!
20 CONTINUE
!
!   Check various parameters related to the binary+binary
!   block
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag 91, bin2masssum
!
      IF(kk == 4784)icount=icount+1
!
!   tag 92, bin2massdiff
!
      IF(kk == 4785)icount=icount+1
!
!   tag 93, bin2Q
!
      IF(kk == 4786)icount=icount+1
!
   END DO
!
!   if icount=3, then stop
!
   IF(icount == 3)THEN
      WRITE(*,830)bell
   END IF
!
!  If bin2masssum > 0 and bin2Q = 0, check for
!  bin2M3, bin2M4, tertQ, P2Q
!
   IF((b2masssum > 0.0_dp).AND.(ABS(bin2q) <= EPSILON(bin2q)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,840)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,840)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 97, bin2M3
!
         IF(kk == 4790)THEN
            WRITE(*,840)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 98, bin2M4
!
         IF(kk == 4791)THEN
            WRITE(*,840)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2masssum > 0 and bin2Q > 0, check for
!  bin2M3, bin2M4, tertQ, P2Q
!
   IF((b2masssum > 0.0_dp).AND.(bin2q > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,850)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,850)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 97, bin2M3
!
         IF(kk == 4790)THEN
            WRITE(*,850)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 98, bin2M4
!
         IF(kk == 4791)THEN
            WRITE(*,850)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2M3 > 0 and bin2Q > 0 and bin2M4 = 0, check for
!  tertQ, P2Q
!
   IF((bin2m3 > 0.0_dp).AND.(bin2q > 0.0_dp).AND.(ABS(bin2m4) <= &
          EPSILON(bin2m4)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,860)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,860)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2M4 > 0 and bin2Q > 0 and bin2M3 = 0, check for
!  tertQ, P2Q
!
   IF((bin2m4 > 0.0_dp).AND.(bin2q > 0.0_dp).AND.(ABS(bin2m3) <= &
         EPSILON(bin2m3)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,870)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,870)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2M4 > 0 and bin2Q = 0 and bin2M3 > 0, check for
!  tertQ, P2Q
!
   IF((bin2m4 > 0.0_dp).AND.(ABS(bin2q) <= EPSILON(bin2q)).AND.(bin2m3 > &
           0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,880)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,880)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2M4 = 0 and bin2Q = 0 and bin2M3 > 0, check for
!  P2Q
!
   IF((ABS(bin2m4) <= EPSILON(bin2m4)).AND.(ABS(bin2q) <= EPSILON(bin2q)) &
          .AND.(bin2m3 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag uz, P2Q
!
         IF(kk == 665)THEN
            WRITE(*,890)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
!  If bin2M3 = 0 and bin2Q = 0 and bin2M4 > 0, check for
!  tertQ
!
   IF((bin2m4 > 0.0_dp).AND.(ABS(bin2q) <= EPSILON(bin2q)).AND.(ABS(bin2m3) &
          <= EPSILON(bin2m3)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tz, tertQ
!
         IF(kk == 633)THEN
            WRITE(*,900)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 30
   END IF
!
30 CONTINUE
!
!   Can't have bin2radsum, bin2raddiff, and bin2ratrad at the same time
!
   icount=0
   DO i=1,nvmax
      kk=icnvrt(svar(i)(1:2))
!
!   tag 94, bin2radsum
!
      IF(kk == 4787)icount=icount+1
!
!   tag 95, bin2raddiff
!
      IF(kk == 4788)icount=icount+1
!
!   tag 96, bin2ratrad
!
      IF(kk == 4789)icount=icount+1
!
   END DO
!
!   if icount=3, then stop
!
   IF(icount == 3)THEN
      WRITE(*,910)bell
   END IF
!
!  If bin2radsum > 0 and bin2ratrad = 0, check for
!  bin2R3, bin2R4, tertratrad, P2ratrad
!
   IF((b2radsum > 0.0_dp).AND.(ABS(bin2ratrad) <= EPSILON(bin2ratrad)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,920)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,920)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 99, bin2R3
!
         IF(kk == 4792)THEN
            WRITE(*,920)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 90, bin2R4
!
         IF(kk == 4783)THEN
            WRITE(*,920)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2radsum > 0 and bin2ratrad > 0, check for
!  bin2R3, bin2R4, tertratrad, P2ratrad
!
   IF((b2radsum > 0.0_dp).AND.(bin2ratrad > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,930)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,930)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 99, bin2R3
!
         IF(kk == 4792)THEN
            WRITE(*,930)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag 90, bin2R4
!
         IF(kk == 4783)THEN
            WRITE(*,930)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2R3 > 0 and bin2ratrad > 0 and bin2R4 = 0, check for
!  tertratrad, P2ratrad
!
   IF((bin2r3 > 0.0_dp).AND.(bin2ratrad > 0.0_dp).AND.(ABS(bin2r4) &
        <= EPSILON(bin2r4)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,940)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,860)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2R4 > 0 and bin2ratrad > 0 and bin2R3 = 0, check for
!  tertratrad, P2ratrad
!
   IF((bin2r4 > 0.0_dp).AND.(bin2ratrad > 0.0_dp).AND.(ABS(bin2r3) <= &
          EPSILON(bin2r3)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,950)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,950)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2R4 > 0 and bin2ratrad = 0 and bin2R3 > 0, check for
!  tertratrad, P2ratrad
!
   IF((bin2r4 > 0.0_dp).AND.(ABS(bin2ratrad) <= EPSILON(bin2ratrad)).AND. &
         (bin2r3 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,960)bell,svar(i)(1:2)
            STOP
         END IF
!
!   tag ub, P2ratrad
!
         IF(kk == 665)THEN
            WRITE(*,960)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2R4 = 0 and bin2ratrad = 0 and bin2R3 > 0, check for
!  P2ratrad
!
   IF((ABS(bin2r4) <= EPSILON(bin2r4)).AND.(ABS(bin2ratrad) <= EPSILON(bin2ratrad)) &
          .AND.(bin2r3 > 0.0_dp))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag ub, P2ratrad
!
         IF(kk == 641)THEN
            WRITE(*,970)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
!  If bin2R3 = 0 and bin2ratrad = 0 and bin2R4 > 0, check for
!  tertratrad
!
   IF((bin2r4 > 0.0_dp).AND.(ABS(bin2ratrad) <= EPSILON(bin2ratrad)).AND. &
        (ABS(bin2r3) <= EPSILON(bin2r3)))THEN
      DO i=1,nvmax
         kk=icnvrt(svar(i)(1:2))
!
!   tag tb, tertratrad
!
         IF(kk == 609)THEN
            WRITE(*,980)bell,svar(i)(1:2)
            STOP
         END IF
!
      END DO
      GO TO 40
   END IF
!
40 CONTINUE
!
50 FORMAT(a1,'Error: fitting body 3 parameter ',a2,' with ','Nbo'  &
      ,'dy < 3')
60 FORMAT(a1,'Error: fitting body 4 parameter ',a2,' with ','Nbo'  &
      ,'dy < 4')
70 FORMAT(a1,'Error: fitting body 5 parameter ',a2,' with ','Nbo'  &
      ,'dy < 5')
80 FORMAT(a1,'Error: fitting body 6 parameter ',a2,' with ','Nbo'  &
      ,'dy < 6')
90 FORMAT(a1,'Error: fitting body 7 parameter ',a2,' with ','Nbo'  &
      ,'dy < 7')
100 FORMAT(a1,'Error: fitting body 8 parameter ',a2,' with ','Nbo'  &
      ,'dy < 8')
110 FORMAT(a1,'Error: fitting body 9 parameter ',a2,' with ','Nbo'  &
      ,'dy < 9')
120 FORMAT(a1,'Error: fitting body 10 parameter ',a2,' with ','Nb'  &
      ,'ody < 10')
3130 FORMAT('Error: fitting for rk1 and rk2 with iGR = 4',a1)
4130 FORMAT('Error: fitting for tesscontam with wrong version',a1)
130 FORMAT('Error: fitting for T1 and T2 with temprat > 0',a1)
140 FORMAT('Error: fitting for T2 with temprat > 0',a1)
150 FORMAT('Error: fitting for ecc or argper when e*cos(omega)',  &
      ' and e*sin(omega) flag is > 0',a1)
160 FORMAT('Error: fitting for sqecos or sqesin when ',' flag is '  &
      ,'0',a1)
170 FORMAT('Error: fitting for ecos or esin when ',' flag is 0', a1)
180 FORMAT('Error: fitting for ecos or esin when ',' sqecos or sq'  &
      ,'esin are > 0',a1)
190 FORMAT('Error: fitting for tertecos or tertesin when ','sqte',  &
      'rtecos or sqtertesin are > 0',a1)
200 FORMAT('Error: fitting for P2ecos or P2esin when ','sqP2ecos',  &
      ' or sqP2esin are > 0',a1)
210 FORMAT('Error: fitting for P3ecos or P3esin when ','sqP3ecos',  &
      ' or sqP3esin are > 0',a1)
220 FORMAT('Error: fitting for P4ecos or P4esin when ','sqP4ecos',  &
      ' or sqP4esin are > 0',a1)
230 FORMAT('Error: fitting for P5ecos or P5esin when ','sqP5ecos',  &
      ' or sqP5esin are > 0',a1)
240 FORMAT('Error: fitting for P6ecos or P6esin when ','sqP6ecos',  &
      ' or sqP6esin are > 0',a1)
250 FORMAT('Error: fitting for P7ecos or P7esin when ','sqP7ecos',  &
      ' or sqP7esin are > 0',a1)
260 FORMAT('Error: fitting for P8ecos or P8esin when ','sqP8ecos',  &
      ' or sqP8esin are > 0',a1)
270 FORMAT('Error: fitting for y-coeffient for limb darkening ',  &
      'when using linear law',a1)
280 FORMAT('Error: fitting for fluxes but flux flag is 0',a1)
290 FORMAT('Error: fitting for accretion disk parameters with ',  &
      'Nterms > 0',a1)
300 FORMAT('Error: fitting for rLx with Nterms > 0',a1)
310 FORMAT('Error: fitting for gravity darkening coefficients ',  &
      'with Nterms > 0',a1)
320 FORMAT('Error: fitting for filling factors with Nterms > 0', a1)
330 FORMAT('Error: fitting for spot parameters on star 1 with ',  &
      'Nterms > 0',a1)
340 FORMAT('Error: fitting for spot parameters on star 2 with ',  &
      'Nterms > 0',a1)
350 FORMAT('Error: fitting for albedos with Nterms > 0',a1)
360 FORMAT('Error: fitting for accretion disk parameters with ',  &
      'idint=0',a1)
370 FORMAT('Error: fitting for seasonal contamination with',' Ise'  &
      ,'ason = 0',a1)
380 FORMAT('Error: fitting for Tconj when Tconj flag = 0',a1)
390 FORMAT('Error: fitting for T0 when Tconj flag > 0',a1)
400 FORMAT('Error: fitting for Tconj or period when PbmTc ','or P'  &
      ,'bpTc are not zero',a1)
410 FORMAT('Error: you can''T FIT FOR TCONJ WHEN -1 < BINQTC ','<'  &
      ,' 1',a1)
420 FORMAT('Error: fitting for tertconj or tertperiod when ','P1m'  &
      ,'Tc or P1pTc are not zero',a1)
430 FORMAT('Error: you can''T FIT FOR TERTCONJ WHEN -1 < P1QTC ',  &
      '< 1',a1)
440 FORMAT('Error: fitting for P2conj or P2period when ','P2mTc o'  &
      ,'r P2pTc are not zero',a1)
450 FORMAT('Error: you can''T FIT FOR P2CONJ WHEN -1 < P2QTC ','<'  &
      ,' 1',a1)
460 FORMAT('Error: fitting for P3conj or P3period when ','P3mTc o'  &
      ,'r P3pTc are not zero',a1)
470 FORMAT('Error: you can''T FIT FOR P3CONJ WHEN -1 < P3QTC ','<'  &
      ,' 1',a1)
480 FORMAT('Error: fitting for P4conj or P4period when ','P4mTc o'  &
      ,'r P4pTc are not zero',a1)
490 FORMAT('Error: you can''T FIT FOR P4CONJ WHEN -1 < P4QTC ','<'  &
      ,' 1',a1)
500 FORMAT('Error: fitting for P5conj or P5period when ','P5mTc o'  &
      ,'r P5pTc are not zero',a1)
510 FORMAT('Error: you can''T FIT FOR P5CONJ WHEN -1 < P5QTC ','<'  &
      ,' 1',a1)
520 FORMAT('Error: fitting for P6conj or P6period when ','P6mTc o'  &
      ,'r P6pTc are not zero',a1)
530 FORMAT('Error: you can''T FIT FOR P6CONJ WHEN -1 < P6QTC ','<'  &
      ,' 1',a1)
540 FORMAT('Error: fitting for P7conj or P7period when ','P7mTc o'  &
      ,'r P7pTc are not zero',a1)
550 FORMAT('Error: you can''T FIT FOR P7CONJ WHEN -1 < P7QTC ','<'  &
      ,' 1',a1)
560 FORMAT('Error: fitting for P8conj or P8period when ','P8mTc o'  &
      ,'r P8pTc are not zero',a1)
570 FORMAT('Error: you can''T FIT FOR P8CONJ WHEN -1 < P8QTC ','<'  &
      ,' 1',a1)
580 FORMAT(a1,'Error: fitting for binary+binary parameter ',a2,  &
      ' when binary+binary flag is 0')
590 FORMAT('Error: cannot fit for tertincl or tertOmega ','when a'  &
      ,'ngsum1 or angdiff1 are not zero',a1)
600 FORMAT('Error: cannot fit for P2incl or P2Omega ','when angsu'  &
      ,'m2 or angdiff2 are not zero',a1)
610 FORMAT('Error: cannot fit for P3incl or P3Omega ','when angsu'  &
      ,'m3 or angdiff3 are not zero',a1)
620 FORMAT('Error: cannot fit for P4incl or P4Omega ','when angsu'  &
      ,'m4 or angdiff4 are not zero',a1)
630 FORMAT('Error: cannot fit for P5incl or P5Omega ','when angsu'  &
      ,'m5 or angdiff5 are not zero',a1)
640 FORMAT('Error: cannot fit for P6incl or P6Omega ','when angsu'  &
      ,'m6 or angdiff6 are not zero',a1)
650 FORMAT('Error: cannot fit for P7incl or P7Omega ','when angsu'  &
      ,'m7 or angdiff7 are not zero',a1)
660 FORMAT('Error: cannot fit for P8incl or P8Omega ','when angsu'  &
      ,'m8 or angdiff8 are not zero',a1)
670 FORMAT(a1,'Error: tag ',a2,' ignored when primmass > 0 ','and'  &
      ,' secmass > 0')
680 FORMAT(a1,'Error: tag ',a2,' ignored when masssum > 0 ','and '  &
      ,'Q = 0')
690 FORMAT(a1,'Error: tag ',a2,' ignored when masssum > 0 ','and '  &
      ,'Q > 0')
700 FORMAT(a1,'Error: tag ',a2,' ignored when primmass > 0 ','and'  &
      ,' Q > 0 and primK = 0 and secmass = 0')
710 FORMAT(a1,'Error: tag ',a2,' ignored when secmass > 0 ','and',  &
      ' Q > 0 and primK = 0 and primmass = 0')
720 FORMAT(a1,'Error: tag ',a2,' ignored when primrad > 0 ','and '  &
      ,'secrad > 0')
730 FORMAT(a1,'Error: tag ',a2,' ignored when radsum > 0 ','and r'  &
      ,'atrad = 0')
740 FORMAT(a1,'Error: tag ',a2,' ignored when radsum > 0 ','and r'  &
      ,'atrad > 0')
750 FORMAT(a1,'Error: tag ',a2,' ignored when fracsum > 0 ','and '  &
      ,'ratrad = 0')
760 FORMAT(a1,'Error: tag ',a2,' ignored when fracsum > 0 ','and '  &
      ,'ratrad > 0')
770 FORMAT(a1,'Error: tag ',a2,' ignored when frac1 > 0 ','and fr'  &
      ,'ac2 > 0')
780 FORMAT(a1,'Error: tag ',a2,' ignored when frac1 > 0 ','and ra'  &
      ,'trad > 0 and frac2 = 0')
790 FORMAT(a1,'Error: tag ',a2,' ignored when frac1 > 0 ','and se'  &
      ,'crad > 0')
800 FORMAT(a1,'Error: tag ',a2,' ignored when primrad > 0 ','and '  &
      ,'frac2 > 0')
810 FORMAT(a1,'Error: tag ',a2,' ignored when primrad > 0 ','and '  &
      ,'ratrad > 0')
820 FORMAT(a1,'Error: tag ',a2,' ignored when secrad > 0 ','and r'  &
      ,'atrad > 0')
830 FORMAT(a1,'Error:  cannot fit bin2masssum, bin2massdiff ','an'  &
      ,'d bin2Q at the same time')
840 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2masssum > 0',  &
      ' and bin2Q = 0')
850 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2masssum > 0',  &
      ' and bin2Q > 0')
860 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2M3 > 0',' and '  &
      ,'bin2Q > 0 and bin2M4 = 0')
870 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2M4 > 0',' and '  &
      ,'bin2Q > 0 and bin2M3 = 0')
880 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2M4 > 0',' and '  &
      ,'bin2Q = 0 and bin2M3 > 0')
890 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2M3 > 0',' and '  &
      ,'bin2Q = 0 and bin2M4 = 0')
900 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2M4 > 0',' and '  &
      ,'bin2Q = 0 and bin2M3 = 0')
910 FORMAT(a1,'Error:  cannot fit bin2radsum, bin2raddiff ','and '  &
      ,'bin2ratrad at the same time')
920 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2radsum > 0',  &
      ' and bin2ratrad = 0')
930 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2radsum > 0',  &
      ' and bin2ratrad > 0')
940 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2R3 > 0',' and '  &
      ,'bin2ratrad > 0 and bin2R4 = 0')
950 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2R4 > 0',' and '  &
      ,'bin2ratrad > 0 and bin2R3 = 0')
960 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2R4 > 0',' and '  &
      ,'bin2ratrad = 0 and bin2R3 > 0')
970 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2R3 > 0',' and '  &
      ,'bin2ratrad = 0 and bin2R4 = 0')
980 FORMAT(a1,'Error:  tag ',a2,' ignored when bin2R4 > 0',' and '  &
      ,'bin2ratrad = 0 and bin2R3 = 0')
!
   RETURN
!
END SUBROUTINE checkgridloop
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checklcfit(islc,nmodel,xmodel,yinput,ndata,xdata,  &
   ydata,errbar,chisq,zero,ifixgamma,itime,res)
!
!   November 12, 1999
!
!   This routine will convert the linear model to magnitudes and adjust
!   the zeropoint to give the best chi^2.  The best chi^2 value is
!   returned, as well as the zeropoint.  Set islc=1 for light curves
!   (linear models are converted to magnitudes) and islc=0 for RV curves.
!
!   January 24, 2001
!
!   Added the parameter ifixgamma.  If this is 1 or more and we are
!   fitting a velocity curve then the zero point is forced to be the input
!   gamma.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: islc
   INTEGER, INTENT(IN)                      :: nmodel
   REAL(KIND=dp), INTENT(IN)                :: xmodel(nmodel)
   REAL(KIND=dp), INTENT(IN)                :: yinput(nmodel)
   INTEGER, INTENT(IN)                      :: ndata
   REAL(KIND=dp), INTENT(IN)                :: xdata(ndata)
   REAL(KIND=dp), INTENT(IN)                :: ydata(ndata)
   REAL(KIND=dp), INTENT(IN)                :: errbar(ndata)
   REAL(KIND=dp), INTENT(OUT)               :: chisq
   REAL(KIND=dp), INTENT(IN OUT)            :: zero
   INTEGER, INTENT(IN)                      :: ifixgamma
   INTEGER, INTENT(IN)                      :: itime
   REAL(KIND=dp), INTENT(OUT)               :: res(ndata)
!
   REAL(KIND=dp)  :: ymin,ymax,qqq,savezero
   REAL(KIND=dp)  :: rmodelave,dataave,step,chi1,chi2,chi3,small,zerosmall
   REAL(KIND=dp)  :: zero1,zero2,zero3,fn,diff,csave,zsave,diff23,chi4
!
   REAL(KIND=dp), DIMENSION(nmodel*3) :: ymodel,xpad,ypad
   REAL(KIND=dp), DIMENSION(ndata)    :: yinter,ydummy
!
   INTEGER :: jj,i,mmodel,ii
   INTEGER :: itempgamma
!
!   COMMON /medblock/ rmed
!
!   Deal with the ifixgamma flag in case it is more than 10
!
   itempgamma=ifixgamma
   IF(ifixgamma >= 10)itempgamma=ifixgamma-10
!
!   First, convert to magnitudes.
!
   IF(itime <= 1)THEN
      CALL addpad(nmodel,xmodel,yinput,xpad,ypad)
      mmodel=nmodel*3
   ELSE
      DO jj=1,nmodel
         xpad(jj)=xmodel(jj)
         ypad(jj)=yinput(jj)
      END DO
      mmodel=nmodel
   END IF
!
   DO  i=1,mmodel
      IF(islc > 0)THEN
!
!  Check to see that the argument of log10 is positive.
!
         IF(ypad(i) > 0.0_dp)THEN
            ymodel(i)=-2.5_dp*LOG10(ypad(i))
         ELSE
            ymodel(i)=-99.9_dp
         END IF
      ELSE
         ymodel(i)=ypad(i)
      END IF
   END DO
!
!   Find the maximum and minimum y-values of the data
!
   ymin=1000.0_dp
   ymax=-1000.0_dp
   DO  i=1,ndata
      IF(ydata(i) < ymin)ymin=ydata(i)
      IF(ydata(i) > ymax)ymax=ydata(i)
   END DO
!
!   Interpolate the model so that we have y-values at all observed phases.
!
   ii=mmodel/2
   DO  i=1,ndata
      CALL hermint(mmodel,xpad,ymodel,xdata(i),qqq,ii)
      yinter(i)=qqq
   END DO
!
!   Now find the optimal zero point that will give the lowest chi^2.
!
   CALL getmean(ndata,ydata,dataave)
   CALL getmean(ndata,yinter,rmodelave)
   savezero=zero
   zero=(dataave-rmodelave)
   step=ABS(rmodelave-(dataave))/1000.0_dp
!
   chi1=0.0_dp
   chi2=0.0_dp
   chi3=0.0_dp
   small=1.0E+35_dp
   zerosmall=1.0E+30_dp
!
   DO  i=1,40
      zero1=zero
      CALL offset(ndata,yinter,ydummy,zero1)
      CALL getchi(ndata,ydata,errbar,ydummy,chi1)
      IF(chi1 < small)THEN
         small=chi1
         zerosmall=zero1
      END IF
      fn=0.0_dp
      zero2=zero+step
      CALL offset(ndata,yinter,ydummy,zero2)
      CALL getchi(ndata,ydata,errbar,ydummy,chi2)
      IF(chi2 < small)THEN
         small=chi2
         zerosmall=zero2
      END IF
      diff=chi1-chi2
      IF(diff > 0.0_dp)GO TO 40
      step=-step
!
      csave=chi1
      chi1=chi2
      chi2=csave
      zsave=zero1
      zero1=zero2
      zero2=zsave
!
40    fn=fn+1.0_dp
!
      zero3=zero2+step
      CALL offset(ndata,yinter,ydummy,zero3)
      CALL getchi(ndata,ydata,errbar,ydummy,chi3)
      IF(chi3 < small)THEN
         small=chi3
         zerosmall=zero3
      END IF
      diff23=chi3-chi2
      IF(diff23 < 0.0_dp)THEN
         chi1=chi2
         chi2=chi3
         zero1=zero2
         zero2=zero3
         zero=zero3
         GO TO 40
      END IF
!
!         find the minimum of parabola defined by the last three points
!
      IF(ABS(chi3-chi2) <= EPSILON(chi3))EXIT
      step=step*(1.0_dp/(1.0_dp+(chi1-chi2)/(chi3-chi2))+0.5_dp)
      zero=zero2-step
      step=step*fn/3.0_dp
      CALL offset(ndata,yinter,ydummy,zero)
      CALL getchi(ndata,ydata,errbar,ydummy,chi4)
      IF(chi4 < small)THEN
         small=chi4
         zerosmall=zero
      END IF
!
   END DO
!
   zero=zerosmall
!
   IF((islc <= 0).AND.(itempgamma == 0))zero=savezero
   CALL offset(ndata,yinter,ydummy,zero)
   CALL getchi(ndata,ydata,errbar,ydummy,chi3)
!
   chisq=chi3
!
!   UPDATE October 31, 2011
!
!   compute the residuals
!
   DO ii=1,ndata
      res(ii)=ydata(ii)-ydummy(ii)
   END DO
!
   RETURN
!
END SUBROUTINE checklcfit
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checklog(it1)
!
!   Will read the ELC.inp file and will return
!   the value of it1, which determines how the
!   planet mass ratios are used.
!
   USE accur

   IMPLICIT NONE
!
   INTEGER, INTENT(OUT)                  :: it1
!
   REAL(KIND=dp)   :: fill1,fill2,omega1,omega2,dphase,q,finc,teff1,teff2
   REAL(KIND=dp)   :: tgrav1,tgrav2,betarim,rinner,router,tdisk,xi,alb1,alb2
   REAL(KIND=dp)   :: rlx,period,fm,separ,gamma,t3,g3,sa3,density,sw1,sw2
   REAL(KIND=dp)   :: sw3,t0,wave,dbolx,dboly,dwavex,dwavey,ecc,argper
   REAL(KIND=dp)   :: pshift,sw5,sw6,sw7,sw8,sw9,spot1parm,spot2parm,omega9
   REAL(KIND=dp)   :: spotdparm,primmass,primk,primrad,ratrad,frac1,frac2
   REAL(KIND=dp)   :: ecosw,temprat,bigi,bigbeta,sw23,sw24,powercoeff,sw25
   REAL(KIND=dp)   :: sw26,sw27,sw28,sw29,sw30,contam,tconj,beam1,beam2
   REAL(KIND=dp)   :: ocose,osine,omegadot,contams0,contams1,contams2
   REAL(KIND=dp)   :: contams3,sw47,sw48,sw49,sw80,sw81,sw82,sw83,sw84,sw85
   REAL(KIND=dp)   :: sw86,sw87,sw88,sw89,sdarkint1,sdarkint2,sdarkint3
   REAL(KIND=dp)   :: sdarkint4,sdarkint5,tertperiod,tertt0,tertecos,omega8
   REAL(KIND=dp)   :: tertesin,tertincl,tertomega,tertq,tertconj,tertratrad
   REAL(KIND=dp)   :: hh,sw72,sw73,p2tconj,p2period,p2t0,p2ecos,p2esin
   REAL(KIND=dp)   :: p2incl,p2omega,p2q,p2ratrad,p3tconj,p3period,p3t0
   REAL(KIND=dp)   :: p3ecos,p3esin,p3incl,p3omega,p3q,p3ratrad,p4tconj
   REAL(KIND=dp)   :: p4period,p4t0,p4ecos,p4esin,p4incl,p4omega,p4q,omega7
   REAL(KIND=dp)   :: p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,p5incl
   REAL(KIND=dp)   :: p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos
   REAL(KIND=dp)   :: p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period
   REAL(KIND=dp)   :: p7t0,p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj
   REAL(KIND=dp)   :: p8period,p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad
   REAL(KIND=dp)   :: secmass,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,t6,g6,omega5
   REAL(KIND=dp)   :: sdarkint6,g7,t7,sdarkint7,t8,g8,sdarkint8,omega3
   REAL(KIND=dp)   :: sdarkint9,sdarkint10,t9,g9,t10,g10,secrad,omega4
   REAL(KIND=dp)   :: radsum,raddiff,masssum,massdiff,p1ptc,p1mtc,p2ptc
   REAL(KIND=dp)   :: p2mtc,p5ptc,p5mtc,p6ptc,p6mtc,p7ptc,p7mtc,p8ptc,p8mtc
   REAL(KIND=dp)   :: p3ptc,p3mtc,pbptc,pbmtc,p4ptc,p4mtc,bigi4,bigbeta4
   REAL(KIND=dp)   :: bin2masssum,bin2massdiff,bin2q,bin2radsum,bin2raddiff
   REAL(KIND=dp)   :: bin2ratrad,bigi2,bigbeta2,bigi3,bigbeta3,omega6
   REAL(KIND=dp)   :: omega10,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4
   REAL(KIND=dp)   :: sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin
   REAL(KIND=dp)   :: sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin
   REAL(KIND=dp)   :: sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin
   REAL(KIND=dp)   :: angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3
   REAL(KIND=dp)   :: angsum4,angdiff4,angsum5,angdiff5,angsum6,angdiff6
   REAL(KIND=dp)   :: angsum7,angdiff7,angsum8,angdiff8,fillsum,filldiff
   REAL(KIND=dp)   :: binqtc,p1qtc,p2qtc,p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc
   REAL(KIND=dp)   :: tbinoff,t1off,t2off,t3off,t4off,t5off,t6off,t7off,t8off
   REAL(KIND=dp)   :: tesscontam,tessbin
!
   INTEGER :: nalph1,nbet1,nalph2,nbet2,ntheta,nradius,nref,idraw
   INTEGER :: iecheck,iidint,iatm,ism1,icnu,icnb,icnv,icnr,icni
   INTEGER :: icnj,icnh,icnk,irvfilt,isw1,isw2,isw3,isw4,ilaw
   INTEGER :: ikeep,isynch,isw5,isw6,isw7,isw8,isw9,idark1,idark2
   INTEGER :: isw12,isw13,isw21,isw22,isw23,isw24,isw25,isw26,isw27
   INTEGER :: isw28,isw29,isw30,isw31,isw32,isw33,isw34,isw80,isw81
   INTEGER :: isw82,isw83,isw84,isw85,isw86,isw87,isw88,isw89
   INTEGER :: nalph3,nbet3,itconj, it2,it3,it4,isw100,nseg
   INTEGER :: iunit,kkkk,imag,iversion,tessfilt
!
   DIMENSION wave(8),dbolx(8,2),dboly(8,2),dwavex(8,10)
   DIMENSION spot1parm(2,4),spot2parm(2,4),spotdparm(2,4)
   DIMENSION powercoeff(8,9),dwavey(8,10),sdarkint7(8)
   DIMENSION sdarkint1(8),sdarkint2(8),sdarkint3(8)
   DIMENSION sdarkint4(8),sdarkint5(8),sdarkint6(8)
   DIMENSION sdarkint8(8),sdarkint9(8),sdarkint10(8)
!
   kkkk=0
   isw24=0
!
   CALL newgetinput(kkkk,nalph1,nalph2,nalph3,nbet1,nbet2,nbet3,  &
      nradius,nref,nseg,ntheta,irvfilt,iatm,icnb,icnh,icni,icnj,  &
      icnk,icnr,icnu,icnv,idark1,idark2,idraw,iecheck,iidint,ikeep,  &
      ilaw,ism1,isw1,isw12,isw13,isw2,isw21,isw22,isw23,isw24,  &
      isw25,isw26,isw27,isw28,isw29,isw3,isw30,isw31,isw32,isw33,  &
      isw34,isw4,isw5,isw6,isw7,isw8,isw80,isw81,isw82,isw83,isw84,  &
      isw85,isw86,isw87,isw88,isw89,isw9,isw100,isynch,it1,it2,it3,  &
      it4,itconj,p1mtc,p1ptc,p2omega,p2q,p2t0,p2ecos,p2esin,p2incl,  &
      p2mtc,p2ptc,p2period,p2ratrad,p2tconj,p3omega,p3q,p3t0,  &
      p3ecos,p3esin,p3incl,p3mtc,p3ptc,p3period,p3ratrad,p3tconj,  &
      p4omega,p4q,p4t0,p4ecos,p4esin,p4incl,p4mtc,p4ptc,p4period,  &
      p4ratrad,p4tconj,p5omega,p5q,p5t0,p5ecos,p5esin,p5incl,p5mtc,  &
      p5ptc,p5period,p5ratrad,p5tconj,p6omega,p6q,p6t0,p6ecos,  &
      p6esin,p6incl,p6mtc,p6ptc,p6period,p6ratrad,p6tconj,p7omega,  &
      p7q,p7t0,p7ecos,p7esin,p7incl,p7mtc,p7ptc,p7period,p7ratrad,  &
      p7tconj,p8omega,p8q,p8t0,p8ecos,p8esin,p8incl,p8mtc,p8ptc,  &
      p8period,p8ratrad,p8tconj,pbmtc,pbptc,period,q,sa3,t0,tconj,  &
      teff1,teff2,tgrav1,tgrav2,alb1,alb2,argper,beam1,beam2,  &
      betarim,bigi,bigi2,bigi3,bigi4,bigbeta,bigbeta2,bigbeta3,  &
      bigbeta4,bin2q,bin2massdiff,bin2masssum,bin2raddiff,  &
      bin2radsum,bin2ratrad,contam,contams0,contams1,contams2,  &
      contams3,dbolx,dboly,density,dphase,dwavex,dwavey,ecc,ecosw,  &
      fill1,fill2,finc,fm,frac1,frac2,g10,g3,g6,g7,g8,g9,gamma,hh,  &
      massdiff,masssum,ocose,omega1,omega2,omega3,omega4,omega5,  &
      omega6,omega7,omega8,omega9,omega10,omegadot,osine,  &
      powercoeff,primk,primmass,primrad,pshift,rlx,raddiff,radsum,  &
      ratrad,rinner,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,router,  &
      sdarkint1,sdarkint2,sdarkint3,sdarkint4,sdarkint5,sdarkint6,  &
      sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,  &
      separ,spot1parm,spot2parm,spotdparm,sw1,sw2,sw23,sw24,sw25,  &
      sw26,sw27,sw28,sw29,sw3,sw30,sw47,sw48,sw49,sw5,sw6,sw7,sw72,  &
      sw73,sw8,sw80,sw81,sw82,sw83,sw84,sw85,sw86,sw87,sw88,sw89,  &
      sw9,t10,t3,t6,t7,t8,t9,tdisk,temprat,tertomega,tertq,  &
      tertconj,tertecos,tertesin,tertincl,tertperiod,tertratrad,  &
      tertt0,wave,xi,iunit,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,  &
      bin2r4,sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
      sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
      sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
      angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
      angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
      angsum8,angdiff8,imag,fillsum,filldiff,binqtc,p1qtc,p2qtc,  &
      p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,  &
      t3off,t4off,t5off,t6off,t7off,t8off,iversion,tesscontam,  &
      tessfilt,tessbin)
!
   RETURN
!
END SUBROUTINE checklog
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checkrvfit(nmodel1,xmodel1,ymodel1,nmodel2,  &
   xmodel2,ymodel2,ndata1,xdata1,ydata1,err1,ndata2,xdata2,  &
   ydata2,err2,chisq1,chisq2,zero,resrv1,resrv2,ndatamax)
!
!   April 11, 2001
!
!   This routine will fit two velocity curves simultaneously, using
!   a common gamma as a free parameter.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmodel1
   REAL(KIND=dp), INTENT(IN)                :: xmodel1(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel1(nmodel1)
   INTEGER, INTENT(IN)                      :: nmodel2
   REAL(KIND=dp), INTENT(IN)                :: xmodel2(nmodel2)
   REAL(KIND=dp), INTENT(IN)                :: ymodel2(nmodel2)
   INTEGER, INTENT(IN)                      :: ndata1
   REAL(KIND=dp), INTENT(IN)                :: xdata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: ydata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: err1(ndata1)
   INTEGER, INTENT(IN)                      :: ndata2
   REAL(KIND=dp), INTENT(IN)                :: xdata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: ydata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: err2(ndata2)
   REAL(KIND=dp), INTENT(OUT)               :: chisq1
   REAL(KIND=dp), INTENT(OUT)               :: chisq2
   REAL(KIND=dp), INTENT(OUT)               :: zero
   REAL(KIND=dp), INTENT(OUT)               :: resrv1(ndata1)
   REAL(KIND=dp), INTENT(OUT)               :: resrv2(ndata2)
   INTEGER, INTENT(IN)                      :: ndatamax
!
   REAL(KIND=dp)  :: ymin1,ymax1,ymin2,ymax2,dataave1,dataave2,rmodelave1
   REAL(KIND=dp)  :: rmodelave2,step,small,zerosmall,chi1,chi2,qqq
   REAL(KIND=dp)  :: chi3,fn,zero1,zero2,diff,csave,chi41,diff23,chi32
   REAL(KIND=dp)  :: chi42,chi12,chi11,chi21,chi22,chi31,chi4,zsave,zero3
!
   REAL(KIND=dp), DIMENSION(ndatamax) :: yinter1,yinter2,ydummy1,ydummy2

   INTEGER :: i, ii
!
!   COMMON /medblock/ rmed
!
!   Find the maximum and minimum y-values of the data
!
   ymin1=1.0E+20_dp
   ymax1=-1.0E+20_dp
   DO  i=1,ndata1
      IF(ydata1(i) < ymin1)ymin1=ydata1(i)
      IF(ydata1(i) > ymax1)ymax1=ydata1(i)
   END DO
!
   ymin2=10000.0_dp
   ymax2=-10000.0_dp
   DO  i=1,ndata2
      IF(ydata2(i) < ymin2)ymin2=ydata2(i)
      IF(ydata2(i) > ymax2)ymax2=ydata2(i)
   END DO
!
!   Interpolate the model so that we have y-values at all observed phases.
!
   ii=nmodel1/2
   DO  i=1,ndata1
      CALL hermint(nmodel1,xmodel1,ymodel1,xdata1(i),qqq,ii)
      yinter1(i)=qqq
   END DO
!
   DO  i=1,ndata2
      CALL hermint(nmodel2,xmodel2,ymodel2,xdata2(i),qqq,ii)
      yinter2(i)=qqq
   END DO
!
!   Now find the optimal zero point that will give the lowest chi^2.
!
   CALL getmean(ndata1,ydata1,dataave1)
   CALL getmean(ndata1,yinter1,rmodelave1)
   CALL getmean(ndata2,ydata2,dataave2)
   CALL getmean(ndata2,yinter2,rmodelave2)

   zero=(dataave1-rmodelave1)
   step=ABS(rmodelave1-dataave1)/1000.0_dp
   IF(step < 0.10_dp)step=0.05_dp

   chi1=0.0_dp
   chi2=0.0_dp
   chi3=0.0_dp
   chisq1=0.0_dp
   chisq2=0.0_dp
   small=1.0E+35_dp
   zerosmall=1.0E+20_dp
!
   DO  i=1,20
      zero1=zero
      CALL offset(ndata1,yinter1,ydummy1,zero1)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi11)
      CALL offset(ndata2,yinter2,ydummy2,zero1)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi12)
      chi1=chi11+chi12
      IF(chi1 < small)THEN
         small=chi1
         zerosmall=zero1
      END IF
      fn=0.0_dp
      zero2=zero+step
      CALL offset(ndata1,yinter1,ydummy1,zero2)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi21)
      CALL offset(ndata2,yinter2,ydummy2,zero2)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi22)
      chi2=chi21+chi22
      IF(chi2 < small)THEN
         small=chi2
         zerosmall=zero2
      END IF
      diff=chi1-chi2
      IF(diff > 0.0_dp)GO TO 50
      step=-step
!
      csave=chi1
      chi1=chi2
      chi2=csave
      zsave=zero1
      zero1=zero2
      zero2=zsave
!
50    fn=fn+1.0_dp
!
      zero3=zero2+step
      CALL offset(ndata1,yinter1,ydummy1,zero3)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi31)
      CALL offset(ndata2,yinter2,ydummy2,zero3)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi32)
      chi3=chi31+chi32
      IF(chi3 < small)THEN
         small=chi3
         zerosmall=zero3
      END IF
      diff23=chi3-chi2
      IF(diff23 < 0.0_dp)THEN
         chi1=chi2
         chi2=chi3
         zero1=zero2
         zero2=zero3
         zero=zero3
         GO TO 50
      END IF
!
!         find the minimum of parabola defined by the last three points
!
      IF(ABS(chi3-chi2) <= EPSILON(chi3))EXIT
      step=step*(1.0_dp/(1.0_dp+(chi1-chi2)/(chi3-chi2))+0.5_dp)
      zero=zero2-step
      step=step*fn/3.0_dp
      CALL offset(ndata1,yinter1,ydummy1,zero)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi41)
      CALL offset(ndata2,yinter2,ydummy2,zero)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi42)
      chi4=chi41+chi42
      IF(chi4 < small)THEN
         small=chi4
         zerosmall=zero
      END IF
!
   END DO
!
!  come here when delta chi is small
!
   zero=zerosmall
!
   CALL offset(ndata1,yinter1,ydummy1,zero)
   CALL getchi(ndata1,ydata1,err1,ydummy1,chisq1)
   CALL offset(ndata2,yinter2,ydummy2,zero)
   CALL getchi(ndata2,ydata2,err2,ydummy2,chisq2)
!
   DO ii=1,ndata1
      resrv1(ii)=ydata1(ii)-ydummy1(ii)
   END DO
   DO ii=1,ndata2
      resrv2(ii)=ydata2(ii)-ydummy2(ii)
   END DO
!
   RETURN
!
END SUBROUTINE checkrvfit
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checkrvfit3(nmodel1,xmodel1,ymodel1,ymodel2,  &
   ymodel3,ndata1,xdata1,ydata1,err1,ndata2,xdata2,ydata2,err2,  &
   ndata3,xdata3,ydata3,err3,chisq1,chisq2,chisq3,zero,resrv1,  &
   resrv2,resrv3,ndatamax)
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmodel1
   REAL(KIND=dp), INTENT(IN)                :: xmodel1(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel1(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel2(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel3(nmodel1)
   INTEGER, INTENT(IN)                      :: ndata1
   REAL(KIND=dp), INTENT(IN)                :: xdata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: ydata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: err1(ndata1)
   INTEGER, INTENT(IN)                      :: ndata2
   REAL(KIND=dp), INTENT(IN)                :: xdata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: ydata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: err2(ndata2)
   INTEGER, INTENT(IN)                      :: ndata3
   REAL(KIND=dp), INTENT(IN)                :: xdata3(ndata3)
   REAL(KIND=dp), INTENT(IN)                :: ydata3(ndata3)
   REAL(KIND=dp), INTENT(IN)                :: err3(ndata3)
   REAL(KIND=dp), INTENT(OUT)               :: chisq1
   REAL(KIND=dp), INTENT(OUT)               :: chisq2
   REAL(KIND=dp), INTENT(OUT)               :: chisq3
   REAL(KIND=dp), INTENT(OUT)               :: zero
   REAL(KIND=dp), INTENT(OUT)               :: resrv1(ndata1)
   REAL(KIND=dp), INTENT(OUT)               :: resrv2(ndata2)
   REAL(KIND=dp), INTENT(OUT)               :: resrv3(ndata3)
   INTEGER, INTENT(IN)                      :: ndatamax
!
   REAL(KIND=dp)  :: ymin1,fn,chi42,chi41,diff23,chi4,chi43,chi11
   REAL(KIND=dp)  :: ymax1,ymin2,ymax2,ymin3,ymax3,zerosmall,qqq,chi12
   REAL(KIND=dp)  :: dataave1,dataave2,dataave3,rmodelave1,rmodelave2,chi13
   REAL(KIND=dp)  :: rmodelave3,step,chi1,chi2,chi3,small,zero1,zero2,zero3
   REAL(KIND=dp)  :: chi23,chi22,chi21,diff,csave,zsave,chi33,chi32,chi31
!
   REAL(KIND=dp), DIMENSION(ndatamax) :: yinter1,yinter2,yinter3
   REAL(KIND=dp), DIMENSION(ndatamax) :: ydummy1,ydummy2,ydummy3
!
   INTEGER :: i, ii
!
!   UPDATE May 27, 2002
!
!   Add this common block:
!
!   COMMON /medblock/ rmed
!
!   Find the maximum and minimum y-values of the data
!
   ymin1=1.0E+20_dp
   ymax1=-1.0E+20_dp
   DO  i=1,ndata1
      IF(ydata1(i) < ymin1)ymin1=ydata1(i)
      IF(ydata1(i) > ymax1)ymax1=ydata1(i)
   END DO
!
   ymin2=1000099.0_dp
   ymax2=-1000099.0_dp
   DO  i=1,ndata2
      IF(ydata2(i) < ymin2)ymin2=ydata2(i)
      IF(ydata2(i) > ymax2)ymax2=ydata2(i)
   END DO
!
   ymin3=1000099.0_dp
   ymax3=-1000099.0_dp
   DO  i=1,ndata3
      IF(ydata3(i) < ymin3)ymin3=ydata3(i)
      IF(ydata3(i) > ymax3)ymax3=ydata3(i)
   END DO
!
!   Interpolate the model so that we have y-values at all observed phases.
!
   ii=100
   DO  i=1,ndata1
      CALL hermint(nmodel1,xmodel1,ymodel1,xdata1(i),qqq,ii)
      yinter1(i)=qqq
   END DO
!
   DO  i=1,ndata2
      CALL hermint(nmodel1,xmodel1,ymodel2,xdata2(i),qqq,ii)
      yinter2(i)=qqq
   END DO
!
   DO  i=1,ndata3
      CALL hermint(nmodel1,xmodel1,ymodel3,xdata3(i),qqq,ii)
      yinter3(i)=qqq
   END DO
!
!   Now find the optimal zero point that will give the lowest chi^2.
!
   CALL getmean(ndata1,ydata1,dataave1)
   CALL getmean(ndata1,yinter1,rmodelave1)
   CALL getmean(ndata2,ydata2,dataave2)
   CALL getmean(ndata2,yinter2,rmodelave2)
   CALL getmean(ndata3,ydata3,dataave3)
   CALL getmean(ndata3,yinter3,rmodelave3)
!
   zero=(dataave1-rmodelave1)
   step=ABS(rmodelave1-dataave1)/1000.0_dp
   IF(step < 0.10_dp)step=0.05_dp
!
   chi1=0.0_dp
   chi2=0.0_dp
   chi3=0.0_dp
   chisq1=0.0_dp
   chisq2=0.0_dp
   chisq3=0.0_dp
   small=1.0E+35_dp
   zerosmall=1.0E+20_dp
!
   DO  i=1,20
      zero1=zero
      CALL offset(ndata1,yinter1,ydummy1,zero1)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi11)
      CALL offset(ndata2,yinter2,ydummy2,zero1)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi12)
      CALL offset(ndata3,yinter3,ydummy3,zero1)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi13)
      chi1=chi11+chi12+chi13
      IF(chi1 < small)THEN
         small=chi1
         zerosmall=zero1
      END IF
      fn=0.0_dp
      zero2=zero+step
      CALL offset(ndata1,yinter1,ydummy1,zero2)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi21)
      CALL offset(ndata2,yinter2,ydummy2,zero2)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi22)
      CALL offset(ndata3,yinter3,ydummy3,zero2)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi23)
      chi2=chi21+chi22+chi23
      IF(chi2 < small)THEN
         small=chi2
         zerosmall=zero2
      END IF
      diff=chi1-chi2
      IF(diff > 0.0_dp)GO TO 70
      step=-step
!
      csave=chi1
      chi1=chi2
      chi2=csave
      zsave=zero1
      zero1=zero2
      zero2=zsave
!
70    fn=fn+1.0_dp
!
      zero3=zero2+step
      CALL offset(ndata1,yinter1,ydummy1,zero3)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi31)
      CALL offset(ndata2,yinter2,ydummy2,zero3)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi32)
      CALL offset(ndata3,yinter3,ydummy3,zero3)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi33)
      chi3=chi31+chi32+chi33
      IF(chi3 < small)THEN
         small=chi3
         zerosmall=zero3
      END IF
      diff23=chi3-chi2
      IF(diff23 < 0.0_dp)THEN
         chi1=chi2
         chi2=chi3
         zero1=zero2
         zero2=zero3
         zero=zero3
         GO TO 70
      END IF
!
!         find the minimum of parabola defined by the last three points
!
      IF(ABS(chi3-chi2) <= EPSILON(chi3))EXIT
      step=step*(1.0_dp/(1.0_dp+(chi1-chi2)/(chi3-chi2))+0.5_dp)
      zero=zero2-step
      step=step*fn/3.0_dp
      CALL offset(ndata1,yinter1,ydummy1,zero)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi41)
      CALL offset(ndata2,yinter2,ydummy2,zero)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi42)
      CALL offset(ndata3,yinter3,ydummy3,zero)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi43)
      chi4=chi41+chi42+chi43
      IF(chi4 < small)THEN
         small=chi4
         zerosmall=zero
      END IF
!
!  continue loop over grid searches
!
   END DO
!
!  come here when delta chi is small
!
   zero=zerosmall
!
   CALL offset(ndata1,yinter1,ydummy1,zero)
   CALL getchi(ndata1,ydata1,err1,ydummy1,chisq1)
   CALL offset(ndata2,yinter2,ydummy2,zero)
   CALL getchi(ndata2,ydata2,err2,ydummy2,chisq2)
   CALL offset(ndata3,yinter3,ydummy3,zero)
   CALL getchi(ndata3,ydata3,err3,ydummy3,chisq3)
!
   DO ii=1,ndata1
      resrv1(ii)=ydata1(ii)-ydummy1(ii)
   END DO
   DO ii=1,ndata2
      resrv2(ii)=ydata2(ii)-ydummy2(ii)
   END DO
   DO ii=1,ndata3
      resrv3(ii)=ydata3(ii)-ydummy3(ii)
   END DO
!
   RETURN
!
END SUBROUTINE checkrvfit3
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checkrvfit4(nmodel1,xmodel1,ymodel1,ymodel2,  &
   ymodel3,ymodel4,ndata1,xdata1,ydata1,err1,ndata2,xdata2,  &
   ydata2,err2,ndata3,xdata3,ydata3,err3,ndata4,xdata4,ydata4,  &
   err4,chisq1,chisq2,chisq3,chisq4,zero,resrv1,resrv2,resrv3,  &
   resrv4,ndatamax)
! 
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmodel1
   REAL(KIND=dp), INTENT(IN)                :: xmodel1(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel1(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel2(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel3(nmodel1)
   REAL(KIND=dp), INTENT(IN)                :: ymodel4(nmodel1)
   INTEGER, INTENT(IN)                      :: ndata1
   REAL(KIND=dp), INTENT(IN)                :: xdata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: ydata1(ndata1)
   REAL(KIND=dp), INTENT(IN)                :: err1(ndata1)
   INTEGER, INTENT(IN)                      :: ndata2
   REAL(KIND=dp), INTENT(IN)                :: xdata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: ydata2(ndata2)
   REAL(KIND=dp), INTENT(IN)                :: err2(ndata2)
   INTEGER, INTENT(IN)                      :: ndata3
   REAL(KIND=dp), INTENT(IN)                :: xdata3(ndata3)
   REAL(KIND=dp), INTENT(IN)                :: ydata3(ndata3)
   REAL(KIND=dp), INTENT(IN)                :: err3(ndata3)
   INTEGER, INTENT(IN)                      :: ndata4
   REAL(KIND=dp), INTENT(IN)                :: xdata4(ndata4)
   REAL(KIND=dp), INTENT(IN)                :: ydata4(ndata4)
   REAL(KIND=dp), INTENT(IN)                :: err4(ndata4)
   REAL(KIND=dp), INTENT(OUT)               :: chisq1
   REAL(KIND=dp), INTENT(OUT)               :: chisq2
   REAL(KIND=dp), INTENT(OUT)               :: chisq3
   REAL(KIND=dp), INTENT(OUT)               :: chisq4
   REAL(KIND=dp), INTENT(OUT)               :: zero
   REAL(KIND=dp), INTENT(OUT)               :: resrv1(ndata1)
   REAL(KIND=dp), INTENT(OUT)               :: resrv2(ndata2)
   REAL(KIND=dp), INTENT(OUT)               :: resrv3(ndata3)
   REAL(KIND=dp), INTENT(OUT)               :: resrv4(ndata4)
   INTEGER, INTENT(IN)                      :: ndatamax
!
   REAL(KIND=dp)  :: ymax1,ymin2,ymax2,ymin3,ymax3,zerosmall,qqq,chi12
   REAL(KIND=dp)  :: dataave1,dataave2,dataave3,rmodelave1,rmodelave2,chi13
   REAL(KIND=dp)  :: rmodelave3,step,chi1,chi2,chi3,small,zero1,zero2,zero3
   REAL(KIND=dp)  :: chi23,chi22,chi21,diff,csave,zsave,chi33,chi32,chi31
   REAL(KIND=dp)  :: diff23,chi4,chi43,chi42,chi41,chi44,fn,ymin4,ymax4,ymin1
   REAL(KIND=dp)  :: dataave4,rmodelave4,chi14,chi24,chi34,chi11
!
   REAL(KIND=dp), DIMENSION(ndatamax) :: yinter1,yinter2,yinter3,yinter4
   REAL(KIND=dp), DIMENSION(ndatamax) :: ydummy1,ydummy2,ydummy3,ydummy4
!
   INTEGER :: i, ii
!
!   COMMON /medblock/ rmed
!
!   Find the maximum and minimum y-values of the data
!
   ymin1=1.0E+20_dp
   ymax1=-1.0E+20_dp
   DO  i=1,ndata1
      IF(ydata1(i) < ymin1)ymin1=ydata1(i)
      IF(ydata1(i) > ymax1)ymax1=ydata1(i)
   END DO
!
   ymin2=1000099.0_dp
   ymax2=-1000099.0_dp
   DO  i=1,ndata2
      IF(ydata2(i) < ymin2)ymin2=ydata2(i)
      IF(ydata2(i) > ymax2)ymax2=ydata2(i)
   END DO
!
   ymin3=1000099.0_dp
   ymax3=-1000099.0_dp
   DO  i=1,ndata3
      IF(ydata3(i) < ymin3)ymin3=ydata3(i)
      IF(ydata3(i) > ymax3)ymax3=ydata3(i)
   END DO
!
   ymin4=1000099.0_dp
   ymax4=-1000099.0_dp
   DO  i=1,ndata4
      IF(ydata4(i) < ymin4)ymin4=ydata4(i)
      IF(ydata4(i) > ymax4)ymax4=ydata4(i)
   END DO
!
!   Interpolate the model so that we have y-values at all observed phases.
!
   ii=nmodel1/2
   DO  i=1,ndata1
      CALL hermint(nmodel1,xmodel1,ymodel1,xdata1(i),qqq,ii)
      yinter1(i)=qqq
   END DO
!
   DO  i=1,ndata2
      CALL hermint(nmodel1,xmodel1,ymodel2,xdata2(i),qqq,ii)
      yinter2(i)=qqq
   END DO
!
   DO  i=1,ndata3
      CALL hermint(nmodel1,xmodel1,ymodel3,xdata3(i),qqq,ii)
      yinter3(i)=qqq
   END DO
!
   DO  i=1,ndata4
      CALL hermint(nmodel1,xmodel1,ymodel4,xdata4(i),qqq,ii)
      yinter4(i)=qqq
   END DO
!
!   Now find the optimal zero point that will give the lowest chi^2.
!
   CALL getmean(ndata1,ydata1,dataave1)
   CALL getmean(ndata1,yinter1,rmodelave1)
   CALL getmean(ndata2,ydata2,dataave2)
   CALL getmean(ndata2,yinter2,rmodelave2)
   CALL getmean(ndata3,ydata3,dataave3)
   CALL getmean(ndata3,yinter3,rmodelave3)
   CALL getmean(ndata4,ydata4,dataave4)
   CALL getmean(ndata4,yinter4,rmodelave4)
!
   zero=(dataave1-rmodelave1)
   step=ABS(rmodelave1-dataave1)/1000.0_dp
   IF(step < 0.10_dp)step=0.05_dp
!
   chi1=0.0_dp
   chi2=0.0_dp
   chi3=0.0_dp
   chi4=0.0_dp
   chisq1=0.0_dp
   chisq2=0.0_dp
   chisq3=0.0_dp
   chisq4=0.0_dp
   small=1.0E+35_dp
   zerosmall=1.0E+20_dp
!
   DO  i=1,20
      zero1=zero
      CALL offset(ndata1,yinter1,ydummy1,zero1)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi11)
      CALL offset(ndata2,yinter2,ydummy2,zero1)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi12)
      CALL offset(ndata3,yinter3,ydummy3,zero1)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi13)
      CALL offset(ndata4,yinter4,ydummy4,zero1)
      CALL getchi(ndata4,ydata4,err4,ydummy4,chi14)
      chi1=chi11+chi12+chi13+chi14
      IF(chi1 < small)THEN
         small=chi1
         zerosmall=zero1
      END IF
      fn=0.0_dp
      zero2=zero+step
      CALL offset(ndata1,yinter1,ydummy1,zero2)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi21)
      CALL offset(ndata2,yinter2,ydummy2,zero2)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi22)
      CALL offset(ndata3,yinter3,ydummy3,zero2)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi23)
      CALL offset(ndata4,yinter4,ydummy4,zero2)
      CALL getchi(ndata4,ydata4,err4,ydummy4,chi24)
      chi2=chi21+chi22+chi23+chi24
      IF(chi2 < small)THEN
         small=chi2
         zerosmall=zero2
      END IF
      diff=chi1-chi2
      IF(diff > 0.0_dp)GO TO 90
      step=-step
      csave=chi1
      chi1=chi2
      chi2=csave
      zsave=zero1
      zero1=zero2
      zero2=zsave
!
90    fn=fn+1.0_dp
!
      zero3=zero2+step
      CALL offset(ndata1,yinter1,ydummy1,zero3)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi31)
      CALL offset(ndata2,yinter2,ydummy2,zero3)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi32)
      CALL offset(ndata3,yinter3,ydummy3,zero3)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi33)
      CALL offset(ndata4,yinter4,ydummy4,zero3)
      CALL getchi(ndata4,ydata4,err4,ydummy4,chi34)
      chi3=chi31+chi32+chi33+chi34
      IF(chi3 < small)THEN
         small=chi3
         zerosmall=zero3
      END IF
      diff23=chi3-chi2
      IF(diff23 < 0.0_dp)THEN
         chi1=chi2
         chi2=chi3
         zero1=zero2
         zero2=zero3
         zero=zero3
         GO TO 90
      END IF
!
!         find the minimum of parabola defined by the last three points
!
      IF(ABS(chi3-chi2) <= EPSILON(chi3))EXIT
      step=step*(1.0_dp/(1.0_dp+(chi1-chi2)/(chi3-chi2))+0.5_dp)
      zero=zero2-step
      step=step*fn/3.0_dp
      CALL offset(ndata1,yinter1,ydummy1,zero)
      CALL getchi(ndata1,ydata1,err1,ydummy1,chi41)
      CALL offset(ndata2,yinter2,ydummy2,zero)
      CALL getchi(ndata2,ydata2,err2,ydummy2,chi42)
      CALL offset(ndata3,yinter3,ydummy3,zero)
      CALL getchi(ndata3,ydata3,err3,ydummy3,chi43)
      CALL offset(ndata4,yinter4,ydummy4,zero)
      CALL getchi(ndata4,ydata4,err4,ydummy4,chi44)
      chi4=chi41+chi42+chi43+chi44
      IF(chi4 < small)THEN
         small=chi4
         zerosmall=zero
      END IF
!
!  continue loop over grid searches
!
   END DO
!
! come here when delta chi is small
!
   zero=zerosmall
!
   CALL offset(ndata1,yinter1,ydummy1,zero)
   CALL getchi(ndata1,ydata1,err1,ydummy1,chisq1)
   CALL offset(ndata2,yinter2,ydummy2,zero)
   CALL getchi(ndata2,ydata2,err2,ydummy2,chisq2)
   CALL offset(ndata3,yinter3,ydummy3,zero)
   CALL getchi(ndata3,ydata3,err3,ydummy3,chisq3)
   CALL offset(ndata4,yinter4,ydummy4,zero)
   CALL getchi(ndata4,ydata4,err4,ydummy4,chisq4)
!
   DO ii=1,ndata1
      resrv1(ii)=ydata1(ii)-ydummy1(ii)
   END DO
   DO ii=1,ndata2
      resrv2(ii)=ydata2(ii)-ydummy2(ii)
   END DO
   DO ii=1,ndata3
      resrv3(ii)=ydata3(ii)-ydummy3(ii)
   END DO
   DO ii=1,ndata4
      resrv4(ii)=ydata4(ii)-ydummy4(ii)
   END DO
!
   RETURN
!
END SUBROUTINE checkrvfit4
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE checktags(nvmax,svar,sobv)
!
!   Will check for unknown tags in gridloop.opt
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvmax
   CHARACTER(LEN=40), INTENT(IN)            :: svar(nvmax)
   CHARACTER(LEN=40), INTENT(IN)            :: sobv(19)
!
   INTEGER :: i,kk,icnvrt,icount,jj,j
!
   CHARACTER(LEN=1) :: bell
!
!   Loop over the gridloop.opt variables and match the tag codes
!   to the variables.
!
   DO i=1,nvmax
      icount=0
      kk=icnvrt(svar(i)(1:2))
!
!  tag no, no entry
!
      IF(kk == 430)icount=icount+1
!
!  tag ct, tesscontam
!
      IF(kk == 83)icount=icount+1
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
      IF(kk == 48)icount=icount+1
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
      IF(kk == 3528)icount=icount+1
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
      IF(kk == 3560)icount=icount+1
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
      IF(kk == 3592)icount=icount+1
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
      IF(kk == 3624)icount=icount+1
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
      IF(kk == 3656)icount=icount+1
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
      IF(kk == 3688)icount=icount+1
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
      IF(kk == 3720)icount=icount+1
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
      IF(kk == 3752)icount=icount+1
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
      IF(kk == 51)icount=icount+1
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
      IF(kk == 3531)icount=icount+1
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
      IF(kk == 3563)icount=icount+1
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
      IF(kk == 3595)icount=icount+1
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
      IF(kk == 3627)icount=icount+1
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
      IF(kk == 3659)icount=icount+1
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
      IF(kk == 3691)icount=icount+1
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
      IF(kk == 3723)icount=icount+1
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
      IF(kk == 3755)icount=icount+1
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
      IF(kk == 581)icount=icount+1
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
      IF(kk == 579)icount=icount+1
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
      IF(kk == 3512)icount=icount+1
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
      IF(kk == 3544)icount=icount+1
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
      IF(kk == 3576)icount=icount+1
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
      IF(kk == 3608)icount=icount+1
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
      IF(kk == 3640)icount=icount+1
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
      IF(kk == 3672)icount=icount+1
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
      IF(kk == 3704)icount=icount+1
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
      IF(kk == 3736)icount=icount+1
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
      IF(kk == 3515)icount=icount+1
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
      IF(kk == 3547)icount=icount+1
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
      IF(kk == 3579)icount=icount+1
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
      IF(kk == 3611)icount=icount+1
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
      IF(kk == 3643)icount=icount+1
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
      IF(kk == 3675)icount=icount+1
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
      IF(kk == 3707)icount=icount+1
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
      IF(kk == 3739)icount=icount+1
!
!  tag fs, fracsum (sum of fractional radii)
!
      IF(kk == 178)icount=icount+1
!
!  tag fd, fracdiff (difference of fractional radii)
!
      IF(kk == 163)icount=icount+1
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
      IF(kk == 4790)icount=icount+1
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
      IF(kk == 4791)icount=icount+1
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4792)icount=icount+1
!
!  tag 90, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4783)icount=icount+1
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 50)icount=icount+1
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 34)icount=icount+1
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3530)icount=icount+1
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3514)icount=icount+1
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3562)icount=icount+1
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3546)icount=icount+1
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3594)icount=icount+1
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3578)icount=icount+1
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3626)icount=icount+1
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3610)icount=icount+1
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3658)icount=icount+1
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3642)icount=icount+1
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3690)icount=icount+1
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3674)icount=icount+1
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3722)icount=icount+1
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3706)icount=icount+1
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3754)icount=icount+1
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3738)icount=icount+1
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
      IF(kk == 3524)icount=icount+1
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
      IF(kk == 3527)icount=icount+1
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
      IF(kk == 3556)icount=icount+1
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
      IF(kk == 3559)icount=icount+1
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
      IF(kk == 3588)icount=icount+1
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
      IF(kk == 3591)icount=icount+1
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
      IF(kk == 3620)icount=icount+1
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
      IF(kk == 3623)icount=icount+1
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
      IF(kk == 3652)icount=icount+1
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
      IF(kk == 3655)icount=icount+1
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
      IF(kk == 3684)icount=icount+1
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
      IF(kk == 3687)icount=icount+1
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
      IF(kk == 3716)icount=icount+1
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
      IF(kk == 3719)icount=icount+1
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
      IF(kk == 3748)icount=icount+1
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
      IF(kk == 3751)icount=icount+1
!
!  tag bm, PbmTc, period-Tconj, binary
!
      IF(kk == 44)icount=icount+1
!
!  tag bp, PbpTc, period+Tconj, binary
!
      IF(kk == 47)icount=icount+1
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
      IF(kk == 40)icount=icount+1
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
      IF(kk == 33)icount=icount+1
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
      IF(kk == 72)icount=icount+1
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
      IF(kk == 65)icount=icount+1
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
      IF(kk == 104)icount=icount+1
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
      IF(kk == 97)icount=icount+1
!
!  tag 91, bin2masssum (M3+M4 in binary+binary)
!
      IF(kk == 4784)icount=icount+1
!
!  tag 92, bin2massdiff (M3-M4 in binary+binary)
!
      IF(kk == 4785)icount=icount+1
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
      IF(kk == 4786)icount=icount+1
!
!  tag 94, bin2radsum (R3+R4 in binary+binary)
!
      IF(kk == 4787)icount=icount+1
!
!  tag 95, bin2raddiff (R3-R4 in binary+binary)
!
      IF(kk == 4788)icount=icount+1
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
      IF(kk == 4789)icount=icount+1
!
!   tag g4, g4
!
      IF(kk == 1211)icount=icount+1
!
!   tag g5, g5
!
      IF(kk == 1212)icount=icount+1
!
!   tag g6, g6
!
      IF(kk == 1213)icount=icount+1
!
!   tag g7, g7
!
      IF(kk == 1214)icount=icount+1
!
!   tag g8, g8
!
      IF(kk == 1215)icount=icount+1
!
!   tag g9, g9
!
      IF(kk == 1216)icount=icount+1
!
!   tag g0, g10
!
      IF(kk == 1207)icount=icount+1
!
!   tag md, massdiff (M1-M2 for binary)
!
      IF(kk == 387)icount=icount+1
!
!   tag ms, masssum (M1+M2 for binary)
!
      IF(kk == 402)icount=icount+1
!
!   tag o3, omega3
!
      IF(kk == 1466)icount=icount+1
!
!   tag o4, omega4
!
      IF(kk == 1467)icount=icount+1
!
!   tag o5, omega5
!
      IF(kk == 1468)icount=icount+1
!
!   tag o6, omega6
!
      IF(kk == 1469)icount=icount+1
!
!   tag o7, omega7
!
      IF(kk == 1470)icount=icount+1
!
!   tag o8, omega8
!
      IF(kk == 1471)icount=icount+1
!
!   tag o9, omega9
!
      IF(kk == 1472)icount=icount+1
!
!   tag o0, omega10
!
      IF(kk == 1463)icount=icount+1
!
!   tag rs, radsum (R1+R2 for binary)
!
      IF(kk == 562)icount=icount+1
!
!   tag rd, raddiff (R1-R2 for binary)
!
      IF(kk == 547)icount=icount+1
!
!   tag a3, rk3 (apsidal constant, body 3)
!
      IF(kk == 1018)icount=icount+1
!
!   tag a4, rk4 (apsidal constant, body 4)
!
      IF(kk == 1019)icount=icount+1
!
!   tag a5, rk5 (apsidal constant, body 5)
!
      IF(kk == 1020)icount=icount+1
!
!   tag a6, rk6 (apsidal constant, body 6)
!
      IF(kk == 1021)icount=icount+1
!
!   tag a7, rk7 (apsidal constant, body 7)
!
      IF(kk == 1022)icount=icount+1
!
!   tag a8, rk8 (apsidal constant, body 8)
!
      IF(kk == 1023)icount=icount+1
!
!   tag a9, rk9 (apsidal constant, body 9)
!
      IF(kk == 1024)icount=icount+1
!
!   tag a0, rk10 (apsidal constant, body 10)
!
      IF(kk == 1015)icount=icount+1
!
!   tag sm, secmass
!
      IF(kk == 588)icount=icount+1
!
!   tag sr, secrad
!
      IF(kk == 593)icount=icount+1
!
!   tag t6, t6 (Teff6)
!
      IF(kk == 1629)icount=icount+1
!
!   tag t7, t7 (Teff7)
!
      IF(kk == 1630)icount=icount+1
!
!   tag t8, t8 (Teff8)
!
      IF(kk == 1631)icount=icount+1
!
!   tag t9, t9 (Teff9)
!
      IF(kk == 1632)icount=icount+1
!
!   tag ta, t10 (Teff10)
!
      IF(kk == 608)icount=icount+1
!
!  tag 61, flux star 6, band 1
!
      IF(kk == 4688)icount=icount+1
!
!  tag 62, flux star 6, band 2
!
      IF(kk == 4689)icount=icount+1
!
!  tag 63, flux star 6, band 3
!
      IF(kk == 4690)icount=icount+1
!
!  tag 64, flux star 6, band 4
!
      IF(kk == 4691)icount=icount+1
!
!  tag 65, flux star 6, band 5
!
      IF(kk == 4692)icount=icount+1
!
!  tag 66, flux star 6, band 6
!
      IF(kk == 4693)icount=icount+1
!
!  tag 67, flux star 6, band 7
!
      IF(kk == 4694)icount=icount+1
!
!  tag 68, flux star 6, band 8
!
      IF(kk == 4695)icount=icount+1
!
!  tag 71, flux star 7, band 1
!
      IF(kk == 4720)icount=icount+1
!
!  tag 72, flux star 7, band 2
!
      IF(kk == 4721)icount=icount+1
!
!  tag 73, flux star 7, band 3
!
      IF(kk == 4722)icount=icount+1
!
!  tag 74, flux star 7, band 4
!
      IF(kk == 4723)icount=icount+1
!
!  tag 75, flux star 7, band 5
!
      IF(kk == 4724)icount=icount+1
!
!  tag 76, flux star 7, band 6
!
      IF(kk == 4725)icount=icount+1
!
!  tag 77, flux star 7, band 7
!
      IF(kk == 4726)icount=icount+1
!
!  tag 78, flux star 7, band 8
!
      IF(kk == 4727)icount=icount+1
!
!  tag 81, flux star 8, band 1
!
      IF(kk == 4752)icount=icount+1
!
!  tag 82, flux star 8, band 2
!
      IF(kk == 4753)icount=icount+1
!
!  tag 83, flux star 8, band 3
!
      IF(kk == 4754)icount=icount+1
!
!  tag 84, flux star 8, band 4
!
      IF(kk == 4755)icount=icount+1
!
!  tag 85, flux star 8, band 5
!
      IF(kk == 4756)icount=icount+1
!
!  tag 86, flux star 8, band 6
!
      IF(kk == 4757)icount=icount+1
!
!  tag 87, flux star 8, band 7
!
      IF(kk == 4758)icount=icount+1
!
!  tag 88, flux star 8, band 8
!
      IF(kk == 4759)icount=icount+1
!
!  tag 91, flux star 9, band 1
!
      IF(kk == 2784)icount=icount+1
!
!  tag 92, flux star 9, band 2
!
      IF(kk == 2785)icount=icount+1
!
!  tag 93, flux star 9, band 3
!
      IF(kk == 2786)icount=icount+1
!
!  tag 94, flux star 9, band 4
!
      IF(kk == 2787)icount=icount+1
!
!  tag 95, flux star 9, band 5
!
      IF(kk == 2788)icount=icount+1
!
!  tag 96, flux star 9, band 6
!
      IF(kk == 2789)icount=icount+1
!
!  tag 97, flux star 9, band 7
!
      IF(kk == 2790)icount=icount+1
!
!  tag 98, flux star 9, band 8
!
      IF(kk == 2791)icount=icount+1
!
!  tag 01, flux star 10, band 1
!
      IF(kk == 4496)icount=icount+1
!
!  tag 02, flux star 10, band 2
!
      IF(kk == 4497)icount=icount+1
!
!  tag 03, flux star 10, band 3
!
      IF(kk == 4498)icount=icount+1
!
!  tag 04, flux star 10, band 4
!
      IF(kk == 4499)icount=icount+1
!
!  tag 05, flux star 10, band 5
!
      IF(kk == 4500)icount=icount+1
!
!  tag 06, flux star 10, band 6
!
      IF(kk == 4501)icount=icount+1
!
!  tag 07, flux star 10, band 7
!
      IF(kk == 4502)icount=icount+1
!
!  tag 08, flux star 10, band 8
!
      IF(kk == 4503)icount=icount+1
!
!  tag 11, flux star 1, band 1
!
      IF(kk == 4528)icount=icount+1
!
!  tag 12, flux star 1, band 2
!
      IF(kk == 4529)icount=icount+1
!
!  tag 13, flux star 1, band 3
!
      IF(kk == 4530)icount=icount+1
!
!  tag 14, flux star 1, band 4
!
      IF(kk == 4531)icount=icount+1
!
!  tag 15, flux star 1, band 5
!
      IF(kk == 4532)icount=icount+1
!
!  tag 16, flux star 1, band 6
!
      IF(kk == 4533)icount=icount+1
!
!  tag 17, flux star 1, band 7
!
      IF(kk == 4534)icount=icount+1
!
!  tag 18, flux star 1, band 8
!
      IF(kk == 4535)icount=icount+1
!
!  tag 21, flux star 2, band 1
!
      IF(kk == 4560)icount=icount+1
!
!  tag 22, flux star 2, band 2
!
      IF(kk == 4561)icount=icount+1
!
!  tag 23, flux star 2, band 3
!
      IF(kk == 4562)icount=icount+1
!
!  tag 24, flux star 2, band 4
!
      IF(kk == 4563)icount=icount+1
!
!  tag 25, flux star 2, band 5
!
      IF(kk == 4564)icount=icount+1
!
!  tag 26, flux star 2, band 6
!
      IF(kk == 4565)icount=icount+1
!
!  tag 27, flux star 2, band 7
!
      IF(kk == 4566)icount=icount+1
!
!  tag 28, flux star 2, band 8
!
      IF(kk == 4567)icount=icount+1
!
!  tag 31, flux star 3, band 1
!
      IF(kk == 4592)icount=icount+1
!
!  tag 32, flux star 3, band 2
!
      IF(kk == 4593)icount=icount+1
!
!  tag 33, flux star 3, band 3
!
      IF(kk == 4594)icount=icount+1
!
!  tag 34, flux star 3, band 4
!
      IF(kk == 4595)icount=icount+1
!
!  tag 35, flux star 3, band 5
!
      IF(kk == 4596)icount=icount+1
!
!  tag 36, flux star 3, band 6
!
      IF(kk == 4597)icount=icount+1
!
!  tag 37, flux star 3, band 7
!
      IF(kk == 4598)icount=icount+1
!
!  tag 38, flux star 3, band 8
!
      IF(kk == 4599)icount=icount+1
!
!  tag 41, flux star 4, band 1
!
      IF(kk == 4624)icount=icount+1
!
!  tag 42, flux star 4, band 2
!
      IF(kk == 4625)icount=icount+1
!
!  tag 43, flux star 4, band 3
!
      IF(kk == 4626)icount=icount+1
!
!  tag 44, flux star 4, band 4
!
      IF(kk == 4627)icount=icount+1
!
!  tag 45, flux star 4, band 5
!
      IF(kk == 4628)icount=icount+1
!
!  tag 46, flux star 4, band 6
!
      IF(kk == 4629)icount=icount+1
!
!  tag 47, flux star 4, band 7
!
      IF(kk == 4630)icount=icount+1
!
!  tag 48, flux star 4, band 8
!
      IF(kk == 4631)icount=icount+1
!
!  tag 51, flux star 5, band 1
!
      IF(kk == 4656)icount=icount+1
!
!  tag 52, flux star 5, band 2
!
      IF(kk == 4657)icount=icount+1
!
!  tag 53, flux star 5, band 3
!
      IF(kk == 4658)icount=icount+1
!
!  tag 54, flux star 5, band 4
!
      IF(kk == 4659)icount=icount+1
!
!  tag 55, flux star 5, band 5
!
      IF(kk == 4660)icount=icount+1
!
!  tag 56, flux star 5, band 6
!
      IF(kk == 4661)icount=icount+1
!
!  tag 57, flux star 5, band 7
!
      IF(kk == 4662)icount=icount+1
!
!  tag 58, flux star 5, band 8
!
      IF(kk == 4663)icount=icount+1
!
!  tag a1, tidal apsidal constant, star 1
!
      IF(kk == 1016)icount=icount+1
!
!  tag a2, tidal apsidal constant, star 2
!
      IF(kk == 1017)icount=icount+1
!
!  tag Ob, nodal angle of binary
!
      IF(kk == 449)icount=icount+1
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
!
      IF(kk == 649)icount=icount+1
!
!  tag ut, P2period
!
      IF(kk == 659)icount=icount+1
!
!  tag uu, P2T0
!
      IF(kk == 660)icount=icount+1
!
!  tag uv, P2ecos
!
      IF(kk == 661)icount=icount+1
!
!  tag uw, P2esin
!
      IF(kk == 662)icount=icount+1
!
!  tag ux, P2incl
!
      IF(kk == 663)icount=icount+1
!
!  tag uy, P2Omega
!
      IF(kk == 664)icount=icount+1
!
!  tag uz, P2Q
!
      IF(kk == 665)icount=icount+1
!
!  tag ub, P2ratrad
!
      IF(kk == 641)icount=icount+1
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
      IF(kk == 681)icount=icount+1
!
!  tag vt, P3period
!
      IF(kk == 691)icount=icount+1
!
!  tag vu, P3T0
!
      IF(kk == 692)icount=icount+1
!
!  tag vv, P3ecos
!
      IF(kk == 693)icount=icount+1
!
!  tag vw, P3esin
!
      IF(kk == 694)icount=icount+1
!
!  tag vx, P3incl
!
      IF(kk == 695)icount=icount+1
!
!  tag vy, P3Omega
!
      IF(kk == 696)icount=icount+1
!
!  tag vz, P3Q
!
      IF(kk == 697)icount=icount+1
!
!  tag vb, P3ratrad
!
      IF(kk == 673)icount=icount+1
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
      IF(kk == 713)icount=icount+1
!
!  tag wt, P4period
!
      IF(kk == 723)icount=icount+1
!
!  tag wu, P4T0
!
      IF(kk == 724)icount=icount+1
!
!  tag wv, P4ecos
!
      IF(kk == 725)icount=icount+1
!
!  tag ww, P4esin
!
      IF(kk == 726)icount=icount+1
!
!  tag wx, P4incl
!
      IF(kk == 727)icount=icount+1
!
!  tag wy, P4Omega
!
      IF(kk == 728)icount=icount+1
!
!  tag wz, P4Q
!
      IF(kk == 729)icount=icount+1
!
!  tag wb, P4ratrad
!
      IF(kk == 705)icount=icount+1
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
      IF(kk == 745)icount=icount+1
!
!  tag xt, P5period
!
      IF(kk == 755)icount=icount+1
!
!  tag xu, P5T0
!
      IF(kk == 756)icount=icount+1
!
!  tag xv, P5ecos
!
      IF(kk == 757)icount=icount+1
!
!  tag xw, P5esin
!
      IF(kk == 758)icount=icount+1
!
!  tag xx, P5incl
!
      IF(kk == 759)icount=icount+1
!
!  tag xy, P5Omega
!
      IF(kk == 760)icount=icount+1
!
!  tag xz, P5Q
!
      IF(kk == 761)icount=icount+1
!
!  tag xb, P5ratrad
!
      IF(kk == 737)icount=icount+1
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
      IF(kk == 585)icount=icount+1
!
!  tag st, P6period
!
      IF(kk == 595)icount=icount+1
!
!  tag su, P6T0
!
      IF(kk == 596)icount=icount+1
!
!  tag sv, P6ecos
!
      IF(kk == 597)icount=icount+1
!
!  tag sw, P6esin
!
      IF(kk == 598)icount=icount+1
!
!  tag sx, P6incl
!
      IF(kk == 599)icount=icount+1
!
!  tag sy, P6Omega
!
      IF(kk == 600)icount=icount+1
!
!  tag sz, P6Q
!
      IF(kk == 601)icount=icount+1
!
!  tag sb, P6ratrad
!
      IF(kk == 577)icount=icount+1
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
      IF(kk == 233)icount=icount+1
!
!  tag ht, P7period
!
      IF(kk == 243)icount=icount+1
!
!  tag hu, P7T0
!
      IF(kk == 244)icount=icount+1
!
!  tag hv, P7ecos
!
      IF(kk == 245)icount=icount+1
!
!  tag hw, P7esin
!
      IF(kk == 246)icount=icount+1
!
!  tag hx, P7incl
!
      IF(kk == 247)icount=icount+1
!
!  tag hy, P7Omega
!
      IF(kk == 248)icount=icount+1
!
!  tag hz, P7Q
!
      IF(kk == 249)icount=icount+1
!
!  tag hb, P7ratrad
!
      IF(kk == 225)icount=icount+1
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
      IF(kk == 329)icount=icount+1
!
!  tag kt, P8period
!
      IF(kk == 339)icount=icount+1
!
!  tag ku, P8T0
!
      IF(kk == 340)icount=icount+1
!
!  tag kv, P8ecos
!
      IF(kk == 341)icount=icount+1
!
!  tag kw, P8esin
!
      IF(kk == 342)icount=icount+1
!
!  tag kx, P8incl
!
      IF(kk == 343)icount=icount+1
!
!  tag ky, P8Omega
!
      IF(kk == 344)icount=icount+1
!
!  tag kz, P8Q
!
      IF(kk == 345)icount=icount+1
!
!  tag kb, P8ratrad
!
      IF(kk == 42)icount=icount+1
!
!  tag s0, seasonal contamination season 0
!
      IF(kk == 1591)icount=icount+1
!
!  tag s1, seasonal contamination season 1
!
      IF(kk == 1592)icount=icount+1
!
!  tag s2, seasonal contamination season 2
!
      IF(kk == 1593)icount=icount+1
!
!  tag s3, seasonal contamination s3
!
      IF(kk == 1594)icount=icount+1
!
!  tag do, omegadot
!
      IF(kk == 110)icount=icount+1
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
      IF(kk == 1208)icount=icount+1
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
      IF(kk == 1209)icount=icount+1
!
!  tag tj, tertconj, third body conjunction
!
      IF(kk == 617)icount=icount+1
!
!  tag tt, tertperiod, third body perioe
!
      IF(kk == 627)icount=icount+1
!
!  tag tu, tertT0, third body periastron
!
      IF(kk == 628)icount=icount+1
!
!  tag tv, tertecos, e*cos(omega) for body 3
!
      IF(kk == 629)icount=icount+1
!
!  tag tw, tertesin, e*sin(omega) for body 3
!
      IF(kk == 630)icount=icount+1
!
!  tag tx, tertincl, inclination for body 3
!
      IF(kk == 631)icount=icount+1
!
!  tag ty, tertOmega, Omega for body 3
!
      IF(kk == 632)icount=icount+1
!
!  tag tz, tertQ, third body mass ratio
!
      IF(kk == 633)icount=icount+1
!
!  tag tb, tertratrad, third body radius ratio
!
      IF(kk == 609)icount=icount+1
!
!  tag oc, ocose, e*cos(omega) for binary
!
      IF(kk == 450)icount=icount+1
!
!  tag os, osine, e*sin(omega) for binary
!
      IF(kk == 466)icount=icount+1
!
!  tag co, contam, Kepler contamination
!
      IF(kk == 78)icount=icount+1
!
!  tag e1, beam1, Doppler beaming coefficient star 1
!
      IF(kk == 1144)icount=icount+1
!
!  tag e2, beam2, Doppler beaming coefficient star 2
!
      IF(kk == 1145)icount=icount+1
!
!  tag tc, Tconj, conjunction time for binary
!
      IF(kk == 610)icount=icount+1
!
!  tag de, density for primary star
!
      IF(kk == 100)icount=icount+1
!
!  tag ai, bigI, inclination of star 1's spin axis
!
      IF(kk == 8)icount=icount+1
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
      IF(kk == 1)icount=icount+1
!
!  tag dp, ecosw, phase difference of secondary eclipse
!
      IF(kk == 111)icount=icount+1
!
!  tag te, temprat, temperature ratio star 2 to star 1
!
      IF(kk == 612)icount=icount+1
!
!  tag pm, primmass, primary mass in solar masses
!
      IF(kk == 492)icount=icount+1
!
!  tag pr, primrad, primary radius in solar masses
!
      IF(kk == 497)icount=icount+1
!
!  tag pk, primK, K-velocity of primary in km/sec
!
      IF(kk == 490)icount=icount+1
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
      IF(kk == 544)icount=icount+1
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
      IF(kk == 1528)icount=icount+1
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
      IF(kk == 1529)icount=icount+1
!
!  tag l1, alb1, star 1 albedo
!
      IF(kk == 1368)icount=icount+1
!
!  tag l2, alb2, star 2 albedo
!
      IF(kk == 1369)icount=icount+1
!
!  tag pe, period, binary period in days
!
      IF(kk == 484)icount=icount+1
!
!  tag t0, T0, time of periastron passage of binary
!
      IF(kk == 1623)icount=icount+1
!
!  tag d1, temperature factor spot 1 on disk
!
      IF(kk == 1112)icount=icount+1
!
!  tag d5, temperature factor spot 2 on disk
!
      IF(kk == 1116)icount=icount+1
!
!  tag d2, azimuth spot 1 on disk
!
      IF(kk == 1113)icount=icount+1
!
!  tag d6, azimuth spot 2 on disk
!
      IF(kk == 1117)icount=icount+1
!
!  tag d3, cutoff radius for spot 1 on disk
!
      IF(kk == 1114)icount=icount+1
!
!  tag d7, cutoff radius for spot 2 on disk
!
      IF(kk == 1118)icount=icount+1
!
!  tag d4, angular width of spot 1 on disk
!
      IF(kk == 1115)icount=icount+1
!
!  tag d8, angular width of spot 2 on disk
!
      IF(kk == 1119)icount=icount+1
!
!  tag c1, temperature factor spot 1, star 2
!
      IF(kk == 1080)icount=icount+1
!
!  tag c5,  temperature factor spot 2, star 2
!
      IF(kk == 1084)icount=icount+1
!
!  tag b1, temperature factor spot 1, star 1
!
      IF(kk == 1048)icount=icount+1
!
!  tag b5, temperature factor spot 2, star 1
!
      IF(kk == 1052)icount=icount+1
!
!  tag c2, latitude spot 1, star 2
!
      IF(kk == 1081)icount=icount+1
!
!  tag c6, latitude spot 2, star 2
!
      IF(kk == 1085)icount=icount+1
!
!  tag b2, latitude spot 1, star 1
!
      IF(kk == 1049)icount=icount+1
!
!  tag b6,  latitude spot 2, star 1
!
      IF(kk == 1053)icount=icount+1
!
!  tag c3, longitude spot 1, star 2
!
      IF(kk == 1082)icount=icount+1
!
!  tag c7, longitude spot 2, star 2
!
      IF(kk == 1086)icount=icount+1
!
!  tag b3, longitude spot 1, star 1
!
      IF(kk == 1050)icount=icount+1
!
!  tag b7, longitude spot 2, star 1
!
      IF(kk == 1054)icount=icount+1
!
!  tag c4, radius spot 1, star 2
!
      IF(kk == 1083)icount=icount+1
!
!  tag c8, radius spot 2, star 2
!
      IF(kk == 1087)icount=icount+1
!
!  tag b4, radius spot 1, star 1
!
      IF(kk == 1051)icount=icount+1
!
!  tag b8,  radius spot 2, star 1
!
      IF(kk == 1055)icount=icount+1
!
!  tag ps, pshift
!
      IF(kk == 498)icount=icount+1
!
!  tag in, finc, inclination of binary
!
      IF(kk == 269)icount=icount+1
!
!  tag ma, Q, mass ratio of binary
!
      IF(kk == 384)icount=icount+1
!
!  tag ec, ecc, eccentricity of binary
!
      IF(kk == 130)icount=icount+1
!
!  tag ar, argper, argument of periastron of binary
!
      IF(kk == 17)icount=icount+1
!
!  tag f1, fill1, Roche lobe filling factor star 1
!
      IF(kk == 1176)icount=icount+1
!
!  tag ri, rinner, inner radius of accretion disk
!
      IF(kk == 552)icount=icount+1
!
!  tag f2, fill 2, Roche lobe filling factor star 2
!
      IF(kk == 1177)icount=icount+1
!
!  tag o1, omega1, spin rate of star 1
!
      IF(kk == 1464)icount=icount+1
!
!  tag o2, omega2, spin rate of star 2
!
      IF(kk == 1465)icount=icount+1
!
!  tag ro, router, outer radius of accretion disk
!
      IF(kk == 558)icount=icount+1
!
!  tag td, Tdisk, temperature of inner disk
!
      IF(kk == 611)icount=icount+1
!
!  tag be, betarim, opening angle of disk
!
      IF(kk == 36)icount=icount+1
!
!  tag t1, Teff1, temperature of star 1
!
      IF(kk == 1624)icount=icount+1
!
!  tag t2, Teff2, temperature of star 2
!
      IF(kk == 1625)icount=icount+1
!
!  tag xi, xi, power-law exponent on disk temperature profile
!
      IF(kk == 744)icount=icount+1
!
!  tag lx, rLx, log of the X-ray luminosity
!
      IF(kk == 375)icount=icount+1
!
!  tag se, separ, binary semimajor axis
!
      IF(kk == 580)icount=icount+1
!
!  tag ga, gamma, gamma-velocity of binary
!
      IF(kk == 192)icount=icount+1
!
!  tag t3, Teff3, temperature of star 3
!
      IF(kk == 1626)icount=icount+1
!
!  tag t4, Teff4, temperature of star 4
!
      IF(kk == 1627)icount=icount+1
!
!  tag t5, Teff5, temperature of star 5
!
      IF(kk == 1628)icount=icount+1
!
!  tag g3, g3, log(g) of star 3
!
      IF(kk == 1210)icount=icount+1
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
      IF(kk == 576)icount=icount+1
!
!   Here are the assignments for the limb darkening parameters.
!   use tags x1, x2, to x8 for the x-coefficient for star 1
!   and y1, y2, to y8 for the y-coefficient for star 1.
!
!   Use z1, z2, to z8 for the x-coefficient for star 2 and
!   use w1, w2, to w8 for the y-coefficient for star 2.
!
      IF(kk == 1752)icount=icount+1
      IF(kk == 1753)icount=icount+1
      IF(kk == 1754)icount=icount+1
      IF(kk == 1755)icount=icount+1
      IF(kk == 1756)icount=icount+1
      IF(kk == 1757)icount=icount+1
      IF(kk == 1758)icount=icount+1
      IF(kk == 1759)icount=icount+1
!
      IF(kk == 1784)icount=icount+1
      IF(kk == 1785)icount=icount+1
      IF(kk == 1786)icount=icount+1
      IF(kk == 1787)icount=icount+1
      IF(kk == 1788)icount=icount+1
      IF(kk == 1789)icount=icount+1
      IF(kk == 1790)icount=icount+1
      IF(kk == 1791)icount=icount+1
!
      IF(kk == 1816)icount=icount+1
      IF(kk == 1817)icount=icount+1
      IF(kk == 1818)icount=icount+1
      IF(kk == 1819)icount=icount+1
      IF(kk == 1820)icount=icount+1
      IF(kk == 1821)icount=icount+1
      IF(kk == 1822)icount=icount+1
      IF(kk == 1823)icount=icount+1
!
      IF(kk == 1720)icount=icount+1
      IF(kk == 1721)icount=icount+1
      IF(kk == 1722)icount=icount+1
      IF(kk == 1723)icount=icount+1
      IF(kk == 1724)icount=icount+1
      IF(kk == 1725)icount=icount+1
      IF(kk == 1726)icount=icount+1
      IF(kk == 1727)icount=icount+1
!
!   body 3 limb darkening, use tags m1 through m8
!   for the first coefficient, and tags n1 through
!   n8 for the second coefficient
!
      IF(kk == 1400)icount=icount+1
      IF(kk == 1401)icount=icount+1
      IF(kk == 1402)icount=icount+1
      IF(kk == 1403)icount=icount+1
      IF(kk == 1404)icount=icount+1
      IF(kk == 1405)icount=icount+1
      IF(kk == 1406)icount=icount+1
      IF(kk == 1407)icount=icount+1
!
      IF(kk == 1432)icount=icount+1
      IF(kk == 1433)icount=icount+1
      IF(kk == 1434)icount=icount+1
      IF(kk == 1435)icount=icount+1
      IF(kk == 1436)icount=icount+1
      IF(kk == 1437)icount=icount+1
      IF(kk == 1438)icount=icount+1
      IF(kk == 1439)icount=icount+1
!
!   body 4 limb darkening, use tags i1 through i8
!   for the first coefficient, and tags j1 through
!   j8 for the second coefficient
!
      IF(kk == 1272)icount=icount+1
      IF(kk == 1273)icount=icount+1
      IF(kk == 1274)icount=icount+1
      IF(kk == 1275)icount=icount+1
      IF(kk == 1276)icount=icount+1
      IF(kk == 1277)icount=icount+1
      IF(kk == 1278)icount=icount+1
      IF(kk == 1279)icount=icount+1
!
      IF(kk == 1304)icount=icount+1
      IF(kk == 1305)icount=icount+1
      IF(kk == 1306)icount=icount+1
      IF(kk == 1307)icount=icount+1
      IF(kk == 1308)icount=icount+1
      IF(kk == 1309)icount=icount+1
      IF(kk == 1310)icount=icount+1
      IF(kk == 1311)icount=icount+1
!
!   body 5 limb darkening, use tags k1 through k8
!   for the first coefficient, and tags p1 through
!   p8 for the second coefficient
!
      IF(kk == 1336)icount=icount+1
      IF(kk == 1337)icount=icount+1
      IF(kk == 1338)icount=icount+1
      IF(kk == 1339)icount=icount+1
      IF(kk == 1340)icount=icount+1
      IF(kk == 1341)icount=icount+1
      IF(kk == 1342)icount=icount+1
      IF(kk == 1343)icount=icount+1
!
      IF(kk == 1496)icount=icount+1
      IF(kk == 1497)icount=icount+1
      IF(kk == 1498)icount=icount+1
      IF(kk == 1499)icount=icount+1
      IF(kk == 1500)icount=icount+1
      IF(kk == 1501)icount=icount+1
      IF(kk == 1502)icount=icount+1
      IF(kk == 1503)icount=icount+1
!
      IF(icount == 0)THEN
         WRITE(*,10)bell,svar(i)(1:2)
         STOP
      END IF
!
   END DO
!
!   Loop over the variables to check for repeated tags
!
   DO i=1,nvmax-1
      kk=icnvrt(svar(i)(1:2))
      DO j=i+1,nvmax
         jj=icnvrt(svar(j)(1:2))
         IF(kk == jj)THEN
            IF(kk /= 430)THEN
               WRITE(*,20)bell,svar(i)(1:2)
               STOP
            END IF
         END IF
      END DO
   END DO
!
!  Check the tags for the observed parameters, if any
!
   DO i=1,19
      icount=0
      kk=icnvrt(sobv(i)(1:2))
!
!  tag no, no entry
!
      IF(kk == 430)icount=icount+1
!
!  tag m1, mass of star 1
!
      IF(kk == 1400)icount=icount+1
!
!  tag m2, mass of star 2
!
      IF(kk == 1401)icount=icount+1
!
!  tag r1, radius of star 1
!
      IF(kk == 1560)icount=icount+1
!
!  tag r2, radius of star 2
!
      IF(kk == 1561)icount=icount+1
!
!  tag g1, gravity of star 1
!
      IF(kk == 1208)icount=icount+1
!
!  tag g2, gravity of star 2
!
      IF(kk == 1209)icount=icount+1
!
!  tag k1, K-velocity of star 1
!
      IF(kk == 1336)icount=icount+1
!
!  tag k2, K-velocity of star 2
!
      IF(kk == 1337)icount=icount+1
!
!  tag in, inclination
!
      IF(kk == 269)icount=icount+1
!
!  tag ma, mass ratio
!
      IF(kk == 384)icount=icount+1
!
!  tag ec, eccentricity
!
      IF(kk == 130)icount=icount+1
!
!  tag ar, argument of periastron
!
      IF(kk == 17)icount=icount+1
!
!  tag T1, Teff1
!
      IF(kk == 1624)icount=icount+1
!
!  tag T2, Teff2
!
      IF(kk == 1625)icount=icount+1
!
!  tag T3, Teff3
!
      IF(kk == 1626)icount=icount+1
!
!  tag su, frac1+frac2
!
      IF(kk == 596)icount=icount+1
!
!  tag v1, Vrot for star 1
!
      IF(kk == 1688)icount=icount+1
!
!  tag v2, Vrot for star 2
!
      IF(kk == 1689)icount=icount+1
!
!  tag xe, duration of X-ray eclipse
!
      IF(kk == 740)icount=icount+1
!
!  tag di, disk fraction in band iRVfilt
!
      IF(kk == 104)icount=icount+1
!
!  tags d1 to d8, disk fractions
!
      IF((kk >= 1112).AND.(kk <= 1119))icount=icount+1
!
!  tags z1 to z8, disk fractions
!
      IF((kk >= 1816).AND.(kk <= 1823))icount=icount+1
!
!  tag 12, flux ratio 2-1, band 1
!
      IF(kk == 4529)icount=icount+1
!
!  tag 22, flux ratio 2-1, band 2
!
      IF(kk == 4561)icount=icount+1
!
!  tag 32, flux ratio 2-1, band 3
!
      IF(kk == 4593)icount=icount+1
!
!  tag 42, flux ratio 2-1, band 4
!
      IF(kk == 4625)icount=icount+1
!
!  tag 52, flux ratio 2-1, band 5
!
      IF(kk == 4657)icount=icount+1
!
!  tag 62, flux ratio 2-1, band 6
!
      IF(kk == 4689)icount=icount+1
!
!  tag 72, flux ratio 2-1, band 7
!
      IF(kk == 4721)icount=icount+1
!
!  tag 82, flux ratio 2-1, band 8
!
      IF(kk == 4753)icount=icount+1
!
!  tag 1z, flux ratio 2-1 upper limit,  band 1
!
      IF(kk == 3537)icount=icount+1
!
!  tag 2z, flux ratio 2-1 upper limit,  band 2
!
      IF(kk == 3569)icount=icount+1
!
!  tag 3z, flux ratio 2-1 upper limit,  band 3
!
      IF(kk == 3601)icount=icount+1
!
!  tag 4z, flux ratio 2-1 upper limit,  band 4
!
      IF(kk == 3633)icount=icount+1
!
!  tag 5z, flux ratio 2-1 upper limit,  band 5
!
      IF(kk == 3665)icount=icount+1
!
!  tag 6z, flux ratio 2-1 upper limit,  band 6
!
      IF(kk == 3697)icount=icount+1
!
!  tag 7z, flux ratio 2-1 upper limit,  band 7
!
      IF(kk == 3729)icount=icount+1
!
!  tag 8z, flux ratio 2-1 upper limit,  band 8
!
      IF(kk == 3761)icount=icount+1
!
!  tag lr, flux ratio 2-1, band iRVfilt
!
      IF(kk == 369)icount=icount+1
!
!  tag l3, flux ratio 3-1, band iRVfilt
!
      IF(kk == 1370)icount=icount+1
!
!  tag l4, flux ratio 4-1, band iRVfilt
!
      IF(kk == 1371)icount=icount+1
!
      IF(icount == 0)THEN
         WRITE(*,30)bell,sobv(i)(1:2)
         STOP
      END IF

   END DO
!
!   Loop over the variables to check for repeated tags
!
   DO i=1,18
      kk=icnvrt(sobv(i)(1:2))
      DO j=i+1,19
         jj=icnvrt(sobv(j)(1:2))
         IF(kk == jj)THEN
            IF(kk /= 430)THEN
               WRITE(*,40)bell,sobv(i)(1:2)
               STOP
            END IF
         END IF
      END DO
   END DO
!
10 FORMAT(a1,'Error: unknown fitting parameter tag ',a2)
20 FORMAT(a1,'Error: redundant fitting parameter tag ',a2)
30 FORMAT(a1,'Error: unknown observed parameter tag ',a2)
40 FORMAT(a1,'Error: redundant observed parameter tag ',a2)
!
   RETURN
!
END SUBROUTINE checktags
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE chiline(iter,chiall,ochidisk,icnu,icnb,icnv,icnr,  &
   icni,icnj,icnh,icnk,icnrv1,icnrv2,chiu,chib,chiv,chir,chii,  &
   chij,chih,chik,chirv1,chirv2,nobv,sobv,obv,eobv,obsparm,  &
   ochilr,icnarr,chitimearr,icnrv3,icnrv4,chirv3,chirv4,  &
   ochilr3,ochilr4,ifixgamma,chirv1arr,chirv2arr,  &
   chirv3arr,chirv4arr,chirv5arr,icnrv1arr,icnrv2arr,  &
   icnrv3arr,icnrv4arr,icnrv5arr,ochilumrat,irecord)
!
!   November 15, 1999
!
!   Here is a new subroutine that will write the chi^2 values in a
!   single line
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: iter
   REAL(KIND=dp), INTENT(IN)                :: chiall
   REAL(KIND=dp), INTENT(IN)                :: ochidisk(8)
   INTEGER, INTENT(IN)                      :: icnu
   INTEGER, INTENT(IN)                      :: icnb
   INTEGER, INTENT(IN)                      :: icnv
   INTEGER, INTENT(IN)                      :: icnr
   INTEGER, INTENT(IN)                      :: icni
   INTEGER, INTENT(IN)                      :: icnj
   INTEGER, INTENT(IN)                      :: icnh
   INTEGER, INTENT(IN)                      :: icnk
   INTEGER, INTENT(IN)                      :: icnrv1
   INTEGER, INTENT(IN)                      :: icnrv2
   REAL(KIND=dp), INTENT(IN)                :: chiu
   REAL(KIND=dp), INTENT(IN)                :: chib
   REAL(KIND=dp), INTENT(IN)                :: chiv
   REAL(KIND=dp), INTENT(IN)                :: chir
   REAL(KIND=dp), INTENT(IN)                :: chii
   REAL(KIND=dp), INTENT(IN)                :: chij
   REAL(KIND=dp), INTENT(IN)                :: chih
   REAL(KIND=dp), INTENT(IN)                :: chik
   REAL(KIND=dp), INTENT(IN)                :: chirv1
   REAL(KIND=dp), INTENT(IN)                :: chirv2
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER(LEN=40), INTENT(IN)            :: sobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obv(25)
   REAL(KIND=dp), INTENT(IN)                :: eobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obsparm(25)
   REAL(KIND=dp), INTENT(IN)                :: ochilr
   INTEGER, INTENT(IN)                      :: icnarr(36)
   REAL(KIND=dp), INTENT(IN)                :: chitimearr(36)
   INTEGER, INTENT(IN)                      :: icnrv3
   INTEGER, INTENT(IN)                      :: icnrv4
   REAL(KIND=dp), INTENT(IN)                :: chirv3
   REAL(KIND=dp), INTENT(IN)                :: chirv4
   REAL(KIND=dp), INTENT(IN)                :: ochilr3
   REAL(KIND=dp), INTENT(IN)                :: ochilr4
   INTEGER, INTENT(IN)                      :: ifixgamma
   REAL(KIND=dp), INTENT(IN)                :: chirv1arr(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv2arr(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv3arr(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv4arr(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv5arr(5)
   INTEGER, INTENT(IN)                      :: icnrv1arr(5)
   INTEGER, INTENT(IN)                      :: icnrv2arr(5)
   INTEGER, INTENT(IN)                      :: icnrv3arr(5)
   INTEGER, INTENT(IN)                      :: icnrv4arr(5)
   INTEGER, INTENT(IN)                      :: icnrv5arr(5)
   REAL(KIND=dp), INTENT(IN)                :: ochilumrat(8)
   INTEGER, INTENT(IN)                      :: irecord
!
   REAL(KIND=dp)  :: cccc,chisq,ccc
!
   INTEGER :: icn,icnvrt,INDEX,j,iline,i
!
   CHARACTER(LEN=16) :: section(56)
   CHARACTER(LEN=1700) :: line
!
!   COMMON /medblock/ rmed
!
   iline=1
!
   DO  i=1,10
      section(i)='123456789012345'
      section(i)='               '
   END DO
   line='  -->'
!
!  check to see which light curve bands and RV curves were fit, and add
!  the chi^2 values to the string.
!
   cccc=chiall
   IF(cccc > 9999999999.0_dp)cccc=9999999999.0_dp
   WRITE(section(1),60)cccc
   IF(icnu /= 430)THEN
      iline=iline+1
      cccc=chiu
      IF(cccc > 9999999999.0_dp)cccc=9999999999.0_dp
      WRITE(section(iline),60)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnb /= 430)THEN
      iline=iline+1
      cccc=chib
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnv /= 430)THEN
      iline=iline+1
      cccc=chiv
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnr /= 430)THEN
      iline=iline+1
      cccc=chir
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icni /= 430)THEN
      iline=iline+1
      cccc=chii
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnj /= 430)THEN
      iline=iline+1
      cccc=chij
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnh /= 430)THEN
      iline=iline+1
      cccc=chih
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
   IF(icnk /= 430)THEN
      iline=iline+1
      cccc=chik
      IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
      WRITE(section(iline),70)cccc
      line=TRIM(line)//section(iline)
   END IF
!
!  If ifixgamma is 0, 1, or 2, we have at most
!  one chi^2 value per star.  If ifixgamma is 10, 11,
!  or 12, then we could have up to 5 chi^2 values
!  per star.
!
   IF(ifixgamma < 10)THEN
      IF(icnrv1 /= 430)THEN
         iline=iline+1
         cccc=chirv1
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv2 /= 430)THEN
         iline=iline+1
         cccc=chirv2
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv3 /= 430)THEN
         iline=iline+1
         cccc=chirv3
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv4 /= 430)THEN
         iline=iline+1
         cccc=chirv4
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
   END IF
!
   IF(ifixgamma >= 10)THEN
!
!   Star 1 chi^2 values
!
      IF(icnrv1arr(1) /= 430)THEN
         iline=iline+1
         cccc=chirv1arr(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv1arr(2) /= 430)THEN
         iline=iline+1
         cccc=chirv1arr(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv1arr(3) /= 430)THEN
         iline=iline+1
         cccc=chirv1arr(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv1arr(4) /= 430)THEN
         iline=iline+1
         cccc=chirv1arr(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv1arr(5) /= 430)THEN
         iline=iline+1
         cccc=chirv1arr(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
!
!   Star 2 chi^2 values
!
      IF(icnrv2arr(1) /= 430)THEN
         iline=iline+1
         cccc=chirv2arr(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv2arr(2) /= 430)THEN
         iline=iline+1
         cccc=chirv2arr(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv2arr(3) /= 430)THEN
         iline=iline+1
         cccc=chirv2arr(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv2arr(4) /= 430)THEN
         iline=iline+1
         cccc=chirv2arr(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv2arr(5) /= 430)THEN
         iline=iline+1
         cccc=chirv2arr(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
!
!   Star 3 chi^2 values
!
      IF(icnrv3arr(1) /= 430)THEN
         iline=iline+1
         cccc=chirv3arr(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv3arr(2) /= 430)THEN
         iline=iline+1
         cccc=chirv3arr(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv3arr(3) /= 430)THEN
         iline=iline+1
         cccc=chirv3arr(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv3arr(4) /= 430)THEN
         iline=iline+1
         cccc=chirv3arr(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv3arr(5) /= 430)THEN
         iline=iline+1
         cccc=chirv3arr(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
!
!   Star 4 chi^2 values
!
      IF(icnrv4arr(1) /= 430)THEN
         iline=iline+1
         cccc=chirv4arr(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv4arr(2) /= 430)THEN
         iline=iline+1
         cccc=chirv4arr(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv4arr(3) /= 430)THEN
         iline=iline+1
         cccc=chirv4arr(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv4arr(4) /= 430)THEN
         iline=iline+1
         cccc=chirv4arr(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv4arr(5) /= 430)THEN
         iline=iline+1
         cccc=chirv4arr(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
!
!   Star 5 chi^2 values
!
      IF(icnrv5arr(1) /= 430)THEN
         iline=iline+1
         cccc=chirv5arr(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv5arr(2) /= 430)THEN
         iline=iline+1
         cccc=chirv5arr(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv5arr(3) /= 430)THEN
         iline=iline+1
         cccc=chirv5arr(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv5arr(4) /= 430)THEN
         iline=iline+1
         cccc=chirv5arr(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
      IF(icnrv5arr(5) /= 430)THEN
         iline=iline+1
         cccc=chirv5arr(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         line=TRIM(line)//section(iline)
      END IF
!
   END IF
   IF(nobv == 0)GO TO 55
!
   DO  i=1,nobv
      icn=icnvrt(sobv(i)(1:2))
!
!   Put an escape if one of the variables is not valid.
!
      INDEX=-1
!
!  tag m1, mass of star 1 in solar masses
!
      IF(icn == 1400)INDEX=1
!
!  tag m2, mass of star 2 in solar masses
!
      IF(icn == 1401)INDEX=5
!
!  tag r1, radius of star 1 in solar radii
!
      IF(icn == 1560)INDEX=2
!
!  tag r2, radius of star 2 in solar radii
!
      IF(icn == 1561)INDEX=6
!
!  tag g1, gravity of star 1 (log(g) in cgs)
!
      IF(icn == 1208)INDEX=3
!
!  tag k1, K-velocity of star 1 in km/sec
!
      IF(icn == 1336)INDEX=10
!
!  tag k2, K-velocity of star 2 in km/sec
!
      IF(icn == 1337)INDEX=11
!
!  tag in, inclination of binary in degrees
!
      IF(icn == 269)INDEX=12
!
!  tag ma, mass ratio of binary
!
      IF(icn == 384)INDEX=13
!
!  tag ec, eccentricity of binary
!
      IF(icn == 130)INDEX=14
!
!  tag ar, argument of periastron of binary
!
      IF(icn == 17)INDEX=15
!
!  tag t1, Teff1, effective temperature of star 1
!
      IF(icn == 1624)INDEX=16
!
!  tag t2, Teff2, effective temperature of star 2
!
      IF(icn == 1625)INDEX=17
!
!  tag t3, Teff3, effective temperature of star 3
!
      IF(icn == 1626)INDEX=19
!
!   tag su, the fractional sum of radii
!
      IF(icn == 596)INDEX=18
!
!  tag g2, gravity of star 2 (log(g) in cgs)
!
      IF(icn == 1209)INDEX=7
!
!  tag v1, Vrot1, rotational velocity of star 1 in km/sec
!
      IF(icn == 1688)INDEX=4
!
!  tag v2, Vrot2, rotational velocity of star 2 in km/sec
!
      IF(icn == 1689)INDEX=8
!
!  tag xe, the duration of the X-ray eclipse in degrees of phase
!
      IF(icn == 740)INDEX=9
!
!   Here is the escape.
!
      IF(INDEX < 0)CYCLE
!
!   There are two changes.  First, if the variable rmed > 1,
!   then we are doing median fitting.  chisq becomes the absolute
!   deviation.
!   Second, if the observed duration of the X-ray eclipse is negative,
!   then the number is meant as an upper limit.  That is, if
!   obv = -10.0, then the eclipse duration is less than 10 degrees.
!
      IF(INDEX == 9)THEN
         IF(obv(i) < 0.0_dp)THEN
!
!   Here is the case where the upper limit is less than the computed
!   eclipse duration.
!
            IF(ABS(obv(i)) > obsparm(INDEX))THEN
               chisq=0.0_dp
               iline=iline+1
               GO TO 20
            ELSE
               IF(rmed >= 1.0_dp)THEN
                  chisq=ABS((ABS(obv(i))-obsparm(INDEX))/(eobv(i)))
               ELSE
                  chisq=(ABS(obv(i))-obsparm(INDEX))*(ABS(obv(i))-  &
                     obsparm(INDEX))/(eobv(i)*eobv(i))
               END IF
               iline=iline+1
               GO TO 20
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               chisq=ABS((ABS(obv(i))-obsparm(INDEX))/(eobv(i)))
            ELSE
               chisq=(ABS(obv(i))-obsparm(INDEX))*(ABS(obv(i))-  &
                  obsparm(INDEX))/(eobv(i)*eobv(i))
            END IF
            iline=iline+1
            GO TO 20
         END IF
      END IF
      IF(rmed >= 1.0_dp)THEN
         chisq=ABS((obv(i)-obsparm(INDEX))/(eobv(i)))
      ELSE
         chisq=(obv(i)-obsparm(INDEX))*(obv(i)-obsparm(INDEX))/ (eobv(i)*eobv(i))
      END IF
      iline=iline+1
!
20    IF(chisq > 9999999.0_dp)chisq=9999999.0_dp
      IF(INDEX == 1)WRITE(section(iline),70)chisq
      IF(INDEX == 2)WRITE(section(iline),70)chisq
      IF(INDEX == 3)WRITE(section(iline),70)chisq
      IF(INDEX == 4)WRITE(section(iline),70)chisq
      IF(INDEX == 5)WRITE(section(iline),70)chisq
      IF(INDEX == 6)WRITE(section(iline),70)chisq
      IF(INDEX == 7)WRITE(section(iline),70)chisq
      IF(INDEX == 8)WRITE(section(iline),70)chisq
      IF(INDEX == 10)WRITE(section(iline),70)chisq
      IF(INDEX == 11)WRITE(section(iline),70)chisq
      IF(INDEX == 12)WRITE(section(iline),70)chisq
      IF(INDEX == 13)WRITE(section(iline),70)chisq
      IF(INDEX == 14)WRITE(section(iline),70)chisq
      IF(INDEX == 15)WRITE(section(iline),70)chisq
      IF(INDEX == 16)WRITE(section(iline),70)chisq
      IF(INDEX == 17)WRITE(section(iline),70)chisq
      IF(INDEX == 18)WRITE(section(iline),70)chisq
      IF(INDEX == 19)WRITE(section(iline),70)chisq
      IF(INDEX == 9)WRITE(section(iline),70)chisq
      line=TRIM(line)//section(iline)
   END DO
!
!  now write disk fractions
!
   DO  i=1,nobv
      icn=icnvrt(sobv(i)(1:2))
!
!  tag d1, disk fraction band 1, or tag
!  z1, upper limit
!
      IF(icn == 1112.OR.icn == 1816)THEN
         iline=iline+1
         cccc=ochidisk(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d2, disk fraction band 2, or tag
!  z2, upper limit
!
      IF(icn == 1113.OR.icn == 1817)THEN
         iline=iline+1
         cccc=ochidisk(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d3, disk fraction band 3, or tag
!  z3, upper limit
!
      IF(icn == 1114.OR.icn == 1818)THEN
         iline=iline+1
         cccc=ochidisk(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d4, disk fraction band 4, or tag
!  z4, upper limit
!
      IF(icn == 1115.OR.icn == 1819)THEN
         iline=iline+1
         cccc=ochidisk(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d5, disk fraction band 5, or tag
!  z5, upper limit
!
      IF(icn == 1116.OR.icn == 1820)THEN
         iline=iline+1
         cccc=ochidisk(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d6, disk fraction band 6, or tag
!  z6, upper limit
!
      IF(icn == 1117.OR.icn == 1821)THEN
         iline=iline+1
         cccc=ochidisk(6)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d7, disk fraction band 7, or tag
!  z7, upper limit
!
      IF(icn == 1118.OR.icn == 1822)THEN
         iline=iline+1
         cccc=ochidisk(7)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag d8, disk fraction band 8, or tag
!  z8, upper limit
!
      IF(icn == 1119.OR.icn == 1823)THEN
         iline=iline+1
         cccc=ochidisk(8)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
      line=TRIM(line)//section(iline)
   END DO
!
!  now write luminosity ratios
!
   DO  i=1,nobv
      icn=icnvrt(sobv(i)(1:2))
!
!  tag lr, secondary to primary luminosity ratio
!
      IF(icn == 369)THEN
         iline=iline+1
         cccc=ochilr
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag l3, body 4 to primary luminosity ratio
!
      IF(icn == 1370)THEN
         iline=iline+1
         cccc=ochilr3
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag l4, body 4 to primary luminosity ratio
!
      IF(icn == 1371)THEN
         iline=iline+1
         cccc=ochilr4
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 12, U-band luminosity ratio (star 2 to star 1)
!  or tag 1u, upper limit
!
      IF(icn == 4529.OR.icn == 3532)THEN
         iline=iline+1
         cccc=ochilumrat(1)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 22, B-band luminosity ratio (star 2 to star 1)
!  or tag 2u, upper limit
!
      IF(icn == 4561.OR.icn == 3564)THEN
         iline=iline+1
         cccc=ochilumrat(2)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 32, V-band luminosity ratio (star 2 to star 1)
!  or tag 3u, upper limit
!
      IF(icn == 4593.OR.icn == 3596)THEN
         iline=iline+1
         cccc=ochilumrat(3)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 42, V-band luminosity ratio (star 2 to star 1)
!  or tag 4u, upper limit
!
      IF(icn == 4625.OR.icn == 3628)THEN
         iline=iline+1
         cccc=ochilumrat(4)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 52, V-band luminosity ratio (star 2 to star 1)
!  or tag 5u, upper limit
!
      IF(icn == 4657.OR.icn == 3660)THEN
         iline=iline+1
         cccc=ochilumrat(5)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 62, V-band luminosity ratio (star 2 to star 1)
!  or tag 6u, upper limit
!
      IF(icn == 4689.OR.icn == 3692)THEN
         iline=iline+1
         cccc=ochilumrat(6)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 72, V-band luminosity ratio (star 2 to star 1)
!  or tag 7u, upper limit
!
      IF(icn == 4721.OR.icn == 3724)THEN
         iline=iline+1
         cccc=ochilumrat(7)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
!  tag 82, V-band luminosity ratio (star 2 to star 1)
!  or tag 7u, upper limit
!
      IF(icn == 4753.OR.icn == 3756)THEN
         iline=iline+1
         cccc=ochilumrat(8)
         IF(cccc > 9999999.0_dp)cccc=9999999.0_dp
         WRITE(section(iline),70)cccc
         CYCLE
      END IF
!
      line=TRIM(line)//section(iline)
   END DO
!
!  tack on the chi^2 for the eclipse times, if any
!
55 DO i=1,36
      IF(icnarr(i) /= 430)THEN
         iline=iline+1
         ccc=chitimearr(i)
         IF(ccc > 9999999999.0_dp)ccc=9999999999.0_dp
         WRITE(section(iline),60)ccc
         line=TRIM(line)//section(iline)
      END IF
   END DO
!
   IF(irecord == 0)WRITE(55,80)iter,(section(j),j=1,iline)
!
   IF(irecord > 0)THEN
      OPEN(UNIT=84,FILE='ELCbestchi',STATUS='unknown')
      WRITE(84,90)(section(j),j=1,iline)
      CLOSE(84)
   END IF
!
60 FORMAT(' ',f15.4)
70 FORMAT(' ',f12.4)
80 FORMAT(i6,1X,56(a16))
90 FORMAT(56(a16))
!
   RETURN
!
END SUBROUTINE chiline
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE chistring(instring,chisq,outstring,ilength)
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER(LEN=*), INTENT(IN)             :: instring
   REAL(KIND=dp), INTENT(IN)                :: chisq
   CHARACTER (LEN=*), INTENT(OUT)           :: outstring
   INTEGER, INTENT(OUT)                     :: ilength
!
   REAL(KIND=dp)  :: tempchi
!
   outstring=' '
   ilength=0
!
   IF(chisq < 1.0_dp)THEN
      WRITE(outstring,10)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 10.0_dp)THEN
      WRITE(outstring,10)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 100.0_dp)THEN
      WRITE(outstring,20)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 1000.0_dp)THEN
      WRITE(outstring,30)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 10000.0_dp)THEN
      WRITE(outstring,40)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 100000.0_dp)THEN
      WRITE(outstring,50)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 1000000.0_dp)THEN
      WRITE(outstring,60)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 10000000.0_dp)THEN
      WRITE(outstring,70)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 100000000.0_dp)THEN
      WRITE(outstring,80)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 1000000000.0_dp)THEN
      WRITE(outstring,90)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 10000000000.0_dp)THEN
      WRITE(outstring,100)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   IF(chisq < 100000000000.0_dp)THEN
      WRITE(outstring,110)instring,chisq
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
   tempchi=999999999999.99_dp
   WRITE(outstring,120)instring,tempchi
   ilength=LEN_TRIM(outstring)
!
10 FORMAT(a,'=',f8.6)
20 FORMAT(a,'=',f10.7)
30 FORMAT(a,'=',f11.7)
40 FORMAT(a,'=',f12.7)
50 FORMAT(a,'=',f14.8)
60 FORMAT(a,'=',f15.8)
70 FORMAT(a,'=',f12.4)
80 FORMAT(a,'=',f13.4)
90 FORMAT(a,'=',f14.4)
100 FORMAT(a,'=',f13.2)
110 FORMAT(a,'=',f14.2)
120 FORMAT(a,'=',f15.2)
!
   RETURN
!
END SUBROUTINE chistring
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE cholfac(nvar,cholc,cholb)
!
!   Computes the Cholesky factorization of the
!   input matrix CholC (Nvar by Nvar).
!
   USE accur

   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvar
   REAL(KIND=dp), INTENT(IN)                :: cholc(nvar,nvar)
   REAL(KIND=dp), INTENT(OUT)               :: cholb(nvar,nvar)
!
   REAL(KIND=dp)  :: ll(100,100),sum1,sum2
!
   INTEGER :: i,j, k
!
!   initialize the LL matrix
!
   DO i=1,100
      DO j=1,100
         ll(i,j)=0.0_dp
      END DO
   END DO
   ll(1,1)=SQRT(cholc(1,1))
   DO i=2,nvar
      ll(i,1)=cholc(i,1)/ll(1,1)
   END DO
!
   DO i=1,nvar
      DO k=1,i
         sum1=0.0_dp
         sum2=0.0_dp
         DO j=1,k-1
            IF(i == k)THEN
               sum1=sum1+(ll(k,j)*ll(k,j))
               ll(k,k)=(SQRT(cholc(k,k)-sum1))
            ELSE IF(i > k)THEN
               sum2=sum2+(ll(i,j)*ll(k,j))
               ll(i,k)=(1/ll(k,k))*(cholc(i,k)-sum2)
            ELSE
               ll(i,k)=0
            END IF
         END DO
      END DO
   END DO
!
   DO i=1,nvar
      DO j=1,nvar
         cholb(i,j)=ll(j,i)
      END DO
   END DO
!
   RETURN
!
END SUBROUTINE cholfac
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE cholsolve(n,bb,xx,cholc)
!
!  solves the linear equation C'CX=B
!  C is the n by n upper triangular Choleski
!  factor.  B and X are arrays of length n.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN)                :: bb(100)
   REAL(KIND=dp), INTENT(OUT)               :: xx(100)
   REAL(KIND=dp), INTENT(IN)                :: cholc(100,100)
!
   REAL(KIND=dp), DIMENSION(100) ::  yy
   REAL(KIND=dp)                 ::  fac
!
   INTEGER :: i,k
!
!  forward substitution
!
   DO i=1,n
      xx(i)=0.0_dp
      yy(i)=0.0_dp
   END DO
!
   yy(1)=bb(1)/cholc(1,1)
   DO k=2,n
      fac=0.0_dp
      DO i=1,k-1
         fac=fac+cholc(i,k)*yy(i)
      END DO
      yy(k)=(bb(k)-fac)/cholc(k,k)
   END DO
!
!  backwards substitution
!
   xx(n)=yy(n)/cholc(n,n)
   DO k=n-1,1,-1
      fac=0.0_dp
      DO i=k+1,n
         fac=fac+cholc(k,i)*xx(i)
      END DO
      xx(k)=(yy(k)-fac)/cholc(k,k)
   END DO
!
   RETURN
!
END SUBROUTINE cholsolve
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE countdata(ifixgamma,ilarge)
!
!   Gives the length of the longest dat afile
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ifixgamma
   INTEGER, INTENT(OUT)                     :: ilarge
!
   INTEGER, PARAMETER :: nvmax=80
!
   REAL(KIND=dp), DIMENSION(19)     :: obv,eobv
   REAL(KIND=dp), DIMENSION(nvmax)  :: var,vstart,vstep
!
   INTEGER :: i,icnvrt,nset,icnrv3,icnrv4,icnrv5
   INTEGER :: nvar,nobv,icnu,icnb,icnv,icnr
   INTEGER :: icni,icnj,icnh,icnk,icnrv1,icnrv2,ndata
!
   INTEGER, DIMENSION(nvmax) :: nstep
!
   CHARACTER(LEN=40) :: sobv(19),rv1file,rv2file,rv3file,rv4file
   CHARACTER(LEN=40) :: udatafile,svar(nvmax),hdatafile,kdatafile
   CHARACTER(LEN=40) :: bdatafile,vdatafile,rdatafile,idatafile
   CHARACTER(LEN=40) :: jdatafile,rv5file
!
   sobv(1)='none'
   sobv(2)='none'
   sobv(3)='none'
   sobv(4)='none'
   sobv(5)='none'
   sobv(6)='none'
   sobv(7)='none'
   sobv(8)='none'
   sobv(9)='none'
   sobv(10)='none'
   sobv(11)='none'
   sobv(12)='none'
   sobv(12)='none'
   sobv(13)='none'
   sobv(14)='none'
   sobv(15)='none'
   sobv(16)='none'
   sobv(17)='none'
   sobv(18)='none'
   sobv(19)='none'
!
!   Initialize the steps.
!
   DO i=1,nvmax
      nstep(i)=1
      var(i)=0.0_dp
      svar(i)='none'
   END DO
!
!   Get the parameters for the grid search.
!
   CALL getloopopt(udatafile,bdatafile,vdatafile,rdatafile,  &
      idatafile,jdatafile,hdatafile,kdatafile,rv1file,rv2file,  &
      nvmax,nvar,svar,var,vstart,vstep,nstep,nobv,sobv,obv,eobv,  &
      rv3file,rv4file,rv5file)
!
!   Figure out which data files were specified.
!
   icnu=icnvrt(udatafile(1:2))
   icnb=icnvrt(bdatafile(1:2))
   icnv=icnvrt(vdatafile(1:2))
   icnr=icnvrt(rdatafile(1:2))
   icni=icnvrt(idatafile(1:2))
   icnj=icnvrt(jdatafile(1:2))
   icnh=icnvrt(hdatafile(1:2))
   icnk=icnvrt(kdatafile(1:2))
   icnrv1=icnvrt(rv1file(1:2))
   icnrv2=icnvrt(rv2file(1:2))
   icnrv3=icnvrt(rv3file(1:2))
   icnrv4=icnvrt(rv4file(1:2))
   icnrv5=icnvrt(rv5file(1:2))
!
!   icn? = 430 indicates that no file was specified.  Load the
!   files listed.
!
   ilarge=-1
   IF(icnu /= 430)THEN
      ndata=0
      CALL datacount(udatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnb /= 430)THEN
      ndata=0
      CALL datacount(bdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnv /= 430)THEN
      ndata=0
      CALL datacount(vdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnr /= 430)THEN
      ndata=0
      CALL datacount(rdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icni /= 430)THEN
      ndata=0
      CALL datacount(idatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnj /= 430)THEN
      ndata=0
      CALL datacount(jdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnh /= 430)THEN
      ndata=0
      CALL datacount(hdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   IF(icnk /= 430)THEN
      ndata=0
      CALL datacount(kdatafile,ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
!   If ifixgamma is 11 or 12, then we have multiple RV data sets.
!   Call the special subroutine to load those data.
!
   nset=0
   IF(ifixgamma < 10)THEN
      IF(icnrv1 /= 430)THEN
         ndata=0
         CALL datacount(rv1file,ndata)
         IF(ndata > ilarge)ilarge=ndata
      END IF
!
      IF(icnrv2 /= 430)THEN
         ndata=0
         CALL datacount(rv2file,ndata)
         IF(ndata > ilarge)ilarge=ndata
      END IF
!
      IF(icnrv3 /= 430)THEN
         ndata=0
         CALL datacount(rv3file,ndata)
         IF(ndata > ilarge)ilarge=ndata
      END IF
!
      IF(icnrv4 /= 430)THEN
         ndata=0
         CALL datacount(rv4file,ndata)
         IF(ndata > ilarge)ilarge=ndata
      END IF
!
   ELSE
      ndata=0
      CALL countrvdata(ndata)
      IF(ndata > ilarge)ilarge=ndata
   END IF
!
   RETURN
!
END SUBROUTINE countdata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE countrvdata(ndatabig)
!
!   If there are multiple observatories for the RV data,
!   they can be given in the optional ELCRVdata.opt.  This
!   subroutine will read that file and count the number of
!   lines in each, and will return the largest value
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(OUT)                     :: ndatabig
!
   REAL(KIND=dp)  :: xrv1array,yrv1array,errrv1array
   REAL(KIND=dp)  :: xrv2array,yrv2array,errrv2array
   REAL(KIND=dp)  :: xrv3array,yrv3array,errrv3array
   REAL(KIND=dp)  :: xrv4array,yrv4array,errrv4array
   REAL(KIND=dp)  :: xrv5array,yrv5array,errrv5array
!
   INTEGER :: nrv1array,icnrv1array,nrv2array
   INTEGER :: icnrv2array,icnvrt,icnrv4array
   INTEGER :: nrv3array,icnrv3array,nrv4array,ndatamax
   INTEGER :: nrv5array,icnrv5array,nset,i,ios,j
!
   CHARACTER(LEN=1) :: bell
   CHARACTER(LEN=50) :: file1,file2,file3,file4,file5
!
   ndatabig=-1
   ndatamax=999999
!
!   DO i=1,5
      nrv1array=0
      nrv2array=0
      nrv3array=0
      nrv4array=0
      nrv5array=0
      icnrv1array=430
      icnrv2array=430
      icnrv3array=430
      icnrv4array=430
      icnrv5array=430
!   END DO
!
   bell=CHAR(7)
!
!   Attempt to open ELCRVdata.opt
!
   ios=0
   OPEN(UNIT=20,FILE='ELCRVdata.opt',STATUS='old',IOSTAT=ios)
   IF(ios /= 0)THEN
      WRITE(*,70)bell
      STOP
   END IF
!
!   Attempt to read the first line, which should be an integer
!   between 1 and 5
!
   ios=0
   READ(20,*,IOSTAT=ios,ERR=120)nset
!
   IF((nset <= 0).OR.(nset > 5))THEN
      WRITE(*,90)bell
      STOP
   END IF
!
!   Loop over Nset, read in files, load data
!
   DO i=1,nset
      ios=0
      READ(20,60,ERR=130,IOSTAT=ios)file1
      READ(20,60,ERR=130,IOSTAT=ios)file2
      READ(20,60,ERR=130,IOSTAT=ios)file3
      READ(20,60,ERR=130,IOSTAT=ios)file4
      READ(20,60,ERR=130,IOSTAT=ios)file5
!
      icnrv1array=icnvrt(file1)
      IF(icnrv1array /= 430)THEN
         OPEN(UNIT=72,FILE=file1,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=10)xrv1array,yrv1array,errrv1array
         END DO
10       CLOSE(72)
         nrv1array=j-1
         IF(nrv1array > ndatabig)ndatabig=nrv1array
      END IF
!
      icnrv2array=icnvrt(file2)
      IF(icnrv2array /= 430)THEN
         OPEN(UNIT=72,FILE=file2,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=20)xrv2array,yrv2array,errrv2array
         END DO
20       CLOSE(72)
         nrv2array=j-1
         IF(nrv2array > ndatabig)ndatabig=nrv2array
      END IF
!
      icnrv3array=icnvrt(file3)
      IF(icnrv3array /= 430)THEN
         OPEN(UNIT=72,FILE=file3,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=30)xrv3array,yrv3array,errrv3array
         END DO
30       CLOSE(72)
         nrv3array=j-1
         IF(nrv3array > ndatabig)ndatabig=nrv3array
      END IF
!
      icnrv4array=icnvrt(file4)
      IF(icnrv4array /= 430)THEN
         OPEN(UNIT=72,FILE=file4,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=40)xrv4array,yrv4array,errrv4array
         END DO
40       CLOSE(72)
         nrv4array=j-1
         IF(nrv4array > ndatabig)ndatabig=nrv4array
      END IF
!
      icnrv5array=icnvrt(file5)
      IF(icnrv5array /= 430)THEN
         OPEN(UNIT=72,FILE=file4,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=50)xrv5array,yrv5array,errrv5array
         END DO
50       CLOSE(72)
         nrv5array=j-1
         IF(nrv5array > ndatabig)ndatabig=nrv5array
      END IF
!
   END DO
!
60 FORMAT(a50)
70 FORMAT(a1,'Error:  ELCRVdata.opt not found')
80 FORMAT(a1,'Error:  First line of ELCRVdata.opt is ','not an i'  &
      ,'nteger')
90 FORMAT(a1,'Error:  Nset should be between 1 and 5')
100 FORMAT(a1,'Error:  Error reading ELCRVdata')
110 FORMAT(a1,'Error reading file ',a50)
!
120 IF(ios /= 0)THEN
      WRITE(*,80)bell
      STOP
   END IF
!
130 IF(ios /= 0)THEN
      WRITE(*,100)bell
      STOP
   END IF
!
140 IF(ios /= 0)THEN
      WRITE(*,110)bell
      STOP
   END IF
!
   RETURN
!
END SUBROUTINE countrvdata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE cross(n,nd,pcross,ign1,ign2)
!
!   Used by geneticELC to cross over genes.
!
   USE accur
   USE medblock
   USE ran_lec
!
   IMPLICIT NONE

   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: nd
   REAL(KIND=dp), INTENT(IN)                :: pcross
   INTEGER, INTENT(IN OUT)                  :: ign1(nd*n)
   INTEGER, INTENT(IN OUT)                  :: ign2(nd*n)
!
   REAL(KIND=dp)  :: urand
!
   INTEGER :: ispl,i,it
!
!   COMMON /ranblock/ idum
!
!!pgi$r opt O1
!
   urand=ran6(idum)
   IF(urand < pcross)THEN
      urand=ran6(idum)
      ispl=INT(urand*REAL(n*nd,KIND=dp))+1
      DO  i=ispl,n*nd
         it=ign2(i)
         ign2(i)=ign1(i)
         ign1(i)=it
      END DO
   END IF
   RETURN
!
END SUBROUTINE cross
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE datacount(filein,ndata)
!
!    This general routine will load a data file and count the
!    number of lines.    It assumes that there
!    are three columns:   phase    flux or RV     error
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER (LEN=40), INTENT(IN)           :: filein
   INTEGER, INTENT(OUT)                     :: ndata
!
   REAL(KIND=dp)  :: xdata,ydata,edata
!
   INTEGER :: ndatamax,i,ios
!
   CHARACTER(LEN=1) :: bell
!
   ndatamax=999999
   bell=CHAR(7)
   ios=0
!
   ndata=0
   OPEN(UNIT=20,FILE=filein,STATUS='old',ERR=30,IOSTAT=ios)
!
   DO i=1,ndatamax
      READ(20,*,END=20)xdata,ydata,edata
   END DO
20 CLOSE(20)
!
   ndata=i-1
!
30 IF(ios /= 0)THEN
      WRITE(*,40)bell,TRIM(filein)
      STOP
   END IF
!
40 FORMAT(a1,'Error:  data file not found (',a,')')
!
   RETURN
!
END SUBROUTINE datacount
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE decode(n,nd,ign,ph)
!
!  Used by geneticELC to decode the genes.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: nd
   INTEGER, INTENT(IN)                      :: ign(n*nd)
   REAL(KIND=dp), INTENT(OUT)               :: ph(n)
!
   REAL(KIND=dp)  :: z
!
   INTEGER :: i,ip,j,ii
!
   z=(10.0_dp)**(-nd)
   ii=0
   DO  i=1,n
      ip=0
      DO  j=1,nd
         ip=10*ip+ign(ii+j)
      END DO
      ph(i)=REAL(ip,KIND=dp)*z
      ii=ii+nd
   END DO
   RETURN
!
END SUBROUTINE decode
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE diskchi(nobv,sobv,obv,eobv,ochidisk,ochi,  &
   compfracs)
!
!   computes the chi^2 values associated with the disk fraction
!   constraints given in gridloop.opt
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
   REAL(KIND=dp), INTENT(IN)                :: obv(19)
   REAL(KIND=dp), INTENT(IN)                :: eobv(19)
   REAL(KIND=dp), INTENT(OUT)               :: ochidisk(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: ochi
   REAL(KIND=dp), INTENT(IN)                :: compfracs(8,3)
!
   REAL(KIND=dp)  :: frac
!
   INTEGER :: i,icn,icnvrt
!
!   UPDATE October 27, 2008
!
!   Make ochidisk have dimension 8.  This will allow the user to fit
!   for the disk fraction in more than 1 band at a time.  Also, put
!   the array compfracs into the argument list above
!
!   COMMON /medblock/ rmed
!
   DO  i=1,8
      ochidisk(i)=0.0_dp
   END DO
!
   DO  i=1,nobv
!
!  UPDATE NOVEMBER 23, 2001
!
!  make the argument sobv(i)(1:2)
!
      icn=icnvrt(sobv(i)(1:2))
!
!  UPDATE May 27, 2002
!
!  If the variable rmed > 1, then define ochidisk to be the absolute
!  deviation, rather than the normal chi^2.
!
!  UPDATE October 27, 2008
!
!  use the tags d1 to d8 to fit for the disk fraction in filter 1, filter 2,
!  etc.  String d1=1112, d2=1113, ... d9=1119
!
!   tag d1
!
      IF(icn == 1112)THEN
         frac=compfracs(1,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(1)=0.0_dp
            ELSE
               ochidisk(1)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(1)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(1)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(1)
      END IF
!
!   tag z1 used, so have the value of obv(i) be an upper limit
!
      IF(icn == 1816)THEN
         frac=compfracs(1,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(1)=0.0_dp
            ELSE
               ochidisk(1)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(1)=0.0_dp
            ELSE
               ochidisk(1)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(1)
      END IF
!
!  tag d2 used
!
      IF(icn == 1113)THEN
         frac=compfracs(2,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(2)=0.0_dp
            ELSE
               ochidisk(2)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(2)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(2)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(2)
      END IF
!
!   tag z2 given, so use the value of obv(i) as an upper limit
!
      IF(icn == 1817)THEN
         frac=compfracs(2,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(2)=0.0_dp
            ELSE
               ochidisk(2)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(2)=0.0_dp
            ELSE
               ochidisk(2)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(2)
      END IF
!
!  tag d3
!
      IF(icn == 1114)THEN
         frac=compfracs(3,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(3)=0.0_dp
            ELSE
               ochidisk(3)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(3)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(3)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(3)
      END IF
!
!  tag z3 given, so use the value of obv(i) as upper limit
!
      IF(icn == 1818)THEN
         frac=compfracs(3,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(3)=0.0_dp
            ELSE
               ochidisk(3)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(3)=0.0_dp
            ELSE
               ochidisk(3)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(3)
      END IF
!
!  tag d4
!
      IF(icn == 1115)THEN
         frac=compfracs(4,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(4)=0.0_dp
            ELSE
               ochidisk(4)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(4)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(4)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(4)
      END IF
!
!  tag z4 used, so use the value of obv(i) as upper limit
!
      IF(icn == 1819)THEN
         frac=compfracs(4,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(4)=0.0_dp
            ELSE
               ochidisk(4)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(4)=0.0_dp
            ELSE
               ochidisk(4)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(4)
      END IF
!
!  tag d5
!
      IF(icn == 1116)THEN
         frac=compfracs(5,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(5)=0.0_dp
            ELSE
               ochidisk(5)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(5)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(5)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(5)
      END IF
!
!   tag z5 given, so use value of obv(i) as upper limit
!
      IF(icn == 1820)THEN
         frac=compfracs(5,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(5)=0.0_dp
            ELSE
               ochidisk(5)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(5)=0.0_dp
            ELSE
               ochidisk(5)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(5)
      END IF
!
!  tag d6
!
      IF(icn == 1117)THEN
         frac=compfracs(6,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(6)=0.0_dp
            ELSE
               ochidisk(6)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(6)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(6)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(6)
      END IF
!
!  tag z6 given, so use the value of obv(i) as upper limit
!
      IF(icn == 1821)THEN
         frac=compfracs(6,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(6)=0.0_dp
            ELSE
               ochidisk(6)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(6)=0.0_dp
            ELSE
               ochidisk(6)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(6)
      END IF
!
!  tag d7
!
      IF(icn == 1118)THEN
         frac=compfracs(7,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(7)=0.0_dp
            ELSE
               ochidisk(7)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(7)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(7)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(7)
      END IF
!
!   tag z7 given, so use the value of obv(i) as upper limit
!
      IF(icn == 1822)THEN
         frac=compfracs(7,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(7)=0.0_dp
            ELSE
               ochidisk(7)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(7)=0.0_dp
            ELSE
               ochidisk(7)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(7)
      END IF
!
!  tag d8
!
      IF(icn == 1119)THEN
         frac=compfracs(8,2)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochidisk(8)=0.0_dp
            ELSE
               ochidisk(8)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochidisk(8)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochidisk(8)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochidisk(8)
      END IF
!
!  tag z8 given, so use the value of obv(i) as upper limit
!
      IF(icn == 1823)THEN
         frac=compfracs(8,2)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochidisk(8)=0.0_dp
            ELSE
               ochidisk(8)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochidisk(8)=0.0_dp
            ELSE
               ochidisk(8)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochidisk(8)
      END IF
!
   END DO
!
   RETURN
!
END SUBROUTINE diskchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE doncholfac(nvar,ccin,ccout)
!
!   Will perform the Cholesky factorization on
!   the input matrix CCin (Nvar x Nvar), using
!   the method from Don Short's code.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvar
   REAL(KIND=dp), INTENT(IN)                :: ccin(100,100)
   REAL(KIND=dp), INTENT(OUT)               :: ccout(100,100)
!
   REAL(KIND=dp), DIMENSION(100,100)  ::  ll
   REAL(KIND=dp)                      ::  fac
!
   INTEGER :: i,j,k
!
!   Initialize
!
   ll(1,1)=SQRT(ccin(1,1))
   DO j=2,nvar
      ll(j,1)=ccin(j,1)/ll(1,1)
   END DO
!
   DO i=2,nvar-1
      fac=0.0_dp
      DO k=1,i-1
         fac=fac+ll(i,k)*ll(i,k)
      END DO
      ll(i,i)=SQRT(ccin(i,i)-fac)
      DO j=i+1,nvar
         fac=0.0_dp
         DO k=1,i-1
            fac=fac+ll(j,k)*ll(i,k)
         END DO
         ll(j,i)=(ccin(j,i)-fac)/ll(i,i)
      END DO
   END DO
   fac=0.0_dp
   DO k=1,nvar-1
      fac=fac+ll(nvar,k)*ll(nvar,k)
   END DO
   ll(nvar,nvar)=SQRT(ccin(nvar,nvar)-fac)
!
   DO i=1,nvar
      DO j=1,nvar
         ccout(i,j)=ll(j,i)
      END DO
   END DO
!
   RETURN
!
END SUBROUTINE doncholfac
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE encode(n,nd,ph,ign)
!
!  Used by geneticELC to encode genes.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: nd
   REAL(KIND=dp), INTENT(IN)                :: ph(n)
   INTEGER, INTENT(OUT)                     :: ign(nd*n)
!
   INTEGER :: i,ip,ii,j
!
   REAL(KIND=dp)  ::  z

!
   z=(10.0_dp)**nd
   ii=0
!
!!pgi$r opt O1
!
   DO  i=1,n
      ip=INT(ph(i)*z)
      DO  j=nd,1,-1
         ign(ii+j)=MOD(ip,10)
         ip=ip/10
      END DO
      ii=ii+nd
   END DO
   RETURN
!
END SUBROUTINE encode
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE evalfit(islc,nmodel,xmodel,yinput,ndata,xdata,  &
   INDEX,yout,bestoff)
!
!   This routine will return the value of the model at a specific
!   datapoint
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: islc
   INTEGER, INTENT(IN)                      :: nmodel
   REAL(KIND=dp), INTENT(IN)                :: xmodel(nmodel)
   REAL(KIND=dp), INTENT(IN)                :: yinput(nmodel)
   INTEGER, INTENT(IN)                      :: ndata
   REAL(KIND=dp), INTENT(IN)                :: xdata(ndata)
   INTEGER, INTENT(IN)                      :: INDEX
   REAL(KIND=dp), INTENT(OUT)               :: yout
   REAL(KIND=dp), INTENT(IN OUT)            :: bestoff
!
   REAL(KIND=dp), DIMENSION(ndata)  :: yinter,ydummy
   REAL(KIND=dp), DIMENSION(nmodel) :: y2,ymodel
!
   REAL(KIND=dp)                    :: qqq   
!
   INTEGER :: i
!
   DO  i=1,nmodel
      IF(islc > 0)THEN
!
!  Check to see that the argument of log10 is positive.
!
         IF(yinput(i) > 0.0_dp)THEN
            ymodel(i)=-2.5_dp*LOG10(yinput(i))
         ELSE
            ymodel(i)=-99.9_dp
         END IF
      ELSE
         ymodel(i)=yinput(i)
      END IF
   END DO
!
   CALL spline(xmodel,ymodel,nmodel,0.0_dp,0.0_dp,y2)
!
   DO  i=1,ndata
      CALL splint(xmodel,ymodel,y2,nmodel,xdata(i),qqq)
      yinter(i)=qqq
   END DO
!
   CALL offset(ndata,yinter,ydummy,bestoff)
!
   yout=ydummy(INDEX)
!
   RETURN
!
END SUBROUTINE evalfit
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE findellipsoid(nvar,nlive,points,centroid,cholb,  &
   volbe,volexpect,volactual)
!
!   Will take a matrix of models (Nlive,Nvar) from a unit
!   hypersphere and find the bounding ellipsoid
!
   USE accur
   USE getpie
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvar
   INTEGER, INTENT(IN)                      :: nlive
   REAL(KIND=dp), INTENT(IN)                :: points(9999,100)
   REAL(KIND=dp), INTENT(OUT)               :: centroid(100)
   REAL(KIND=dp), INTENT(OUT)               :: cholb(100,100)
   REAL(KIND=dp), INTENT(OUT)               :: volbe
   REAL(KIND=dp), INTENT(IN)                :: volexpect
   REAL(KIND=dp), INTENT(OUT)               :: volactual
!
   REAL(KIND=dp)  :: pointstran(100,9999),cc(100,100),f
   REAL(KIND=dp)  :: cholc(100,100),detcholc,fmax,bb(100),xx(100)
   REAL(KIND=dp)  :: bounding(100,100),volconst
   REAL(KIND=dp)  :: cctemp(100,100),gamma_log
   REAL(KIND=dp)  :: copypoints(9999,100),fv
!
   INTEGER :: i,j,k,lll,ll3
!
   CHARACTER(LEN=50) :: outstring,outstring3
!
!   CALL getpie(pie,twopie,halfpie,degtorad,radtodeg)
!
!   initialize
!
   detcholc=1.0_dp
   DO i=1,100
      centroid(i)=0.0_dp
      DO j=1,100
         cctemp(i,j)=0.0_dp
      END DO
   END DO
!
   DO i=1,nlive
      DO j=1,nvar
         copypoints(i,j)=points(i,j)
      END DO
   END DO
!
!   find the centroid along each dimension
!
   DO j=1,nvar
      DO i=1,nlive
         centroid(j)=centroid(j)+copypoints(i,j)
      END DO
   END DO
!
!   offset the points by the centroid
!
   DO j=1,nvar
      centroid(j)=centroid(j)/REAL(nlive,KIND=dp)
      DO i=1,nlive
         copypoints(i,j)=copypoints(i,j)-centroid(j)
      END DO
   END DO
!
!   find the transpose of the points matrix
!
   DO i=1,nlive
      DO j=1,nvar
         pointstran(j,i)=copypoints(i,j)
      END DO
   END DO
!
!   multiply the points matrix by the transpose to construct
!   the 'C' matrix
!
   DO j=1,nvar
      DO k=1,nlive
         DO i=1,nvar
            cctemp(i,j)=cctemp(i,j)+pointstran(i,k)*copypoints(k,j)
         END DO
      END DO
   END DO
!
!   Scale the C matrix by the number of points minus 1
!
   DO i=1,nvar
      DO j=1,nvar
         cc(i,j)=cctemp(i,j)/REAL(nlive-1,KIND=dp)
      END DO
   END DO
!
!   Find the Cholesky factorization of the C matrix.
!
   CALL doncholfac(nvar,cc,cholc)
!
!   Find the determinite
!
   DO i=1,nvar
      detcholc=detcholc*cholc(i,i)
   END DO
!
   fmax=0.0_dp
!
!   Find the distance of the farthest point, which will be
!   used to define the edge of the bounding ellipsoid
!
   DO i=1,nlive
      DO j=1,nvar
         bb(j)=pointstran(j,i)
      END DO
      CALL cholsolve(nvar,bb,xx,cholc)
      f=0.0_dp
      DO j=1,nvar
         f=f+copypoints(i,j)*xx(j)
      END DO
      IF(f > fmax)fmax=f
   END DO
!
!   The bounding ellipsoid is the C matrix times the scale
!   factor
!
   DO i=1,nvar
      DO j=1,nvar
         bounding(i,j)=fmax*cc(i,j)
      END DO
   END DO
!
!   Find the volume of the ellipsoid, and scale it if needed.
!
   volconst=pie**(REAL(nvar,KIND=dp)/2.0_dp)/EXP(gamma_log(REAL(nvar,KIND=dp)/2.0_dp+1.0_dp))
   volbe=volconst*fmax**(REAL(nvar,KIND=dp)/2.0_dp)*detcholc
   volactual=volbe
   CALL pspacestring('Actual volume',12,volbe,outstring,lll)
   CALL pspacestring('expected volume',12,volexpect,outstring3,ll3)
   WRITE(*,10)outstring(1:lll),outstring3(1:ll3)
!
!   Rescale the ellipsoid if needed.
!
   fv=1.0_dp
   IF(volbe < volexpect)THEN
      fv=(volexpect/volbe)**(2.0_dp/REAL(nvar,KIND=dp))
      DO i=1,nvar
         DO j=1,nvar
            bounding(i,j)=fv*bounding(i,j)
         END DO
      END DO
      volbe=volexpect
   END IF
!
!   Find the Cholesky factorization of the bounding ellipsoid.
!
!          CALL doncholfac(Nvar,bounding,CholB)
!
   DO i=1,nvar
      DO j=1,nvar
         cholb(i,j)=SQRT(fmax*fv)*cholc(i,j)
      END DO
   END DO

   RETURN
!
10 FORMAT('Recomputing ellipsoid:',1X,a,',',1X,a,'.')
!
END SUBROUTINE findellipsoid
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE gaperrorlc(ifilter,time,datafile,idata,igap)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)             :: ifilter
   REAL(KIND=dp), INTENT(IN)       :: time
   CHARACTER (LEN=40), INTENT(IN)  :: datafile
   INTEGER, INTENT(IN)             :: idata
   INTEGER, INTENT(IN)             :: igap
!
   INTEGER   :: ilength1,ilength2,ilength3
!
   CHARACTER(LEN=40)  :: outstring1,outstring2,outstring3
!
   CALL istringnoequals('line ',idata,outstring1,ilength1)
   CALL pstring('time',5,time,outstring2,ilength2)
   CALL istringnoequals('#',igap,outstring3,ilength3)
!
   WRITE(*,100)TRIM(outstring1),ifilter,TRIM(datafile),TRIM(outstring2), &
        TRIM(outstring3)
!
100 FORMAT(a,1x,'of filter ',i1,1x,'data file (',a,') at',1x,a,1x, &
      'is inside gap line ',a,a)
!
   RETURN
!
END SUBROUTINE gaperrorlc
SUBROUTINE gaperrorrv(ifilter,time,datafile,idata,igap)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)             :: ifilter
   REAL(KIND=dp), INTENT(IN)       :: time
   CHARACTER (LEN=40), INTENT(IN)  :: datafile
   INTEGER, INTENT(IN)             :: idata
   INTEGER, INTENT(IN)             :: igap
!
   INTEGER   :: ilength1,ilength2,ilength3
!
   CHARACTER(LEN=40)  :: outstring1,outstring2,outstring3
!
   CALL istringnoequals('line ',idata,outstring1,ilength1)
   CALL pstring('time',5,time,outstring2,ilength2)
   CALL istringnoequals('#',igap,outstring3,ilength3)
!
   WRITE(*,100)TRIM(outstring1),ifilter,TRIM(datafile),TRIM(outstring2), &
        TRIM(outstring3)
!
100 FORMAT(a,1x,'of star ',i1,1x,'RV data file (',a,') at',1x,a,1x, &
      'is inside gap line ',a,a)
!
   RETURN
!
END SUBROUTINE gaperrorrv
SUBROUTINE gaussj(a,n,np,b,m)
!
!   from numerical recipes
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: np
   REAL(KIND=dp), INTENT(IN OUT)            :: a(np,np)
   REAL(KIND=dp), INTENT(IN OUT)            :: b(np,np)
   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: m
!
   INTEGER :: i,icol,irow,j,k,l,ll
!
   INTEGER, PARAMETER :: nmax=50
!
   INTEGER :: indxc(nmax),indxr(nmax),ipiv(nmax)
!
   REAL(KIND=dp)  :: big,dum,pivinv
!
   irow=1
   icol=1
   DO  j=1,n
      ipiv(j)=0
   END DO
   DO  i=1,n
      big=0.0_dp
      DO  j=1,n
         IF(ipiv(j) /= 1)THEN
            DO  k=1,n
               IF(ipiv(k) == 0)THEN
                  IF(ABS(a(j,k)) >= big)THEN
                     big=ABS(a(j,k))
                     irow=j
                     icol=k
                  END IF
               ELSE IF(ipiv(k) > 1)THEN
                  WRITE(*,*) 'Singular matrix in gaussj'
                  STOP
               END IF
            END DO
         END IF
      END DO
      ipiv(icol)=ipiv(icol)+1
      IF(irow /= icol)THEN
         DO  l=1,n
            dum=a(irow,l)
            a(irow,l)=a(icol,l)
            a(icol,l)=dum
         END DO
         DO  l=1,m
            dum=b(irow,l)
            b(irow,l)=b(icol,l)
            b(icol,l)=dum
         END DO
      END IF
      indxr(i)=irow
      indxc(i)=icol
      IF(ABS(a(icol,icol)) <= EPSILON(a(icol,icol)))THEN
         WRITE(*,*) 'Singular matrix in gaussj.'
      END IF
      pivinv=1.0_dp/a(icol,icol)
      a(icol,icol)=1.0_dp
      DO  l=1,n
         a(icol,l)=a(icol,l)*pivinv
      END DO
      DO  l=1,m
         b(icol,l)=b(icol,l)*pivinv
      END DO
      DO  ll=1,n
         IF(ll /= icol)THEN
            dum=a(ll,icol)
            a(ll,icol)=0.0_dp
            DO  l=1,n
               a(ll,l)=a(ll,l)-a(icol,l)*dum
            END DO
            DO  l=1,m
               b(ll,l)=b(ll,l)-b(icol,l)*dum
            END DO
         END IF
      END DO
   END DO
   DO  l=n,1,-1
      IF(indxr(l) /= indxc(l))THEN
         DO  k=1,n
            dum=a(k,indxr(l))
            a(k,indxr(l))=a(k,indxc(l))
            a(k,indxc(l))=dum
         END DO
      END IF
   END DO
   RETURN
!
END SUBROUTINE gaussj
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE genrep(ndim,n,np,ip,ph,rnewph)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndim
   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: np
   INTEGER, INTENT(IN)                      :: ip
   REAL(KIND=dp), INTENT(IN)                :: ph(ndim,2)
   REAL(KIND=dp), INTENT(OUT)               :: rnewph(ndim,np)
!
   INTEGER :: i1,i2,k
!
   i1=2*ip-1
   i2=i1+1
!!pgi$r opt O1
   DO  k=1,n
      rnewph(k,i1)=ph(k,1)
      rnewph(k,i2)=ph(k,2)
   END DO
   RETURN
!
END SUBROUTINE genrep
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getchi(n,y,errbar,ydum,chisq)
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN)                :: y(n)
   REAL(KIND=dp), INTENT(IN)                :: errbar(n)
   REAL(KIND=dp), INTENT(IN)                :: ydum(n)
   REAL(KIND=dp), INTENT(OUT)               :: chisq
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: i
!
!   COMMON /medblock/ rmed
!
   chisq=0.0_dp
!
!   If the variable rmed > 1, then define chisq to be the
!   absolute deviation
!
   DO  i=1,n
      IF(rmed >= 1.0_dp)THEN
         chisq=chisq+ABS((y(i)-ydum(i))/errbar(i))
      ELSE
         chisq=chisq+(y(i)-ydum(i))*(y(i)-ydum(i))/(errbar(i)*errbar(i))
      END IF
   END DO
   RETURN
!
END SUBROUTINE getchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getchilimb(nvmax,nterms,svar,dwavex,dwavey,  &
   chilimb)
!
!  This routine will check to see if the quad law coefficients are
!  unphysical (sum greater than 1).  A large value for chilimb is returned
!  if that is the case.
!
   USE accur
!
   IMPLICIT NONE

   INTEGER, INTENT(IN)                      :: nvmax
   INTEGER, INTENT(IN)                      :: nterms
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvmax)
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(OUT)               :: chilimb
!
   REAL(KIND=dp)  :: rlimbsum
!
   INTEGER :: j,kk,icnvrt,jjj
!
   chilimb=0.0_dp
   DO j=1,nterms
      kk=icnvrt(svar(j)(1:2))
      IF(kk >= 1752.AND.kk <= 1759)THEN
         DO jjj=1,8
            rlimbsum=dwavex(jjj,1)+dwavey(jjj,1)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
            rlimbsum=dwavex(jjj,2)+dwavey(jjj,2)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
         END DO
      END IF
      IF(kk >= 1784.AND.kk <= 1791)THEN
         DO jjj=1,8
            rlimbsum=dwavex(jjj,1)+dwavey(jjj,1)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
            rlimbsum=dwavex(jjj,2)+dwavey(jjj,2)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
         END DO
      END IF
      IF(kk >= 1816.AND.kk <= 1823)THEN
         DO jjj=1,8
            rlimbsum=dwavex(jjj,1)+dwavey(jjj,1)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
            rlimbsum=dwavex(jjj,2)+dwavey(jjj,2)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
         END DO
      END IF
      IF(kk >= 1720.AND.kk <= 1727)THEN
         DO jjj=1,8
            rlimbsum=dwavex(jjj,1)+dwavey(jjj,1)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
            rlimbsum=dwavex(jjj,2)+dwavey(jjj,2)
            IF(rlimbsum > 1.0_dp)chilimb=9.99E+18_dp
         END DO
      END IF
   END DO
!
   RETURN
!
END SUBROUTINE getchilimb
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getcov(igen,nback,nskip,nlength,nvar,covchol,  &
   invcovchol,aveparm,iburn,ioptimizer)
!
!   Will read the demcmc_fitparm* files on the fly to determine
!   the covariance matrix.  Nback is the number of files
!   to average over, and Nskip is the number to skip in between.
!   igen is the current generation number.  Thus the generation
!   numbers to be used would be igen-Nskip, igen-2*Nskip,
!   igen-3*Nskip, ... igen*Nback*Nskip
!
!   covchol(Nvar,Nvar) is the square root of the covariance
!   matrix, aveparm(Nvar) contains the averages,
!   and invcovchol(Nvar,Nvar) is the inverse of covchol
!
!   To get a vector of uncorrelated parameters from a vector
!   corr, use
!
!   uncorr = matmul(corr,invcovchol)
!
!   To reverse that, use
!
!   corr = matmul(uncorr,covchol
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: igen
   INTEGER, INTENT(IN)                      :: nback
   INTEGER, INTENT(IN)                      :: nskip
   INTEGER, INTENT(IN)                      :: nlength
   INTEGER, INTENT(IN)                      :: nvar
   REAL(KIND=dp), INTENT(OUT)               :: covchol(nvar,nvar)
   REAL(KIND=dp), INTENT(OUT)               :: invcovchol(nvar,nvar)
   REAL(KIND=dp), INTENT(OUT)               :: aveparm(nvar)
   INTEGER, INTENT(IN)                      :: iburn
   INTEGER, INTENT(IN)                      :: ioptimizer
!
   REAL(KIND=dp), ALLOCATABLE  :: parm(:,:),sum(:),cov(:,:)
!
   INTEGER :: i,j,k,ios,ifile,icount
!
   CHARACTER (LEN=7) :: extension
!
   ios=0
   ifile=0
   icount=0
!
   ALLOCATE(parm(99999,99),sum(99999),cov(nvar,nvar))
!
   DO k=0,nback
      IF(igen-k*nskip < iburn)GO TO 20
      WRITE(extension,30)igen-k*nskip+1000000
      IF(ioptimizer == 2)THEN
         OPEN(UNIT=2,FILE='demcmc_fitparm.'//extension,STATUS= 'old')
      END IF
      IF(ioptimizer == 10)THEN
         OPEN(UNIT=2,FILE='hammer_fitparm.'//extension,STATUS= 'old')
      END IF
      DO j=1,nlength
         icount=icount+1
         READ(2,*,END=10)(parm(icount,i),i=1,nvar)
      END DO
   END DO
10 CLOSE(2)
!
20 DO i=1,nvar
      sum(i)=0.0_dp
      aveparm(i)=0.0_dp
      DO j=1,nvar
         cov(i,j)=0.0_dp
      END DO
   END DO
!
   DO i=1,nvar
      DO j=1,icount
         sum(i)=sum(i)+parm(j,i)
      END DO
   END DO
!
   DO i=1,nvar
      aveparm(i)=sum(i)/REAL(icount,KIND=dp)
   END DO
!
   DO i=1,nvar
      DO j=1,nvar
         DO k=1,icount
            cov(i,j)=cov(i,j)+(parm(k,i)-aveparm(i))*(parm(k,j)-aveparm(j))
         END DO
         cov(i,j)=cov(i,j)/REAL(icount-1,KIND=dp)
      END DO
   END DO
!
   CALL cholfac(nvar,cov,covchol)
!
!   copy the matrix covchol into cov as a temporary
!   copy for use in the inversemat routine
!
   DO i=1,nvar
      DO j=1,nvar
         cov(i,j)=covchol(i,j)
      END DO
   END DO
!
!   get the inverse of
!
   CALL inversemat(cov,invcovchol,nvar)
!
   DEALLOCATE(parm,sum,cov)
!
   RETURN
!
30 FORMAT(i7)
!
END SUBROUTINE getcov
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getgenerationvals(ioptimizer,nvar,nvmax,svar,  &
   isw29,isvel1,isvel2,isvel3,isvel4,sw5,ecc,ifixgamma,  &
   icnrv1arr,icnrv2arr,icnrv3arr,icnrv4arr,icnrv5arr)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ioptimizer
   INTEGER, INTENT(IN)                      :: nvar
   INTEGER, INTENT(IN)                      :: nvmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvmax)
   INTEGER, INTENT(IN)                      :: isw29
   INTEGER, INTENT(IN)                      :: isvel1
   INTEGER, INTENT(IN)                      :: isvel2
   INTEGER, INTENT(IN)                      :: isvel3
   INTEGER, INTENT(IN)                      :: isvel4
   REAL(KIND=dp), INTENT(IN)                :: sw5
   REAL(KIND=dp), INTENT(IN)                :: ecc
   INTEGER, INTENT(IN)                      :: ifixgamma
   INTEGER, INTENT(IN)                      :: icnrv1arr(5)
   INTEGER, INTENT(IN)                      :: icnrv2arr(5)
   INTEGER, INTENT(IN)                      :: icnrv3arr(5)
   INTEGER, INTENT(IN)                      :: icnrv4arr(5)
   INTEGER, INTENT(IN)                      :: icnrv5arr(5)
!
   INTEGER :: i,kk,iargper,icnvrt
!
   CHARACTER(LEN=80) :: suffixstring,labelstring
!
   OPEN(UNIT=66,FILE='getgenerationvals.com',STATUS='unknown')
   IF(ioptimizer == 2)OPEN(UNIT=67,FILE=  &
      'getdemcmc_fitparmvals.com',STATUS='unknown')
   IF(ioptimizer == 10)OPEN(UNIT=67,FILE=  &
      'gethammer_fitparmvals.com',STATUS='unknown')
!
   iargper=0
   DO i=1,nvar
      kk=icnvrt(svar(i)(1:2))
      IF(kk == 111)iargper=100
      CALL getsuffix(svar(i),suffixstring,labelstring)
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
   END DO
!
   i=i-1
!
   IF(iargper > 0)THEN
      i=i+1
      suffixstring='argper2deg'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
   END IF
!
   IF(isw29 > 0)THEN
      i=i+1
      suffixstring='ecc2'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
      i=i+1
      suffixstring='argper2deg'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
   END IF
!
!   If ifixgamma is 0, 1, or 2, we have
!   up to 1 gamma value per star.  If ifixgamma is
!   10, 11, or 12, we can have up to 5 gamma values
!   per star.
!
   IF(ifixgamma < 10)THEN
      IF(isvel1 > 0)THEN
         i=i+1
         suffixstring='gam1'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(isvel2 > 0)THEN
         i=i+1
         suffixstring='gam2'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(isvel3 > 0)THEN
         i=i+1
         suffixstring='gam3'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(isvel4 > 0)THEN
         i=i+1
         suffixstring='gam4'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
   END IF
!
!  here are the cases for ifixgamma = 10, 11, or 12
!
   IF(ifixgamma >= 10)THEN
!
!  star 1 gammas
!
      IF(icnrv1arr(1) /= 430)THEN
         i=i+1
         suffixstring='gam1A'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv1arr(2) /= 430)THEN
         i=i+1
         suffixstring='gam1B'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv1arr(3) /= 430)THEN
         i=i+1
         suffixstring='gam1C'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv1arr(4) /= 430)THEN
         i=i+1
         suffixstring='gam1D'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv1arr(5) /= 430)THEN
         i=i+1
         suffixstring='gam1E'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
!  star 2 gammas
!
      IF(icnrv2arr(1) /= 430)THEN
         i=i+1
         suffixstring='gam2A'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv2arr(2) /= 430)THEN
         i=i+1
         suffixstring='gam2B'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv2arr(3) /= 430)THEN
         i=i+1
         suffixstring='gam2C'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv2arr(4) /= 430)THEN
         i=i+1
         suffixstring='gam2D'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv2arr(5) /= 430)THEN
         i=i+1
         suffixstring='gam2E'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
!  star 3 gammas
!
      IF(icnrv3arr(1) /= 430)THEN
         i=i+1
         suffixstring='gam3A'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv3arr(2) /= 430)THEN
         i=i+1
         suffixstring='gam3B'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv3arr(3) /= 430)THEN
         i=i+1
         suffixstring='gam3C'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv3arr(4) /= 430)THEN
         i=i+1
         suffixstring='gam3D'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv3arr(5) /= 430)THEN
         i=i+1
         suffixstring='gam3E'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
!  star 4 gammas
!
      IF(icnrv4arr(1) /= 430)THEN
         i=i+1
         suffixstring='gam4A'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv4arr(2) /= 430)THEN
         i=i+1
         suffixstring='gam4B'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv4arr(3) /= 430)THEN
         i=i+1
         suffixstring='gam4C'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv4arr(4) /= 430)THEN
         i=i+1
         suffixstring='gam4D'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv4arr(5) /= 430)THEN
         i=i+1
         suffixstring='gam4E'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
!  star 5 gammas
!
      IF(icnrv5arr(1) /= 430)THEN
         i=i+1
         suffixstring='gam5A'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv5arr(2) /= 430)THEN
         i=i+1
         suffixstring='gam5B'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv5arr(3) /= 430)THEN
         i=i+1
         suffixstring='gam5C'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv5arr(4) /= 430)THEN
         i=i+1
         suffixstring='gam5D'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF
!
      IF(icnrv5arr(5) /= 430)THEN
         i=i+1
         suffixstring='gam5E'
         IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
         IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
         IF(ioptimizer == 2)THEN
            IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
         END IF
         IF(ioptimizer == 10)THEN
            IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
            IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
         END IF
      END IF

   END IF
!
   IF(sw5 > 0)THEN
      i=i+1
      suffixstring='asini'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
   END IF
!
   IF(ecc > 0)THEN
      i=i+1
      suffixstring='Tperi2'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
      i=i+1
      suffixstring='Tsupconj2'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
      i=i+1
      suffixstring='Tinfconj2'
      IF(i+2 < 10)WRITE(66,10)i+2,TRIM(suffixstring)
      IF((i+2 >= 10).AND.(i+2 < 100))WRITE(66,20)i+2,TRIM(suffixstring)
      IF(ioptimizer == 2)THEN
         IF(i < 10)WRITE(67,30)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,40)i,TRIM(suffixstring)
      END IF
      IF(ioptimizer == 10)THEN
         IF(i < 10)WRITE(67,50)i,TRIM(suffixstring)
         IF((i >= 10).AND.(i < 100))WRITE(67,60)i,TRIM(suffixstring)
      END IF
   END IF
!
   CLOSE(66)
   IF(ioptimizer > 0)CLOSE(67)
!
10 FORMAT('awk ''{print $',i1,',$2}'' generation.*',1X,'> ttempE'  &
      ,'LC.',a)
20 FORMAT('awk ''{print $',i2,',$2}'' generation.*',1X,'> ttempE'  &
      ,'LC.',a)
30 FORMAT('awk ''{print $',i1,'}'' demcmc_fitparm.*',1X,'> tempE'  &
      ,'LC.',a)
40 FORMAT('awk ''{print $',i2,'}'' demcmc_fitparm.*',1X,'> tempE'  &
      ,'LC.',a)
50 FORMAT('awk ''{print $',i1,'}'' hammer_fitparm.*',1X,'> tempE'  &
      ,'LC.',a)
60 FORMAT('awk ''{print $',i2,'}'' hammer_fitparm.*',1X,'> tempE'  &
      ,'LC.',a)
!
   RETURN
!
END SUBROUTINE getgenerationvals
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getloopopt(udatafile,bdatafile,vdatafile,  &
   rdatafile,idatafile,jdatafile,hdatafile,kdatafile,rv1file,  &
   rv2file,nvmax,nvar,svar,var,vstart,vstep,nstep,nobv,sobv,obv,  &
   eobv,rv3file,rv4file,rv5file)
!
!    November 12, 1999
!
!    This routine will read the input file to set up the optimizer (either
!    the 'grid search' or the Levenburg-Marquardt routine).
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER (LEN=40), INTENT(OUT)          :: udatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: bdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: vdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: rdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: idatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: jdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: hdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: kdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: rv1file
   CHARACTER (LEN=40), INTENT(OUT)          :: rv2file
   INTEGER, INTENT(IN)                      :: nvmax
   INTEGER, INTENT(OUT)                     :: nvar
   CHARACTER (LEN=40), INTENT(OUT)          :: svar(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: var(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: vstart(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: vstep(nvmax)
   INTEGER, INTENT(OUT)                     :: nstep(nvmax)
   INTEGER, INTENT(OUT)                     :: nobv
   CHARACTER (LEN=40), INTENT(OUT)          :: sobv(19)
   REAL(KIND=dp), INTENT(OUT)               :: obv(19)
   REAL(KIND=dp), INTENT(OUT)               :: eobv(19)
   CHARACTER (LEN=40), INTENT(OUT)          :: rv3file
   CHARACTER (LEN=40), INTENT(IN OUT)       :: rv4file
   CHARACTER (LEN=40), INTENT(IN OUT)       :: rv5file
!
   INTEGER :: i,ios,isnumber,k1,iosopen,j
!
   CHARACTER(LEN=1) :: bell
   CHARACTER(LEN=40) :: line
!
   DO  i=1,19
      sobv(i)='none'
      obv(i)=-99.0_dp
      eobv(i)=-99.0_dp
   END DO
   nobv=0
!
   DO  i=1,nvmax
      svar(i)='none'
   END DO
!
   WRITE(rv3file,120)
   WRITE(rv4file,121)
   WRITE(rv5file,122)
!
   bell=CHAR(7)
   ios=0
   iosopen=0
   OPEN(UNIT=11,FILE='gridloop.opt',STATUS='old',ERR=90,IOSTAT= iosopen)
!
   READ(11,100)udatafile
   READ(11,100)bdatafile
   READ(11,100)vdatafile
   READ(11,100)rdatafile
   READ(11,100)idatafile
   READ(11,100)jdatafile
   READ(11,100)hdatafile
   READ(11,100)kdatafile
   READ(11,100)rv1file
   READ(11,100)rv2file
!
!  In the old format, the next line should be an integer.  In
!  the new format, we have three more lines of strings.
!  look at the next line and determine if it is an integer.
!
   isnumber=0
   READ(11,100)line
   k1=LEN_TRIM(line)
   ios=0
   DO  i=1,k1
      j=ICHAR(line(i:i))
!
!  Check for leading blank (ICHAR = 32)
!
      IF(j == 32)CYCLE
!
!  Check for digits 0 through 9 (ICHAR between 48 and
!  57)
!
      IF((j < 48).OR.(j > 57))ios=99
   END DO
!
   IF(ios /= 0)THEN
!
!   Looks like a string, so read two more lines, since
!   the string line is already RV3file.
!
      rv3file=TRIM(line)
      READ(11,100)rv4file
      READ(11,100)rv5file
   ELSE
!
!   Looks like a number, set the value of Nvar to that value
!
      BACKSPACE(11)
   END IF
!
   READ(11,*)nvar
!
   IF(nvar == 0)GO TO 50
   IF(nvar > nvmax)THEN
      WRITE(*,110)bell
      STOP
   END IF
!
   DO  i=1,nvar
      READ(11,100)svar(i)
   END DO
!
   DO  i=1,nvar
      READ(11,*)vstart(i),vstep(i),nstep(i)
      var(i)=vstart(i)
   END DO
!
!  Look here for possible observed parameters
!
50 READ(11,*,END=80,ERR=80)nobv
!
   DO  i=1,nobv
      READ(11,100)sobv(i)
   END DO
   DO  i=1,nobv
      READ(11,*)obv(i),eobv(i)
   END DO
!
80 CLOSE(11)
!
!  error in opening the file
!
90 IF(iosopen /= 0)THEN
      CALL makeloopopt(nvmax)
   END IF
!
100 FORMAT(a40)
110 FORMAT(a1,'Error:  too many variables in ''gridloop.opt''')
120 FORMAT('none RV3file',28X)
121 FORMAT('none RV4file',28X)
122 FORMAT('none RV5file',28X)
!
   RETURN
!
END SUBROUTINE getloopopt
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getmean(n,y,average)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN)                :: y(n)
   REAL(KIND=dp), INTENT(OUT)               :: average
!
   REAL(KIND=dp)  :: summ
!
   INTEGER :: i
!
   summ=0.0_dp
   average=0.0_dp
!
   DO  i=1,n
      summ=summ+y(i)
   END DO
!
   average=summ/REAL(n,KIND=dp)
!
   RETURN
!
END SUBROUTINE getmean
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE getsuffix(instr1,suffixstr,labelstr)
!
!  This subroutine will take an input tag, and return strings
!  to be used as file extensions and as labels.  For example,
!  "pe" gives "period" as a file extension and "Period (days)"
!  as a label.
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER (LEN=*), INTENT(IN)            :: instr1
   CHARACTER (LEN=80 ), INTENT(OUT)         :: suffixstr
   CHARACTER (LEN=80 ), INTENT(OUT)         :: labelstr
!
   INTEGER :: icnvrt,kk,it1
!
!  Figure out the variable that goes with the input tag.
!
   kk=icnvrt(instr1(1:2))
!
!  tag ct, tesscontam
!
   IF(kk == 83)THEN
      suffixstr='tesscontam'
      labelstr='TESS contaminatione'
   END IF
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
   IF(kk == 48)THEN
      suffixstr='binqTc'
      labelstr='binary P-Tc plane slope'
   END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
   IF(kk == 3528)THEN
      suffixstr='P1qTc'
      labelstr='body 3 P-Tc plane slope'
   END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
   IF(kk == 3560)THEN
      suffixstr='P2qTc'
      labelstr='body 4 P-Tc plane slope'
   END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
   IF(kk == 3592)THEN
      suffixstr='P3qTc'
      labelstr='body 5 P-Tc plane slope'
   END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
   IF(kk == 3624)THEN
      suffixstr='P4qTc'
      labelstr='body 6 P-Tc plane slope'
   END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
   IF(kk == 3656)THEN
      suffixstr='P5qTc'
      labelstr='body 7 P-Tc plane slope'
   END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
   IF(kk == 3688)THEN
      suffixstr='P6qTc'
      labelstr='body 8 P-Tc plane slope'
   END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
   IF(kk == 3720)THEN
      suffixstr='P7qTc'
      labelstr='body 9 P-Tc plane slope'
   END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
   IF(kk == 3752)THEN
      suffixstr='P8qTc'
      labelstr='body 10 P-Tc plane slope'
   END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
   IF(kk == 51)THEN
      suffixstr='Tbinoff'
      labelstr='T offset binary'
   END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
   IF(kk == 3531)THEN
      suffixstr='T1off'
      labelstr='T offset body 3'
   END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
   IF(kk == 3563)THEN
      suffixstr='T2off'
      labelstr='T offset body 4'
   END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
   IF(kk == 3595)THEN
      suffixstr='T3off'
      labelstr='T offset body 5'
   END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
   IF(kk == 3627)THEN
      suffixstr='T4off'
      labelstr='T offset body 6'
   END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
   IF(kk == 3659)THEN
      suffixstr='T5off'
      labelstr='T offset body 7'
   END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
   IF(kk == 3691)THEN
      suffixstr='T6off'
      labelstr='T offset body 8'
   END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
   IF(kk == 3723)THEN
      suffixstr='T7off'
      labelstr='T offset body 9'
   END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
   IF(kk == 3755)THEN
      suffixstr='T8off'
      labelstr='T offset body 10'
   END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
   IF(kk == 581)THEN
      suffixstr='fillsum'
      labelstr='fill1+fill2'
   END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
   IF(kk == 579)THEN
      suffixstr='filldiff'
      labelstr='fill1-fill2'
   END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
   IF(kk == 3512)THEN
      suffixstr='angsum1'
      labelstr='P1incl+P1Omega (deg)'
   END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
   IF(kk == 3544)THEN
      suffixstr='angsum2'
      labelstr='P2incl+P2Omega (deg)'
   END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
   IF(kk == 3576)THEN
      suffixstr='angsum3'
      labelstr='P3incl+P3Omega (deg)'
   END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
   IF(kk == 3608)THEN
      suffixstr='angsum4'
      labelstr='P4incl+P4Omega (deg)'
   END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
   IF(kk == 3640)THEN
      suffixstr='angsum5'
      labelstr='P5incl+P5Omega (deg)'
   END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
   IF(kk == 3672)THEN
      suffixstr='angsum6'
      labelstr='P6incl+P6Omega (deg)'
   END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
   IF(kk == 3704)THEN
      suffixstr='angsum7'
      labelstr='P7incl+P7Omega (deg)'
   END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
   IF(kk == 3736)THEN
      suffixstr='angsum8'
      labelstr='P8incl+P8Omega (deg)'
   END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
   IF(kk == 3515)THEN
      suffixstr='angdiff1'
      labelstr='P1incl-P1Omega (deg)'
   END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
   IF(kk == 3547)THEN
      suffixstr='angdiff2'
      labelstr='P2incl-P2Omega (deg)'
   END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
   IF(kk == 3579)THEN
      suffixstr='angdiff3'
      labelstr='P3incl-P3Omega (deg)'
   END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
   IF(kk == 3611)THEN
      suffixstr='angdiff4'
      labelstr='P4incl-P4Omega (deg)'
   END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
   IF(kk == 3643)THEN
      suffixstr='angdiff5'
      labelstr='P5incl-P5Omega (deg)'
   END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
   IF(kk == 3675)THEN
      suffixstr='angdiff6'
      labelstr='P6incl-P6Omega (deg)'
   END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
   IF(kk == 3707)THEN
      suffixstr='angdiff7'
      labelstr='P7incl-P7Omega (deg)'
   END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
   IF(kk == 3739)THEN
      suffixstr='angdiff8'
      labelstr='P8incl-P8Omega (deg)'
   END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
   IF(kk == 178)THEN
      suffixstr='fracsum'
      labelstr='frac1+frac2'
   END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
   IF(kk == 163)THEN
      suffixstr='fracdiff'
      labelstr='frac1-frac2'
   END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
   IF(kk == 4790)THEN
      suffixstr='bin2M3'
      labelstr='bin2M3 (solar)'
   END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
   IF(kk == 4791)THEN
      suffixstr='bin2M4'
      labelstr='bin2M4 (solar)'
   END IF
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
   IF(kk == 4792)THEN
      suffixstr='bin2R3'
      labelstr='bin2R3 (solar)'
   END IF
!
!  tag 90, bin2R4 (R4 in solar radii in binary+binary)
!
   IF(kk == 4783)THEN
      suffixstr='bin2R4'
      labelstr='bin2R4 (solar)'
   END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 50)THEN
      suffixstr='sqrt_e_sin_omega'
      labelstr='sqrt(e)*sin(omega)'
   END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 34)THEN
      suffixstr='sqrt_e_cos_omega'
      labelstr='sqrt(e)*cos(omega)'
   END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3530)THEN
      suffixstr='sqP1esin'
      labelstr='sqrt(e1)*sin(omega1)'
   END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3514)THEN
      suffixstr='sqP1ecos'
      labelstr='sqrt(e1)*cos(omega1)'
   END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3562)THEN
      suffixstr='sqP2esin'
      labelstr='sqrt(e2)*sin(omega2)'
   END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3546)THEN
      suffixstr='sqP2ecos'
      labelstr='sqrt(e2)*cos(omega2)'
   END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3594)THEN
      suffixstr='sqP3esin'
      labelstr='sqrt(e3)*sin(omega3)'
   END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3578)THEN
      suffixstr='sqP3ecos'
      labelstr='sqrt(e3)*cos(omega3)'
   END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3626)THEN
      suffixstr='sqP4esin'
      labelstr='sqrt(e4)*sin(omega4)'
   END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3610)THEN
      suffixstr='sqP4ecos'
      labelstr='sqrt(e4)*cos(omega4)'
   END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3658)THEN
      suffixstr='sqP5esin'
      labelstr='sqrt(e5)*sin(omega5)'
   END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3642)THEN
      suffixstr='sqP5ecos'
      labelstr='sqrt(e5)*cos(omega5)'
   END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3690)THEN
      suffixstr='sqP6esin'
      labelstr='sqr(e6)*sin(omega6)'
   END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3674)THEN
      suffixstr='sqP6ecos'
      labelstr='sqrt(e6)*cos(omega6)'
   END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3722)THEN
      suffixstr='sqP7esin'
      labelstr='sqrt(e7)*sin(omega7)'
   END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3706)THEN
      suffixstr='sqP7ecos'
      labelstr='sqrt(e7)*cos(omega7)'
   END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3754)THEN
      suffixstr='sqP8esin'
      labelstr='sqrt(e8)*sin(omega8)'
   END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3738)THEN
      suffixstr='sqP8ecos'
      labelstr='sqrt(e8)*cos(omega8)'
   END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
   IF(kk == 3524)THEN
      suffixstr='P1mTc'
      labelstr='P1-Tc1 (days)'
   END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
   IF(kk == 3527)THEN
      suffixstr='P1pTc'
      labelstr='P1+Tc1 (days)'
   END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
   IF(kk == 3556)THEN
      suffixstr='P2mTc'
      labelstr='P2-Tc2 (days)'
   END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
   IF(kk == 3559)THEN
      suffixstr='P2pTc'
      labelstr='P2+Tc2 (days)'
   END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
   IF(kk == 3588)THEN
      suffixstr='P3mTc'
      labelstr='P3-Tc3 (days)'
   END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
   IF(kk == 3591)THEN
      suffixstr='P3pTc'
      labelstr='P3+Tc3 (days)'
   END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
   IF(kk == 3620)THEN
      suffixstr='P4mTc'
      labelstr='P4-Tc4 (days)'
   END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
   IF(kk == 3623)THEN
      suffixstr='P4pTc'
      labelstr='P4+Tc4 (days)'
   END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
   IF(kk == 3652)THEN
      suffixstr='P5mTc'
      labelstr='P5-Tc5 (days)'
   END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
   IF(kk == 3655)THEN
      suffixstr='P5pTc'
      labelstr='P5+Tc5 (days)'
   END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
   IF(kk == 3684)THEN
      suffixstr='P6mTc'
      labelstr='P6-Tc6 (days)'
   END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
   IF(kk == 3687)THEN
      suffixstr='P6pTc'
      labelstr='P6+Tc6 (days)'
   END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
   IF(kk == 3716)THEN
      suffixstr='P7mTc'
      labelstr='P7-Tc7 (days)'
   END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
   IF(kk == 3719)THEN
      suffixstr='P7pTc'
      labelstr='P7+Tc7 (days)'
   END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
   IF(kk == 3748)THEN
      suffixstr='P8mTc'
      labelstr='P8-Tc8 (days)'
   END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
   IF(kk == 3751)THEN
      suffixstr='P8pTc'
      labelstr='P8+Tc8 (days)'
   END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
   IF(kk == 44)THEN
      suffixstr='PbinmTc'
      labelstr='Pbin-Tc (days)'
   END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
   IF(kk == 47)THEN
      suffixstr='PbinpTc'
      labelstr='Pbin+Tc (days)'
   END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
   IF(kk == 40)THEN
      suffixstr='axis_I2'
      labelstr='axis_I2 (deg)'
   END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
   IF(kk == 33)THEN
      suffixstr='axis_beta2'
      labelstr='axis_beta2 (deg)'
   END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
   IF(kk == 72)THEN
      suffixstr='axis_I3'
      labelstr='axis_I3 (deg)'
   END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
   IF(kk == 65)THEN
      suffixstr='axis_beta3'
      labelstr='axis_beta3 (deg)'
   END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
   IF(kk == 104)THEN
      suffixstr='axis_I4'
      labelstr='axis_I4 (deg)'
   END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
   IF(kk == 97)THEN
      suffixstr='axis_beta4'
      labelstr='axis_beta4 (deg)'
   END IF
!
!  tag 91, bin2masssum (M3+M4 in binary+binary)
!
   IF(kk == 4784)THEN
      suffixstr='bin2masssum'
      labelstr='bin2 M3+M4 (solar)'
   END IF
!
!  tag 92, bin2massdiff (M3-M4 in binary+binary)
!
   IF(kk == 4785)THEN
      suffixstr='bin2massdiff'
      labelstr='bin2 M3-M4 (solar)'
   END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
   IF(kk == 4786)THEN
      suffixstr='bin2Q'
      labelstr='bin2Q (M4/M3)'
   END IF
!
!  tag 94, bin2radsum (R3+R4 in binary+binary)
!
   IF(kk == 4787)THEN
      suffixstr='bin2radsum'
      labelstr='bin2 R3+R4 (solar)'
   END IF
!
!  tag 95, bin2raddiff (R3-R4 in binary+binary)
!
   IF(kk == 4788)THEN
      suffixstr='bin2raddiff'
      labelstr='bin2 R3-R4 (solar)'
   END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
   IF(kk == 4789)THEN
      suffixstr='bin2ratrad'
      labelstr='bin2ratrad (R3/R4)'
   END IF
!
!   tag g6, g6
!
   IF(kk == 1213)THEN
      suffixstr='g6'
      labelstr='log(g6)'
   END IF
!
!   tag g7, g7
!
   IF(kk == 1214)THEN
      suffixstr='g7'
      labelstr='log(g7)'
   END IF
!
!   tag g8, g8
!
   IF(kk == 1215)THEN
      suffixstr='g8'
      labelstr='log(g8)'
   END IF
!
!   tag g9, g9
!
   IF(kk == 1216)THEN
      suffixstr='g9'
      labelstr='log(g9)'
   END IF
!
!   tag g0, g10
!
   IF(kk == 1207)THEN
      suffixstr='g10'
      labelstr='log(g10)'
   END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
   IF(kk == 387)THEN
      suffixstr='massdiff'
      labelstr='M1-M2 (solar)'
   END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
   IF(kk == 402)THEN
      suffixstr='masssum'
      labelstr='M1+M2 (solar)'
   END IF
!
!   tag o3, omega3
!
   IF(kk == 1466)THEN
      suffixstr='omega3'
      labelstr='omega3'
   END IF
!
!   tag o4, omega4
!
   IF(kk == 1467)THEN
      suffixstr='omega4'
      labelstr='omega4'
   END IF
!
!   tag o5, omega5
!
   IF(kk == 1468)THEN
      suffixstr='omega5'
      labelstr='omega5'
   END IF
!
!   tag o6, omega6
!
   IF(kk == 1469)THEN
      suffixstr='omega6'
      labelstr='omega6'
   END IF
!
!   tag o7, omega7
!
   IF(kk == 1470)THEN
      suffixstr='omega7'
      labelstr='omega7'
   END IF
!
!   tag o8, omega8
!
   IF(kk == 1471)THEN
      suffixstr='omega8'
      labelstr='omega8'
   END IF
!
!   tag o9, omega9
!
   IF(kk == 1472)THEN
      suffixstr='omega9'
      labelstr='omega9'
   END IF
!
!   tag o0, omega10
!
   IF(kk == 1463)THEN
      suffixstr='omega10'
      labelstr='omega10'
   END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
   IF(kk == 562)THEN
      suffixstr='radsum'
      labelstr='R1+R2 (solar)'
   END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
   IF(kk == 547)THEN
      suffixstr='raddiff'
      labelstr='R1-R2 (solar)'
   END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
   IF(kk == 1018)THEN
      suffixstr='rk3'
      labelstr='apsidal_k3'
   END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
   IF(kk == 1019)THEN
      suffixstr='rk4'
      labelstr='aspsidal_k4'
   END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
   IF(kk == 1020)THEN
      suffixstr='rk5'
      labelstr='apsidal_k5'
   END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
   IF(kk == 1021)THEN
      suffixstr='rk6'
      labelstr='apsidal_k6'
   END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
   IF(kk == 1022)THEN
      suffixstr='rk7'
      labelstr='apsidal_k7'
   END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
   IF(kk == 1023)THEN
      suffixstr='rk8'
      labelstr='apsidal_k8'
   END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
   IF(kk == 1024)THEN
      suffixstr='rk9'
      labelstr='apsidal_k9'
   END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
   IF(kk == 1015)THEN
      suffixstr='rk10'
      labelstr='apsidal_k10'
   END IF
!
!   tag sm, secmass
!
   IF(kk == 588)THEN
      suffixstr='secmass'
      labelstr='M2 (solar)'
   END IF
!
!   tag sr, secrad
!
   IF(kk == 593)THEN
      suffixstr='secrad'
      labelstr='R2 (solar)'
   END IF
!
!   tag t6, t6 (Teff6)
!
   IF(kk == 1629)THEN
      suffixstr='Teff6'
      labelstr='Teff6 (K)'
   END IF
!
!   tag t7, t7 (Teff7)
!
   IF(kk == 1630)THEN
      suffixstr='Teff7'
      labelstr='Teff7 (K)'
   END IF
!
!   tag t8, t8 (Teff8)
!
   IF(kk == 1631)THEN
      suffixstr='Teff8'
      labelstr='Teff8 (K)'
   END IF
!
!   tag t9, t9 (Teff9)
!
   IF(kk == 1632)THEN
      suffixstr='Teff9'
      labelstr='Teff9 (K)'
   END IF
!
!   tag ta, t10 (Teff10)
!
   IF(kk == 608)THEN
      suffixstr='Teff10'
      labelstr='Teff10 (K)'
   END IF
!
!  tag 61, flux star 6, band 1
!
   IF(kk == 4688)THEN
      suffixstr='flux6_U'
      labelstr='flux6_U'
   END IF
!
!  tag 62, flux star 6, band 2
!
   IF(kk == 4689)THEN
      suffixstr='flux6_B'
      labelstr='flux6_B'
   END IF
!
!  tag 63, flux star 6, band 3
!
   IF(kk == 4690)THEN
      suffixstr='flux6_V'
      labelstr='flux6_V'
   END IF
!
!  tag 64, flux star 6, band 4
!
   IF(kk == 4691)THEN
      suffixstr='flux6_R'
      labelstr='flux6_R'
   END IF
!
!  tag 65, flux star 6, band 5
!
   IF(kk == 4692)THEN
      suffixstr='flux6_I'
      labelstr='flux6_I'
   END IF
!
!  tag 66, flux star 6, band 6
!
   IF(kk == 4693)THEN
      suffixstr='flux6_J'
      labelstr='flux6_J'
   END IF
!
!  tag 67, flux star 6, band 7
!
   IF(kk == 4694)THEN
      suffixstr='flux6_H'
      labelstr='flux6_H'
   END IF
!
!  tag 68, flux star 6, band 8
!
   IF(kk == 4695)THEN
      suffixstr='flux6_K'
      labelstr='flux6_K'
   END IF
!
!  tag 71, flux star 7, band 1
!
   IF(kk == 4720)THEN
      suffixstr='flux7_U'
      labelstr='flux7_U'
   END IF
!
!  tag 72, flux star 7, band 2
!
   IF(kk == 4721)THEN
      suffixstr='flux7_B'
      labelstr='flux7_B'
   END IF
!
!  tag 73, flux star 7, band 3
!
   IF(kk == 4722)THEN
      suffixstr='flux7_V'
      labelstr='flux7_V'
   END IF
!
!  tag 74, flux star 7, band 4
!
   IF(kk == 4723)THEN
      suffixstr='flux7_R'
      labelstr='flux7_R'
   END IF
!
!  tag 75, flux star 7, band 5
!
   IF(kk == 4724)THEN
      suffixstr='flux7_I'
      labelstr='flux7_I'
   END IF
!
!  tag 76, flux star 7, band 6
!
   IF(kk == 4725)THEN
      suffixstr='flux7_J'
      labelstr='flux7_J'
   END IF
!
!  tag 77, flux star 7, band 7
!
   IF(kk == 4726)THEN
      suffixstr='flux7_H'
      labelstr='flux7_H'
   END IF
!
!  tag 78, flux star 7, band 8
!
   IF(kk == 4727)THEN
      suffixstr='flux7_K'
      labelstr='flux7_K'
   END IF
!
!  tag 81, flux star 8, band 1
!
   IF(kk == 4752)THEN
      suffixstr='flux8_U'
      labelstr='flux8_U'
   END IF
!
!  tag 82, flux star 8, band 2
!
   IF(kk == 4753)THEN
      suffixstr='flux8_B'
      labelstr='flux8_B'
   END IF
!
!  tag 83, flux star 8, band 3
!
   IF(kk == 4754)THEN
      suffixstr='flux8_V'
      labelstr='flux8_V'
   END IF
!
!  tag 84, flux star 8, band 4
!
   IF(kk == 4755)THEN
      suffixstr='flux8_R'
      labelstr='flux8_R'
   END IF
!
!  tag 85, flux star 8, band 5
!
   IF(kk == 4756)THEN
      suffixstr='flux8_I'
      labelstr='flux8_I'
   END IF
!
!  tag 86, flux star 8, band 6
!
   IF(kk == 4757)THEN
      suffixstr='flux8_J'
      labelstr='flux8_J'
   END IF
!
!  tag 87, flux star 8, band 7
!
   IF(kk == 4758)THEN
      suffixstr='flux8_H'
      labelstr='flux8_H'
   END IF
!
!  tag 88, flux star 8, band 8
!
   IF(kk == 4759)THEN
      suffixstr='flux8_K'
      labelstr='flux8_K'
   END IF
!
!  tag 91, flux star 9, band 1
!
   IF(kk == 2784)THEN
      suffixstr='flux9_U'
      labelstr='flux9_U'
   END IF
!
!  tag 92, flux star 9, band 2
!
   IF(kk == 2785)THEN
      suffixstr='flux9_B'
      labelstr='flux9_B'
   END IF
!
!  tag 93, flux star 9, band 3
!
   IF(kk == 2786)THEN
      suffixstr='flux9_V'
      labelstr='flux9_V'
   END IF
!
!  tag 94, flux star 9, band 4
!
   IF(kk == 2787)THEN
      suffixstr='flux9_R'
      labelstr='flux9_R'
   END IF
!
!  tag 95, flux star 9, band 5
!
   IF(kk == 2788)THEN
      suffixstr='flux9_I'
      labelstr='flux9_I'
   END IF
!
!  tag 96, flux star 9, band 6
!
   IF(kk == 2789)THEN
      suffixstr='flux9_J'
      labelstr='flux9_J'
   END IF
!
!  tag 97, flux star 9, band 7
!
   IF(kk == 2790)THEN
      suffixstr='flux9_H'
      labelstr='flux9_H'
   END IF
!
!  tag 98, flux star 9, band 8
!
   IF(kk == 2791)THEN
      suffixstr='flux9_K'
      labelstr='flux9_K'
   END IF
!
!  tag 01, flux star 10, band 1
!
   IF(kk == 4496)THEN
      suffixstr='flux10_U'
      labelstr='flux10_U'
   END IF
!
!  tag 02, flux star 10, band 2
!
   IF(kk == 4497)THEN
      suffixstr='flux10_B'
      labelstr='flux10_B'
   END IF
!
!  tag 03, flux star 10, band 3
!
   IF(kk == 4498)THEN
      suffixstr='flux10_V'
      labelstr='flux10_V'
   END IF
!
!  tag 04, flux star 10, band 4
!
   IF(kk == 4499)THEN
      suffixstr='flux10_R'
      labelstr='flux10_R'
   END IF
!
!  tag 05, flux star 10, band 5
!
   IF(kk == 4500)THEN
      suffixstr='flux10_I'
      labelstr='flux10_I'
   END IF
!
!  tag 06, flux star 10, band 6
!
   IF(kk == 4501)THEN
      suffixstr='flux10_J'
      labelstr='flux10_J'
   END IF
!
!  tag 07, flux star 10, band 7
!
   IF(kk == 4502)THEN
      suffixstr='flux10_H'
      labelstr='flux10_H'
   END IF
!
!  tag 08, flux star 10, band 8
!
   IF(kk == 4503)THEN
      suffixstr='flux10_K'
      labelstr='flux10_K'
   END IF
!
!  tag 11, flux star 1, band 1
!
   IF(kk == 4528)THEN
      suffixstr='flux1_U'
      labelstr='flux1_U'
   END IF
!
!  tag 12, flux star 1, band 2
!
   IF(kk == 4529)THEN
      suffixstr='flux1_B'
      labelstr='flux1_B'
   END IF
!
!  tag 13, flux star 1, band 3
!
   IF(kk == 4530)THEN
      suffixstr='flux1_V'
      labelstr='flux1_V'
   END IF
!
!  tag 14, flux star 1, band 4
!
   IF(kk == 4531)THEN
      suffixstr='flux1_R'
      labelstr='flux1_R'
   END IF
!
!  tag 15, flux star 1, band 5
!
   IF(kk == 4532)THEN
      suffixstr='flux1_I'
      labelstr='flux1_I'
   END IF
!
!  tag 16, flux star 1, band 6
!
   IF(kk == 4533)THEN
      suffixstr='flux1_J'
      labelstr='flux1_J'
   END IF
!
!  tag 17, flux star 1, band 7
!
   IF(kk == 4534)THEN
      suffixstr='flux1_H'
      labelstr='flux1_H'
   END IF
!
!  tag 18, flux star 1, band 8
!
   IF(kk == 4535)THEN
      suffixstr='flux1_K'
      labelstr='flux1_K'
   END IF
!
!  tag 21, flux star 2, band 1
!
   IF(kk == 4560)THEN
      suffixstr='flux2_U'
      labelstr='flux2_U'
   END IF
!
!  tag 22, flux star 2, band 2
!
   IF(kk == 4561)THEN
      suffixstr='flux2_B'
      labelstr='flux2_B'
   END IF
!
!  tag 23, flux star 2, band 3
!
   IF(kk == 4562)THEN
      suffixstr='flux2_V'
      labelstr='flux2_V'
   END IF
!
!  tag 24, flux star 2, band 4
!
   IF(kk == 4563)THEN
      suffixstr='flux2_R'
      labelstr='flux2_R'
   END IF
!
!  tag 25, flux star 2, band 5
!
   IF(kk == 4564)THEN
      suffixstr='flux2_I'
      labelstr='flux2_I'
   END IF
!
!  tag 26, flux star 2, band 6
!
   IF(kk == 4565)THEN
      suffixstr='flux2_J'
      labelstr='flux2_J'
   END IF
!
!  tag 27, flux star 2, band 7
!
   IF(kk == 4566)THEN
      suffixstr='flux2_H'
      labelstr='flux2_H'
   END IF
!
!  tag 28, flux star 2, band 8
!
   IF(kk == 4567)THEN
      suffixstr='flux2_K'
      labelstr='flux2_K'
   END IF
!
!  tag 31, flux star 3, band 1
!
   IF(kk == 4592)THEN
      suffixstr='flux3_U'
      labelstr='flux3_U'
   END IF
!
!  tag 32, flux star 3, band 2
!
   IF(kk == 4593)THEN
      suffixstr='flux3_B'
      labelstr='flux3_B'
   END IF
!
!  tag 33, flux star 3, band 3
!
   IF(kk == 4594)THEN
      suffixstr='flux3_V'
      labelstr='flux3_V'
   END IF
!
!  tag 34, flux star 3, band 4
!
   IF(kk == 4595)THEN
      suffixstr='flux3_R'
      labelstr='flux3_R'
   END IF
!
!  tag 35, flux star 3, band 5
!
   IF(kk == 4596)THEN
      suffixstr='flux3_I'
      labelstr='flux3_I'
   END IF
!
!  tag 36, flux star 3, band 6
!
   IF(kk == 4597)THEN
      suffixstr='flux3_J'
      labelstr='flux3_J'
   END IF
!
!  tag 37, flux star 3, band 7
!
   IF(kk == 4598)THEN
      suffixstr='flux3_H'
      labelstr='flux3_H'
   END IF
!
!  tag 38, flux star 3, band 8
!
   IF(kk == 4599)THEN
      suffixstr='flux3_K'
      labelstr='flux3_K'
   END IF
!
!  tag 41, flux star 4, band 1
!
   IF(kk == 4624)THEN
      suffixstr='flux4_U'
      labelstr='flux4_U'
   END IF
!
!  tag 42, flux star 4, band 2
!
   IF(kk == 4625)THEN
      suffixstr='flux4_B'
      labelstr='flux4_B'
   END IF
!
!  tag 43, flux star 4, band 3
!
   IF(kk == 4626)THEN
      suffixstr='flux4_V'
      labelstr='flux4_V'
   END IF
!
!  tag 44, flux star 4, band 4
!
   IF(kk == 4627)THEN
      suffixstr='flux4_R'
      labelstr='flux4_R'
   END IF
!
!  tag 45, flux star 4, band 5
!
   IF(kk == 4628)THEN
      suffixstr='flux4_I'
      labelstr='flux4_I'
   END IF
!
!  tag 46, flux star 4, band 6
!
   IF(kk == 4629)THEN
      suffixstr='flux4_J'
      labelstr='flux4_J'
   END IF
!
!  tag 47, flux star 4, band 7
!
   IF(kk == 4630)THEN
      suffixstr='flux4_H'
      labelstr='flux4_H'
   END IF
!
!  tag 48, flux star 4, band 8
!
   IF(kk == 4631)THEN
      suffixstr='flux4_K'
      labelstr='flux4_K'
   END IF
!
!  tag 51, flux star 5, band 1
!
   IF(kk == 4656)THEN
      suffixstr='flux5_U'
      labelstr='flux5_U'
   END IF
!
!  tag 52, flux star 5, band 2
!
   IF(kk == 4657)THEN
      suffixstr='flux5_B'
      labelstr='flux5_B'
   END IF
!
!  tag 53, flux star 5, band 3
!
   IF(kk == 4658)THEN
      suffixstr='flux5_V'
      labelstr='flux5_V'
   END IF
!
!  tag 54, flux star 5, band 4
!
   IF(kk == 4659)THEN
      suffixstr='flux5_R'
      labelstr='flux5_R'
   END IF
!
!  tag 55, flux star 5, band 5
!
   IF(kk == 4660)THEN
      suffixstr='flux5_I'
      labelstr='flux5_I'
   END IF
!
!  tag 56, flux star 6, band 6
!
   IF(kk == 4661)THEN
      suffixstr='flux5_J'
      labelstr='flux5_J'
   END IF
!
!  tag 57, flux star 5, band 7
!
   IF(kk == 4662)THEN
      suffixstr='flux5_H'
      labelstr='flux5_H'
   END IF
!
!  tag 58, flux star 5, band 8
!
   IF(kk == 4663)THEN
      suffixstr='flux5_K'
      labelstr='flux5_K'
   END IF
!
!  tag ob, Omega_bin, nodal angle of binary
!
   IF(kk == 449)THEN
      suffixstr='Omega_bin'
      labelstr='Omega_bin (deg)'
   END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
   IF(kk == 450)THEN
      suffixstr='ecos'
      labelstr='e*cos(omega)'
   END IF
!
!  tag os, osine, e*sin(omega) for binary
!
   IF(kk == 466)THEN
      suffixstr='esin'
      labelstr='e*sin(omega)'
   END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1
!
   IF(kk == 1016)THEN
      suffixstr='rk1'
      labelstr='apsidal_k1'
   END IF
!
!  tag a2, rk2, tidal apsidal constant for star 2
!
   IF(kk == 1017)THEN
      suffixstr='rk2'
      labelstr='apsidal_k2'
   END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
   IF(kk == 649)THEN
      suffixstr='P2tconj'
      labelstr='P2tconj'
   END IF
!
!  tag ut, P2period
!
   IF(kk == 659)THEN
      suffixstr='P2period'
      labelstr='P2period (days)'
   END IF
!
!  tag uu, P2T0
!
   IF(kk == 660)THEN
      suffixstr='P2T0'
      labelstr='P2T0'
   END IF
!
!  tag uv, P2ecos
!
   IF(kk == 661)THEN
      suffixstr='P2ecos'
      labelstr='e2*cos(omega2)'
   END IF
!
!  tag uw, P2esin
!
   IF(kk == 662)THEN
      suffixstr='P2esin'
      labelstr='e2*sin(omega2)'
   END IF
!
!  tag ux, P2incl
!
   IF(kk == 663)THEN
      suffixstr='P2incl'
      labelstr='P2incl (deg)'
   END IF
!
!  tag uy, P2Omega
!
   IF(kk == 664)THEN
      suffixstr='P2Omega'
      labelstr='P2Omega (deg)'
   END IF
!
!  tag uz, P2Q
!
   IF(kk == 665)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P2Q'
      IF(it1 == 0)labelstr='P2Q [(M1+M2)/M4]'
      IF(it1 == 1)labelstr='log(P2Q) [(M1+M2)/M4]'
      IF(it1 == 2)labelstr= 'P2Q (Mass of body 4 in Earth masses)'
   END IF
!
!  tag ub, P2ratrad
!
   IF(kk == 641)THEN
      suffixstr='P2ratrad'
      labelstr='P2ratrad (R1/R4)'
   END IF
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
   IF(kk == 681)THEN
      suffixstr='P3tconj'
      labelstr='P3tconj'
   END IF
!
!  tag vt, P3period
!
   IF(kk == 691)THEN
      suffixstr='P3period'
      labelstr='P3period (days)'
   END IF
!
!  tag vu, P3T0
!
   IF(kk == 692)THEN
      suffixstr='P3T0'
      labelstr='P3T0'
   END IF
!
!  tag vv, P3ecos
!
   IF(kk == 693)THEN
      suffixstr='P3ecos'
      labelstr='e3*cos(omega3)'
   END IF
!
!  tag vw, P3esin
!
   IF(kk == 694)THEN
      suffixstr='P3esin'
      labelstr='e3*sin(omega3)'
   END IF
!
!  tag vx, P3incl
!
   IF(kk == 695)THEN
      suffixstr='P3incl'
      labelstr='P3incl (deg)'
   END IF
!
!  tag vy, P3Omega
!
   IF(kk == 696)THEN
      suffixstr='P3Omega'
      labelstr='P3Omega (deg)'
   END IF
!
!  tag vz, P3Q
!
   IF(kk == 697)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P3Q'
      IF(it1 == 0)labelstr='P3Q [(M1+M2)/M5]'
      IF(it1 == 1)labelstr='log(P3Q) [(M1+M2)/M5]'
      IF(it1 == 2)labelstr= 'P3Q (Mass of body 5 in Earth masses)'
   END IF
!
!  tag vb, P3ratrad
!
   IF(kk == 673)THEN
      suffixstr='P3ratrad'
      labelstr='P3ratrad (R1/R5)'
   END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
   IF(kk == 713)THEN
      suffixstr='P4tconj'
      labelstr='P4tconj'
   END IF
!
!  tag wt, P4period
!
   IF(kk == 723)THEN
      suffixstr='P4period'
      labelstr='P4period (days)'
   END IF
!
!  tag wu, P4T0
!
   IF(kk == 724)THEN
      suffixstr='P4T0'
      labelstr='P4T0'
   END IF
!
!  tag wv, P4ecos
!
   IF(kk == 725)THEN
      suffixstr='P4ecos'
      labelstr='e4*cos(omega4)'
   END IF
!
!  tag ww, P4esin
!
   IF(kk == 726)THEN
      suffixstr='P4esin'
      labelstr='e4*sin(omega4)'
   END IF
!
!  tag wx, P4incl
!
   IF(kk == 727)THEN
      suffixstr='P4incl'
      labelstr='P4incl (deg)'
   END IF
!
!  tag wy, P4Omega
!
   IF(kk == 728)THEN
      suffixstr='P4Omega'
      labelstr='P4Omega (deg)'
   END IF
!
!  tag wz, P4Q
!
   IF(kk == 729)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P4Q'
      IF(it1 == 0)labelstr='P4Q [(M1+M2)/M6]'
      IF(it1 == 1)labelstr='log(P4Q) [(M1+M2)/M6]'
      IF(it1 == 2)labelstr= 'P4Q (Mass of body 6 in Earth masses)'
   END IF
!
!  tag wb, P4ratrad
!
   IF(kk == 705)THEN
      suffixstr='P4ratrad'
      labelstr='P4ratrad (R1/R6)'
   END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
   IF(kk == 745)THEN
      suffixstr='P5tconj'
      labelstr='P5tconj'
   END IF
!
!  tag xt, P5period
!
   IF(kk == 755)THEN
      suffixstr='P5period'
      labelstr='P5period (days)'
   END IF
!
!  tag xu, P5T0
!
   IF(kk == 756)THEN
      suffixstr='P5T0'
      labelstr='P5T0'
   END IF
!
!  tag xv, P5ecos
!
   IF(kk == 757)THEN
      suffixstr='P5ecos'
      labelstr='e5*cos(omega5)'
   END IF
!
!  tag xw, P5esin
!
   IF(kk == 758)THEN
      suffixstr='P5esin'
      labelstr='e5*sin(omega5)'
   END IF
!
!  tag xx, P5incl
!
   IF(kk == 759)THEN
      suffixstr='P5incl'
      labelstr='P5incl (deg)'
   END IF
!
!  tag xy, P5Omega
!
   IF(kk == 760)THEN
      suffixstr='P5Omega'
      labelstr='P5Omega (deg)'
   END IF
!
!  tag xz, P5Q
!
   IF(kk == 761)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P5Q'
      IF(it1 == 0)labelstr='P5Q [(M1+M2)/M7]'
      IF(it1 == 1)labelstr='log(P5Q) [(M1+M2)/M7]'
      IF(it1 == 2)labelstr= 'P5Q (Mass of body 7 in Earth masses)'
   END IF
!
!  tag xb, P5ratrad
!
   IF(kk == 737)THEN
      suffixstr='P5ratrad'
      labelstr='P5ratrad (R1/R7)'
   END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
   IF(kk == 585)THEN
      suffixstr='P6tconj'
      labelstr='P6tconj'
   END IF
!
!  tag st, P6period
!
   IF(kk == 595)THEN
      suffixstr='P6period'
      labelstr='P6period (days)'
   END IF
!
!  tag su, P6T0
!
   IF(kk == 596)THEN
      suffixstr='P6T0'
      labelstr='P6T0'
   END IF
!
!  tag sv, P6ecos
!
   IF(kk == 597)THEN
      suffixstr='P6ecos'
      labelstr='e6*cos(omega6)'
   END IF
!
!  tag sw, P6esin
!
   IF(kk == 598)THEN
      suffixstr='P6esin'
      labelstr='e6*sin(omega6)'
   END IF
!
!  tag sx, P6incl
!
   IF(kk == 599)THEN
      suffixstr='P6incl'
      labelstr='P6incl (deg)'
   END IF
!
!  tag sy, P6Omega
!
   IF(kk == 600)THEN
      suffixstr='P6Omega'
      labelstr='P6Omega (deg)'
   END IF
!
!  tag sz, P6Q
!
   IF(kk == 601)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P6Q'
      IF(it1 == 0)labelstr='P6Q [(M1+M2)/M8]'
      IF(it1 == 1)labelstr='log(P6Q) [(M1+M2)/M8]'
      IF(it1 == 2)labelstr= 'P6Q (Mass of body 8 in Earth masses)'
   END IF
!
!  tag sb, P6ratrad
!
   IF(kk == 577)THEN
      suffixstr='P6ratrad'
      labelstr='P6ratrad (R1/R8)'
   END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
   IF(kk == 233)THEN
      suffixstr='P7tconj'
      labelstr='P7tconj'
   END IF
!
!  tag ht, P7period
!
   IF(kk == 243)THEN
      suffixstr='P7period'
      labelstr='P7period (days)'
   END IF
!
!  tag hu, P7T0
!
   IF(kk == 244)THEN
      suffixstr='P7T0'
      labelstr='P7T0'
   END IF
!
!  tag hv, P7ecos
!
   IF(kk == 245)THEN
      suffixstr='P7ecos'
      labelstr='e7*cos(omega7)'
   END IF
!
!  tag hw, P7esin
!
   IF(kk == 246)THEN
      suffixstr='P7esin'
      labelstr='e7*sin(omega7)'
   END IF
!
!  tag hx, P7incl
!
   IF(kk == 247)THEN
      suffixstr='P7incl'
      labelstr='P7incl (deg)'
   END IF
!
!  tag hy, P7Omega
!
   IF(kk == 248)THEN
      suffixstr='P7Omega'
      labelstr='P7Omega (deg)'
   END IF
!
!  tag hz, P7Q
!
   IF(kk == 249)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P7Q'
      IF(it1 == 0)labelstr='P7Q [(M1+M2)/M9]'
      IF(it1 == 1)labelstr='log(P7Q) [(M1+M2)/M9]'
      IF(it1 == 2)labelstr= 'P7Q (Mass of body 9 in Earth masses)'
   END IF
!
!  tag hb, P7ratrad
!
   IF(kk == 225)THEN
      suffixstr='P7ratrad'
      labelstr='P7ratrad (R1/R9)'
   END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
   IF(kk == 329)THEN
      suffixstr='P8tconj'
      labelstr='P8tconj'
   END IF
!
!  tag kt, P8period
!
   IF(kk == 339)THEN
      suffixstr='P8period'
      labelstr='P8period (days)'
   END IF
!
!  tag ku, P8T0
!
   IF(kk == 340)THEN
      suffixstr='P8T0'
      labelstr='P8T0'
   END IF
!
!  tag kv, P8ecos
!
   IF(kk == 341)THEN
      suffixstr='P8ecos'
      labelstr='e8*cos(omega8)'
   END IF
!
!  tag kw, P8esin
!
   IF(kk == 342)THEN
      suffixstr='P8esin'
      labelstr='e8*sin(omega8)'
   END IF
!
!  tag kx, P8incl
!
   IF(kk == 343)THEN
      suffixstr='P8incl'
      labelstr='P8incl (deg)'
   END IF
!
!  tag ky, P8Omega
!
   IF(kk == 344)THEN
      suffixstr='P8Omega'
      labelstr='P8Omega (deg)'
   END IF
!
!  tag kz, P8Q
!
   IF(kk == 345)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P8Q'
      IF(it1 == 0)labelstr='P8Q [(M1+M2)/M10]'
      IF(it1 == 1)labelstr='log(P8Q) [(M1+M2)/M10]'
      IF(it1 == 2)labelstr= 'P8Q (Mass of body 10 in Earth masses)'
   END IF
!
!  tag kb, P8ratrad
!
   IF(kk == 321)THEN
      suffixstr='P8ratrad'
      labelstr='P8ratrad (R1/R10)'
   END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
   IF(kk == 1208)THEN
      suffixstr='Tgrav1'
      labelstr='Tgrav1'
   END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
   IF(kk == 1209)THEN
      suffixstr='Tgrav2'
      labelstr='Tgrav2'
   END IF
!
!  tag s0, contamS0, contamination season 0
!
   IF(kk == 1591)THEN
      suffixstr='contamS0'
      labelstr='contamS0'
   END IF
!
!  tag s1, contamS1, contamination season 1
!
   IF(kk == 1592)THEN
      suffixstr='contamS1'
      labelstr='contamS1'
   END IF
!
!  tag s2, contamS2, contamination season 2
!
   IF(kk == 1593)THEN
      suffixstr='contamS2'
      labelstr='contamS2'
   END IF
!
!  tag s3, contamS3, contamination season 3
!
   IF(kk == 1594)THEN
      suffixstr='contamS3'
      labelstr='contamS3'
   END IF
!
!  tag do, omegadot
!
   IF(kk == 110)THEN
      suffixstr='omega_dot'
      labelstr='omega_dot (deg/sec)'
   END IF
!
!  tag tt, tertperiod, orbital period of body 3
!
   IF(kk == 627)THEN
      suffixstr='P1period'
      labelstr='P1period (days)'
   END IF
!
!  tag tu, tertT0, periastron passage of body 3 orbit
!
   IF(kk == 628)THEN
      suffixstr='P1T0'
      labelstr='P1T0'
   END IF
!
!  tag tj, tertconj, time of primary conjunction of body 3 orbit
!
   IF(kk == 617)THEN
      suffixstr='P1tconj'
      labelstr='P1tconj'
   END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3 orbit
!
   IF(kk == 629)THEN
      suffixstr='P1ecos'
      labelstr='e1*cos(omega1)'
   END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3 orbit
!
   IF(kk == 630)THEN
      suffixstr='P1esin'
      labelstr='e1*sin(omega1)'
   END IF
!
!  tag tx, tertincl, inclination of body 3 orbit
!
   IF(kk == 631)THEN
      suffixstr='P1incl'
      labelstr='P1incl (deg)'
   END IF
!
!  tag ty, tertOmega, nodal angle of body 3 orbit
!
   IF(kk == 632)THEN
      suffixstr='P1Omega'
      labelstr='P1Omega (deg)'
   END IF
!
!  tag tz, tertQ, mass ratio of body 3
!
   IF(kk == 633)THEN
      it1=0
      CALL checklog(it1)
      IF(it1 > 2)it1=0
      suffixstr='P1Q'
      IF(it1 == 0)labelstr='P1Q [(M1+M2)/M3]'
      IF(it1 == 1)labelstr='log(P1Q) [(M1+M2)/M3]'
      IF(it1 == 2)labelstr= 'P1Q (Mass of body 3 in Earth masses)'
   END IF
!
!  tag tb, tertratrad, radius ratio of body 3
!
   IF(kk == 609)THEN
      suffixstr='P1ratrad'
      labelstr='P1ratrad (R1/R3)'
   END IF
!
!  tag co, contam, Kepler contamination
!
   IF(kk == 78)THEN
      suffixstr='contam'
      labelstr='Kepler contamination'
   END IF
!
!  tag e1, beam1, Doppler boosting coefficient for star 1
!
   IF(kk == 1144)THEN
      suffixstr='beam1'
      labelstr='beam1'
   END IF
!
!  tag e2, beam2, Doppler boosting coefficient for star 2
!
   IF(kk == 1145)THEN
      suffixstr='beam2'
      labelstr='beam2'
   END IF
!
!  tag pm, primmass, mass of star 1 in solar masses
!
   IF(kk == 492)THEN
      suffixstr='primmass'
      labelstr='M1 (solar)'
   END IF
!
!  tag pr, primrad, radius of star in solar radii
!
   IF(kk == 497)THEN
      suffixstr='primrad'
      labelstr='R1 (solar)'
   END IF
!
!  tag te, temprat, ratio of star 2 temperature to star 1 temperature
!
   IF(kk == 612)THEN
      suffixstr='temprat'
      labelstr='T2/T1'
   END IF
!
!  tag pk, primK, K-velocity of star 1 in km/sec
!
   IF(kk == 490)THEN
      suffixstr='primK'
      labelstr='K1 (km/sec)'
   END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
   IF(kk == 544)THEN
      suffixstr='ratrad'
      labelstr='R1/R2'
   END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
   IF(kk == 1528)THEN
      suffixstr='frac1'
      labelstr='frac1 (R1/a)'
   END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
   IF(kk == 1529)THEN
      suffixstr='frac2'
      labelstr='frac2 (R2/a)'
   END IF
!
!  tag de, density, density of star 1 in cgs
!
   IF(kk == 100)THEN
      suffixstr='density'
      labelstr='density1 (g/cc)'
   END IF
!
!  tag l1, alb1, albedo of star 1
!
   IF(kk == 1368)THEN
      suffixstr='al1'
      labelstr='albedo1'
   END IF
!
!  tag l2, alb2, albedo of star 2
!
   IF(kk == 1369)THEN
      suffixstr='al2'
      labelstr='albedo2'
   END IF
!
!  tag dp, dphi, phase difference between secondary and primary eclipse
!
   IF(kk == 111)THEN
      suffixstr='dphi'
      labelstr='dphi'
   END IF
!
!  tag tc, Tconj, time of primary conjunction of the binary orbit
!
   IF(kk == 610)THEN
      suffixstr='Tconj'
      labelstr='Tconj'
   END IF
!
!  tag t0, T0, time of periastron passage of binary orbit
!
   IF(kk == 1623)THEN
      suffixstr='T0'
      labelstr='T0'
   END IF
!
!  tag p2, period, binary orbital period in days
!
   IF(kk == 484)THEN
      suffixstr='P'
      labelstr='binary period (days)'
   END IF
!
!  tag in, finc, inclination of binary in degrees
!
   IF(kk == 269)THEN
      suffixstr='i'
      labelstr='binary inclination (deg)'
   END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
   IF(kk == 8)THEN
      suffixstr='bigI'
      labelstr='bigI (deg)'
   END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
   IF(kk == 1)THEN
      suffixstr='bigbeta'
      labelstr='bigbeta (deg)'
   END IF
!
!  tag ma, Q, mass ratio of binary
!
   IF(kk == 384)THEN
      suffixstr='Q'
      labelstr='Q (M2/M1)'
   END IF
!
!  tag f1, fill1, Roche lobe filling factor of star 1
!
   IF(kk == 1176)THEN
      suffixstr='fill1'
      labelstr='fill1'
   END IF
!
!  tag f2, fill2, Roche lobe filling factor of star 2
!
   IF(kk == 1177)THEN
      suffixstr='fill2'
      labelstr='fill2'
   END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
   IF(kk == 552)THEN
      suffixstr='rin'
      labelstr='rinner'
   END IF
!
!  tag o1, omega1, spin frequency of star 1
!
   IF(kk == 1464)THEN
      suffixstr='omega1'
      labelstr='omega1'
   END IF
!
!  tag o2, spin frequency of star 2
!
   IF(kk == 1465)THEN
      suffixstr='omega2'
      labelstr='omega2'
   END IF
!
!  tag ro, router, radius of outer edge of accretion disk
!
   IF(kk == 558)THEN
      suffixstr='rout'
      labelstr='r_outer'
   END IF
!
!  tag t3, Teff3, effective temperature of star 3
!
   IF(kk == 1626)THEN
      suffixstr='Teff3'
      labelstr='Teff3 (K)'
   END IF
!
!  tag t4, Teff4, effective temperature of star 4
!
   IF(kk == 1627)THEN
      suffixstr='Teff4'
      labelstr='Teff4 (K)'
   END IF
!
!  tag t5, Teff5, effective temperature of star 5
!
   IF(kk == 1628)THEN
      suffixstr='Teff5'
      labelstr='Teff5 (K)'
   END IF
!
!  tag g3, g3, gravity of star 3 (log(g))
!
   IF(kk == 1210)THEN
      suffixstr='g3'
      labelstr='log(g3)'
   END IF
!
!  tag g4, g4, gravity of star 4 (log(g))
!
   IF(kk == 1210)THEN
      suffixstr='g4'
      labelstr='log(g4)'
   END IF
!
!  tag g5, g5, gravity of star 5 (log(g))
!
   IF(kk == 1210)THEN
      suffixstr='g5'
      labelstr='log(g5)'
   END IF
!
!  tag be, betarim, opening angle of accretion disk rim
!
   IF(kk == 36)THEN
      suffixstr='beta_rim'
      labelstr='beta_rim (deg)'
   END IF
!
!  tag t1, Teff1, effective temperature of star 1
!
   IF(kk == 1624)THEN
      suffixstr='Teff1'
      labelstr='Teff1 (K)'
   END IF
!
!  tag t2, Teff2, effective temperature of star 2
!
   IF(kk == 1625)THEN
      suffixstr='Teff2'
      labelstr='Teff2 (K)'
   END IF
!
!  tag xi, xi, power-law exponent of the disk temperature profile
!
   IF(kk == 744)THEN
      suffixstr='xi'
      labelstr='xi'
   END IF
!
!  tag td, Tdisk, temperature of the inner edge of the accretion disk
!
   IF(kk == 611)THEN
      suffixstr='Tdisk'
      labelstr='Tdisk'
   END IF
!
!  tag lx, rLx, log of the X-ray luminosity in cgs units
!
   IF(kk == 375)THEN
      suffixstr='Lx'
      labelstr='log(Lx) (erg/sec)'
   END IF
!
!  tag se, separ, semimajor axis of binary orbit
!
   IF(kk == 580)THEN
      suffixstr='separ'
      labelstr='separation (solar)'
   END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
   IF(kk == 576)THEN
      suffixstr='SA3'
      labelstr='SA3 (R3/R1)^2'
   END IF
!
!  tag ps, pshift
!
   IF(kk == 498)THEN
      suffixstr='pshift'
      labelstr='pshift'
   END IF
!
!  tag ec, ecc, eccentricity of binary orbit
!
   IF(kk == 130)THEN
      suffixstr='ecc'
      labelstr='binary eccentricity'
   END IF
!
!  tag ar, argper, argument of periastron of binary orbit
!
   IF(kk == 17)THEN
      suffixstr='argper'
      labelstr='binary arg_per (deg)'
   END IF
!
!  tag b1, temperature factor spot 1, star 1
!
   IF(kk == 1048)THEN
      suffixstr='TF_spot1_star1'
      labelstr='TF_spot1_star1'
   END IF
!
!  tag b2, latitude spot 1, star 1
!
   IF(kk == 1049)THEN
      suffixstr='lat_spot1_star1'
      labelstr='lat_spot1_star1 (deg)'
   END IF
!
!  tag b3, longitude spot 1, star 1
!
   IF(kk == 1050)THEN
      suffixstr='lon_spot1_star1'
      labelstr='lon_spot1_star1 (deg)'
   END IF
!
!  tag  b4, radius spot 1, star 1
!
   IF(kk == 1051)THEN
      suffixstr='rad_spot1_star1'
      labelstr='rad_spot1_star1 (deg)'
   END IF
!
!  tag b5, temperature factor spot 2, star 1
!
   IF(kk == 1052)THEN
      suffixstr='TF_spot2_star1'
      labelstr='TF_spot2_star1'
   END IF
!
!  tag b6,  latitude spot 2, star 1
!
   IF(kk == 1053)THEN
      suffixstr='lat_spot2_star1'
      labelstr='lat_spot2_star1 (deg)'
   END IF
!
!  tag b7, longitude spot 2, star 1
!
   IF(kk == 1054)THEN
      suffixstr='lon_spot2_star1'
      labelstr='lon_spot2_star1 (deg)'
   END IF
!
!  tag b8, radius spot 2, star 1
!
   IF(kk == 1055)THEN
      suffixstr='rad_spot2_star1'
      labelstr='rad_spot2_star1 (deg)'
   END IF
!
!  tag c1, temperature factor spot 1, star 2
!
   IF(kk == 1080)THEN
      suffixstr='TF_spot1_star2'
      labelstr='TF_spot1_star2'
   END IF
!
!  tag c2, latitude spot 1, star 2
!
   IF(kk == 1081)THEN
      suffixstr='lat_spot1_star2'
      labelstr='lat_spot1_star2 (deg)'
   END IF
!
!  tag c3, longitude spot 1, star 2
!
   IF(kk == 1082)THEN
      suffixstr='lon_spot1_star2'
      labelstr='lon_spot1_star2 (deg)'
   END IF
!
!  tag c4, radius spot 1, star 2
!
   IF(kk == 1083)THEN
      suffixstr='rad_spot1_star2'
      labelstr='rad_spot1_star2 (deg)'
   END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
   IF(kk == 1084)THEN
      suffixstr='TF_spot2_star2'
      labelstr='TF_spot2_star2'
   END IF
!
!  tag c6, latitude spot 2, star 2
!
   IF(kk == 1085)THEN
      suffixstr='lat_spot2_star2'
      labelstr='lat_spot2_star2 (deg)'
   END IF
!
!  tag c7, longitude spot 2, star 2
!
   IF(kk == 1086)THEN
      suffixstr='lon_spot2_star2'
      labelstr='lon_spot2_star2 (deg)'
   END IF
!
!  tag c8, radius spot 2, star 2
!
   IF(kk == 1087)THEN
      suffixstr='rad_spot2_star2'
      labelstr='rad_spot2_star2 (deg)'
   END IF
!
!  tag d1, temperature factor spot 1 on disk
!
   IF(kk == 1112)THEN
      suffixstr='TF_spot1_disk'
      labelstr='TF_spot1_disk'
   END IF
!
!  tag d2, azimuth spot 1 on disk
!
   IF(kk == 1113)THEN
      suffixstr='azi_spot1_disk'
      labelstr='azi_spot1_disk (deg)'
   END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
   IF(kk == 1114)THEN
      suffixstr='cut_spot1_disk'
      labelstr='cut_spot1_disk'
   END IF
!
!  tag d4, angular width of spot 1 on disk
!
   IF(kk == 1115)THEN
      suffixstr='wid_spot1_disk'
      labelstr='wid_spot1_disk (deg)'
   END IF
!
!  tag d5, temperature factor spot 2 on disk
!
   IF(kk == 1116)THEN
      suffixstr='TF_spot2_disk'
      labelstr='TF_spot2_disk'
   END IF
!
!  tag d6, azimuth spot 2 on disk
!
   IF(kk == 1117)THEN
      suffixstr='azi_spot2_disk'
      labelstr='azi_spot2_disk (deg)'
   END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
   IF(kk == 1118)THEN
      suffixstr='cut_spot2_disk'
      labelstr='cut_spot2_disk'
   END IF
!
!  tag d8, angular width of spot 2 on disk
!
   IF(kk == 1119)THEN
      suffixstr='wid_spot2_disk'
      labelstr='wid_spot2_disk (deg)'
   END IF
!
!  tag x1, limb darkening x-coefficient, band 1, star 1
!
   IF(kk == 1752)THEN
      suffixstr='x1_U'
      labelstr='x1_U'
   END IF
!
!  tag x2, limb darkening x-coefficient, band 2, star 1
!
   IF(kk == 1753)THEN
      suffixstr='x1_B'
      labelstr='x1_B'
   END IF
!
!  tag x3, limb darkening x-coefficient, band 3, star 1
!
   IF(kk == 1754)THEN
      suffixstr='x1_V'
      labelstr='x1_V'
   END IF
!
!  tag x4, limb darkening x-coefficient, band 4, star 1
!
   IF(kk == 1755)THEN
      suffixstr='x1_R'
      labelstr='x1_R'
   END IF
!
!  tag x5, limb darkening x-coefficient, band 5, star 1
!
   IF(kk == 1756)THEN
      suffixstr='x1_I'
      labelstr='x1_I'
   END IF
!
!  tag x6, limb darkening x-coefficient, band 6, star 1
!
   IF(kk == 1757)THEN
      suffixstr='x1_J'
      labelstr='x1_J'
   END IF
!
!  tag x7, limb darkening x-coefficient, band 7, star 1
!
   IF(kk == 1758)THEN
      suffixstr='x1_H'
      labelstr='x1_H'
   END IF
!
!  tag x8, limb darkening x-coefficient, band 8, star 1
!
   IF(kk == 1759)THEN
      suffixstr='x1_K'
      labelstr='x1_K'
   END IF
!
!  tag z1, limb darkening x-coefficient, band 1, star 2
!
   IF(kk == 1816)THEN
      suffixstr='x2_U'
      labelstr='x2_U'
   END IF
!
!  tag z2, limb darkening x-coefficient, band 2, star 2
!
   IF(kk == 1817)THEN
      suffixstr='x2_B'
      labelstr='x2_B'
   END IF
!
!  tag z3, limb darkening x-coefficient, band 3, star 2
!
   IF(kk == 1818)THEN
      suffixstr='x2_V'
      labelstr='x2_V'
   END IF
!
!  tag z4, limb darkening x-coefficient, band 4, star 2
!
   IF(kk == 1819)THEN
      suffixstr='x2_R'
      labelstr='x2_R'
   END IF
!
!  tag z5, limb darkening x-coefficient, band 5, star 2
!
   IF(kk == 1820)THEN
      suffixstr='x2_I'
      labelstr='x2_I'
   END IF
!
!  tag z6, limb darkening x-coefficient, band 6, star 2
!
   IF(kk == 1821)THEN
      suffixstr='x2_J'
      labelstr='x2_J'
   END IF
!
!  tag z7, limb darkening x-coefficient, band 7, star 2
!
   IF(kk == 1822)THEN
      suffixstr='x2_H'
      labelstr='x2_H'
   END IF
!
!  tag z8, limb darkening x-coefficient, band 8, star 2
!
   IF(kk == 1823)THEN
      suffixstr='x2_K'
      labelstr='x2_K'
   END IF
!
!  tag y1, limb darkening y-coefficient, band 1, star 1
!
   IF(kk == 1784)THEN
      suffixstr='y1_U'
      labelstr='y1_U'
   END IF
!
!  tag y2, limb darkening y-coefficient, band 2, star 1
!
   IF(kk == 1785)THEN
      suffixstr='y1_B'
      labelstr='y1_B'
   END IF
!
!  tag y3, limb darkening y-coefficient, band 3, star 1
!
   IF(kk == 1786)THEN
      suffixstr='y1_V'
      labelstr='y1_V'
   END IF
!
!  tag y4, limb darkening y-coefficient, band 4, star 1
!
   IF(kk == 1787)THEN
      suffixstr='y1_R'
      labelstr='y1_R'
   END IF
!
!  tag y5, limb darkening y-coefficient, band 5, star 1
!
   IF(kk == 1788)THEN
      suffixstr='y1_I'
      labelstr='y1_I'
   END IF
!
!  tag y6, limb darkening y-coefficient, band 6, star 1
!
   IF(kk == 1789)THEN
      suffixstr='y1_J'
      labelstr='y1_J'
   END IF
!
!  tag y7, limb darkening y-coefficient, band 7, star 1
!
   IF(kk == 1790)THEN
      suffixstr='y1_H'
      labelstr='y1_H'
   END IF
!
!  tag y8, limb darkening y-coefficient, band 8, star 1
!
   IF(kk == 1791)THEN
      suffixstr='y1_K'
      labelstr='y1_K'
   END IF
!
!  tag w1, limb darkening y-coefficient, band 1, star 2
!
   IF(kk == 1720)THEN
      suffixstr='y2_U'
      labelstr='y2_U'
   END IF
!
!  tag w2, limb darkening y-coefficient, band 2, star 2
!
   IF(kk == 1721)THEN
      suffixstr='y2_B'
      labelstr='y2_B'
   END IF
!
!  tag w3, limb darkening y-coefficient, band 3, star 2
!
   IF(kk == 1722)THEN
      suffixstr='y2_V'
      labelstr='y2_V'
   END IF
!
!  tag w4, limb darkening y-coefficient, band 4, star 2
!
   IF(kk == 1723)THEN
      suffixstr='y2_R'
      labelstr='y2_R'
   END IF
!
!  tag w5, limb darkening y-coefficient, band 5, star 2
!
   IF(kk == 1724)THEN
      suffixstr='y2_I'
      labelstr='y2_I'
   END IF
!
!  tag w6, limb darkening y-coefficient, band 6, star 2
!
   IF(kk == 1725)THEN
      suffixstr='y2_J'
      labelstr='y2_J'
   END IF
!
!  tag w7, limb darkening y-coefficient, band 7, star 2
!
   IF(kk == 1726)THEN
      suffixstr='y2_H'
      labelstr='y2_H'
   END IF
!
!  tag w8, limb darkening y-coefficient, band 8, star 2
!
   IF(kk == 1727)THEN
      suffixstr='y2_K'
      labelstr='y2_K'
   END IF
!
!  tag m1, limb darkening x-coefficient, band 1, star 3
!
   IF(kk == 1400)THEN
      suffixstr='x3_U'
      labelstr='x3_U'
   END IF
!
!  tag m2, limb darkening x-coefficient, band 2, star 3
!
   IF(kk == 1401)THEN
      suffixstr='x3_B'
      labelstr='x3_B'
   END IF
!
!  tag m3, limb darkening x-coefficient, band 3, star 3
!
   IF(kk == 1402)THEN
      suffixstr='x3_V'
      labelstr='x3_V'
   END IF
!
!  tag m4, limb darkening x-coefficient, band 4, star 3
!
   IF(kk == 1403)THEN
      suffixstr='x3_R'
      labelstr='x3_R'
   END IF
!
!  tag m5, limb darkening x-coefficient, band 5, star 3
!
   IF(kk == 1404)THEN
      suffixstr='x3_I'
      labelstr='x3_I'
   END IF
!
!  tag m6, limb darkening x-coefficient, band 6, star 3
!
   IF(kk == 1405)THEN
      suffixstr='x3_J'
      labelstr='x3_J'
   END IF
!
!  tag m7, limb darkening x-coefficient, band 7, star 3
!
   IF(kk == 1406)THEN
      suffixstr='x3_H'
      labelstr='x3_H'
   END IF
!
!  tag m8, limb darkening x-coefficient, band 8, star 3
!
   IF(kk == 1407)THEN
      suffixstr='x3_K'
      labelstr='x3_K'
   END IF
!
!  tag n1, limb darkening y-coefficient, band 1, star 3
!
   IF(kk == 1432)THEN
      suffixstr='y3_U'
      labelstr='y3_U'
   END IF
!
!  tag n2, limb darkening y-coefficient, band 2, star 3
!
   IF(kk == 1433)THEN
      suffixstr='y3_B'
      labelstr='y3_B'
   END IF
!
!  tag n3, limb darkening y-coefficient, band 3, star 3
!
   IF(kk == 1434)THEN
      suffixstr='y3_V'
      labelstr='y3_V'
   END IF
!
!  tag n4, limb darkening y-coefficient, band 4, star 3
!
   IF(kk == 1435)THEN
      suffixstr='y3_R'
      labelstr='y3_R'
   END IF
!
!  tag n5, limb darkening y-coefficient, band 5, star 3
!
   IF(kk == 1436)THEN
      suffixstr='y3_I'
      labelstr='y3_I'
   END IF
!
!  tag n6, limb darkening y-coefficient, band 6, star 3
!
   IF(kk == 1437)THEN
      suffixstr='y3_J'
      labelstr='y3_J'
   END IF
!
!  tag n7, limb darkening y-coefficient, band 7, star 3
!
   IF(kk == 1438)THEN
      suffixstr='y3_H'
      labelstr='y3_H'
   END IF
!
!  tag n8, limb darkening y-coefficient, band 8, star 3
!
   IF(kk == 1439)THEN
      suffixstr='y3_K'
      labelstr='y3_K'
   END IF
!
!  tag i1, limb darkening x-coefficient, band 1, star 4
!
   IF(kk == 1272)THEN
      suffixstr='x4_U'
      labelstr='x4_U'
   END IF
!
!  tag i2, limb darkening x-coefficient, band 2, star 4
!
   IF(kk == 1273)THEN
      suffixstr='x4_B'
      labelstr='x4_B'
   END IF
!
!  tag i3, limb darkening x-coefficient, band 3, star 4
!
   IF(kk == 1274)THEN
      suffixstr='x4_V'
      labelstr='x4_V'
   END IF
!
!  tag i4, limb darkening x-coefficient, band 4, star 4
!
   IF(kk == 1275)THEN
      suffixstr='x4_R'
      labelstr='x4_R'
   END IF
!
!  tag i5, limb darkening x-coefficient, band 5, star 4
!
   IF(kk == 1276)THEN
      suffixstr='x4_I'
      labelstr='x4_I'
   END IF
!
!  tag i6, limb darkening x-coefficient, band 6, star 4
!
   IF(kk == 1277)THEN
      suffixstr='x4_J'
      labelstr='x4_J'
   END IF
!
!  tag i7, limb darkening x-coefficient, band 7, star 4
!
   IF(kk == 1278)THEN
      suffixstr='x4_H'
      labelstr='x4_H'
   END IF
!
!  tag i8, limb darkening x-coefficient, band 8, star 4
!
   IF(kk == 1279)THEN
      suffixstr='x4_K'
      labelstr='x4_K'
   END IF
!
!  tag j1, limb darkening y-coefficient, band 1, star 4
!
   IF(kk == 1304)THEN
      suffixstr='y4_U'
      labelstr='y4_U'
   END IF
!
!  tag j2, limb darkening y-coefficient, band 2, star 4
!
   IF(kk == 1305)THEN
      suffixstr='y4_B'
      labelstr='y4_B'
   END IF
!
!  tag j3, limb darkening y-coefficient, band 3, star 4
!
   IF(kk == 1306)THEN
      suffixstr='y4_V'
      labelstr='y4_V'
   END IF
!
!  tag j4, limb darkening y-coefficient, band 4, star 4
!
   IF(kk == 1307)THEN
      suffixstr='y4_R'
      labelstr='y4_R'
   END IF
!
!  tag j5, limb darkening y-coefficient, band 5, star 4
!
   IF(kk == 1308)THEN
      suffixstr='y4_I'
      labelstr='y4_I'
   END IF
!
!  tag j6, limb darkening y-coefficient, band 6, star 4
!
   IF(kk == 1309)THEN
      suffixstr='y4_J'
      labelstr='y4_J'
   END IF
!
!  tag j7, limb darkening y-coefficient, band 7, star 4
!
   IF(kk == 1310)THEN
      suffixstr='y4_H'
      labelstr='y4_H'
   END IF
!
!  tag j8, limb darkening y-coefficient, band 8, star 4
!
   IF(kk == 1311)THEN
      suffixstr='y4_K'
      labelstr='y4_K'
   END IF
!
!  tag k1, limb darkening x-coefficient, band 1, star 5
!
   IF(kk == 1336)THEN
      suffixstr='x5_U'
      labelstr='x5_U'
   END IF
!
!  tag k2, limb darkening x-coefficient, band 2, star 5
!
   IF(kk == 1337)THEN
      suffixstr='x5_B'
      labelstr='x5_B'
   END IF
!
!  tag k3, limb darkening x-coefficient, band 3, star 5
!
   IF(kk == 1338)THEN
      suffixstr='x5_V'
      labelstr='x5_V'
   END IF
!
!  tag k4, limb darkening x-coefficient, band 4, star 5
!
   IF(kk == 1339)THEN
      suffixstr='x5_R'
      labelstr='x5_R'
   END IF
!
!  tag k5, limb darkening x-coefficient, band 5, star 5
!
   IF(kk == 1340)THEN
      suffixstr='x5_I'
      labelstr='x5_I'
   END IF
!
!  tag k6, limb darkening x-coefficient, band 6, star 5
!
   IF(kk == 1341)THEN
      suffixstr='x5_J'
      labelstr='x5_J'
   END IF
!
!  tag k7, limb darkening x-coefficient, band 7, star 5
!
   IF(kk == 1342)THEN
      suffixstr='x5_H'
      labelstr='x5_H'
   END IF
!
!  tag k8, limb darkening x-coefficient, band 8, star 5
!
   IF(kk == 1343)THEN
      suffixstr='x5_K'
      labelstr='x5_K'
   END IF
!
!  tag p1, limb darkening y-coefficient, band 1, star 5
!
   IF(kk == 1496)THEN
      suffixstr='y5_U'
      labelstr='y5_U'
   END IF
!
!  tag p2, limb darkening y-coefficient, band 2, star 5
!
   IF(kk == 1497)THEN
      suffixstr='y5_B'
      labelstr='y5_B'
   END IF
!
!  tag p3, limb darkening y-coefficient, band 3, star 5
!
   IF(kk == 1498)THEN
      suffixstr='y5_V'
      labelstr='y5_V'
   END IF
!
!  tag p4, limb darkening y-coefficient, band 4, star 5
!
   IF(kk == 1499)THEN
      suffixstr='y5_R'
      labelstr='y5_R'
   END IF
!
!  tag p5, limb darkening y-coefficient, band 5, star 5
!
   IF(kk == 1500)THEN
      suffixstr='y5_I'
      labelstr='y5_I'
   END IF
!
!  tag p6, limb darkening y-coefficient, band 6, star 5
!
   IF(kk == 1501)THEN
      suffixstr='y5_J'
      labelstr='y5_J'
   END IF
!
!  tag p7, limb darkening y-coefficient, band 7, star 5
!
   IF(kk == 1502)THEN
      suffixstr='y5_H'
      labelstr='y5_H'
   END IF
!
!  tag p8, limb darkening y-coefficient, band 8, star 5
!
   IF(kk == 1503)THEN
      suffixstr='y5_K'
      labelstr='y5_K'
   END IF
!
   RETURN
!
END SUBROUTINE getsuffix
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE gscaleadjust(ig,aa,fjumparr,ave,targt,ifracjump)
!
!  This routine is used by demcmcELC to adjust its step size
!  to get a jump fraction of targt.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ifracjump
   INTEGER, INTENT(IN)                      :: ig
   REAL(KIND=dp), INTENT(OUT)               :: aa
   REAL(KIND=dp), INTENT(IN)                :: fjumparr(ifracjump)
   REAL(KIND=dp), INTENT(OUT)               :: ave
   REAL(KIND=dp), INTENT(IN)                :: targt
!
   REAL(KIND=dp)  :: diff,summ
!
   INTEGER :: i,icount
!
   summ=0.0_dp
   icount=0
   DO i=ig-20,ig
      summ=summ+fjumparr(i)
      icount=icount+1
   END DO
   ave=summ/REAL(icount,KIND=dp)
   diff=targt-ave
!
!          if((diff.gt.0.3d0).and.(diff.lt.0.4d0))return
!
   IF(ave < targt-0.05_dp)THEN
      aa=aa*0.9_dp
      RETURN
   END IF
   IF(ave > targt+0.05_dp)THEN
      aa=aa*1.10_dp
      RETURN
   END IF
   aa=aa*SQRT(ave/targt)
   RETURN
!
END SUBROUTINE gscaleadjust
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
FUNCTION icnvrt(astring)
!
!    November 12, 1999
!
!    This function was stolen directly out of Peter Stetson's DAOPHOT IIe
!    source code.  The following are his comments:
!
!=======================================================================
!
! This little function is supposed to take two ASCII characters and
! express them as an integer in the range 0-(32**2-1) without
! distinguishing upper and lower case:
!
! AA = Aa = aA = aa = 0, AB = Ab = aB = ab = 1, BA = Ba = bA = ba = 32,
! etc.
!
! Argument
!
! ASTRING is a character string containing two ASCII characters.
!
!=======================================================================
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER ::   icnvrt
!
   CHARACTER(LEN=2), INTENT(IN)            :: astring
!
!-----------------------------------------------------------------------
!
   icnvrt=32*MOD(ICHAR(astring(1:1))-1,32)+MOD(ICHAR(astring(2:2))-1,32)
!
!   modifications to allow for numbers in the two
!   input characters
!
   IF(astring(2:2) == '0')icnvrt=icnvrt+1000
   IF(astring(2:2) == '1')icnvrt=icnvrt+1000
   IF(astring(2:2) == '2')icnvrt=icnvrt+1000
   IF(astring(2:2) == '3')icnvrt=icnvrt+1000
   IF(astring(2:2) == '4')icnvrt=icnvrt+1000
   IF(astring(2:2) == '5')icnvrt=icnvrt+1000
   IF(astring(2:2) == '6')icnvrt=icnvrt+1000
   IF(astring(2:2) == '7')icnvrt=icnvrt+1000
   IF(astring(2:2) == '8')icnvrt=icnvrt+1000
   IF(astring(2:2) == '9')icnvrt=icnvrt+1000
!
   IF(astring(1:1) == '0')icnvrt=icnvrt+3000
   IF(astring(1:1) == '1')icnvrt=icnvrt+3000
   IF(astring(1:1) == '2')icnvrt=icnvrt+3000
   IF(astring(1:1) == '3')icnvrt=icnvrt+3000
   IF(astring(1:1) == '4')icnvrt=icnvrt+3000
   IF(astring(1:1) == '5')icnvrt=icnvrt+3000
   IF(astring(1:1) == '6')icnvrt=icnvrt+3000
   IF(astring(1:1) == '7')icnvrt=icnvrt+3000
   IF(astring(1:1) == '8')icnvrt=icnvrt+3000
   IF(astring(1:1) == '9')icnvrt=icnvrt+3000
!
   RETURN
!
END FUNCTION icnvrt
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE initchi(chisqu,chisqb,chisqv,chisqr,chisqi,chisqj,  &
   chisqh,chisqk,chisqrv1,chisqrv2,chisqrv3,chisqrv4)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(OUT)               :: chisqu
   REAL(KIND=dp), INTENT(OUT)               :: chisqb
   REAL(KIND=dp), INTENT(OUT)               :: chisqv
   REAL(KIND=dp), INTENT(OUT)               :: chisqr
   REAL(KIND=dp), INTENT(OUT)               :: chisqi
   REAL(KIND=dp), INTENT(OUT)               :: chisqj
   REAL(KIND=dp), INTENT(OUT)               :: chisqh
   REAL(KIND=dp), INTENT(OUT)               :: chisqk
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv1
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv2
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv3
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv4
!
   chisqu=0.0_dp
   chisqb=0.0_dp
   chisqv=0.0_dp
   chisqr=0.0_dp
   chisqi=0.0_dp
   chisqj=0.0_dp
   chisqh=0.0_dp
   chisqk=0.0_dp
   chisqrv1=0.0_dp
   chisqrv2=0.0_dp
   chisqrv3=0.0_dp
   chisqrv4=0.0_dp
!
   RETURN
!
END SUBROUTINE initchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE initndata(ndatau,ndatab,ndatav,ndatar,ndatai,  &
   ndataj,ndatah,ndatak,nrv1,nrv2,nobv,nrv3,nrv4)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(OUT)                     :: ndatau
   INTEGER, INTENT(OUT)                     :: ndatab
   INTEGER, INTENT(OUT)                     :: ndatav
   INTEGER, INTENT(OUT)                     :: ndatar
   INTEGER, INTENT(OUT)                     :: ndatai
   INTEGER, INTENT(OUT)                     :: ndataj
   INTEGER, INTENT(OUT)                     :: ndatah
   INTEGER, INTENT(OUT)                     :: ndatak
   INTEGER, INTENT(OUT)                     :: nrv1
   INTEGER, INTENT(OUT)                     :: nrv2
   INTEGER, INTENT(OUT)                     :: nobv
   INTEGER, INTENT(OUT)                     :: nrv3
   INTEGER, INTENT(OUT)                     :: nrv4
!
   ndatau=0
   ndatab=0
   ndatav=0
   ndatar=0
   ndatai=0
   ndataj=0
   ndatah=0
   ndatak=0
   nrv1=0
   nrv2=0
   nrv3=0
   nrv4=0
   nobv=0
!
   RETURN
!
END SUBROUTINE initndata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE inversemat(a,c,n)
!
!============================================================
! Inverse matrix
! Method: Based on Doolittle LU factorization for Ax=b
! Alex G. December 2009
!-----------------------------------------------------------
! input ...
! a(n,n) - array of coefficients for matrix A
! n      - dimension
! output ...
! c(n,n) - inverse matrix of A
! comments ...
! the original matrix a(n,n) will be destroyed
! during the calculation
!===========================================================
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN OUT)            :: a(n,n)
   REAL(KIND=dp), INTENT(OUT)               :: c(n,n)
!
   REAL(KIND=dp)  :: l(100,100),u(100,100),b(100),d(100),x(100)
   REAL(KIND=dp)  :: coeff
!
   INTEGER :: i,j,k
!
! step 0: initialization for matrices L and U and b
! Fortran 90/95 aloows such operations on matrices
!
   DO i=1,100
      b(i)=0.0_dp
      d(i)=0.0_dp
      x(i)=0.0_dp
      DO j=1,100
         l(i,j)=0.0_dp
         u(i,j)=0.0_dp
      END DO
   END DO
!
! step 1: forward elimination
!
   DO k=1,n-1
      DO i=k+1,n
         coeff=a(i,k)/a(k,k)
         l(i,k)=coeff
         DO j=k+1,n
            a(i,j)=a(i,j)-coeff*a(k,j)
         END DO
      END DO
   END DO
!
! Step 2: prepare L and U matrices
! L matrix is a matrix of the elimination coefficient
! + the diagonal elements are 1.0
!
   DO i=1,n
      l(i,i)=1.0_dp
   END DO
!
! U matrix is the upper triangular part of A
!
   DO j=1,n
      DO i=1,j
         u(i,j)=a(i,j)
      END DO
   END DO
!
! Step 3: compute columns of the inverse matrix C
!
   DO k=1,n
      b(k)=1.0_dp
      d(1)=b(1)
!
! Step 3a: Solve Ld=b using the forward substitution
!
      DO i=2,n
         d(i)=b(i)
         DO j=1,i-1
            d(i)=d(i)-l(i,j)*d(j)
         END DO
      END DO
!
! Step 3b: Solve Ux=d using the back substitution
!
      x(n)=d(n)/u(n,n)
      DO i=n-1,1,-1
         x(i)=d(i)
         DO j=n,i+1,-1
            x(i)=x(i)-u(i,j)*x(j)
         END DO
         x(i)=x(i)/u(i,i)
      END DO
!
! Step 3c: fill the solutions x(n) into column k of C
!
      DO i=1,n
         c(i,k)=x(i)
      END DO
      b(k)=0.0_dp
   END DO
!
END SUBROUTINE inversemat
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE istring(instring,ichi,outstring,ilength)
!
!  Will combine an input string and an input integer in a compact
!  way for printing on the screen.
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER (LEN=*), INTENT(IN)            :: instring
   INTEGER, INTENT(IN)                      :: ichi
   CHARACTER (LEN=*), INTENT(OUT)           :: outstring
   INTEGER, INTENT(OUT)                     :: ilength
!
   INTEGER :: itemp
!
   ilength=0
   outstring=' '
!
!   1 digit positive
!
   IF((ichi >= 0).AND.(ichi < 10))THEN
      WRITE(outstring,10)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   2 digits positive
!
   IF((ichi >= 10).AND.(ichi < 100))THEN
      WRITE(outstring,20)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   3 digits positive
!
   IF((ichi >= 100).AND.(ichi < 1000))THEN
      WRITE(outstring,30)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   4 digits positive
!
   IF((ichi >= 1000).AND.(ichi < 10000))THEN
      WRITE(outstring,40)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   5 digits positive
!
   IF((ichi >= 10000).AND.(ichi < 100000))THEN
      WRITE(outstring,50)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   6 digits positive
!
   IF((ichi >= 100000).AND.(ichi < 1000000))THEN
      WRITE(outstring,60)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   7 digits positive
!
   IF((ichi >= 1000000).AND.(ichi < 10000000))THEN
      WRITE(outstring,70)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   8 digits positive
!
   IF((ichi >= 10000000).AND.(ichi < 100000000))THEN
      WRITE(outstring,80)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   9 digits positive
!
   IF((ichi >= 100000000).AND.(ichi < 1000000000))THEN
      WRITE(outstring,90)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   10 digits positive
!
   IF((ichi >= 1000000000))THEN
      itemp=999999999
      WRITE(outstring,91)instring,itemp
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!!   11 digits positive
!!
!          IF((ichi.ge.100000000000))THEN
!            itemp=99999999999
!            WRITE(outstring,92)instring,itemp
!            ilength=LEN_TRIM(outstring)
!            RETURN
!          END IF
!
!   1 digit negative
!
   IF((ichi > -10).AND.(ichi <= 0))THEN
      WRITE(outstring,100)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   2 digits negative
!
   IF((ichi > -100).AND.(ichi <= -10))THEN
      WRITE(outstring,110)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   3 digits negative
!
   IF((ichi > -1000).AND.(ichi <= -100))THEN
      WRITE(outstring,120)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   4 digits negative
!
   IF((ichi > -10000).AND.(ichi <= -1000))THEN
      WRITE(outstring,130)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   5 digits negative
!
   IF((ichi > -100000).AND.(ichi <= -10000))THEN
      WRITE(outstring,140)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   6 digits negative
!
   IF((ichi > -1000000).AND.(ichi <= -100000))THEN
      WRITE(outstring,150)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   7 digits negative
!
   IF((ichi > -10000000).AND.(ichi <= -1000000))THEN
      WRITE(outstring,160)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   8 digits negative
!
   IF((ichi > -100000000).AND.(ichi <= -10000000))THEN
      WRITE(outstring,170)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   9 digits negative
!
   IF((ichi <= -100000000))THEN
      itemp=-999999999
      WRITE(outstring,180)instring,itemp
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
10 FORMAT(a,'=',i1)
20 FORMAT(a,'=',i2)
30 FORMAT(a,'=',i3)
40 FORMAT(a,'=',i4)
50 FORMAT(a,'=',i5)
60 FORMAT(a,'=',i6)
70 FORMAT(a,'=',i7)
80 FORMAT(a,'=',i8)
90 FORMAT(a,'=',i9)
91 FORMAT(a,'=',i10)
100 FORMAT(a,'=',i2)
110 FORMAT(a,'=',i3)
120 FORMAT(a,'=',i4)
130 FORMAT(a,'=',i5)
140 FORMAT(a,'=',i6)
150 FORMAT(a,'=',i7)
160 FORMAT(a,'=',i8)
170 FORMAT(a,'=',i9)
180 FORMAT(a,'=',i10)
!
   RETURN
!
END SUBROUTINE istring
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE istring16(instring,ichi,outstring,ilength)
!
!  Will combine an input string and an input integer in a compact
!  way for printing on the screen.
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER (LEN=*), INTENT(IN)            :: instring
   INTEGER(KIND=8), INTENT(IN)              :: ichi
   CHARACTER (LEN=*), INTENT(OUT)           :: outstring
   INTEGER, INTENT(OUT)                     :: ilength
!
   INTEGER(KIND=8) :: itemp
!
   ilength=0
   outstring=' '
!
!   1 digit positive
!
   IF((ichi >= 0).AND.(ichi < 10))THEN
      WRITE(outstring,10)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   2 digits positive
!
   IF((ichi >= 10).AND.(ichi < 100))THEN
      WRITE(outstring,20)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   3 digits positive
!
   IF((ichi >= 100).AND.(ichi < 1000))THEN
      WRITE(outstring,30)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   4 digits positive
!
   IF((ichi >= 1000).AND.(ichi < 10000))THEN
      WRITE(outstring,40)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   5 digits positive
!
   IF((ichi >= 10000).AND.(ichi < 100000))THEN
      WRITE(outstring,50)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   6 digits positive
!
   IF((ichi >= 100000).AND.(ichi < 1000000))THEN
      WRITE(outstring,60)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   7 digits positive
!
   IF((ichi >= 1000000).AND.(ichi < 10000000))THEN
      WRITE(outstring,70)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   8 digits positive
!
   IF((ichi >= 10000000).AND.(ichi < 100000000))THEN
      WRITE(outstring,80)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   9 digits positive
!
   IF((ichi >= 100000000).AND.(ichi < 1000000000))THEN
      WRITE(outstring,90)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   10 digits positive
!
   IF((ichi >= 1000000000_8).AND.(ichi < 10000000000_8))THEN
      WRITE(outstring,91)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   11 digits positive
!
   IF((ichi >= 10000000000_8).AND.(ichi < 100000000000_8))THEN
      WRITE(outstring,92)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   12 digits positive
!
   IF((ichi >= 100000000000_8).AND.(ichi < 1000000000000_8))THEN
      WRITE(outstring,93)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   13 digits positive
!
   IF((ichi >= 1000000000000_8))THEN
      itemp=999999999999_8
      WRITE(outstring,93)instring,itemp
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!!   11 digits positive
!!
!          IF((ichi.ge.100000000000))THEN
!            itemp=99999999999
!            WRITE(outstring,92)instring,itemp
!            ilength=LEN_TRIM(outstring)
!            RETURN
!          END IF
!
!   1 digit negative
!
   IF((ichi > -10).AND.(ichi <= 0))THEN
      WRITE(outstring,100)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   2 digits negative
!
   IF((ichi > -100).AND.(ichi <= -10))THEN
      WRITE(outstring,110)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   3 digits negative
!
   IF((ichi > -1000).AND.(ichi <= -100))THEN
      WRITE(outstring,120)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   4 digits negative
!
   IF((ichi > -10000).AND.(ichi <= -1000))THEN
      WRITE(outstring,130)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   5 digits negative
!
   IF((ichi > -100000).AND.(ichi <= -10000))THEN
      WRITE(outstring,140)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   6 digits negative
!
   IF((ichi > -1000000).AND.(ichi <= -100000))THEN
      WRITE(outstring,150)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   7 digits negative
!
   IF((ichi > -10000000).AND.(ichi <= -1000000))THEN
      WRITE(outstring,160)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   8 digits negative
!
   IF((ichi > -100000000).AND.(ichi <= -10000000))THEN
      WRITE(outstring,170)instring,ichi
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
!   9 digits negative
!
   IF((ichi <= -100000000))THEN
      itemp=-999999999
      WRITE(outstring,180)instring,itemp
      ilength=LEN_TRIM(outstring)
      RETURN
   END IF
!
10 FORMAT(a,' = ',i1)
20 FORMAT(a,' = ',i2)
30 FORMAT(a,' = ',i3)
40 FORMAT(a,' = ',i4)
50 FORMAT(a,' = ',i5)
60 FORMAT(a,' = ',i6)
70 FORMAT(a,' = ',i7)
80 FORMAT(a,' = ',i8)
90 FORMAT(a,' = ',i9)
91 FORMAT(a,' = ',i10)
92 FORMAT(a,' = ',i11)
93 FORMAT(a,' = ',i12)

100 FORMAT(a,' = ',i2)
110 FORMAT(a,' = ',i3)
120 FORMAT(a,' = ',i4)
130 FORMAT(a,' = ',i5)
140 FORMAT(a,' = ',i6)
150 FORMAT(a,' = ',i7)
160 FORMAT(a,' = ',i8)
170 FORMAT(a,' = ',i9)
180 FORMAT(a,' = ',i10)
!
   RETURN
!
END SUBROUTINE istring16
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE kopydata(ndatamax,ndata,xdata,ydata,errdata,isavn,  &
   savx,savy,savrr)
!
!   August 2, 2001
!
!   When the period and/or T0 is being adjusted, the data is entered
!   in time units.  We have to save the original arrays because the
!   data can be multiply folded during a single run of a program.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: ndata
   REAL(KIND=dp), INTENT(IN)                :: xdata(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydata(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errdata(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavn
   REAL(KIND=dp), INTENT(OUT)               :: savx(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: savy(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: savrr(ndatamax)
!
   INTEGER :: i
!
   isavn=ndata
!
   DO  i=1,ndata
      savx(i)=xdata(i)
      savy(i)=ydata(i)
      savrr(i)=errdata(i)
   END DO
!
   RETURN
!
END SUBROUTINE kopydata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE loaddata(ndatamax,filein,ndata,xdata,ydata,edata)
!
!    November 12, 1999
!
!    This general routine will load a data file.  It assumes that there
!    are three columns:   phase    flux or RV     error
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndatamax
   CHARACTER (LEN=40), INTENT(IN)           :: filein
   INTEGER, INTENT(OUT)                     :: ndata
   REAL(KIND=dp), INTENT(OUT)               :: xdata(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydata(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: edata(ndatamax)
!
   INTEGER :: i,ios
!
   CHARACTER (LEN=1) :: bell
!
   bell=CHAR(7)
   ios=0
!
   ndata=0
   OPEN(UNIT=20,FILE=filein,STATUS='old',ERR=30,IOSTAT=ios)
!
   DO  i=1,ndatamax
      READ(20,*,END=20)xdata(i),ydata(i),edata(i)
   END DO
20 CLOSE(20)
!
   ndata=i-1
!
30 IF(ios /= 0)THEN
      WRITE(*,40)bell,TRIM(filein)
      STOP
   END IF
!
40 FORMAT(a1,'Error:  data file not found (',a,')')
!
   RETURN
!
END SUBROUTINE loaddata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE loadrvdata(nset,nrv1arry,icnrv1arry,xrv1arry,  &
   yrv1arry,errrv1arry,nrv2arry,icnrv2arry,xrv2arry,  &
   yrv2arry,errrv2arry,nrv3arry,icnrv3arry,xrv3arry,  &
   yrv3arry,errrv3arry,nrv4arry,icnrv4arry,xrv4arry,  &
   yrv4arry,errrv4arry,nrv5arry,icnrv5arry,xrv5arry,  &
   yrv5arry,errrv5arry,ndatamax,svxrv1arry,svyrv1arry,  &
   svrrv1arry,svxrv2arry,svyrv2arry,svrrv2arry,  &
   svxrv3arry,svyrv3arry,svrrv3arry,svxrv4arry,  &
   svyrv4arry,svrrv4arry,svxrv5arry,svyrv5arry,  &
   svrrv5arry,itime,ngap,gaplow,gaphigh,icount)
!
!   If there are multiple observatories for the RV data,
!   they can be given in the optional ELCRVdata.opt.  This
!   subroutine will read that file and load the data
!   into the appropriate arrys
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(OUT)                     :: nset
   INTEGER, INTENT(OUT)                     :: nrv1arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv1arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: errrv1arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv2arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv2arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: errrv2arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv3arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv3arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: errrv3arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv4arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv4arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: errrv4arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv5arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv5arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: errrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv5arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: itime
   INTEGER, INTENT(IN)                      :: ngap
   REAL(KIND=dp), INTENT(IN)                :: gaplow(9999)
   REAL(KIND=dp), INTENT(IN)                :: gaphigh(9999)
   INTEGER, INTENT(OUT)                     :: icount
!
   INTEGER :: icnvrt,i,ios,j,k
!
   CHARACTER(LEN=1) :: bell
   CHARACTER(LEN=50) :: file1,file2,file3,file4,file5
!
   icount=0
   DO i=1,5
      nrv1arry(i)=0
      nrv2arry(i)=0
      nrv3arry(i)=0
      nrv4arry(i)=0
      nrv5arry(i)=0
      icnrv1arry(i)=430
      icnrv2arry(i)=430
      icnrv3arry(i)=430
      icnrv4arry(i)=430
      icnrv5arry(i)=430
   END DO
!
   bell=CHAR(7)
!
!   Attempt to open ELCRVdata.opt
!
   ios=0
   OPEN(UNIT=20,FILE='ELCRVdata.opt',STATUS='old',IOSTAT=ios)
   IF(ios /= 0)THEN
      WRITE(*,70)bell
      STOP
   END IF
!
!   Attempt to read the first line, which should be an integer
!   between 1 and 5
!
   ios=0
   READ(20,*,IOSTAT=ios,ERR=120)nset
!
   IF((nset <= 0).OR.(nset > 5))THEN
      WRITE(*,90)bell
      STOP
   END IF
!
!   Loop over Nset, read in files, load data
!
   DO i=1,nset
      ios=0
      READ(20,60,ERR=130,IOSTAT=ios)file1
      READ(20,60,ERR=130,IOSTAT=ios)file2
      READ(20,60,ERR=130,IOSTAT=ios)file3
      READ(20,60,ERR=130,IOSTAT=ios)file4
      READ(20,60,ERR=130,IOSTAT=ios)file5
!
      icnrv1arry(i)=icnvrt(file1)
      IF(icnrv1arry(i) /= 430)THEN
         OPEN(UNIT=72,FILE=file1,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=10)xrv1arry(j,i),yrv1arry(j,i),errrv1arry(j,i)
            svxrv1arry(j,i)=xrv1arry(j,i)
            svyrv1arry(j,i)=yrv1arry(j,i)
            svrrv1arry(j,i)=errrv1arry(j,i)
            IF((itime >= 2).AND.(ngap >= 1))THEN
               DO k=1,ngap
                  IF((xrv1arry(j,i) >= gaplow(k)).AND.(xrv1arry(j,i) <= &
                       gaphigh(k)))THEN
                     icount=icount+1
                     CALL gaperrorrv(1,xrv1arry(j,i),file1,j,k)
                  END IF
               END DO
            END IF
         END DO
10       CLOSE(72)
         nrv1arry(i)=j-1
      END IF
!
      icnrv2arry(i)=icnvrt(file2)
      IF(icnrv2arry(i) /= 430)THEN
         OPEN(UNIT=72,FILE=file2,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=20)xrv2arry(j,i),yrv2arry(j,i),errrv2arry(j,i)
            svxrv2arry(j,i)=xrv2arry(j,i)
            svyrv2arry(j,i)=yrv2arry(j,i)
            svrrv2arry(j,i)=errrv2arry(j,i)
            IF((itime >= 2).AND.(ngap >= 1))THEN
               DO k=1,ngap
                  IF((xrv2arry(j,i) >= gaplow(k)).AND.(xrv2arry(j,i) <= &
                       gaphigh(k)))THEN
                     icount=icount+1
                     CALL gaperrorrv(2,xrv2arry(j,i),file2,j,k)
                  END IF
               END DO
            END IF
         END DO
20       CLOSE(72)
         nrv2arry(i)=j-1
      END IF
!
      icnrv3arry(i)=icnvrt(file3)
      IF(icnrv3arry(i) /= 430)THEN
         OPEN(UNIT=72,FILE=file3,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=30)xrv3arry(j,i),yrv3arry(j,i),errrv3arry(j,i)
            svxrv3arry(j,i)=xrv3arry(j,i)
            svyrv3arry(j,i)=yrv3arry(j,i)
            svrrv3arry(j,i)=errrv3arry(j,i)
            IF((itime >= 2).AND.(ngap >= 1))THEN
               DO k=1,ngap
                  IF((xrv3arry(j,i) >= gaplow(k)).AND.(xrv3arry(j,i) <= &
                       gaphigh(k)))THEN
                     icount=icount+1
                     CALL gaperrorrv(3,xrv3arry(j,i),file3,j,k)
                  END IF
               END DO
            END IF
         END DO
30       CLOSE(72)
         nrv3arry(i)=j-1
      END IF
!
      icnrv4arry(i)=icnvrt(file4)
      IF(icnrv4arry(i) /= 430)THEN
         OPEN(UNIT=72,FILE=file4,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=40)xrv4arry(j,i),yrv4arry(j,i),errrv4arry(j,i)
            svxrv4arry(j,i)=xrv4arry(j,i)
            svyrv4arry(j,i)=yrv4arry(j,i)
            svrrv4arry(j,i)=errrv4arry(j,i)
            IF((itime >= 2).AND.(ngap >= 1))THEN
               DO k=1,ngap
                  IF((xrv4arry(j,i) >= gaplow(k)).AND.(xrv4arry(j,i) <= &
                       gaphigh(k)))THEN
                     icount=icount+1
                     CALL gaperrorrv(4,xrv4arry(j,i),file4,j,k)
                  END IF
               END DO
            END IF
         END DO
40       CLOSE(72)
         nrv4arry(i)=j-1
      END IF
!
      icnrv5arry(i)=icnvrt(file5)
      IF(icnrv5arry(i) /= 430)THEN
         OPEN(UNIT=72,FILE=file4,IOSTAT=ios,ERR=140)
         DO j=1,ndatamax
            READ(72,*,END=50)xrv5arry(j,i),yrv5arry(j,i),errrv5arry(j,i)
            svxrv5arry(j,i)=xrv5arry(j,i)
            svyrv5arry(j,i)=yrv5arry(j,i)
            svrrv5arry(j,i)=errrv5arry(j,i)
            IF((itime >= 2).AND.(ngap >= 1))THEN
               DO k=1,ngap
                  IF((xrv5arry(j,i) >= gaplow(k)).AND.(xrv5arry(j,i) <= &
                       gaphigh(k)))THEN
                     icount=icount+1
                     CALL gaperrorrv(5,xrv5arry(j,i),file5,j,k)
                  END IF
               END DO
            END IF
         END DO
50       CLOSE(72)
         nrv5arry(i)=j-1
      END IF
!
   END DO
!
60 FORMAT(a50)
70 FORMAT(a1,'Error:  ELCRVdata.opt not found')
80 FORMAT(a1,'Error:  First line of ELCRVdata.opt is ','not an iteger')
90 FORMAT(a1,'Error:  Nset should be between 1 and 5')
100 FORMAT(a1,'Error:  Error reading ELCRVdata')
110 FORMAT(a1,'Error reading file ',a50)
!
120 IF(ios /= 0)THEN
      WRITE(*,80)bell
      STOP
   END IF
!
130 IF(ios /= 0)THEN
      WRITE(*,100)bell
      STOP
   END IF
!
140 IF(ios /= 0)THEN
      WRITE(*,110)bell
      STOP
   END IF
!
   RETURN
!
END SUBROUTINE loadrvdata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE loadtimes(icnarray,nobscycle,obsttimes,obsterr,  &
   nmeclpse)
!
!   This routine will load the observed eclipse times into the
!   arrays.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmeclpse
   INTEGER, INTENT(OUT)                     :: icnarray(40)
   INTEGER, INTENT(OUT)                     :: nobscycle(40)
   REAL(KIND=dp), INTENT(OUT)               :: obsttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: obsterr(40,nmeclpse)
!
   REAL(KIND=dp) :: col1
!
   INTEGER :: ios,ios1,ios2,i,ios3,j,icnvrt,ios4
!
   CHARACTER(LEN=40) :: filein
   CHARACTER(LEN=1) :: bell
!
   bell=CHAR(7)
   ios=0
   ios1=0
   ios2=0
!
   OPEN(UNIT=20,FILE='ELCeclipsetimes.opt',STATUS='old',ERR=50,IOSTAT=ios)
   DO i=1,34
      READ(20,80,ERR=70,IOSTAT=ios2)filein
      icnarray(i)=icnvrt(filein(1:2))
      IF(icnarray(i) /= 430)THEN
         OPEN(UNIT=21,FILE=filein,STATUS='old',ERR=60,IOSTAT=ios1)
         DO j=1,10000
            READ(21,*,END=10)col1,obsttimes(i,j),obsterr(i,j)
         END DO
10       nobscycle(i)=j-1
         CLOSE(21)
      END IF
   END DO
   ios3=0
!
   DO i=35,40
      READ(20,80,ERR=70,IOSTAT=ios2)filein
      icnarray(i)=icnvrt(filein(1:2))
      IF(icnarray(i) /= 430)THEN
         OPEN(UNIT=21,FILE=filein,STATUS='old',ERR=60,IOSTAT=ios1)
         DO j=1,10000
            READ(21,*,END=30)col1,obsttimes(i,j),obsterr(i,j)
         END DO
30       nobscycle(i)=j-1
         CLOSE(21)
      END IF
   END DO
!
   ios4=0
!
!  supress compilier warning about unusued variable
!
   col1=1.0_dp
   col1=col1*col1
!
50 IF(ios /= 0)THEN
      WRITE(*,90)bell
      STOP
   END IF
!
60 IF(ios1 /= 0)THEN
      WRITE(*,100)bell,TRIM(filein)
      STOP
   END IF
!
70 IF((ios2 /= 0).OR.(ios3 /= 0).OR.(ios4 /= 0))THEN
      WRITE(*,110)bell
      STOP
   END IF
!
80 FORMAT(a40)
90 FORMAT(a1,'Error:  ELCeclipsetimes.opt not found')
100 FORMAT(a1,'Error:  data file not found (',a,')')
110 FORMAT(a1,'Error:  error reading ELCeclipsetimes.opt')
!
   CLOSE(20)
   RETURN
!
END SUBROUTINE loadtimes
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE lrchi(nphase,nmaxphase,ymods1,ymods2,ymods3,  &
   nobv,sobv,obv,eobv,ochilr,ochi,ymods4,ochilr3,ochilr4)
!
!  UPDATE FEBRUARY 4, 2005
!
!  Here is a new subroutine that will compute the chi^2 of the luminosity
!  fraction.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE

   INTEGER, INTENT(IN)                      :: nphase
   INTEGER, INTENT(IN)                      :: nmaxphase
   REAL(KIND=dp), INTENT(IN)                :: ymods1(nmaxphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods2(nmaxphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods3(nmaxphase)
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
   REAL(KIND=dp), INTENT(IN)                :: obv(19)
   REAL(KIND=dp), INTENT(IN)                :: eobv(19)
   REAL(KIND=dp), INTENT(OUT)               :: ochilr
   REAL(KIND=dp), INTENT(OUT)               :: ochi
   REAL(KIND=dp), INTENT(IN)                :: ymods4(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ochilr3
   REAL(KIND=dp), INTENT(OUT)               :: ochilr4
!
   REAL(KIND=dp)  :: xr3,xr4,rat,q1,q2,rmedian,rmedian3,rmedian4,frac
   REAL(KIND=dp)  :: frac3,frac4
!
   INTEGER :: icount,i,icn,icnvrt
!
!   UPDATE September 23, 2015
!
!   add tags l3 and l4 to allow the flux ratio of body 3 to primary
!   or body 4 to primary to be fit.
!
   DIMENSION xr3(nmaxphase),rat(nmaxphase),xr4(nmaxphase)
!
!   COMMON /medblock/ rmed
!
   ochilr=0.0_dp
   ochilr3=0.0_dp
   ochilr4=0.0_dp
   icount=0
   DO  i=1,nphase
      IF(ymods1(i) > 0.0_dp)THEN
         icount=icount+1
         rat(icount)=ymods2(i)/ymods1(i)
         xr3(icount)=ymods3(i)/ymods1(i)
         xr4(icount)=ymods4(i)/ymods1(i)
      END IF
   END DO
!
   IF(icount <= 2)THEN
      ochilr=9999999999.0_dp
      ochi=ochi+ochilr
      RETURN
   END IF
!
   CALL sort3(icount,rat,xr3,xr4)
!
   q1=REAL(icount/2,KIND=dp)
   q2=REAL(icount,KIND=dp)/2.0_dp
   IF(ABS(q1-q2) <= EPSILON(q1))THEN
      rmedian=(rat(icount/2)+rat(icount/2+1))/2.0_dp
      rmedian3=(xr3(icount/2)+xr3(icount/2+1))/2.0_dp
      rmedian4=(xr4(icount/2)+xr4(icount/2+1))/2.0_dp
   ELSE
      rmedian=rat(icount/2+1)
      rmedian3=xr3(icount/2+1)
      rmedian4=xr4(icount/2+1)
   END IF
   frac=rmedian
   frac3=rmedian3
   frac4=rmedian4
!
   DO  i=1,nobv
!
      icn=icnvrt(sobv(i)(1:2))
!
!  If the variable rmed > 1, then define ochidisk to be the absolute
!  deviation, rather than the normal chi^2.
!
!  tag lr
!
      IF(icn == 369)THEN
         IF(rmed >= 1.0_dp)THEN
            ochilr=ABS((obv(i)-frac)/(eobv(i)))
         ELSE
            ochilr=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
         END IF
      END IF
!
!  tag l3
!
      IF(icn == 1370)THEN
         IF(rmed >= 1.0_dp)THEN
            ochilr3=ABS((obv(i)-frac3)/(eobv(i)))
         ELSE
            ochilr3=(obv(i)-frac3)*(obv(i)-frac3)/(eobv(i)*eobv(i))
         END IF
      END IF
!
!  tag l4
!
      IF(icn == 1371)THEN
         IF(rmed >= 1.0_dp)THEN
            ochilr4=ABS((obv(i)-frac4)/(eobv(i)))
         ELSE
            ochilr4=(obv(i)-frac4)*(obv(i)-frac4)/(eobv(i)*eobv(i))
         END IF
      END IF

   END DO
!
   ochi=ochi+ochilr+ochilr3+ochilr4
!
   RETURN
!
END SUBROUTINE lrchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE lumratchi(nobv,sobv,obv,eobv,ochilumrat,ochi,  &
   compfracs)
!
!   computes the chi^2 values associated with the disk fraction
!   constraints given in gridloop.opt
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
   REAL(KIND=dp), INTENT(IN)                :: obv(19)
   REAL(KIND=dp), INTENT(IN)                :: eobv(19)
   REAL(KIND=dp), INTENT(OUT)               :: ochilumrat(8)
   REAL(KIND=dp), INTENT(OUT)               :: ochi
   REAL(KIND=dp), INTENT(IN)                :: compfracs(8,3)
!
   REAL(KIND=dp)  :: frac
!
   INTEGER :: i,icn,icnvrt
!
!   UPDATE October 27, 2008
!
!   Make ochidisk have dimension 8.  This will allow the user to fit
!   for the disk fraction in more than 1 band at a time.  Also, put
!   the array compfracs into the argument list above
!
!   COMMON /medblock/ rmed
!
   DO  i=1,8
      ochilumrat(i)=0.0_dp
   END DO
!
   DO  i=1,nobv
!
!  UPDATE NOVEMBER 23, 2001
!
!  make the argument sobv(i)(1:2)
!
      icn=icnvrt(sobv(i)(1:2))
!
!  UPDATE May 27, 2002
!
!  If the variable rmed > 1, then define ochilumrat to be the absolute
!  deviation, rather than the normal chi^2.
!
!  UPDATE October 27, 2008
!
!  use the tags 21 to 28 to fit for the disk fraction in filter 1, filter 2,
!  etc.  String 21=4529, 22=4561, ...
!
!   tag 21
!
      IF(icn == 4529)THEN
         frac=compfracs(1,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(1)=0.0_dp
            ELSE
               ochilumrat(1)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(1)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(1)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(1)
      END IF
!
!   tag u1 used, so have the value of obv(i) be an upper limit
!
      IF(icn == 3532)THEN
         frac=compfracs(1,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(1)=0.0_dp
            ELSE
               ochilumrat(1)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(1)=0.0_dp
            ELSE
               ochilumrat(1)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(1)
      END IF
!
!  tag 22 used
!
      IF(icn == 4561)THEN
         frac=compfracs(2,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(2)=0.0_dp
            ELSE
               ochilumrat(2)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(2)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(2)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(2)
      END IF
!
!   tag 2u given, so use the value of obv(i) as an upper limit
!
      IF(icn == 3564)THEN
         frac=compfracs(2,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(2)=0.0_dp
            ELSE
               ochilumrat(2)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(2)=0.0_dp
            ELSE
               ochilumrat(2)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(2)
      END IF
!
!  tag 32
!
      IF(icn == 4593)THEN
         frac=compfracs(3,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(3)=0.0_dp
            ELSE
               ochilumrat(3)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(3)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(3)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(3)
      END IF
!
!  tag 3u given, so use the value of obv(i) as upper limit
!
      IF(icn == 3596)THEN
         frac=compfracs(3,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(3)=0.0_dp
            ELSE
               ochilumrat(3)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(3)=0.0_dp
            ELSE
               ochilumrat(3)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(3)
      END IF
!
!  tag 42
!
      IF(icn == 4625)THEN
         frac=compfracs(4,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(4)=0.0_dp
            ELSE
               ochilumrat(4)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(4)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(4)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(4)
      END IF
!
!  tag 4u used, so use the value of obv(i) as upper limit
!
      IF(icn == 3628)THEN
         frac=compfracs(4,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(4)=0.0_dp
            ELSE
               ochilumrat(4)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(4)=0.0_dp
            ELSE
               ochilumrat(4)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(4)
      END IF
!
!  tag 52
!
      IF(icn == 4657)THEN
         frac=compfracs(5,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(5)=0.0_dp
            ELSE
               ochilumrat(5)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(5)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(5)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(5)
      END IF
!
!   tag 5u given, so use value of obv(i) as upper limit
!
      IF(icn == 3660)THEN
         frac=compfracs(5,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(5)=0.0_dp
            ELSE
               ochilumrat(5)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(5)=0.0_dp
            ELSE
               ochilumrat(5)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(5)
      END IF
!
!  tag 62
!
      IF(icn == 4689)THEN
         frac=compfracs(6,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(6)=0.0_dp
            ELSE
               ochilumrat(6)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(6)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(6)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(6)
      END IF
!
!  tag 6u given, so use the value of obv(i) as upper limit
!
      IF(icn == 3692)THEN
         frac=compfracs(6,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(6)=0.0_dp
            ELSE
               ochilumrat(6)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(6)=0.0_dp
            ELSE
               ochilumrat(6)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(6)
      END IF
!
!  tag 72
!
      IF(icn == 4721)THEN
         frac=compfracs(7,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(7)=0.0_dp
            ELSE
               ochilumrat(7)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(7)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(7)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(7)
      END IF
!
!   tag 7u given, so use the value of obv(i) as upper limit
!
      IF(icn == 3724)THEN
         frac=compfracs(7,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(7)=0.0_dp
            ELSE
               ochilumrat(7)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(7)=0.0_dp
            ELSE
               ochilumrat(7)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(7)
      END IF
!
!  tag 82
!
      IF(icn == 4753)THEN
         frac=compfracs(8,1)
         IF(obv(i) < 0.0_dp)THEN
            IF(frac > ABS(obv(i)))THEN
               ochilumrat(8)=0.0_dp
            ELSE
               ochilumrat(8)=1.0E+10_dp
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               ochilumrat(8)=ABS((obv(i)-frac)/(eobv(i)))
            ELSE
               ochilumrat(8)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         END IF
         ochi=ochi+ochilumrat(8)
      END IF
!
!  tag 8u given, so use the value of obv(i) as upper limit
!
      IF(icn == 3756)THEN
         frac=compfracs(8,1)
         IF(rmed < 1.0_dp)THEN
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(8)=0.0_dp
            ELSE
               ochilumrat(8)=(obv(i)-frac)*(obv(i)-frac)/(eobv(i)*eobv(i))
            END IF
         ELSE
            IF(frac < ABS(obv(i)))THEN
               ochilumrat(8)=0.0_dp
            ELSE
               ochilumrat(8)=ABS((obv(i)-frac)/(eobv(i)))
            END IF
         END IF
         ochi=ochi+ochilumrat(8)
      END IF
!
   END DO
!
   RETURN
!
END SUBROUTINE lumratchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE makeloopopt(nvmax)
!
!   This routine will write a correctly formatted 'gridloop.opt' file
!   in the event one does not exist.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvmax
!
   INTEGER :: nvar,idummy
!
   CHARACTER(LEN=1) :: bell
!
   bell=CHAR(7)
   WRITE(*,10)bell
!
   OPEN(UNIT=11,FILE='gridloop.opt',STATUS='new')
!
   WRITE(11,20)
   WRITE(11,30)
   WRITE(11,40)
   WRITE(11,50)
   WRITE(11,60)
   WRITE(11,70)
   WRITE(11,80)
   WRITE(11,90)
   WRITE(11,100)
   WRITE(11,110)
   WRITE(11,111)
   WRITE(11,112)
   WRITE(11,113)
   nvar=nvmax
   WRITE(11,120)nvar
   WRITE(11,130)
   WRITE(11,140)
   WRITE(11,150)
   WRITE(11,160)
   WRITE(11,170)
   WRITE(11,180)
   WRITE(11,190)
   WRITE(11,200)
   WRITE(11,210)
   WRITE(11,220)
   WRITE(11,230)
   WRITE(11,240)
   WRITE(11,250)
   WRITE(11,260)
   WRITE(11,270)
   WRITE(11,280)
   WRITE(11,290)
   WRITE(11,300)
   WRITE(11,310)
   WRITE(11,320)
   WRITE(11,330)
   WRITE(11,340)
   WRITE(11,350)
   WRITE(11,360)
   WRITE(11,370)
   WRITE(11,380)
   WRITE(11,390)
   WRITE(11,400)
   WRITE(11,410)
   WRITE(11,420)
   WRITE(11,430)
   WRITE(11,440)
   WRITE(11,450)
   WRITE(11,460)
   WRITE(11,470)
   WRITE(11,480)
   WRITE(11,490)
   WRITE(11,500)
   WRITE(11,510)
   WRITE(11,520)
   WRITE(11,530)
   WRITE(11,540)
   WRITE(11,550)
   WRITE(11,560)
   WRITE(11,570)
   WRITE(11,580)
!
   idummy=10
   IF(idummy == 10)THEN
      WRITE(*,590)
      STOP
   END IF
!
10 FORMAT(a1,'Error:  file ''gridloop.opt'' not found!  ','I''m '  &
      ,'making one up!')
20 FORMAT('put_your_file_for_U_data_here')
30 FORMAT('put_your_file_for_B_data_here')
40 FORMAT('put_your_file_for_V_data_here')
50 FORMAT('put_your_file_for_R_data_here')
60 FORMAT('put_your_file_for_I_data_here')
70 FORMAT('put_your_file_for_J_data_here')
80 FORMAT('put_your_file_for_H_data_here')
90 FORMAT('put_your_file_for_K_data_here')
100 FORMAT('put_your_file_for_RV1_data_here')
110 FORMAT('put_your_file_for_RV2_data_here')
111 FORMAT('put_your_file_for_RV3_data_here')
112 FORMAT('put_your_file_for_RV4_data_here')
113 FORMAT('put_your_file_for_RV5_data_here')
120 FORMAT(i2,18X,'Number of variables to adjust')
130 FORMAT('inclination')
140 FORMAT('mass ratio')
150 FORMAT('f1 (fill 1)')
160 FORMAT('f2 (fill 2)')
170 FORMAT('o1 (omega1)')
180 FORMAT('o2 (omega2)')
190 FORMAT('rinner [inner disk radius (same units as fill2)]')
200 FORMAT('router [outer disk radius','                         '  &
      ,'               (in units of Rl volume of star 2)]')
210 FORMAT('Tdisk (inner disk temperature)')
220 FORMAT('betarim (half-opening angle of disk rim in degrees)')
230 FORMAT('T1 (T_eff of star 1)')
240 FORMAT('T2 (T_eff of star 2)')
250 FORMAT('xi')
260 FORMAT('Lx (L_x/L_opt)')
270 FORMAT('separation (solar radii)')
280 FORMAT('gamma (gamma velocity in km/sec)')
290 FORMAT('70.0     1.0     3')
300 FORMAT('2.0      0.25    3')
310 FORMAT('0.70     0.1     3')
320 FORMAT('0.70     0.1     3')
330 FORMAT('1.0      0.1     3')
340 FORMAT('1.0      0.1     3')
350 FORMAT('0.01     0.001   3')
360 FORMAT('0.75     0.01    3')
370 FORMAT('20000.0  100.0   3')
380 FORMAT('4.0      0.5     3')
390 FORMAT('6500.0   100.0   3')
400 FORMAT('7500.0   100.0   3')
410 FORMAT('-0.75    0.05    3')
420 FORMAT('10.0     1.0     3')
430 FORMAT('5.0      0.5     3')
440 FORMAT('-69.0    10.0    3')
450 FORMAT('##############################################')
460 FORMAT('#    The first 8 entry MUST be a string indicating ',  &
      'the name of the FOLDED')
470 FORMAT('#    data files.  Put ''NONE'' if there is no file.')
480 FORMAT('#')
490 FORMAT('#    The next entry MUST be a positive integer (Nvar)' )
500 FORMAT('#    The next Nvar entries MUST be strings.  Put the',  &
      ' name ','of the variable you want ')
510 FORMAT('#    in the innermost loop first, the name of the ',''  &
      ,'variable in the second')
520 FORMAT('#    loop second, etc.',' If you do not want to loop '  &
      ,'over all variables, ')
530 FORMAT('#    put the string ''NOTHING'' in the unwanted',' po'  &
      ,'sitions.')
540 FORMAT('#    The names of the allowed variables that can be ',  &
      'put into loops are listed')
550 FORMAT('#    The next Nvar lines contain the starting values',  &
      ' of the variables')
560 FORMAT('#    the step size, and the number of loops.')
570 FORMAT('#')
580 FORMAT('##############################################')
590 FORMAT('Edit the file ''gridloop.opt'' and restart the',' pro'  &
      ,'gram.')
!
   RETURN
!
END SUBROUTINE makeloopopt
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE monster(nphase,nmaxphase,xmod,ymodu,ymodb,ymodv,ymodr,ymodi,  &
   ymodj,ymodh,ymodk,ymods1,ymods2,ymods3,ymodd,rv1,rv2,drv1,drv2,obsparm,  &
   ifastflag,nrvphase,xrvmod,fracs1,fracs2,fracs3,fracs4,fracs5,fracs6,  &
   fracs7,fracs8,chisqu,chisqb,chisqv,chisqr,chisqi,chisqj,chisqh,chisqk,  &
   chisqrv1,chisqrv2,chilimb,chi1,ndatau,xdatau,ydatau,erru,zerou,resu,  &
   ndatab,xdatab,ydatab,errb,zerob,resb,ndatav,xdatav,ydatav,errv,zerov,  &
   resv,ndatar,xdatar,ydatar,errr,zeror,resr,ndatai,xdatai,ydatai,erri,  &
   zeroi,resi,ndataj,xdataj,ydataj,errj,zeroj,resj,ndatah,xdatah,ydatah,  &
   errh,zeroh,resh,ndatak,xdatak,ydatak,errk,zerok,resk,nrv1,xrv1,yrv1,  &
   errrv1,nrv2,xrv2,yrv2,errrv2,ggamma1,ggamma2,nobv,sobv,obv,eobv,ochi,  &
   ochidisk,ochilr,nvmax,svar,var,saveasini,svxdatau,svydatau,sverru,  &
   svxdatab,svydatab,sverrb,svxdatav,svydatav,sverrv,svxdatar,svydatar,  &
   sverrr,svxdatai,svydatai,sverri,svxdataj,svydataj,sverrj,svxdatah,  &
   svydatah,sverrh,svxdatak,svydatak,sverrk,svxrv1,svyrv1,svrv1,svxrv2,  &
   svyrv2,svrv2,ifrac,ilum,i16,isavnu,isavnb,isavnv,isavnr,isavni,isavnj,  &
   isavnh,isavnk,isavrv1,isavrv2,isvel1,isvel2,ndatamax,ibest,ifixgamma,  &
   savesep,ichilabel,resrv1,resrv2,thresh,small,ncycle,ttimes,tseps,  &
   nobscycle,obsttimes,obsterr,icnarry,rv3,xrv3,yrv3,errrv3,icnrv3,resrv3,  &
   ggamma3,nrv3,parmstring,planetparm,dynparm,line,fill1,fill2,omega1,  &
   omega2,dphase,q,finc,teff1,teff2,tgrav1,tgrav2,betarim,rinner,router,  &
   tdisk,xi,alb1,alb2,rlx,period,fm,separ,gamma,wave,dbolx,dboly,dwavex,  &
   dwavey,t3,g3,sa3,density,sw1,sw2,sw3,t0,ecc,argper,pshift,sw5,sw6,sw7,  &
   sw8,sw9,primmass,primk,primrad,ratrad,frac1,frac2,ecosw,temprat,bigi,  &
   bigbeta,sw23,sw24,sw25,sw26,sw27,sw28,sw29,sw30,contam,tconj,beam1,beam2,  &
   ocose,osine,omegadot,contams0,contams1,contams2,contams3,sw47,sw48,sw49,  &
   gaplow,gaphigh,p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,  &
   p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,p3q,p3ratrad,  &
   p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,p4omega,p4q,p4ratrad,p5tconj,  &
   p5period,p5t0,p5ecos,p5esin,p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,  &
   p6t0,p6ecos,p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,  &
   p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,p8t0,p8ecos,  &
   p8esin,p8incl,p8omega,p8q,p8ratrad,xsc,ysc,spot1parm,spot2parm,spotdparm,  &
   nalph1,nbet1,nalph2,nbet2,ntheta,nradius,nref,idraw,iecheck,iidint,iatm,  &
   ism1,ilaw,icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk,icnrv1,icnrv2,irvfilt,  &
   isw1,isw2,isw3,isw4,ikeep,isynch,isw5,isw6,isw7,isw8,isw9,idark1,idark2,  &
   isw12,isw13,isw21,isw22,isw23,isw24,isw25,isw26,isw27,isw28,isw29,isw30,  &
   isw31,isw32,isw33,isw34,nsc,compfracs,tertperiod,tertt0,tertecos,  &
   tertesin,tertincl,tertomega,tertq,tertconj,tertratrad,hh,sw72,sw73,  &
   nmeclpse,tdur1,tdur2,sw80,sw81,sw82,sw83,sw84,sw85,isw80,isw81,isw82,  &
   isw83,isw84,isw85,isw86,isw87,isw88,isw89,ymods4,ymods5,arrsobx,arrsoby,  &
   montemax,nrv4,xrv4,yrv4,rv4,icnrv4,resrv4,ggamma4,errrv4,sdarkint1,  &
   sdarkint2,sdarkint3,sdarkint4,sdarkint5,atmt,atmg,atmmu,atmint1,atmint2,  &
   atmint3,atmint4,atmint5,atmint6,atmint7,atmint8,tmin,nlines,nmu,nalph3,  &
   nbet3,itconj,it1,it2,it3,it4,ndynwin,dynwinlow,dynwinhigh,p1mtc,p1ptc,  &
   p2mtc,p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,p7ptc,  &
   p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,bigbeta3,bigbeta4,  &
   bin2q,b2massdiff,b2masssum,b2raddiff,b2radsum,bin2ratrad,g10,g6,g7,g8,g9,  &
   massdiff,masssum,omega3,omega4,omega5,omega6,omega7,omega8,omega9,  &
   omega10,raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
   sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,t6,t7,t8,t9,  &
   nseg,isw100,iunit,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,sqecos,  &
   sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,sqp3ecos,sqp3esin,  &
   sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,  &
   sqp8ecos,sqp8esin,angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,  &
   angsum4,angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,imag,newparmstr,ioutflag,fillsum,filldiff,binqtc,p1qtc,  &
   p2qtc,p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
   t4off,t5off,t6off,t7off,t8off,fracstring,resttimes,drv3,drv4,drv5,rv5,  &
   nset,nrv1arry,icnrv1arry,xrv1arry,yrv1arry,errrv1arry,nrv2arry,  &
   icnrv2arry,xrv2arry,yrv2arry,errrv2arry,nrv3arry,icnrv3arry,xrv3arry,  &
   yrv3arry,errrv3arry,nrv4arry,icnrv4arry,xrv4arry,yrv4arry,errrv4arry,  &
   icnrv5arry,svxrv1arry,svyrv1arry,svrv1arry,svxrv2arry,svyrv2arry,  &
   svrv2arry,resrv1arry,resrv2arry,resrv3arry,resrv4arry,resrv5arry,  &
   gamma1arry,gamma2arry,gamma3arry,gamma4arry,gamma5arry,irecord,iversion,  &
   tesscontam,tessfilt,tessbin,maxlines,maxmu)                                  
!
!   January 1, 2013
!
!   This subroutine will collect all of the steps necessary to compute
!   models, fold the data, compute chi^2, and print the variables.
!
   USE accur
   USE getpie
   USE medblock
   USE ran_lec
!
   IMPLICIT NONE
!
   INTEGER, INTENT(OUT)                     :: nphase
   INTEGER, INTENT(IN)                      :: nmaxphase
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: nmeclpse
   INTEGER, INTENT(IN)                      :: montemax
   INTEGER, INTENT(IN)                      :: maxlines
   INTEGER, INTENT(IN)                      :: maxmu
   REAL(KIND=dp), INTENT(OUT)               :: xmod(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodu(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodb(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodv(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodr(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodi(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodj(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodh(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodk(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymods1(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymods2(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymods3(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymodd(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: rv1(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: rv2(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: drv1(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: drv2(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: obsparm(25)
   INTEGER, INTENT(IN OUT)                  :: ifastflag
   INTEGER, INTENT(OUT)                     :: nrvphase
   REAL(KIND=dp), INTENT(OUT)               :: xrvmod(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: fracs1(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs2(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs3(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs4(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs5(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs6(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs7(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: fracs8(nmaxphase,4)
   REAL(KIND=dp), INTENT(OUT)               :: chisqu
   REAL(KIND=dp), INTENT(OUT)               :: chisqb
   REAL(KIND=dp), INTENT(OUT)               :: chisqv
   REAL(KIND=dp), INTENT(OUT)               :: chisqr
   REAL(KIND=dp), INTENT(OUT)               :: chisqi
   REAL(KIND=dp), INTENT(OUT)               :: chisqj
   REAL(KIND=dp), INTENT(OUT)               :: chisqh
   REAL(KIND=dp), INTENT(OUT)               :: chisqk
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv1
   REAL(KIND=dp), INTENT(OUT)               :: chisqrv2
   REAL(KIND=dp), INTENT(IN)                :: chilimb
   REAL(KIND=dp), INTENT(OUT)               :: chi1
   INTEGER, INTENT(IN OUT)                  :: ndatau
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatau(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatau(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: erru(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zerou
   REAL(KIND=dp), INTENT(OUT)               :: resu(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatab
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatab(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatab(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errb(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zerob
   REAL(KIND=dp), INTENT(OUT)               :: resb(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatav
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatav(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatav(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errv(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zerov
   REAL(KIND=dp), INTENT(OUT)               :: resv(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatar
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatar(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatar(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errr(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zeror
   REAL(KIND=dp), INTENT(OUT)               :: resr(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatai
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatai(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatai(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: erri(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zeroi
   REAL(KIND=dp), INTENT(OUT)               :: resi(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndataj
   REAL(KIND=dp), INTENT(IN OUT)            :: xdataj(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydataj(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errj(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zeroj
   REAL(KIND=dp), INTENT(OUT)               :: resj(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatah
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatah(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatah(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errh(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zeroh
   REAL(KIND=dp), INTENT(OUT)               :: resh(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: ndatak
   REAL(KIND=dp), INTENT(IN OUT)            :: xdatak(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: ydatak(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errk(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: zerok
   REAL(KIND=dp), INTENT(OUT)               :: resk(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: nrv1
   REAL(KIND=dp), INTENT(OUT)               :: xrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errrv1(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: nrv2
   REAL(KIND=dp), INTENT(OUT)               :: xrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ggamma1
   REAL(KIND=dp), INTENT(OUT)               :: ggamma2
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obv(25)
   REAL(KIND=dp), INTENT(IN)                :: eobv(25)
   REAL(KIND=dp), INTENT(OUT)               :: ochi
   REAL(KIND=dp), INTENT(OUT)               :: ochidisk(8)
   REAL(KIND=dp), INTENT(OUT)               :: ochilr
   INTEGER, INTENT(IN)                      :: nvmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvmax)
   REAL(KIND=dp), INTENT(IN OUT)            :: var(nvmax)
   REAL(KIND=dp), INTENT(IN)                :: saveasini
   REAL(KIND=dp), INTENT(IN)                :: svxdatau(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatau(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverru(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatab(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatab(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrb(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatav(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatav(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrv(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatar(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatar(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrr(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatai(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatai(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverri(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdataj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydataj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatah(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatah(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrh(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxdatak(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svydatak(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: sverrk(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svyrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svxrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svyrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: svrv2(ndatamax)
   INTEGER, INTENT(IN)                      :: ifrac
   INTEGER, INTENT(IN)                      :: ilum
   INTEGER, INTENT(IN)                      :: i16
   INTEGER, INTENT(IN)                      :: isavnu
   INTEGER, INTENT(IN)                      :: isavnb
   INTEGER, INTENT(IN)                      :: isavnv
   INTEGER, INTENT(IN)                      :: isavnr
   INTEGER, INTENT(IN)                      :: isavni
   INTEGER, INTENT(IN)                      :: isavnj
   INTEGER, INTENT(IN)                      :: isavnh
   INTEGER, INTENT(IN)                      :: isavnk
   INTEGER, INTENT(IN)                      :: isavrv1
   INTEGER, INTENT(IN)                      :: isavrv2
   INTEGER, INTENT(IN)                      :: isvel1
   INTEGER, INTENT(IN)                      :: isvel2
   INTEGER, INTENT(IN)                      :: ibest
   INTEGER, INTENT(IN)                      :: ifixgamma
   REAL(KIND=dp), INTENT(IN)                :: savesep
   INTEGER, INTENT(IN)                      :: ichilabel
   REAL(KIND=dp), INTENT(OUT)               :: resrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: resrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: thresh
   REAL(KIND=dp), INTENT(IN OUT)            :: small
   INTEGER, INTENT(OUT)                     :: ncycle(40)
   REAL(KIND=dp), INTENT(OUT)               :: ttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: tseps(40,nmeclpse)
   INTEGER, INTENT(IN)                      :: nobscycle(40)
   REAL(KIND=dp), INTENT(IN)                :: obsttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(IN)                :: obsterr(40,nmeclpse)
   INTEGER, INTENT(IN)                      :: icnarry(40)
   REAL(KIND=dp), INTENT(OUT)               :: rv3(nmaxphase)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv3(ndatamax)
   INTEGER, INTENT(IN OUT)                  :: icnrv3
   REAL(KIND=dp), INTENT(OUT)               :: resrv3(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ggamma3
   INTEGER, INTENT(IN OUT)                  :: nrv3
   CHARACTER (LEN=1000), INTENT(OUT)        :: parmstring
   CHARACTER (LEN=3000), INTENT(OUT)        :: planetparm
   CHARACTER (LEN=1700), INTENT(OUT)        :: dynparm
   CHARACTER (LEN=3000), INTENT(OUT)        :: line
   REAL(KIND=dp), INTENT(IN OUT)            :: fill1
   REAL(KIND=dp), INTENT(IN OUT)            :: fill2
   REAL(KIND=dp), INTENT(IN OUT)            :: omega1
   REAL(KIND=dp), INTENT(IN OUT)            :: omega2
   REAL(KIND=dp), INTENT(IN OUT)            :: dphase
   REAL(KIND=dp), INTENT(IN OUT)            :: q
   REAL(KIND=dp), INTENT(IN OUT)            :: finc
   REAL(KIND=dp), INTENT(IN OUT)            :: teff1
   REAL(KIND=dp), INTENT(IN OUT)            :: teff2
   REAL(KIND=dp), INTENT(IN OUT)            :: tgrav1
   REAL(KIND=dp), INTENT(IN OUT)            :: tgrav2
   REAL(KIND=dp), INTENT(IN OUT)            :: betarim
   REAL(KIND=dp), INTENT(IN OUT)            :: rinner
   REAL(KIND=dp), INTENT(IN OUT)            :: router
   REAL(KIND=dp), INTENT(IN OUT)            :: tdisk
   REAL(KIND=dp), INTENT(IN OUT)            :: xi
   REAL(KIND=dp), INTENT(IN OUT)            :: alb1
   REAL(KIND=dp), INTENT(IN OUT)            :: alb2
   REAL(KIND=dp), INTENT(IN OUT)            :: rlx
   REAL(KIND=dp), INTENT(IN OUT)            :: period
   REAL(KIND=dp), INTENT(IN OUT)            :: fm
   REAL(KIND=dp), INTENT(IN OUT)            :: separ
   REAL(KIND=dp), INTENT(IN OUT)            :: gamma
   REAL(KIND=dp), INTENT(IN OUT)            :: wave(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: dbolx(8,2)
   REAL(KIND=dp), INTENT(IN OUT)            :: dboly(8,2)
   REAL(KIND=dp), INTENT(IN OUT)            :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN OUT)            :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN OUT)            :: t3
   REAL(KIND=dp), INTENT(IN OUT)            :: g3
   REAL(KIND=dp), INTENT(IN OUT)            :: sa3
   REAL(KIND=dp), INTENT(IN OUT)            :: density
   REAL(KIND=dp), INTENT(IN OUT)            :: sw1
   REAL(KIND=dp), INTENT(IN OUT)            :: sw2
   REAL(KIND=dp), INTENT(IN OUT)            :: sw3
   REAL(KIND=dp), INTENT(IN OUT)            :: t0
   REAL(KIND=dp), INTENT(IN OUT)            :: ecc
   REAL(KIND=dp), INTENT(IN OUT)            :: argper
   REAL(KIND=dp), INTENT(IN OUT)            :: pshift
   REAL(KIND=dp), INTENT(IN OUT)            :: sw5
   REAL(KIND=dp), INTENT(IN OUT)            :: sw6
   REAL(KIND=dp), INTENT(IN OUT)            :: sw7
   REAL(KIND=dp), INTENT(IN OUT)            :: sw8
   REAL(KIND=dp), INTENT(IN OUT)            :: sw9
   REAL(KIND=dp), INTENT(IN OUT)            :: primmass
   REAL(KIND=dp), INTENT(IN OUT)            :: primk
   REAL(KIND=dp), INTENT(IN OUT)            :: primrad
   REAL(KIND=dp), INTENT(IN OUT)            :: ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: frac1
   REAL(KIND=dp), INTENT(IN OUT)            :: frac2
   REAL(KIND=dp), INTENT(IN OUT)            :: ecosw
   REAL(KIND=dp), INTENT(IN OUT)            :: temprat
   REAL(KIND=dp), INTENT(IN OUT)            :: bigi
   REAL(KIND=dp), INTENT(IN OUT)            :: bigbeta
   REAL(KIND=dp), INTENT(IN OUT)            :: sw23
   REAL(KIND=dp), INTENT(IN OUT)            :: sw24
   REAL(KIND=dp), INTENT(IN OUT)            :: sw25
   REAL(KIND=dp), INTENT(IN OUT)            :: sw26
   REAL(KIND=dp), INTENT(IN OUT)            :: sw27
   REAL(KIND=dp), INTENT(IN OUT)            :: sw28
   REAL(KIND=dp), INTENT(IN OUT)            :: sw29
   REAL(KIND=dp), INTENT(IN OUT)            :: sw30
   REAL(KIND=dp), INTENT(IN OUT)            :: contam
   REAL(KIND=dp), INTENT(IN OUT)            :: tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: beam1
   REAL(KIND=dp), INTENT(IN OUT)            :: beam2
   REAL(KIND=dp), INTENT(IN OUT)            :: ocose
   REAL(KIND=dp), INTENT(IN OUT)            :: osine
   REAL(KIND=dp), INTENT(IN OUT)            :: omegadot
   REAL(KIND=dp), INTENT(IN OUT)            :: contams0
   REAL(KIND=dp), INTENT(IN OUT)            :: contams1
   REAL(KIND=dp), INTENT(IN OUT)            :: contams2
   REAL(KIND=dp), INTENT(IN OUT)            :: contams3
   REAL(KIND=dp), INTENT(IN OUT)            :: sw47
   REAL(KIND=dp), INTENT(IN OUT)            :: sw48
   REAL(KIND=dp), INTENT(IN OUT)            :: sw49
   REAL(KIND=dp), INTENT(IN OUT)            :: gaplow(9999)
   REAL(KIND=dp), INTENT(IN OUT)            :: gaphigh(9999)
   REAL(KIND=dp), INTENT(IN OUT)            :: p2tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p2period
   REAL(KIND=dp), INTENT(IN OUT)            :: p2t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p2ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p2esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p2incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p2omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p2q
   REAL(KIND=dp), INTENT(IN OUT)            :: p2ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p3tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p3period
   REAL(KIND=dp), INTENT(IN OUT)            :: p3t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p3ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p3esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p3incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p3omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p3q
   REAL(KIND=dp), INTENT(IN OUT)            :: p3ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p4tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p4period
   REAL(KIND=dp), INTENT(IN OUT)            :: p4t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p4ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p4esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p4incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p4omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p4q
   REAL(KIND=dp), INTENT(IN OUT)            :: p4ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p5tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p5period
   REAL(KIND=dp), INTENT(IN OUT)            :: p5t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p5ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p5esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p5incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p5omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p5q
   REAL(KIND=dp), INTENT(IN OUT)            :: p5ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p6tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p6period
   REAL(KIND=dp), INTENT(IN OUT)            :: p6t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p6ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p6esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p6incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p6omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p6q
   REAL(KIND=dp), INTENT(IN OUT)            :: p6ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p7tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p7period
   REAL(KIND=dp), INTENT(IN OUT)            :: p7t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p7ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p7esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p7incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p7omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p7q
   REAL(KIND=dp), INTENT(IN OUT)            :: p7ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: p8tconj
   REAL(KIND=dp), INTENT(IN OUT)            :: p8period
   REAL(KIND=dp), INTENT(IN OUT)            :: p8t0
   REAL(KIND=dp), INTENT(IN OUT)            :: p8ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: p8esin
   REAL(KIND=dp), INTENT(IN OUT)            :: p8incl
   REAL(KIND=dp), INTENT(IN OUT)            :: p8omega
   REAL(KIND=dp), INTENT(IN OUT)            :: p8q
   REAL(KIND=dp), INTENT(IN OUT)            :: p8ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: xsc(9999)
   REAL(KIND=dp), INTENT(IN OUT)            :: ysc(9999)
   REAL(KIND=dp), INTENT(IN OUT)            :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN OUT)            :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN OUT)            :: spotdparm(2,4)
   INTEGER, INTENT(IN OUT)                  :: nalph1
   INTEGER, INTENT(IN OUT)                  :: nbet1
   INTEGER, INTENT(IN OUT)                  :: nalph2
   INTEGER, INTENT(IN OUT)                  :: nbet2
   INTEGER, INTENT(IN OUT)                  :: ntheta
   INTEGER, INTENT(IN OUT)                  :: nradius
   INTEGER, INTENT(IN OUT)                  :: nref
   INTEGER, INTENT(IN OUT)                  :: idraw
   INTEGER, INTENT(IN OUT)                  :: iecheck
   INTEGER, INTENT(IN OUT)                  :: iidint
   INTEGER, INTENT(IN OUT)                  :: iatm
   INTEGER, INTENT(IN OUT)                  :: ism1
   INTEGER, INTENT(IN OUT)                  :: ilaw
   INTEGER, INTENT(IN OUT)                  :: icnu
   INTEGER, INTENT(IN OUT)                  :: icnb
   INTEGER, INTENT(IN OUT)                  :: icnv
   INTEGER, INTENT(IN OUT)                  :: icnr
   INTEGER, INTENT(IN OUT)                  :: icni
   INTEGER, INTENT(IN OUT)                  :: icnj
   INTEGER, INTENT(IN OUT)                  :: icnh
   INTEGER, INTENT(IN OUT)                  :: icnk
   INTEGER, INTENT(IN OUT)                  :: icnrv1
   INTEGER, INTENT(IN OUT)                  :: icnrv2
   INTEGER, INTENT(IN OUT)                  :: irvfilt
   INTEGER, INTENT(IN OUT)                  :: isw1
   INTEGER, INTENT(IN OUT)                  :: isw2
   INTEGER, INTENT(IN OUT)                  :: isw3
   INTEGER, INTENT(IN OUT)                  :: isw4
   INTEGER, INTENT(IN OUT)                  :: ikeep
   INTEGER, INTENT(IN OUT)                  :: isynch
   INTEGER, INTENT(IN OUT)                  :: isw5
   INTEGER, INTENT(IN OUT)                  :: isw6
   INTEGER, INTENT(IN OUT)                  :: isw7
   INTEGER, INTENT(IN OUT)                  :: isw8
   INTEGER, INTENT(IN OUT)                  :: isw9
   INTEGER, INTENT(IN OUT)                  :: idark1
   INTEGER, INTENT(IN OUT)                  :: idark2
   INTEGER, INTENT(IN OUT)                  :: isw12
   INTEGER, INTENT(IN OUT)                  :: isw13
   INTEGER, INTENT(IN OUT)                  :: isw21
   INTEGER, INTENT(IN OUT)                  :: isw22
   INTEGER, INTENT(IN OUT)                  :: isw23
   INTEGER, INTENT(IN OUT)                  :: isw24
   INTEGER, INTENT(IN OUT)                  :: isw25
   INTEGER, INTENT(IN OUT)                  :: isw26
   INTEGER, INTENT(IN OUT)                  :: isw27
   INTEGER, INTENT(IN OUT)                  :: isw28
   INTEGER, INTENT(IN OUT)                  :: isw29
   INTEGER, INTENT(IN OUT)                  :: isw30
   INTEGER, INTENT(IN OUT)                  :: isw31
   INTEGER, INTENT(IN OUT)                  :: isw32
   INTEGER, INTENT(IN OUT)                  :: isw33
   INTEGER, INTENT(IN OUT)                  :: isw34
   INTEGER, INTENT(IN)                      :: nsc
   REAL(KIND=dp), INTENT(IN OUT)            :: compfracs(8,3)
   REAL(KIND=dp), INTENT(IN OUT)            :: tertperiod
   REAL(KIND=dp), INTENT(IN OUT)            :: tertt0
   REAL(KIND=dp), INTENT(IN OUT)            :: tertecos
   REAL(KIND=dp), INTENT(IN OUT)            :: tertesin
   REAL(KIND=dp), INTENT(IN OUT)            :: tertincl
   REAL(KIND=dp), INTENT(IN OUT)            :: tertomega
   REAL(KIND=dp), INTENT(IN OUT)            :: tertq
   REAL(KIND=dp), INTENT(IN OUT)            :: tertconj
   REAL(KIND=dp), INTENT(IN OUT)            :: tertratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: hh
   REAL(KIND=dp), INTENT(IN OUT)            :: sw72
   REAL(KIND=dp), INTENT(IN OUT)            :: sw73
   REAL(KIND=dp), INTENT(IN OUT)            :: tdur1(40,nmaxphase)
   REAL(KIND=dp), INTENT(IN OUT)            :: tdur2(40,nmeclpse)
   REAL(KIND=dp), INTENT(IN OUT)            :: sw80
   REAL(KIND=dp), INTENT(IN OUT)            :: sw81
   REAL(KIND=dp), INTENT(IN OUT)            :: sw82
   REAL(KIND=dp), INTENT(IN OUT)            :: sw83
   REAL(KIND=dp), INTENT(IN OUT)            :: sw84
   REAL(KIND=dp), INTENT(IN OUT)            :: sw85
   INTEGER, INTENT(IN OUT)                  :: isw80
   INTEGER, INTENT(IN OUT)                  :: isw81
   INTEGER, INTENT(IN OUT)                  :: isw82
   INTEGER, INTENT(IN OUT)                  :: isw83
   INTEGER, INTENT(IN OUT)                  :: isw84
   INTEGER, INTENT(IN OUT)                  :: isw85
   INTEGER, INTENT(IN OUT)                  :: isw86
   INTEGER, INTENT(IN OUT)                  :: isw87
   INTEGER, INTENT(IN OUT)                  :: isw88
   INTEGER, INTENT(IN OUT)                  :: isw89
   REAL(KIND=dp), INTENT(OUT)               :: ymods4(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: ymods5(nmaxphase)
   REAL(KIND=dp), INTENT(IN OUT)            :: arrsobx(montemax)
   REAL(KIND=dp), INTENT(IN OUT)            :: arrsoby(montemax)
   INTEGER, INTENT(IN OUT)                  :: nrv4
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: rv4(nmaxphase)
   INTEGER, INTENT(IN OUT)                  :: icnrv4
   REAL(KIND=dp), INTENT(OUT)               :: resrv4(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ggamma4
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint5(8)
   REAL(KIND=dp), INTENT(IN)                :: atmt(maxlines)
   REAL(KIND=dp), INTENT(IN)                :: atmg(maxlines)
   REAL(KIND=dp), INTENT(IN)                :: atmmu(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint1(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint2(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint3(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint4(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint5(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint6(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint7(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: atmint8(maxlines,maxmu)
   REAL(KIND=dp), INTENT(IN)                :: tmin
   INTEGER, INTENT(IN)                      :: nlines
   INTEGER, INTENT(IN)                      :: nmu(maxlines)
   INTEGER, INTENT(IN OUT)                  :: nalph3
   INTEGER, INTENT(IN OUT)                  :: nbet3
   INTEGER, INTENT(IN OUT)                  :: itconj
   INTEGER, INTENT(IN OUT)                  :: it1
   INTEGER, INTENT(IN OUT)                  :: it2
   INTEGER, INTENT(IN OUT)                  :: it3
   INTEGER, INTENT(IN OUT)                  :: it4
   INTEGER, INTENT(IN)                      :: ndynwin
   REAL(KIND=dp), INTENT(IN)                :: dynwinlow(1000)
   REAL(KIND=dp), INTENT(IN)                :: dynwinhigh(1000)
   REAL(KIND=dp), INTENT(IN OUT)            :: p1mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p1ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p2mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p2ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p3mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p3ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p4mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p4ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p5mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p5ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p6mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p6ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p7mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p7ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: p8mtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p8ptc
   REAL(KIND=dp), INTENT(IN OUT)            :: pbmtc
   REAL(KIND=dp), INTENT(IN OUT)            :: pbptc
   REAL(KIND=dp), INTENT(IN OUT)            :: bigi2
   REAL(KIND=dp), INTENT(IN OUT)            :: bigi3
   REAL(KIND=dp), INTENT(IN OUT)            :: bigi4
   REAL(KIND=dp), INTENT(IN OUT)            :: bigbeta2
   REAL(KIND=dp), INTENT(IN OUT)            :: bigbeta3
   REAL(KIND=dp), INTENT(IN OUT)            :: bigbeta4
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2q
   REAL(KIND=dp), INTENT(IN OUT)            :: b2massdiff
   REAL(KIND=dp), INTENT(IN OUT)            :: b2masssum
   REAL(KIND=dp), INTENT(IN OUT)            :: b2raddiff
   REAL(KIND=dp), INTENT(IN OUT)            :: b2radsum
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2ratrad
   REAL(KIND=dp), INTENT(IN OUT)            :: g10
   REAL(KIND=dp), INTENT(IN OUT)            :: g6
   REAL(KIND=dp), INTENT(IN OUT)            :: g7
   REAL(KIND=dp), INTENT(IN OUT)            :: g8
   REAL(KIND=dp), INTENT(IN OUT)            :: g9
   REAL(KIND=dp), INTENT(IN OUT)            :: massdiff
   REAL(KIND=dp), INTENT(IN OUT)            :: masssum
   REAL(KIND=dp), INTENT(IN OUT)            :: omega3
   REAL(KIND=dp), INTENT(IN OUT)            :: omega4
   REAL(KIND=dp), INTENT(IN OUT)            :: omega5
   REAL(KIND=dp), INTENT(IN OUT)            :: omega6
   REAL(KIND=dp), INTENT(IN OUT)            :: omega7
   REAL(KIND=dp), INTENT(IN OUT)            :: omega8
   REAL(KIND=dp), INTENT(IN OUT)            :: omega9
   REAL(KIND=dp), INTENT(IN OUT)            :: omega10
   REAL(KIND=dp), INTENT(IN OUT)            :: raddiff
   REAL(KIND=dp), INTENT(IN OUT)            :: radsum
   REAL(KIND=dp), INTENT(IN OUT)            :: rk3
   REAL(KIND=dp), INTENT(IN OUT)            :: rk4
   REAL(KIND=dp), INTENT(IN OUT)            :: rk5
   REAL(KIND=dp), INTENT(IN OUT)            :: rk6
   REAL(KIND=dp), INTENT(IN OUT)            :: rk7
   REAL(KIND=dp), INTENT(IN OUT)            :: rk8
   REAL(KIND=dp), INTENT(IN OUT)            :: rk9
   REAL(KIND=dp), INTENT(IN OUT)            :: rk10
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint6(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint7(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint8(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint9(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: sdarkint10(8)
   REAL(KIND=dp), INTENT(IN OUT)            :: secmass
   REAL(KIND=dp), INTENT(IN OUT)            :: secrad
   REAL(KIND=dp), INTENT(IN OUT)            :: t10
   REAL(KIND=dp), INTENT(IN OUT)            :: t6
   REAL(KIND=dp), INTENT(IN OUT)            :: t7
   REAL(KIND=dp), INTENT(IN OUT)            :: t8
   REAL(KIND=dp), INTENT(IN OUT)            :: t9
   INTEGER, INTENT(IN OUT)                  :: nseg
   INTEGER, INTENT(IN OUT)                  :: isw100
   INTEGER, INTENT(IN)                      :: iunit
   REAL(KIND=dp), INTENT(IN OUT)            :: fracsum
   REAL(KIND=dp), INTENT(IN OUT)            :: fracdiff
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2m3
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2m4
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2r3
   REAL(KIND=dp), INTENT(IN OUT)            :: bin2r4
   REAL(KIND=dp), INTENT(IN OUT)            :: sqecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqesin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqtertecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqtertesin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp2ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp2esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp3ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp3esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp4ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp4esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp5ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp5esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp6ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp6esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp7ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp7esin
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp8ecos
   REAL(KIND=dp), INTENT(IN OUT)            :: sqp8esin
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum1
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff1
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum2
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff2
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum3
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff3
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum4
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff4
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum5
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff5
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum6
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff6
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum7
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff7
   REAL(KIND=dp), INTENT(IN OUT)            :: angsum8
   REAL(KIND=dp), INTENT(IN OUT)            :: angdiff8
   INTEGER, INTENT(IN)                      :: imag
   CHARACTER (LEN=4000), INTENT(OUT)        :: newparmstr
   INTEGER, INTENT(IN OUT)                  :: ioutflag
   REAL(KIND=dp), INTENT(IN OUT)            :: fillsum
   REAL(KIND=dp), INTENT(IN OUT)            :: filldiff
   REAL(KIND=dp), INTENT(IN OUT)            :: binqtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p1qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p2qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p3qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p4qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p5qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p6qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p7qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: p8qtc
   REAL(KIND=dp), INTENT(IN OUT)            :: tbinoff
   REAL(KIND=dp), INTENT(IN OUT)            :: t1off
   REAL(KIND=dp), INTENT(IN OUT)            :: t2off
   REAL(KIND=dp), INTENT(IN OUT)            :: t3off
   REAL(KIND=dp), INTENT(IN OUT)            :: t4off
   REAL(KIND=dp), INTENT(IN OUT)            :: t5off
   REAL(KIND=dp), INTENT(IN OUT)            :: t6off
   REAL(KIND=dp), INTENT(IN OUT)            :: t7off
   REAL(KIND=dp), INTENT(IN OUT)            :: t8off
   CHARACTER (LEN=350), INTENT(OUT)         :: fracstring
   REAL(KIND=dp), INTENT(OUT)               :: resttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: drv3(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: drv4(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: drv5(nmaxphase)
   REAL(KIND=dp), INTENT(OUT)               :: rv5(nmaxphase)
   INTEGER, INTENT(IN)                      :: nset
   INTEGER, INTENT(IN)                      :: nrv1arry(5)
   INTEGER, INTENT(IN)                      :: icnrv1arry(5)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv1arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv2arry(5)
   INTEGER, INTENT(IN)                      :: icnrv2arry(5)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv2arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv3arry(5)
   INTEGER, INTENT(IN)                      :: icnrv3arry(5)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv3arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv4arry(5)
   INTEGER, INTENT(IN)                      :: icnrv4arry(5)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv4arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: icnrv5arry(5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svxrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svyrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svxrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svyrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN OUT)            :: svrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: resrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: resrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: resrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: resrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: resrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: gamma1arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: gamma2arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: gamma3arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: gamma4arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: gamma5arry(5)
   INTEGER, INTENT(IN)                      :: irecord
   INTEGER, INTENT(IN)                      :: iversion
   REAL(KIND=dp), INTENT(IN OUT)            :: tesscontam
   INTEGER, INTENT(IN)                      :: tessfilt
   REAL(KIND=dp), INTENT(IN)                :: tessbin
!
   INTEGER :: i,icnrv5,ijk,isvel3,isvel4,j,nbin,nnrv1,nnrv2,nnrv3,nnrv4 
!
   REAL(KIND=dp) :: cccc,chipenalty,chipenaltysec,chisqrv3,chisqrv4,chitimetot
   REAL(KIND=dp) :: gamma1,gamma2,gamma3,gamma4,ochilr3,ochilr4,remf1,remf2
   REAL(KIND=dp) :: savp2q,savp3q,savp4q,savp5q,savp6q,savp7q,savp8q,savtertq 
   REAL(KIND=dp) :: chiout
!
   REAL(KIND=dp), DIMENSION(3)  :: penaltyarr(3)
   REAL(KIND=dp), DIMENSION(5)  :: chirv2arry,chirv3arry,chirv4arry
   REAL(KIND=dp), DIMENSION(5)  :: chirv5arry,chirv1arry
   REAL(KIND=dp), DIMENSION(8)  :: ochilumrat
   REAL(KIND=dp), DIMENSION(27) :: orbitparm
   REAL(KIND=dp), DIMENSION(40) :: chitimearry
!
   chisqu=0.0_dp
   chisqb=0.0_dp
   chisqv=0.0_dp
   chisqr=0.0_dp
   chisqi=0.0_dp
   chisqj=0.0_dp
   chisqh=0.0_dp
   chisqk=0.0_dp
   chisqrv1=0.0_dp
   chisqrv2=0.0_dp
   chi1=0.0_dp
   zerou=0.0_dp
   resu=0.0_dp
   zerob=0.0_dp
   resb=0.0_dp
   zerov=0.0_dp
   resv=0.0_dp
   zeror=0.0_dp
   resr=0.0_dp
   zeroi=0.0_dp
   resi=0.0_dp
   zeroj=0.0_dp
   resj=0.0_dp
   zeroh=0.0_dp
   resh=0.0_dp
   zerok=0.0_dp
   resk=0.0_dp
   ochi=0.0_dp
   ochidisk=0.0_dp
   ochilr=0.0_dp
   resrv1=0.0_dp
   resrv2=0.0_dp
   resrv3=0.0_dp
   resrv4=0.0_dp
   resrv1arry=0.0_dp
   resrv2arry=0.0_dp
   resrv3arry=0.0_dp
   resrv4arry=0.0_dp
   resrv5arry=0.0_dp
!
   gamma1arry=0.0_dp
   gamma2arry=0.0_dp
   gamma3arry=0.0_dp
   gamma4arry=0.0_dp
   gamma5arry=0.0_dp
   ggamma1=0.0_dp
   ggamma2=0.0_dp
   ggamma3=0.0_dp
   ggamma4=0.0_dp
   penaltyarr(1)=0.0_dp
   penaltyarr(2)=0.0_dp
   penaltyarr(3)=0.0_dp
!
   xmod=0.0_dp
   xrvmod=0.0_dp
   ymodu=0.0_dp
   ymodb=0.0_dp
   ymodv=0.0_dp
   ymodr=0.0_dp
   ymodi=0.0_dp
   ymodj=0.0_dp
   ymodh=0.0_dp
   ymodk=0.0_dp
   ymods1=0.0_dp
   ymods2=0.0_dp
   ymods3=0.0_dp
   ymodd=0.0_dp
   rv1=0.0_dp
   rv2=0.0_dp
   rv3=0.0_dp
   rv4=0.0_dp
   rv5=0.0_dp
   drv1=0.0_dp
   drv2=0.0_dp
   drv3=0.0_dp
   drv4=0.0_dp
   drv5=0.0_dp
   fracs1=0.0_dp
   fracs2=0.0_dp
   fracs3=0.0_dp
   fracs4=0.0_dp
   fracs5=0.0_dp
   fracs6=0.0_dp
   fracs7=0.0_dp
   fracs8=0.0_dp

!
   IF(savesep < 0.0_dp)separ=savesep
!
   CALL assignvar(nvmax,svar,var,fill1,fill2,omega1,omega2,q,  &
      finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,separ,  &
      gamma,t3,g3,sa3,ecc,argper,pshift,spot1parm,spot2parm,  &
      spotdparm,period,t0,alb1,alb2,dwavex,dwavey,primmass,primk,  &
      primrad,ratrad,frac1,frac2,ecosw,temprat,bigi,bigbeta,  &
      density,tconj,beam1,beam2,contam,ocose,osine,  &
      isw29,tertperiod,tertt0,tertecos,tertesin,tertincl,tertomega,  &
      tertq,tgrav1,tgrav2,tertconj,omegadot,contams0,contams1,  &
      contams2,contams3,p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,  &
      p2omega,p2q,p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,  &
      p3incl,p3omega,p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,  &
      p4esin,p4incl,p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,  &
      p5ecos,p5esin,p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,  &
      p6t0,p6ecos,p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,  &
      p7period,p7t0,p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,  &
      p8tconj,p8period,p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,  &
      p8ratrad,sw72,sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,  &
      sdarkint3,sdarkint4,sdarkint5,tertratrad,p1mtc,p1ptc,p2mtc,  &
      p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,  &
      p7ptc,p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,  &
      bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
      b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
      omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
      raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
      sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
      t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,  &
      sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
      sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
      sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
      angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
      angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
      angsum8,angdiff8,fillsum,filldiff,binqtc,p1qtc,p2qtc,p3qtc,  &
      p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
      t4off,t5off,t6off,t7off,t8off,isw26,tesscontam)
!
!   If isw28 is greater than 0, then set the value of T0 based
!   on the time of transit Tconj.
!
   thresh=sw48
   nbin=0
   IF(isw28 > 0)THEN
      IF(isw29 > 0)THEN
         ecc=SQRT(ocose*ocose+osine*osine)
         argper=ATAN2(osine,ocose)*radtodeg
         IF(argper <= 0.0_dp)argper=argper+360.0_dp
         IF(argper > 360.0_dp)argper=argper-360.0_dp
      END IF
      CALL gett0(finc,period,ecc,argper,t0,tconj)
   END IF
!
!  Save the filling factors in case there is an eccentric orbit
!
   remf1=fill1
   remf2=fill2
!
!  Get the models.
!
!  If sw25>0, use that as an error for asini (sw5)
!
   IF(sw25 > 0.0_dp)sw5=saveasini+gasdev6(idum)*sw25
!
!  if we are doing the body3, and it1=1, then assume mass
!  ratios are logs
!
   IF((isw30 >= 1).AND.(it1 == 1))THEN
      savtertq=tertq
      savp2q=p2q
      savp3q=p3q
      savp4q=p4q
      savp5q=p5q
      savp6q=p6q
      savp7q=p7q
      savp8q=p8q
      tertq=10.0_dp**(tertq)
      p2q=10.0_dp**(p2q)
      p3q=10.0_dp**(p3q)
      p4q=10.0_dp**(p4q)
      p5q=10.0_dp**(p5q)
      p6q=10.0_dp**(p6q)
      p7q=10.0_dp**(p7q)
      p8q=10.0_dp**(p8q)
   END IF
!
   sw85=10.0_dp
   CALL lightcurve(nphase,nmaxphase,xmod,ymodu,ymodb,ymodv,  &
      ymodr,ymodi,ymodj,ymodh,ymodk,ymods1,ymods2,ymods3,ymodd,rv1,  &
      rv2,drv1,drv2,obsparm,ifastflag,nrvphase,xrvmod,fracs1,  &
      fracs2,fracs3,fracs4,fracs5,fracs6,fracs7,fracs8,ncycle,  &
      ttimes,tseps,rv3,parmstring,planetparm,dynparm,fill1,  &
      fill2,omega1,omega2,dphase,q,finc,teff1,teff2,tgrav1,tgrav2,  &
      betarim,rinner,router,tdisk,xi,alb1,alb2,rlx,period,fm,separ,  &
      gamma,wave,dbolx,dboly,dwavex,dwavey,t3,g3,sa3,density,sw1,  &
      sw2,sw3,t0,ecc,argper,pshift,sw5,sw6,sw7,sw8,sw9,primmass,  &
      primk,primrad,ratrad,frac1,frac2,ecosw,temprat,bigi,bigbeta,  &
      sw23,sw24,sw25,sw26,sw27,sw28,sw29,sw30,contam,  &
      tconj,beam1,beam2,ocose,osine,omegadot,contams0,contams1,  &
      contams2,contams3,sw47,sw48,sw49,gaplow,gaphigh,p2tconj,  &
      p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,p2ratrad,  &
      p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,p3q,  &
      p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,p4omega,  &
      p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,p5incl,  &
      p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,p6esin,  &
      p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,p7ecos,  &
      p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,p8t0,  &
      p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad,xsc,ysc,spot1parm,  &
      spot2parm,spotdparm,nalph1,nbet1,nalph2,nbet2,ntheta,nradius,  &
      nref,idraw,iecheck,iidint,iatm,ism1,ilaw,icnu,icnb,icnv,icnr,  &
      icni,icnj,icnh,icnk,icnrv1,icnrv2,irvfilt,isw1,isw2,isw3,  &
      isw4,ikeep,isynch,isw5,isw6,isw7,isw8,isw9,idark1,idark2,  &
      isw12,isw13,isw21,isw22,isw23,isw24,isw25,isw26,isw27,isw28,  &
      isw29,isw30,isw31,isw32,isw33,isw34,nsc,compfracs,tertperiod,  &
      tertt0,tertecos,tertesin,tertincl,tertomega,tertq,tertconj,  &
      tertratrad,hh,sw72,sw73,nmeclpse,tdur1,tdur2,ioutflag,  &
      sw80,sw81,sw82,sw83,sw84,sw85,isw80,  &
      isw81,isw82,isw83,isw84,isw85,isw86,isw87,isw88,isw89,ymods4,  &
      ymods5,arrsobx,arrsoby,montemax,rv4,sdarkint1,sdarkint2,  &
      sdarkint3,sdarkint4,sdarkint5,atmt,atmg,atmmu,atmint1,  &
      atmint2,atmint3,atmint4,atmint5,atmint6,atmint7,atmint8,  &
      tmin,nlines,nmu,nalph3,nbet3,itconj,it1,it2,it3,  &
      it4,ndynwin,dynwinlow,dynwinhigh,p1mtc,p1ptc,p2mtc,p2ptc,  &
      p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,p7ptc,  &
      p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,bigbeta3,  &
      bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
      b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
      omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
      raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
      sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
      t6,t7,t8,t9,nseg,isw100,iunit,fracsum,fracdiff,bin2m3,bin2m4,  &
      bin2r3,bin2r4,sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,  &
      sqp2esin,sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,  &
      sqp5esin,sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,  &
      sqp8esin,angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,  &
      angsum4,angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,  &
      angdiff7,angsum8,angdiff8,imag,newparmstr,fillsum,  &
      filldiff,binqtc,p1qtc,p2qtc,p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,  &
      p8qtc,tbinoff,t1off,t2off,t3off,t4off,t5off,t6off,t7off,  &
      t8off,1,fracstring,drv3,drv4,drv5,rv5,orbitparm,iversion, &
      tesscontam,tessfilt,tessbin,maxlines,maxmu)
!
   IF((isw30 >= 1).AND.(it1 == 1))THEN
      tertq=savtertq
      p2q=savp2q
      p3q=savp3q
      p4q=savp4q
      p5q=savp5q
      p6q=savp6q
      p7q=savp7q
      p8q=savp8q
   END IF
!
   fill1=remf1
   fill2=remf2
!
!   August 2, 2001
!
!   If we are fitting for the period and/or T0 (itime>0), then we
!   have to fold the saved arrays.
!
   IF(isw7 > 0)THEN
      IF(icnu /= 430)CALL phasefold(ndatamax,isavnu,svxdatau,  &
         svydatau,sverru,nbin,ndatau,xdatau,ydatau,erru,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnb /= 430)CALL phasefold(ndatamax,isavnb,svxdatab,  &
         svydatab,sverrb,nbin,ndatab,xdatab,ydatab,errb,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnv /= 430)CALL phasefold(ndatamax,isavnv,svxdatav,  &
         svydatav,sverrv,nbin,ndatav,xdatav,ydatav,errv,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnr /= 430)CALL phasefold(ndatamax,isavnr,svxdatar,  &
         svydatar,sverrr,nbin,ndatar,xdatar,ydatar,errr,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icni /= 430)CALL phasefold(ndatamax,isavni,svxdatai,  &
         svydatai,sverri,nbin,ndatai,xdatai,ydatai,erri,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnj /= 430)CALL phasefold(ndatamax,isavnj,svxdataj,  &
         svydataj,sverrj,nbin,ndataj,xdataj,ydataj,errj,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnh /= 430)CALL phasefold(ndatamax,isavnh,svxdatah,  &
         svydatah,sverrh,nbin,ndatah,xdatah,ydatah,errh,period,t0,  &
         ikeep,ecc,argper,isw7)
      IF(icnk /= 430)CALL phasefold(ndatamax,isavnk,svxdatak,  &
         svydatak,sverrk,nbin,ndatak,xdatak,ydatak,errk,period,t0,  &
         ikeep,ecc,argper,isw7)
!
!   If ifixgamma is 11 or 12 then we need to loop over RV sets
!
      IF(ifixgamma < 10)THEN
         IF(icnrv1 /= 430)CALL phasefold(ndatamax,isavrv1,svxrv1,  &
            svyrv1,svrv1,nbin,nrv1,xrv1,yrv1,errrv1,period,t0,ikeep, &
            ecc,argper,isw7)
         IF(icnrv2 /= 430)CALL phasefold(ndatamax,isavrv2,svxrv2,  &
            svyrv2,svrv2,nbin,nrv2,xrv2,yrv2,errrv2,period,t0,ikeep, &
            ecc,argper,isw7)
      END IF
!
      IF(ifixgamma >= 10)THEN
         IF(icnrv1 /= 430)CALL setfold(nset,ndatamax,nrv1arry,  &
            svxrv1arry,svyrv1arry,svrv1arry,nbin,xrv1arry,  &
            yrv1arry,errrv1arry,period,t0,ikeep,ecc,argper,isw7)
         IF(icnrv2 /= 430)CALL setfold(nset,ndatamax,nrv2arry,  &
            svxrv2arry,svyrv2arry,svrv2arry,nbin,xrv2arry,  &
            yrv2arry,errrv2arry,period,t0,ikeep,ecc,argper,isw7)
      END IF
!
   END IF
!
!   Get the chi^2 values
!
   CALL initchi(chisqu,chisqb,chisqv,chisqr,chisqi,chisqj,  &
      chisqh,chisqk,chisqrv1,chisqrv2,chisqrv3,chisqrv4)
   DO i=1,5
      chirv1arry(i)=0.0_dp
      chirv2arry(i)=0.0_dp
      chirv3arry(i)=0.0_dp
      chirv4arry(i)=0.0_dp
      chirv5arry(i)=0.0_dp
   END DO
!
   IF(imag == 0)THEN
      IF(icnu /= 430)CALL checklcfit(9,nphase,xmod,ymodu,ndatau,  &
         xdatau,ydatau,erru,chisqu,zerou,ifixgamma,isw7,resu)
      IF(icnb /= 430)CALL checklcfit(9,nphase,xmod,ymodb,ndatab,  &
         xdatab,ydatab,errb,chisqb,zerob,ifixgamma,isw7,resb)
      IF(icnv /= 430)CALL checklcfit(9,nphase,xmod,ymodv,ndatav,  &
         xdatav,ydatav,errv,chisqv,zerov,ifixgamma,isw7,resv)
      IF(icnr /= 430)CALL checklcfit(9,nphase,xmod,ymodr,ndatar,  &
         xdatar,ydatar,errr,chisqr,zeror,ifixgamma,isw7,resr)
      IF(icni /= 430)CALL checklcfit(9,nphase,xmod,ymodi,ndatai,  &
         xdatai,ydatai,erri,chisqi,zeroi,ifixgamma,isw7,resi)
      IF(icnj /= 430)CALL checklcfit(9,nphase,xmod,ymodj,ndataj,  &
         xdataj,ydataj,errj,chisqj,zeroj,ifixgamma,isw7,resj)
      IF(icnh /= 430)CALL checklcfit(9,nphase,xmod,ymodh,ndatah,  &
         xdatah,ydatah,errh,chisqh,zeroh,ifixgamma,isw7,resh)
      IF(icnk /= 430)CALL checklcfit(9,nphase,xmod,ymodk,ndatak,  &
         xdatak,ydatak,errk,chisqk,zerok,ifixgamma,isw7,resk)
   END IF
   IF(imag > 0)THEN
      IF(icnu /= 430)CALL checkfluxfit(9,nphase,xmod,ymodu,  &
         ndatau,xdatau,ydatau,erru,chisqu,zerou,ifixgamma,isw7,resu)
      IF(icnb /= 430)CALL checkfluxfit(9,nphase,xmod,ymodb,  &
         ndatab,xdatab,ydatab,errb,chisqb,zerob,ifixgamma,isw7,resb)
      IF(icnv /= 430)CALL checkfluxfit(9,nphase,xmod,ymodv,  &
         ndatav,xdatav,ydatav,errv,chisqv,zerov,ifixgamma,isw7,resv)
      IF(icnr /= 430)CALL checkfluxfit(9,nphase,xmod,ymodr,  &
         ndatar,xdatar,ydatar,errr,chisqr,zeror,ifixgamma,isw7,resr)
      IF(icni /= 430)CALL checkfluxfit(9,nphase,xmod,ymodi,  &
         ndatai,xdatai,ydatai,erri,chisqi,zeroi,ifixgamma,isw7,resi)
      IF(icnj /= 430)CALL checkfluxfit(9,nphase,xmod,ymodj,  &
         ndataj,xdataj,ydataj,errj,chisqj,zeroj,ifixgamma,isw7,resj)
      IF(icnh /= 430)CALL checkfluxfit(9,nphase,xmod,ymodh,  &
         ndatah,xdatah,ydatah,errh,chisqh,zeroh,ifixgamma,isw7,resh)
      IF(icnk /= 430)CALL checkfluxfit(9,nphase,xmod,ymodk,  &
         ndatak,xdatak,ydatak,errk,chisqk,zerok,ifixgamma,isw7,resk)
   END IF
!
!   If ifixgamma is 11 or 12, we have multiple RV sets from
!   different observatories.  Fit each separately, finding
!   separate gamma velocities for each.
!
   IF(ifixgamma < 10)THEN
!
!  only have RV1 and RV2, but not RV3 or RV4, and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.((icnrv3 == 430)  &
         .AND.(icnrv4 == 430)).AND.(ifixgamma == 2))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,rv2,  &
            nrv1,xrv1,yrv1,errrv1,nrv2,xrv2,yrv2,errrv2,chisqrv1,  &
            chisqrv2,ggamma1,resrv1,resrv2,ndatamax)
         gamma1=ggamma1+gamma
         gamma2=ggamma1+gamma
         ggamma2=ggamma1
      END IF
!
!   Have RV1, RV2, and RV3, no RV4, and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv3 /= 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv4 == 430))THEN
         CALL checkrvfit3(nrvphase,xrvmod,rv1,rv2,rv3,nrv1,xrv1,  &
            yrv1,errrv1,nrv2,xrv2,yrv2,errrv2,nrv3,xrv3,yrv3,errrv3,  &
            chisqrv1,chisqrv2,chisqrv3,ggamma1,resrv1,resrv2,resrv3, &
            ndatamax)
         gamma1=ggamma1+gamma
         gamma2=ggamma1+gamma
         gamma3=ggamma1+gamma
         ggamma2=ggamma1
         ggamma3=gamma3
      END IF
!
!   Have RV1, RV2, and RV4, but not RV3, and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv4 /= 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv3 == 430))THEN
         CALL checkrvfit3(nrvphase,xrvmod,rv1,rv2,rv4,nrv1,xrv1,  &
            yrv1,errrv1,nrv2,xrv2,yrv2,errrv2,nrv4,xrv4,yrv4,errrv4,  &
            chisqrv1,chisqrv2,chisqrv4,ggamma1,resrv1,resrv2,resrv4, &
            ndatamax)
         gamma1=ggamma1+gamma
         gamma2=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma2=ggamma1
      END IF
!
!   Have RV2, RV3, and RV4, but not RV1, and ifixgamma=2
!
      IF((icnrv2 /= 430).AND.(icnrv3 /= 430).AND.(icnrv4 /= 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv1 == 430))THEN
         CALL checkrvfit3(nrvphase,xrvmod,rv2,rv3,rv4,nrv2,xrv2,  &
            yrv2,errrv2,nrv3,xrv3,yrv3,errrv3,nrv4,xrv4,yrv4,errrv4,  &
            chisqrv2,chisqrv3,chisqrv4,ggamma1,resrv2,resrv3,resrv4, &
            ndatamax)
         gamma2=ggamma1+gamma
         gamma3=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma2=ggamma1
         ggamma3=gamma3
      END IF
!
!   Have RV1, RV2, RV3, and RV4, and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv4 /= 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv3 /= 430))THEN
         CALL checkrvfit4(nrvphase,xrvmod,rv1,rv2,rv3,rv4,nrv1,  &
            xrv1,yrv1,errrv1,nrv2,xrv2,yrv2,errrv2,nrv3,xrv3,yrv3,  &
            errrv3,nrv4,xrv4,yrv4,errrv4,chisqrv1,chisqrv2,chisqrv3,  &
            chisqrv4,ggamma1,resrv1,resrv2,resrv3,resrv4,ndatamax)
         gamma1=ggamma1+gamma
         gamma2=ggamma1+gamma
         gamma3=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma2=ggamma1
      END IF
!
!   have RV1 and RV3, but not RV2 or RV4 and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv3 /= 430).AND.(icnrv2 == 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv4 == 430))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,rv3,  &
            nrv1,xrv1,yrv1,errrv1,nrv3,xrv3,yrv3,errrv3,chisqrv1,  &
            chisqrv3,ggamma1,resrv1,resrv3,ndatamax)
         gamma1=ggamma1+gamma
         gamma3=ggamma1+gamma
         ggamma3=ggamma1
         ggamma2=ggamma1
      END IF
!
!   have RV2 and RV4, but not RV1 or RV3 and ifixgamma=2
!
      IF((icnrv2 /= 430).AND.(icnrv4 /= 430).AND.(icnrv1 == 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv3 == 430))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv2,nrvphase,xrvmod,rv4,  &
            nrv2,xrv2,yrv2,errrv2,nrv4,xrv4,yrv4,errrv4,chisqrv2,  &
            chisqrv4,ggamma1,resrv2,resrv4,ndatamax)
         gamma2=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma2=ggamma1
         ggamma4=ggamma1
      END IF
!
!   have RV2 and RV3, but not RV1 or RV4 and ifixgamma=2
!
      IF((icnrv2 /= 430).AND.(icnrv3 /= 430).AND.(icnrv1 == 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv4 == 430))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv2,nrvphase,xrvmod,rv3,  &
            nrv2,xrv2,yrv2,errrv2,nrv3,xrv3,yrv3,errrv3,chisqrv2,  &
            chisqrv3,ggamma1,resrv2,resrv3,ndatamax)
         gamma2=ggamma1+gamma
         gamma3=ggamma1+gamma
         ggamma2=ggamma1
         ggamma3=ggamma1
      END IF
!
!   have RV1 and RV4, but not RV2 or RV3 and ifixgamma=2
!
      IF((icnrv1 /= 430).AND.(icnrv4 /= 430).AND.(icnrv2 == 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv3 == 430))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,rv4,  &
            nrv1,xrv1,yrv1,errrv1,nrv4,xrv4,yrv4,errrv4,chisqrv1,  &
            chisqrv4,ggamma1,resrv1,resrv4,ndatamax)
         gamma1=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma1=ggamma1
         ggamma4=ggamma1
      END IF
!
!   have RV3 and RV4, but not RV1 or RV2 and ifixgamma=2
!
      IF((icnrv3 /= 430).AND.(icnrv4 /= 430).AND.(icnrv1 == 430)  &
         .AND.(ifixgamma == 2).AND.(icnrv2 == 430))THEN
         CALL checkrvfit(nrvphase,xrvmod,rv3,nrvphase,xrvmod,rv4,  &
            nrv3,xrv3,yrv3,errrv3,nrv4,xrv4,yrv4,errrv4,chisqrv3,  &
            chisqrv4,ggamma1,resrv3,resrv4,ndatamax)
         gamma3=ggamma1+gamma
         gamma4=ggamma1+gamma
         ggamma3=ggamma1
         ggamma4=ggamma1
      END IF
!
!   if ifixgamma < 2, then fit each RV curve separately
!
      IF(ifixgamma < 2)THEN
         IF(icnrv1 /= 430)CALL checklcfit(0,nrvphase,xrvmod,rv1,  &
            nrv1,xrv1,yrv1,errrv1,chisqrv1,ggamma1,ifixgamma,isw7, &
            resrv1)
         gamma1=ggamma1+gamma
         IF(icnrv2 /= 430)CALL checklcfit(0,nrvphase,xrvmod,rv2,  &
            nrv2,xrv2,yrv2,errrv2,chisqrv2,ggamma2,ifixgamma,isw7, &
            resrv2)
         gamma2=ggamma2+gamma
         IF(icnrv3 /= 430)CALL checklcfit(0,nrvphase,xrvmod,rv3,  &
            nrv3,xrv3,yrv3,errrv3,chisqrv3,ggamma3,ifixgamma,isw7, &
            resrv3)
         gamma3=ggamma3+gamma
         IF(icnrv4 /= 430)CALL checklcfit(0,nrvphase,xrvmod,rv4,  &
            nrv4,xrv4,yrv4,errrv4,chisqrv4,ggamma4,ifixgamma,isw7, &
            resrv4)
         gamma4=ggamma4+gamma
      END IF
!
!   end if ifixgamma.lt.10
!
   END IF
!
!   if ifixgamma >= 10, then fit each RV curve set separately,
!   looping over sets
!
   IF(ifixgamma >= 10)THEN
!
!  only have RV1 and RV2, but not RV3 or RV4, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.((icnrv3 ==  &
            430).AND.(icnrv4 == 430)).AND.(ifixgamma == 12))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,  &
               rv2,nnrv1,xrv1,yrv1,errrv1,nnrv2,xrv2,yrv2,errrv2,  &
               chisqrv1,chisqrv2,ggamma1,resrv1,resrv2,ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma2arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv2arry(i)=chisqrv2
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
         END IF
      END DO
!
!   Have RV1, RV2, and RV3, but not RV4, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv3 /= 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv4 == 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            CALL checkrvfit3(nrvphase,xrvmod,rv1,rv2,rv3,nnrv1,xrv1,  &
               yrv1,errrv1,nnrv2,xrv2,yrv2,errrv2,nnrv3,xrv3,yrv3,  &
               errrv3,chisqrv1,chisqrv2,chisqrv3,ggamma1,resrv1,  &
               resrv2,resrv3,ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma2arry(i)=ggamma1+gamma
            gamma3arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv2arry(i)=chisqrv2
            chirv3arry(i)=chisqrv3
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
         END IF
      END DO
!
!   Have RV1, RV2, and RV4, but not RV3, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv4 /= 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv3 == 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit3(nrvphase,xrvmod,rv1,rv2,rv4,nnrv1,xrv1,  &
               yrv1,errrv1,nnrv2,xrv2,yrv2,errrv2,nnrv4,xrv4,yrv4,  &
               errrv4,chisqrv1,chisqrv2,chisqrv4,ggamma1,resrv1,  &
               resrv2,resrv4,ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma2arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv2arry(i)=chisqrv2
            chirv4arry(i)=chisqrv4
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   Have RV2, RV3, and RV4, but not RV1, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv2 /= 430).AND.(icnrv3 /= 430).AND.(icnrv4 /= 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv1 == 430))THEN
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit3(nrvphase,xrvmod,rv2,rv3,rv4,nnrv2,xrv2,  &
               yrv2,errrv2,nnrv3,xrv3,yrv3,errrv3,nnrv4,xrv4,yrv4,  &
               errrv4,chisqrv2,chisqrv3,chisqrv4,ggamma1,resrv2,  &
               resrv3,resrv4,ndatamax)
            gamma2arry(i)=ggamma1+gamma
            gamma3arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv2arry(i)=chisqrv2
            chirv3arry(i)=chisqrv3
            chirv4arry(i)=chisqrv4
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   Have RV1, RV2, RV3, and RV4, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv2 /= 430).AND.(icnrv4 /= 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv3 /= 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit4(nrvphase,xrvmod,rv1,rv2,rv3,rv4,nnrv1,  &
               xrv1,yrv1,errrv1,nnrv2,xrv2,yrv2,errrv2,nnrv3,xrv3,  &
               yrv3,errrv3,nnrv4,xrv4,yrv4,errrv4,chisqrv1,chisqrv2,  &
               chisqrv3,chisqrv4,ggamma1,resrv1,resrv2,resrv3,resrv4, &
               ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma2arry(i)=ggamma1+gamma
            gamma3arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv2arry(i)=chisqrv2
            chirv3arry(i)=chisqrv3
            chirv4arry(i)=chisqrv4
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   have RV1 and RV3, but not RV2 or RV4, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv3 /= 430).AND.(icnrv2 == 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv4 == 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,  &
               rv3,nnrv1,xrv1,yrv1,errrv1,nnrv3,xrv3,yrv3,errrv3,  &
               chisqrv1,chisqrv3,ggamma1,resrv1,resrv3,ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma3arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv3arry(i)=chisqrv3
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
         END IF
      END DO
!
!   have RV1 and RV4, but not RV2 or RV3, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv4 /= 430).AND.(icnrv2 == 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv3 == 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv1,nrvphase,xrvmod,  &
               rv4,nnrv1,xrv1,yrv1,errrv1,nnrv4,xrv4,yrv4,errrv4,  &
               chisqrv1,chisqrv4,ggamma1,resrv1,resrv4,ndatamax)
            gamma1arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            chirv4arry(i)=chisqrv4
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   have RV2 and RV3, but not RV1 or RV4, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv2 /= 430).AND.(icnrv3 /= 430).AND.(icnrv1 == 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv4 == 430))THEN
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv2,nrvphase,xrvmod,  &
               rv3,nnrv2,xrv2,yrv2,errrv2,nnrv3,xrv3,yrv3,errrv3,  &
               chisqrv2,chisqrv3,ggamma1,resrv2,resrv3,ndatamax)
            gamma2arry(i)=ggamma1+gamma
            gamma3arry(i)=ggamma1+gamma
            chirv2arry(i)=chisqrv2
            chirv3arry(i)=chisqrv3
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
         END IF
      END DO
!
!   have RV2 and RV4, but not RV1 or RV3, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv2 /= 430).AND.(icnrv4 /= 430).AND.(icnrv1 == 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv3 == 430))THEN
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv2,nrvphase,xrvmod,  &
               rv4,nnrv2,xrv2,yrv2,errrv2,nnrv4,xrv4,yrv4,errrv4,  &
               chisqrv2,chisqrv4,ggamma1,resrv2,resrv4,ndatamax)
            gamma2arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv2arry(i)=chisqrv2
            chirv4arry(i)=chisqrv4
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   have RV3 and RV4, but not RV1 or RV2, and ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv3 /= 430).AND.(icnrv4 /= 430).AND.(icnrv1 == 430)  &
            .AND.(ifixgamma == 12).AND.(icnrv2 == 430))THEN
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checkrvfit(nrvphase,xrvmod,rv3,nrvphase,xrvmod,  &
               rv4,nnrv3,xrv3,yrv3,errrv3,nnrv4,xrv4,yrv4,errrv4,  &
               chisqrv3,chisqrv4,ggamma1,resrv3,resrv4,ndatamax)
            gamma3arry(i)=ggamma1+gamma
            gamma4arry(i)=ggamma1+gamma
            chirv3arry(i)=chisqrv3
            chirv4arry(i)=chisqrv4
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
!   have RV1 only, ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv1 /= 430).AND.(icnrv2 == 430).AND.  &
            (icnrv3 == 430).AND.(icnrv4 == 430))THEN
            DO j=1,nrv1arry(i)
               xrv1(j)=xrv1arry(j,i)
               yrv1(j)=yrv1arry(j,i)
               errrv1(j)=errrv1arry(j,i)
            END DO
            nnrv1=nrv1arry(i)
            CALL checklcfit(0,nrvphase,xrvmod,rv1,nnrv1,xrv1,yrv1,  &
               errrv1,chisqrv1,ggamma1,1,isw7,resrv1)
            gamma1arry(i)=ggamma1+gamma
            chirv1arry(i)=chisqrv1
            DO j=1,nrv1arry(i)
               resrv1arry(j,i)=resrv1(j)
            END DO
         END IF
      END DO
!
!   have RV2 only, ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv2 /= 430).AND.(icnrv1 == 430).AND.  &
            (icnrv3 == 430).AND.(icnrv4 == 430))THEN
            DO j=1,nrv2arry(i)
               xrv2(j)=xrv2arry(j,i)
               yrv2(j)=yrv2arry(j,i)
               errrv2(j)=errrv2arry(j,i)
            END DO
            nnrv2=nrv2arry(i)
            CALL checklcfit(0,nrvphase,xrvmod,rv2,nnrv2,xrv2,yrv2,  &
               errrv2,chisqrv2,ggamma1,ifixgamma,isw7,resrv2)
            gamma2arry(i)=ggamma1+gamma
            chirv2arry(i)=chisqrv2
            DO j=1,nrv2arry(i)
               resrv2arry(j,i)=resrv2(j)
            END DO
         END IF
      END DO
!
!   have RV3 only, ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv3 /= 430).AND.(icnrv1 == 430).AND.  &
            (icnrv2 == 430).AND.(icnrv4 == 430))THEN
            DO j=1,nrv3arry(i)
               xrv3(j)=xrv3arry(j,i)
               yrv3(j)=yrv3arry(j,i)
               errrv3(j)=errrv3arry(j,i)
            END DO
            nnrv3=nrv3arry(i)
            CALL checklcfit(0,nrvphase,xrvmod,rv3,nnrv3,xrv3,yrv3,  &
               errrv3,chisqrv3,ggamma1,ifixgamma,isw7,resrv3)
            gamma3arry(i)=ggamma1+gamma
            chirv3arry(i)=chisqrv3
            DO j=1,nrv3arry(i)
               resrv3arry(j,i)=resrv3(j)
            END DO
         END IF
      END DO
!
!   have RV4 only, ifixgamma=12
!
      DO i=1,nset
         icnrv1=icnrv1arry(i)
         icnrv2=icnrv2arry(i)
         icnrv3=icnrv3arry(i)
         icnrv4=icnrv4arry(i)
         icnrv5=icnrv5arry(i)
         IF((icnrv4 /= 430).AND.(icnrv1 == 430).AND.  &
            (icnrv2 == 430).AND.(icnrv3 == 430))THEN
            DO j=1,nrv4arry(i)
               xrv4(j)=xrv4arry(j,i)
               yrv4(j)=yrv4arry(j,i)
               errrv4(j)=errrv4arry(j,i)
            END DO
            nnrv4=nrv4arry(i)
            CALL checklcfit(0,nrvphase,xrvmod,rv4,nnrv4,xrv4,yrv4,  &
               errrv4,chisqrv4,ggamma1,ifixgamma,isw7,resrv4)
            gamma4arry(i)=ggamma1+gamma
            chirv4arry(i)=chisqrv4
            DO j=1,nrv4arry(i)
               resrv4arry(j,i)=resrv4(j)
            END DO
         END IF
      END DO
!
      resRV5arry=0.0_dp
!
!   have RV5 only, ifixgamma=12
!
!            DO i=1,Nset
!              icnRV1=icnRV1arry(i)
!              icnRV2=icnRV2arry(i)
!              icnRV3=icnRV3arry(i)
!              icnRV4=icnRV4arry(i)
!              icnRV5=icnRV5arry(i)
!              IF(icnRV5.ne.430)THEN
!                DO j=1,NRV5arry(i)
!                  xRV5(j)=xRV5arry(j,i)
!                  yRV5(j)=yRV5arry(j,i)
!                  errRV5(j)=errRV5arry(j,i)
!                END DO
!                NNRV5=NRV5arry(i)
!                CALL checklcfit(0,NRVphase,xRVmod,RV5,NNRV5,xRV5,yRV5,
!     &             errRV5,chisqRV5,ggamma1,ifixgamma,isw7,resRV5)
!                gamma5arry(i)=ggamma1+gamma
!                DO j=1,NRV5arry(i)
!                  resRV5arry(j,i)=resRV5(j)
!                END DO
!              END IF
!            END DO
!
!   if ifixgamma < 12, then fit each RV curve separately
!
      IF(ifixgamma < 12)THEN
         DO i=1,nset
            icnrv1=icnrv1arry(i)
            icnrv2=icnrv2arry(i)
            icnrv3=icnrv3arry(i)
            icnrv4=icnrv4arry(i)
            icnrv5=icnrv5arry(i)
            IF(icnrv1 /= 430)THEN
               DO j=1,nrv1arry(i)
                  xrv1(j)=xrv1arry(j,i)
                  yrv1(j)=yrv1arry(j,i)
                  errrv1(j)=errrv1arry(j,i)
               END DO
               nnrv1=nrv1arry(i)
               CALL checklcfit(0,nrvphase,xrvmod,rv1,nnrv1,xrv1,yrv1,  &
                  errrv1,chisqrv1,ggamma1,ifixgamma,isw7,resrv1)
               gamma1arry(i)=ggamma1+gamma
               chirv1arry(i)=chisqrv1
               DO j=1,nrv1arry(i)
                  resrv1arry(j,i)=resrv1(j)
               END DO
            END IF
            IF(icnrv2 /= 430)THEN
               DO j=1,nrv2arry(i)
                  xrv2(j)=xrv2arry(j,i)
                  yrv2(j)=yrv2arry(j,i)
                  errrv2(j)=errrv2arry(j,i)
               END DO
               nnrv2=nrv2arry(i)
               CALL checklcfit(0,nrvphase,xrvmod,rv2,nnrv2,xrv2,yrv2,  &
                  errrv2,chisqrv2,ggamma2,ifixgamma,isw7,resrv2)
               gamma2arry(i)=ggamma2+gamma
               chirv2arry(i)=chisqrv2
               DO j=1,nrv2arry(i)
                  resrv2arry(j,i)=resrv2(j)
               END DO
            END IF
            IF(icnrv3 /= 430)THEN
               DO j=1,nrv3arry(i)
                  xrv3(j)=xrv3arry(j,i)
                  yrv3(j)=yrv3arry(j,i)
                  errrv3(j)=errrv3arry(j,i)
               END DO
               nnrv3=nrv3arry(i)
               CALL checklcfit(0,nrvphase,xrvmod,rv3,nnrv3,xrv3,yrv3,  &
                  errrv3,chisqrv3,ggamma3,ifixgamma,isw7,resrv3)
               gamma3arry(i)=ggamma3+gamma
               chirv3arry(i)=chisqrv3
               DO j=1,nrv3arry(i)
                  resrv3arry(j,i)=resrv3(j)
               END DO
            END IF
            IF(icnrv4 /= 430)THEN
               DO j=1,nrv4arry(i)
                  xrv4(j)=xrv4arry(j,i)
                  yrv4(j)=yrv4arry(j,i)
                  errrv4(j)=errrv4arry(j,i)
               END DO
               nnrv4=nrv4arry(i)
               CALL checklcfit(0,nrvphase,xrvmod,rv4,nnrv4,xrv4,yrv4,  &
                  errrv4,chisqrv4,ggamma4,ifixgamma,isw7,resrv4)
               gamma4arry(i)=ggamma4+gamma
               chirv4arry(i)=chisqrv4
               DO j=1,nrv4arry(i)
                  resrv4arry(j,i)=resrv4(j)
               END DO
            END IF
         END DO
      END IF
!
!   end if ifixgamma.ge.10
!
   END IF
!
   ochi=0.0_dp
   ochilr=0.0_dp
   ochilr3=0.0_dp
   ochilr4=0.0_dp
!
   IF(nobv > 0)CALL obschi(nobv,sobv,obv,eobv,obsparm,ochi)
!
   IF(ifrac > 10)CALL diskchi(nobv,sobv,obv,eobv,ochidisk,ochi,compfracs)
!
   IF(ilum == 99)CALL lrchi(nphase,nmaxphase,ymods1,ymods2,  &
      ymods3,nobv,sobv,obv,eobv,ochilr,ochi,ymods4,ochilr3,ochilr4)
!
   IF(ilum == 999)CALL lumratchi(nobv,sobv,obv,eobv,ochilumrat,ochi,compfracs)
!
!   add in the eclipse times chi^2
!
   chitimetot=0.0_dp
   chipenalty=0.0_dp
   chipenaltysec=0.0_dp
   IF((isw30 >= 3).AND.(isw23 == 1))THEN
      CALL timechi(icnarry,ncycle,ttimes,tseps,nobscycle,  &
         obsttimes,obsterr,chitimearry,chitimetot,nmeclpse,it3, &
         resttimes)
      IF(isw81 > 0)THEN
         CALL tranpenalty(tseps,penaltyarr,sw84,chipenalty,nmeclpse,ncycle)
      END IF
      IF(isw85 > 0)THEN
         CALL secpenalty(tseps,penaltyarr,sw84,chipenaltysec,nmeclpse,ncycle)
      END IF
   END IF
!
   chiout=0.0_dp
   CALL cygchi(Teff1,obsparm(2),chiout)
   WRITE(*,*)'CYG CHI ',Teff1,obsparm(2),chiout
!
   IF(ifixgamma < 10)THEN
      chi1=(chisqu+chisqb+chisqv+chisqr+chisqi+chisqj+chisqh+  &
         chisqk+chisqrv1+chisqrv2+ochi+chilimb+chitimetot+chisqrv3+  &
         chisqrv4+chipenalty+chipenaltysec)
   ELSE
      chi1=(chisqu+chisqb+chisqv+chisqr+chisqi+chisqj+chisqh+  &
         chisqk+ochi+chilimb+chitimetot+chipenalty+chipenaltysec)
      DO i=1,nset
         chi1=chi1+chirv1arry(i)+chirv2arry(i)+chirv3arry(i)+  &
            chirv4arry(i)!+chiRVarry5(i)
      END DO
   END IF
!
   chi1=chi1+chiout
   isvel3=0
   IF(icnrv3 /= 430)isvel3=1
   isvel4=0
   IF(icnrv4 /= 430)isvel4=1
!
   IF(isw22 == 0)CALL writevar(nvmax,svar,fill1,fill2,  &
      omega1,omega2,q,finc,teff1,teff2,betarim,rinner,router,tdisk,  &
      xi,rlx,separ,isvel1,gamma1,isvel2,gamma2,t3,g3,sa3,ecc,  &
      argper,pshift,spot1parm,spot2parm,spotdparm,period,t0,alb1,  &
      alb2,dwavex,dwavey,primmass,primk,primrad,ratrad,frac1,frac2,  &
      ecosw,temprat,bigi,bigbeta,density,tconj,beam1,  &
      beam2,contam,ocose,osine,isw29,tertperiod,tertt0,tertecos,  &
      tertesin,tertincl,tertomega,tertq,tgrav1,tgrav2,tertconj,  &
      omegadot,contams0,contams1,contams2,contams3,p2tconj,  &
      p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,p2ratrad,  &
      p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,p3q,  &
      p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,p4omega,  &
      p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,p5incl,  &
      p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,p6esin,  &
      p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,p7ecos,  &
      p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,p8t0,  &
      p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad,gamma3,isvel3,sw72,  &
      sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,sdarkint3,sdarkint4,  &
      sdarkint5,gamma4,isvel4,tertratrad,p1mtc,p1ptc,p2mtc,p2ptc,  &
      p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,p7ptc,  &
      p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,bigbeta3,  &
      bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
      b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
      omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
      raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
      sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
      t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,  &
      sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
      sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
      sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
      angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
      angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
      angsum8,angdiff8,isw86,fillsum,filldiff,binqtc,p1qtc,p2qtc,  &
      p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,  &
      t3off,t4off,t5off,t6off,t7off,t8off,ifixgamma,  &
      gamma1arry,gamma2arry,gamma3arry,gamma4arry,gamma5arry,  &
      icnrv1arry,icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry,isw26, &
      tesscontam)
!
   IF(isw22 == 0)THEN
      IF(sw6 >= 1.0_dp)THEN
         CALL printamoebamed(ichilabel,chi1)
      ELSE
         CALL printamoebachi(ichilabel,chi1)
      END IF
   END IF
!
   IF(isw22 == 0)THEN
      CALL writechi(icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk,  &
         icnrv1,icnrv2,chisqu,chisqb,chisqv,chisqr,chisqi,chisqj,  &
         chisqh,chisqk,chisqrv1,chisqrv2,icnrv3,chisqrv3,icnrv4,  &
         chisqrv4,ifixgamma,chirv1arry,chirv2arry,  &
         chirv3arry,chirv4arry,chirv5arry,icnrv1arry,  &
         icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry)
      IF(nobv > 0)CALL wobschi(nobv,sobv,obv,eobv,obsparm,ochi)
      IF(ifrac > 10)CALL wdiskobschi(ochidisk,nobv,sobv)
      IF(ilum == 999)CALL wlumratobschi(ochilumrat,nobv,sobv)
      IF(ilum == 99)CALL wlrobschi(ochilr,ochilr3,ochilr4,sobv)
      IF((isw30 >= 3).AND.(isw23 == 1))THEN
         CALL writetimechi(icnarry,chitimearry)
         IF(isw81 > 0)CALL writepenaltychi(penaltyarr)
         IF(isw85 > 0)CALL writesecpenaltychi(penaltyarr)
      END IF
   END IF
!
   IF(ibest == 0)THEN
      IF((ABS(thresh) <= EPSILON(thresh)).OR.(chi1 < small+thresh))THEN
         CALL chiline(i16,chi1,ochidisk,icnu,icnb,icnv,icnr,icni,  &
            icnj,icnh,icnk,icnrv1,icnrv2,chisqu,chisqb,chisqv,chisqr,  &
            chisqi,chisqj,chisqh,chisqk,chisqrv1,chisqrv2,nobv,sobv,  &
            obv,eobv,obsparm,ochilr,icnarry,chitimearry,icnrv3,  &
            icnrv4,chisqrv3,chisqrv4,ochilr3,ochilr4,ifixgamma,  &
            chirv1arry,chirv2arry,chirv3arry,chirv4arry,  &
            chirv5arry,icnrv1arry,icnrv2arry,icnrv3arry,  &
            icnrv4arry,icnrv5arry,ochilumrat,irecord)
      END IF
   END IF
!
   IF((irecord > 0).AND.(ibest > 0))THEN
      CALL chiline(i16,chi1,ochidisk,icnu,icnb,icnv,icnr,icni,  &
         icnj,icnh,icnk,icnrv1,icnrv2,chisqu,chisqb,chisqv,chisqr,  &
         chisqi,chisqj,chisqh,chisqk,chisqrv1,chisqrv2,nobv,sobv,  &
         obv,eobv,obsparm,ochilr,icnarry,chitimearry,icnrv3,  &
         icnrv4,chisqrv3,chisqrv4,ochilr3,ochilr4,ifixgamma,  &
         chirv1arry,chirv2arry,chirv3arry,chirv4arry,  &
         chirv5arry,icnrv1arry,icnrv2arry,icnrv3arry,  &
         icnrv4arry,icnrv5arry,ochilumrat,irecord)
   END IF
!
   CALL newwritevar(nvmax,svar,fill1,fill2,omega1,omega2,q,  &
      finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,separ,  &
      isvel1,gamma1,isvel2,gamma2,t3,g3,sa3,ecc,argper,pshift,  &
      spot1parm,spot2parm,spotdparm,period,t0,chi1,i16,line,alb1,  &
      alb2,dwavex,dwavey,primmass,primk,primrad,ratrad,frac1,frac2,  &
      ecosw,temprat,bigi,bigbeta,density,sw5,tconj,  &
      beam1,beam2,contam,ocose,osine,isw29,tertperiod,tertt0,  &
      tertecos,tertesin,tertincl,tertomega,tertq,tgrav1,tgrav2,  &
      tertconj,omegadot,contams0,contams1,contams2,contams3,  &
      p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,  &
      p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,  &
      p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,  &
      p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,  &
      p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,  &
      p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,  &
      p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,  &
      p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad,gamma3,isvel3,  &
      sw72,sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,sdarkint3,  &
      sdarkint4,sdarkint5,isvel4,gamma4,tertratrad,p1mtc,p1ptc,  &
      p2mtc,p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,  &
      p7mtc,p7ptc,p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,  &
      bigbeta2,bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,  &
      b2raddiff,b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,  &
      masssum,omega3,omega4,omega5,omega6,omega7,omega8,omega9,  &
      omega10,raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,  &
      sdarkint6,sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,  &
      secrad,t10,t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,  &
      bin2r4,sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
      sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
      sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
      angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
      angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
      angsum8,angdiff8,fillsum,filldiff,binqtc,p1qtc,p2qtc,p3qtc,  &
      p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
      t4off,t5off,t6off,t7off,t8off,ifixgamma,gamma1arry,  &
      gamma2arry,gamma3arry,gamma4arry,gamma5arry,icnrv1arry,  &
      icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry,isw30,orbitparm, &
      tesscontam)
!
!$omp critical
   IF(ibest == 0)THEN
      cccc=chi1
      IF(cccc > 999999999999.0_dp)cccc=999999999999.9_dp
      IF((ABS(thresh) <= EPSILON(thresh)).OR.(chi1 < small+thresh))THEN
         WRITE(46,10)i16,cccc,TRIM(newparmstr)
         IF((isw30 >= 3).AND.(it4 == 0))WRITE(49,20)i16,cccc,TRIM(dynparm)
         WRITE(45,30)TRIM(line)
         IF(isw24 >= 1)WRITE(47,40)i16,cccc,(compfracs(ijk,1),ijk=  &
            1,8),(compfracs(ijk,2),ijk=1,8),(compfracs(ijk,3),ijk=1, 8)
      END IF
   END IF
!$omp end critical
!
10 FORMAT(i7,1X,f18.5,1X,a)
20 FORMAT(i7,1X,f18.5,1X,a)
30 FORMAT(a)
40 FORMAT(i5,1X,f18.4,1X,24(1PE13.6,1X))
!
   RETURN
!
END SUBROUTINE monster
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE mutate(n,nd,pmut,ign)
!
   USE accur
   USE medblock
   USE ran_lec
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   INTEGER, INTENT(IN)                      :: nd
   REAL(KINd=dp), INTENT(IN)                :: pmut
   INTEGER, INTENT(OUT)                     :: ign(n*nd)
!
   REAL(KIND=dp)  :: urand
!
   INTEGER :: i
!
!   COMMON /ranblock/ idum
!
!!pgi$r opt O1
!
   DO  i=1,n*nd
      urand=ran6(idum)
      IF(urand < pmut)THEN
         urand=ran6(idum)
         ign(i)=INT(urand*10.0_dp)
      END IF
   END DO
   RETURN
!
END SUBROUTINE mutate
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE newinsgridinput(kkkk,nalph1,nalph2,nalph3,nbet1,  &
   nbet2,nbet3,nradius,nref,nseg,ntheta,irvfilt,iatm,icnb,icnh,  &
   icni,icnj,icnk,icnr,icnu,icnv,idark1,idark2,idraw,iecheck,  &
   iidint,ikeep,ilaw,ism1,isw1,isw13,isw2,isw21,isw22,isw23,  &
   isw24,isw25,isw26,isw27,isw28,isw29,isw3,isw30,isw31,isw32,  &
   isw33,isw34,isw4,isw5,isw6,isw7,isw8,isw80,isw81,isw85,isw86,  &
   isw87,isw88,isw89,isw9,isw100,isynch,it1,it2,it3,it4,itconj,  &
   p1mtc,p1ptc,p2omega,p2q,p2t0,p2ecos,p2esin,p2incl,p2mtc,  &
   p2ptc,p2period,p2ratrad,p2tconj,p3omega,p3q,p3t0,p3ecos,  &
   p3esin,p3incl,p3mtc,p3ptc,p3period,p3ratrad,p3tconj,p4omega,  &
   p4q,p4t0,p4ecos,p4esin,p4incl,p4mtc,p4ptc,p4period,p4ratrad,  &
   p4tconj,p5omega,p5q,p5t0,p5ecos,p5esin,p5incl,p5mtc,p5ptc,  &
   p5period,p5ratrad,p5tconj,p6omega,p6q,p6t0,p6ecos,p6esin,  &
   p6incl,p6mtc,p6ptc,p6period,p6ratrad,p6tconj,p7omega,p7q,  &
   p7t0,p7ecos,p7esin,p7incl,p7mtc,p7ptc,p7period,p7ratrad,  &
   p7tconj,p8omega,p8q,p8t0,p8ecos,p8esin,p8incl,p8mtc,p8ptc,  &
   p8period,p8ratrad,p8tconj,pbmtc,pbptc,period,q,sa3,t0,tconj,  &
   teff1,teff2,tgrav1,tgrav2,alb1,alb2,argper,beam1,beam2,  &
   betarim,bigi,bigi2,bigi3,bigi4,bigbeta,bigbeta2,bigbeta3,  &
   bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
   b2radsum,bin2ratrad,contam,contams0,contams1,contams2,  &
   contams3,dbolx,dboly,dphase,dwavex,dwavey,ecc,ecosw,fill1,  &
   fill2,finc,frac1,frac2,g10,g3,g6,g7,g8,g9,gamma,hh,massdiff,  &
   masssum,ocose,omega1,omega2,omega3,omega4,omega5,omega6,  &
   omega7,omega8,omega9,omega10,osine,primk,primmass,primrad,  &
   pshift,rlx,raddiff,radsum,ratrad,rinner,rk3,rk4,rk5,rk6,rk7,  &
   rk8,rk9,rk10,router,sdarkint1,sdarkint2,sdarkint3,sdarkint4,  &
   sdarkint5,sdarkint6,sdarkint7,sdarkint8,sdarkint9,sdarkint10,  &
   secmass,secrad,separ,spot1parm,spot2parm,spotdparm,sw1,sw2,  &
   sw23,sw24,sw25,sw26,sw27,sw28,sw29,sw3,sw30,sw47,sw48,sw49,  &
   sw5,sw6,sw7,sw72,sw73,sw8,sw80,sw81,sw82,sw83,sw84,sw9,t10,  &
   t3,t6,t7,t8,t9,tdisk,temprat,tertomega,tertq,tertconj,  &
   tertecos,tertesin,tertincl,tertperiod,tertratrad,tertt0,wave,  &
   xi,iunit,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,sqecos,  &
   sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,sqp3ecos,  &
   sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,sqp6ecos,  &
   sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,angsum1,  &
   angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,angdiff4,  &
   angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,angsum8,  &
   angdiff8,imag,fillsum,filldiff,binqtc,p1qtc,p2qtc,p3qtc,  &
   p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
   t4off,t5off,t6off,t7off,t8off)
!
!   This routine used by demcmcELC and geneticELC.
!   If the file ELC.insert exists, read it in and distroy it.
!   Set kkkk=99 on exit.  If the file does not exist,
!   set kkkk=0 and exit.
!
!   Reads version 6 input files.  If the first line is not
!   #1, then the subroutine will return.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(OUT)                     :: kkkk
   INTEGER, INTENT(OUT)                     :: nalph1
   INTEGER, INTENT(OUT)                     :: nalph2
   INTEGER, INTENT(OUT)                     :: nalph3
   INTEGER, INTENT(OUT)                     :: nbet1
   INTEGER, INTENT(OUT)                     :: nbet2
   INTEGER, INTENT(OUT)                     :: nbet3
   INTEGER, INTENT(OUT)                     :: nradius
   INTEGER, INTENT(OUT)                     :: nref
   INTEGER, INTENT(OUT)                     :: nseg
   INTEGER, INTENT(OUT)                     :: ntheta
   INTEGER, INTENT(OUT)                     :: irvfilt
   INTEGER, INTENT(OUT)                     :: iatm
   INTEGER, INTENT(OUT)                     :: icnb
   INTEGER, INTENT(OUT)                     :: icnh
   INTEGER, INTENT(OUT)                     :: icni
   INTEGER, INTENT(OUT)                     :: icnj
   INTEGER, INTENT(OUT)                     :: icnk
   INTEGER, INTENT(OUT)                     :: icnr
   INTEGER, INTENT(OUT)                     :: icnu
   INTEGER, INTENT(OUT)                     :: icnv
   INTEGER, INTENT(OUT)                     :: idark1
   INTEGER, INTENT(OUT)                     :: idark2
   INTEGER, INTENT(OUT)                     :: idraw
   INTEGER, INTENT(OUT)                     :: iecheck
   INTEGER, INTENT(OUT)                     :: iidint
   INTEGER, INTENT(OUT)                     :: ikeep
   INTEGER, INTENT(OUT)                     :: ilaw
   INTEGER, INTENT(OUT)                     :: ism1
   INTEGER, INTENT(OUT)                     :: isw1
   INTEGER, INTENT(OUT)                     :: isw13
   INTEGER, INTENT(OUT)                     :: isw2
   INTEGER, INTENT(OUT)                     :: isw21
   INTEGER, INTENT(OUT)                     :: isw22
   INTEGER, INTENT(OUT)                     :: isw23
   INTEGER, INTENT(OUT)                     :: isw24
   INTEGER, INTENT(OUT)                     :: isw25
   INTEGER, INTENT(OUT)                     :: isw26
   INTEGER, INTENT(OUT)                     :: isw27
   INTEGER, INTENT(OUT)                     :: isw28
   INTEGER, INTENT(OUT)                     :: isw29
   INTEGER, INTENT(OUT)                     :: isw3
   INTEGER, INTENT(OUT)                     :: isw30
   INTEGER, INTENT(OUT)                     :: isw31
   INTEGER, INTENT(OUT)                     :: isw32
   INTEGER, INTENT(OUT)                     :: isw33
   INTEGER, INTENT(OUT)                     :: isw34
   INTEGER, INTENT(OUT)                     :: isw4
   INTEGER, INTENT(OUT)                     :: isw5
   INTEGER, INTENT(OUT)                     :: isw6
   INTEGER, INTENT(OUT)                     :: isw7
   INTEGER, INTENT(OUT)                     :: isw8
   INTEGER, INTENT(OUT)                     :: isw80
   INTEGER, INTENT(OUT)                     :: isw81
   INTEGER, INTENT(OUT)                     :: isw85
   INTEGER, INTENT(OUT)                     :: isw86
   INTEGER, INTENT(OUT)                     :: isw87
   INTEGER, INTENT(OUT)                     :: isw88
   INTEGER, INTENT(OUT)                     :: isw89
   INTEGER, INTENT(OUT)                     :: isw9
   INTEGER, INTENT(OUT)                     :: isw100
   INTEGER, INTENT(OUT)                     :: isynch
   INTEGER, INTENT(OUT)                     :: it1
   INTEGER, INTENT(OUT)                     :: it2
   INTEGER, INTENT(OUT)                     :: it3
   INTEGER, INTENT(OUT)                     :: it4
   INTEGER, INTENT(OUT)                     :: itconj
   REAL(KIND=dp), INTENT(OUT)               :: p1mtc
   REAL(KIND=dp), INTENT(OUT)               :: p1ptc
   REAL(KIND=dp), INTENT(OUT)               :: p2omega
   REAL(KIND=dp), INTENT(OUT)               :: p2q
   REAL(KIND=dp), INTENT(OUT)               :: p2t0
   REAL(KIND=dp), INTENT(OUT)               :: p2ecos
   REAL(KIND=dp), INTENT(OUT)               :: p2esin
   REAL(KIND=dp), INTENT(OUT)               :: p2incl
   REAL(KIND=dp), INTENT(OUT)               :: p2mtc
   REAL(KIND=dp), INTENT(OUT)               :: p2ptc
   REAL(KIND=dp), INTENT(OUT)               :: p2period
   REAL(KIND=dp), INTENT(OUT)               :: p2ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p2tconj
   REAL(KIND=dp), INTENT(OUT)               :: p3omega
   REAL(KIND=dp), INTENT(OUT)               :: p3q
   REAL(KIND=dp), INTENT(OUT)               :: p3t0
   REAL(KIND=dp), INTENT(OUT)               :: p3ecos
   REAL(KIND=dp), INTENT(OUT)               :: p3esin
   REAL(KIND=dp), INTENT(OUT)               :: p3incl
   REAL(KIND=dp), INTENT(OUT)               :: p3mtc
   REAL(KIND=dp), INTENT(OUT)               :: p3ptc
   REAL(KIND=dp), INTENT(OUT)               :: p3period
   REAL(KIND=dp), INTENT(OUT)               :: p3ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p3tconj
   REAL(KIND=dp), INTENT(OUT)               :: p4omega
   REAL(KIND=dp), INTENT(OUT)               :: p4q
   REAL(KIND=dp), INTENT(OUT)               :: p4t0
   REAL(KIND=dp), INTENT(OUT)               :: p4ecos
   REAL(KIND=dp), INTENT(OUT)               :: p4esin
   REAL(KIND=dp), INTENT(OUT)               :: p4incl
   REAL(KIND=dp), INTENT(OUT)               :: p4mtc
   REAL(KIND=dp), INTENT(OUT)               :: p4ptc
   REAL(KIND=dp), INTENT(OUT)               :: p4period
   REAL(KIND=dp), INTENT(OUT)               :: p4ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p4tconj
   REAL(KIND=dp), INTENT(OUT)               :: p5omega
   REAL(KIND=dp), INTENT(OUT)               :: p5q
   REAL(KIND=dp), INTENT(OUT)               :: p5t0
   REAL(KIND=dp), INTENT(OUT)               :: p5ecos
   REAL(KIND=dp), INTENT(OUT)               :: p5esin
   REAL(KIND=dp), INTENT(OUT)               :: p5incl
   REAL(KIND=dp), INTENT(OUT)               :: p5mtc
   REAL(KIND=dp), INTENT(OUT)               :: p5ptc
   REAL(KIND=dp), INTENT(OUT)               :: p5period
   REAL(KIND=dp), INTENT(OUT)               :: p5ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p5tconj
   REAL(KIND=dp), INTENT(OUT)               :: p6omega
   REAL(KIND=dp), INTENT(OUT)               :: p6q
   REAL(KIND=dp), INTENT(OUT)               :: p6t0
   REAL(KIND=dp), INTENT(OUT)               :: p6ecos
   REAL(KIND=dp), INTENT(OUT)               :: p6esin
   REAL(KIND=dp), INTENT(OUT)               :: p6incl
   REAL(KIND=dp), INTENT(OUT)               :: p6mtc
   REAL(KIND=dp), INTENT(OUT)               :: p6ptc
   REAL(KIND=dp), INTENT(OUT)               :: p6period
   REAL(KIND=dp), INTENT(OUT)               :: p6ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p6tconj
   REAL(KIND=dp), INTENT(OUT)               :: p7omega
   REAL(KIND=dp), INTENT(OUT)               :: p7q
   REAL(KIND=dp), INTENT(OUT)               :: p7t0
   REAL(KIND=dp), INTENT(OUT)               :: p7ecos
   REAL(KIND=dp), INTENT(OUT)               :: p7esin
   REAL(KIND=dp), INTENT(OUT)               :: p7incl
   REAL(KIND=dp), INTENT(OUT)               :: p7mtc
   REAL(KIND=dp), INTENT(OUT)               :: p7ptc
   REAL(KIND=dp), INTENT(OUT)               :: p7period
   REAL(KIND=dp), INTENT(OUT)               :: p7ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p7tconj
   REAL(KIND=dp), INTENT(OUT)               :: p8omega
   REAL(KIND=dp), INTENT(OUT)               :: p8q
   REAL(KIND=dp), INTENT(OUT)               :: p8t0
   REAL(KIND=dp), INTENT(OUT)               :: p8ecos
   REAL(KIND=dp), INTENT(OUT)               :: p8esin
   REAL(KIND=dp), INTENT(OUT)               :: p8incl
   REAL(KIND=dp), INTENT(OUT)               :: p8mtc
   REAL(KIND=dp), INTENT(OUT)               :: p8ptc
   REAL(KIND=dp), INTENT(OUT)               :: p8period
   REAL(KIND=dp), INTENT(OUT)               :: p8ratrad
   REAL(KIND=dp), INTENT(OUT)               :: p8tconj
   REAL(KIND=dp), INTENT(OUT)               :: pbmtc
   REAL(KIND=dp), INTENT(OUT)               :: pbptc
   REAL(KIND=dp), INTENT(OUT)               :: period
   REAL(KIND=dp), INTENT(OUT)               :: q
   REAL(KIND=dp), INTENT(OUT)               :: sa3
   REAL(KIND=dp), INTENT(OUT)               :: t0
   REAL(KIND=dp), INTENT(OUT)               :: tconj
   REAL(KIND=dp), INTENT(OUT)               :: teff1
   REAL(KIND=dp), INTENT(OUT)               :: teff2
   REAL(KIND=dp), INTENT(OUT)               :: tgrav1
   REAL(KIND=dp), INTENT(OUT)               :: tgrav2
   REAL(KIND=dp), INTENT(OUT)               :: alb1
   REAL(KIND=dp), INTENT(OUT)               :: alb2
   REAL(KIND=dp), INTENT(OUT)               :: argper
   REAL(KIND=dp), INTENT(OUT)               :: beam1
   REAL(KIND=dp), INTENT(OUT)               :: beam2
   REAL(KIND=dp), INTENT(OUT)               :: betarim
   REAL(KIND=dp), INTENT(OUT)               :: bigi
   REAL(KIND=dp), INTENT(OUT)               :: bigi2
   REAL(KIND=dp), INTENT(OUT)               :: bigi3
   REAL(KIND=dp), INTENT(OUT)               :: bigi4
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta2
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta3
   REAL(KIND=dp), INTENT(OUT)               :: bigbeta4
   REAL(KIND=dp), INTENT(OUT)               :: bin2q
   REAL(KIND=dp), INTENT(OUT)               :: b2massdiff
   REAL(KIND=dp), INTENT(OUT)               :: b2masssum
   REAL(KIND=dp), INTENT(OUT)               :: b2raddiff
   REAL(KIND=dp), INTENT(OUT)               :: b2radsum
   REAL(KIND=dp), INTENT(OUT)               :: bin2ratrad
   REAL(KIND=dp), INTENT(OUT)               :: contam
   REAL(KIND=dp), INTENT(OUT)               :: contams0
   REAL(KIND=dp), INTENT(OUT)               :: contams1
   REAL(KIND=dp), INTENT(OUT)               :: contams2
   REAL(KIND=dp), INTENT(OUT)               :: contams3
   REAL(KIND=dp), INTENT(OUT)               :: dbolx(8,2)
   REAL(KIND=dp), INTENT(OUT)               :: dboly(8,2)
   REAL(KIND=dp), INTENT(OUT)               :: dphase
   REAL(KIND=dp), INTENT(OUT)               :: dwavex(8,10)
   REAL(KIND=dp), INTENT(OUT)               :: dwavey(8,10)
   REAL(KIND=dp), INTENT(OUT)               :: ecc
   REAL(KIND=dp), INTENT(OUT)               :: ecosw
   REAL(KIND=dp), INTENT(OUT)               :: fill1
   REAL(KIND=dp), INTENT(OUT)               :: fill2
   REAL(KIND=dp), INTENT(OUT)               :: finc
   REAL(KIND=dp), INTENT(OUT)               :: frac1
   REAL(KIND=dp), INTENT(OUT)               :: frac2
   REAL(KIND=dp), INTENT(OUT)               :: g10
   REAL(KIND=dp), INTENT(OUT)               :: g3
   REAL(KIND=dp), INTENT(OUT)               :: g6
   REAL(KIND=dp), INTENT(OUT)               :: g7
   REAL(KIND=dp), INTENT(OUT)               :: g8
   REAL(KIND=dp), INTENT(OUT)               :: g9
   REAL(KIND=dp), INTENT(OUT)               :: gamma
   REAL(KIND=dp), INTENT(OUT)               :: hh
   REAL(KIND=dp), INTENT(OUT)               :: massdiff
   REAL(KIND=dp), INTENT(OUT)               :: masssum
   REAL(KIND=dp), INTENT(OUT)               :: ocose
   REAL(KIND=dp), INTENT(OUT)               :: omega1
   REAL(KIND=dp), INTENT(OUT)               :: omega2
   REAL(KIND=dp), INTENT(OUT)               :: omega3
   REAL(KIND=dp), INTENT(OUT)               :: omega4
   REAL(KIND=dp), INTENT(OUT)               :: omega5
   REAL(KIND=dp), INTENT(OUT)               :: omega6
   REAL(KIND=dp), INTENT(OUT)               :: omega7
   REAL(KIND=dp), INTENT(OUT)               :: omega8
   REAL(KIND=dp), INTENT(OUT)               :: omega9
   REAL(KIND=dp), INTENT(OUT)               :: omega10
   REAL(KIND=dp), INTENT(OUT)               :: osine
   REAL(KIND=dp), INTENT(OUT)               :: primk
   REAL(KIND=dp), INTENT(OUT)               :: primmass
   REAL(KIND=dp), INTENT(OUT)               :: primrad
   REAL(KIND=dp), INTENT(OUT)               :: pshift
   REAL(KIND=dp), INTENT(OUT)               :: rlx
   REAL(KIND=dp), INTENT(OUT)               :: raddiff
   REAL(KIND=dp), INTENT(OUT)               :: radsum
   REAL(KIND=dp), INTENT(OUT)               :: ratrad
   REAL(KIND=dp), INTENT(OUT)               :: rinner
   REAL(KIND=dp), INTENT(OUT)               :: rk3
   REAL(KIND=dp), INTENT(OUT)               :: rk4
   REAL(KIND=dp), INTENT(OUT)               :: rk5
   REAL(KIND=dp), INTENT(OUT)               :: rk6
   REAL(KIND=dp), INTENT(OUT)               :: rk7
   REAL(KIND=dp), INTENT(OUT)               :: rk8
   REAL(KIND=dp), INTENT(OUT)               :: rk9
   REAL(KIND=dp), INTENT(OUT)               :: rk10
   REAL(KIND=dp), INTENT(OUT)               :: router
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint1(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint2(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint3(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint4(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint5(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint6(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint7(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint8(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint9(8)
   REAL(KIND=dp), INTENT(OUT)               :: sdarkint10(8)
   REAL(KIND=dp), INTENT(OUT)               :: secmass
   REAL(KIND=dp), INTENT(OUT)               :: secrad
   REAL(KIND=dp), INTENT(OUT)               :: separ
   REAL(KIND=dp), INTENT(OUT)               :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(OUT)               :: sw1
   REAL(KIND=dp), INTENT(OUT)               :: sw2
   REAL(KIND=dp), INTENT(OUT)               :: sw23
   REAL(KIND=dp), INTENT(OUT)               :: sw24
   REAL(KIND=dp), INTENT(OUT)               :: sw25
   REAL(KIND=dp), INTENT(OUT)               :: sw26
   REAL(KIND=dp), INTENT(OUT)               :: sw27
   REAL(KIND=dp), INTENT(OUT)               :: sw28
   REAL(KIND=dp), INTENT(OUT)               :: sw29
   REAL(KIND=dp), INTENT(OUT)               :: sw3
   REAL(KIND=dp), INTENT(OUT)               :: sw30
   REAL(KIND=dp), INTENT(OUT)               :: sw47
   REAL(KIND=dp), INTENT(OUT)               :: sw48
   REAL(KIND=dp), INTENT(OUT)               :: sw49
   REAL(KIND=dp), INTENT(OUT)               :: sw5
   REAL(KIND=dp), INTENT(OUT)               :: sw6
   REAL(KIND=dp), INTENT(OUT)               :: sw7
   REAL(KIND=dp), INTENT(OUT)               :: sw72
   REAL(KIND=dp), INTENT(OUT)               :: sw73
   REAL(KIND=dp), INTENT(OUT)               :: sw8
   REAL(KIND=dp), INTENT(OUT)               :: sw80
   REAL(KIND=dp), INTENT(OUT)               :: sw81
   REAL(KIND=dp), INTENT(OUT)               :: sw82
   REAL(KIND=dp), INTENT(OUT)               :: sw83
   REAL(KIND=dp), INTENT(OUT)               :: sw84
   REAL(KIND=dp), INTENT(OUT)               :: sw9
   REAL(KIND=dp), INTENT(OUT)               :: t10
   REAL(KIND=dp), INTENT(OUT)               :: t3
   REAL(KIND=dp), INTENT(OUT)               :: t6
   REAL(KIND=dp), INTENT(OUT)               :: t7
   REAL(KIND=dp), INTENT(OUT)               :: t8
   REAL(KIND=dp), INTENT(OUT)               :: t9
   REAL(KIND=dp), INTENT(OUT)               :: tdisk
   REAL(KIND=dp), INTENT(OUT)               :: temprat
   REAL(KIND=dp), INTENT(OUT)               :: tertomega
   REAL(KIND=dp), INTENT(OUT)               :: tertq
   REAL(KIND=dp), INTENT(OUT)               :: tertconj
   REAL(KIND=dp), INTENT(OUT)               :: tertecos
   REAL(KIND=dp), INTENT(OUT)               :: tertesin
   REAL(KIND=dp), INTENT(OUT)               :: tertincl
   REAL(KIND=dp), INTENT(OUT)               :: tertperiod
   REAL(KIND=dp), INTENT(OUT)               :: tertratrad
   REAL(KIND=dp), INTENT(OUT)               :: tertt0
   REAL(KIND=dp), INTENT(OUT)               :: wave(8)
   REAL(KIND=dp), INTENT(OUT)               :: xi
   INTEGER, INTENT(OUT)                     :: iunit
   REAL(KIND=dp), INTENT(OUT)               :: fracsum
   REAL(KIND=dp), INTENT(OUT)               :: fracdiff
   REAL(KIND=dp), INTENT(OUT)               :: bin2m3
   REAL(KIND=dp), INTENT(OUT)               :: bin2m4
   REAL(KIND=dp), INTENT(OUT)               :: bin2r3
   REAL(KIND=dp), INTENT(OUT)               :: bin2r4
   REAL(KIND=dp), INTENT(OUT)               :: sqecos
   REAL(KIND=dp), INTENT(OUT)               :: sqesin
   REAL(KIND=dp), INTENT(OUT)               :: sqtertecos
   REAL(KIND=dp), INTENT(OUT)               :: sqtertesin
   REAL(KIND=dp), INTENT(OUT)               :: sqp2ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp2esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp3ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp3esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp4ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp4esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp5ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp5esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp6ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp6esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp7ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp7esin
   REAL(KIND=dp), INTENT(OUT)               :: sqp8ecos
   REAL(KIND=dp), INTENT(OUT)               :: sqp8esin
   REAL(KIND=dp), INTENT(OUT)               :: angsum1
   REAL(KIND=dp), INTENT(OUT)               :: angdiff1
   REAL(KIND=dp), INTENT(OUT)               :: angsum2
   REAL(KIND=dp), INTENT(OUT)               :: angdiff2
   REAL(KIND=dp), INTENT(OUT)               :: angsum3
   REAL(KIND=dp), INTENT(OUT)               :: angdiff3
   REAL(KIND=dp), INTENT(OUT)               :: angsum4
   REAL(KIND=dp), INTENT(OUT)               :: angdiff4
   REAL(KIND=dp), INTENT(OUT)               :: angsum5
   REAL(KIND=dp), INTENT(OUT)               :: angdiff5
   REAL(KIND=dp), INTENT(OUT)               :: angsum6
   REAL(KIND=dp), INTENT(OUT)               :: angdiff6
   REAL(KIND=dp), INTENT(OUT)               :: angsum7
   REAL(KIND=dp), INTENT(OUT)               :: angdiff7
   REAL(KIND=dp), INTENT(OUT)               :: angsum8
   REAL(KIND=dp), INTENT(OUT)               :: angdiff8
   INTEGER, INTENT(OUT)                     :: imag
   REAL(KIND=dp), INTENT(OUT)               :: fillsum
   REAL(KIND=dp), INTENT(OUT)               :: filldiff
   REAL(KIND=dp), INTENT(OUT)               :: binqtc
   REAL(KIND=dp), INTENT(OUT)               :: p1qtc
   REAL(KIND=dp), INTENT(OUT)               :: p2qtc
   REAL(KIND=dp), INTENT(OUT)               :: p3qtc
   REAL(KIND=dp), INTENT(OUT)               :: p4qtc
   REAL(KIND=dp), INTENT(OUT)               :: p5qtc
   REAL(KIND=dp), INTENT(OUT)               :: p6qtc
   REAL(KIND=dp), INTENT(OUT)               :: p7qtc
   REAL(KIND=dp), INTENT(OUT)               :: p8qtc
   REAL(KIND=dp), INTENT(OUT)               :: tbinoff
   REAL(KIND=dp), INTENT(OUT)               :: t1off
   REAL(KIND=dp), INTENT(OUT)               :: t2off
   REAL(KIND=dp), INTENT(OUT)               :: t3off
   REAL(KIND=dp), INTENT(OUT)               :: t4off
   REAL(KIND=dp), INTENT(OUT)               :: t5off
   REAL(KIND=dp), INTENT(OUT)               :: t6off
   REAL(KIND=dp), INTENT(OUT)               :: t7off
   REAL(KIND=dp), INTENT(OUT)               :: t8off
!
   INTEGER :: ios,i
!
   REAL(KIND=dp)  :: fake
!
   CHARACTER(LEN=1) :: bell
   CHARACTER(LEN=10) :: ff
   CHARACTER(LEN=40) :: BLANK
!
   bell=CHAR(7)
!
   ff='ELC.insert'
   ios=0
   OPEN(UNIT=1,FILE='ELC.insert',STATUS='old',ERR=10,IOSTAT=ios)
!
   READ(1,20)BLANK
!
!  Determine if we read a version 6 style input, or if we
!  attempt to read the old style files.
!
   IF(BLANK(1:3) /= '#1')THEN
      CLOSE(1)
      kkkk=0
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
!  We have a version 6 style input file, so start reading.
!  The various subroutines will scan for comment lines and
!  report errors for the specific variable if needed.
!
   CALL rdint(1,iunit,'iunit',ff)
   CALL rdint(1,isw7,'itime',ff)
   CALL rdreal(1,sw23,'t_start',ff)
   CALL rdreal(1,sw24,'t_end',ff)
   CALL rdreal(1,sw9,'time step',ff)
   CALL rdreal(1,dphase,'dphase',ff)
   CALL rdint(1,iatm,'iatm',ff)
   CALL rdint8(1,icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk,'icn',ff)
   CALL rdint(1,irvfilt,'iRVfilt',ff)
   CALL rdint(1,ilaw,'ilaw',ff)
   CALL rdreal(1,wave(1),'wavelength filter 1',ff)
   CALL rdreal(1,wave(2),'wavelength filter 2',ff)
   CALL rdreal(1,wave(3),'wavelength filter 3',ff)
   CALL rdreal(1,wave(4),'wavelength filter 4',ff)
   CALL rdreal(1,wave(5),'wavelength filter 5',ff)
   CALL rdreal(1,wave(6),'wavelength filter 6',ff)
   CALL rdreal(1,wave(7),'wavelength filter 7',ff)
   CALL rdreal(1,wave(8),'wavelength filter 8',ff)
   CALL rdint(1,nref,'Nref',ff)
   CALL rdreal(1,rlx,'log10(Lx)',ff)
   CALL rdint(1,isw25,'X-ray foreshortening switch',ff)
   CALL rdint(1,idark1,'idark1',ff)
   CALL rdint(1,idark2,'idark2',ff)
   CALL rdint(1,isw5,'ispotprof',ff)
   CALL rdint(1,isw6,'igrav',ff)
   CALL rdint(1,isw86,'flux switch',ff)
   CALL rdreal(1,t3,'T3',ff)
   CALL rdreal(1,g3,'g3',ff)
   CALL rdreal(1,sa3,'SA3',ff)
   CALL rdint(1,isw27,'Nterms',ff)
   CALL rdint(1,isw33,'Mandel',ff)
   CALL rdint(1,isw31,'Ngap',ff)
   CALL rdint(1,iecheck,'iecheck',ff)
   CALL rdint(1,ism1,'ism1',ff)
   CALL rdint(1,isw13,'ifasttrans',ff)
   CALL rdint(1,isw8,'MonteCarlo',ff)
   CALL rdreal(1,sw7,'phaselow',ff)
   CALL rdreal(1,sw8,'phasehigh',ff)
   CALL rdint(1,isw2,'isquare',ff)
   CALL rdint(1,isw3,'iusepot',ff)
   CALL rdreal(1,sw2,'usepot1',ff)
   CALL rdreal(1,sw3,'iusepot2',ff)
   CALL rdint(1,idraw,'idraw',ff)
   CALL rdint(1,isw1,'ionephase',ff)
   CALL rdreal(1,sw1,'onephase',ff)
   CALL rdreal(1,pshift,'pshift',ff)
   CALL rdint(1,ikeep,'ikeep',ff)
   CALL rdint(1,isynch,'isynch',ff)
   CALL rdint(1,isw21,'ialign',ff)
   CALL rdint(1,isw28,'Tconj switch',ff)
   CALL rdint(1,isw29,'e*cos(omega), e*sin(omega) switch',ff)
   CALL rdint(1,imag,'imag',ff)
   CALL rdint(1,isw9,'ieliete',ff)
   CALL rdint(1,isw4,'ifixgamma',ff)
   CALL rdint(1,isw23,'iwriteeclipse',ff)
   CALL rdint(1,isw24,'frac switch',ff)
   CALL rdint(1,isw22,'screen output supress switch',ff)
   CALL rdint(1,it4,'output files supress switch',ff)
   CALL rdreal(1,sw48,'chi^2 threshold',ff)
   CALL rdreal(1,sw6,'median fit',ff)
   CALL rdint(1,isw32,'jdum',ff)
   CALL rdint(1,isw88,'Ndynwin',ff)
   CALL rdreal(1,sw47,'Tref',ff)
   CALL rdreal(1,hh,'hh',ff)
   CALL rdint(1,isw26,'iGR',ff)
   CALL rdint(1,isw80,'binary+binary switch',ff)
   CALL rdint(1,itconj,'itconj',ff)
   CALL rdint(1,it1,'logarithmic mass ratios switch',ff)
   CALL rdint(1,isw100,'planet radii switch',ff)
   CALL rdint(1,it3,'transit treatment switch',ff)
   CALL rdint(1,isw81,'transit penalty switch',ff)
   CALL rdint(1,isw85,'secondary eclipse penalty switch',ff)
   CALL rdreal(1,sw84,'chi^2 penalty',ff)
   CALL rdint(1,it2,'informational output switch',ff)
   CALL rdreal(1,contam,'contam',ff)
   CALL rdint(1,isw34,'Iseason',ff)
   CALL rdreal(1,contams0,'contamS0',ff)
   CALL rdreal(1,contams1,'contamS1',ff)
   CALL rdreal(1,contams2,'contamS2',ff)
   CALL rdreal(1,contams3,'contamS3',ff)
   CALL rdint(1,nseg,'Nseg',ff)
   CALL rdint(1,isw87,'fast Kepler binning switch',ff)
   CALL rdreal(1,sw29,'LC bin size',ff)
   CALL rdreal(1,sw30,'RV bin size',ff)
   CALL rdint(1,isw89,'NSC',ff)
   CALL rdint(1,isw30,'Nbody',ff)
   CALL rdreal(1,period,'Period',ff)
   CALL rdreal(1,t0,'T0',ff)
   CALL rdreal(1,tconj,'Tconj',ff)
   CALL rdreal(1,pbptc,'PbpTc',ff)
   CALL rdreal(1,pbmtc,'PbmTc',ff)
   CALL rdreal(1,binqtc,'binqTc',ff)
   CALL rdreal(1,tbinoff,'Tbinoff',ff)
   CALL rdreal(1,ecc,'eccentricity',ff)
   CALL rdreal(1,argper,'argper',ff)
   CALL rdreal(1,ocose,'ocose',ff)
   CALL rdreal(1,osine,'osine',ff)
   CALL rdreal(1,sqecos,'sqrt(e)*cos(omega)',ff)
   CALL rdreal(1,sqesin,'sqrt(e)*sin(omega)',ff)
   CALL rdreal(1,finc,'finc',ff)
   CALL rdreal(1,sw49,'Omega_bin',ff)
   CALL rdreal(1,primk,'primK',ff)
   CALL rdreal(1,separ,'separ',ff)
   CALL rdreal(1,gamma,'gamma',ff)
   CALL rdreal(1,ecosw,'ecosw',ff)
   CALL rdint2(1,nalph1,nbet1,'Nalph1,Nbet1',ff)
   CALL rdreal(1,teff1,'Teff1',ff)
   CALL rdreal(1,tgrav1,'Tgrav1',ff)
   CALL rdreal(1,alb1,'alb1',ff)
   CALL rdreal(1,omega1,'omega1',ff)
   CALL rdreal(1,fill1,'fill1',ff)
   CALL rdreal(1,primrad,'primrad',ff)
   CALL rdreal(1,frac1,'frac1',ff)
   CALL rdreal(1,sw27,'radfill1',ff)
   CALL rdreal(1,primmass,'primmass',ff)
   CALL rdreal(1,bigi,'bigI',ff)
   CALL rdreal(1,bigbeta,'bigbeta',ff)
   CALL rdreal2(1,dwavex(1,1),dwavey(1,1),'l.d. 1, band 1',ff)
   CALL rdreal2(1,dwavex(2,1),dwavey(2,1),'l.d. 1, band 2',ff)
   CALL rdreal2(1,dwavex(3,1),dwavey(3,1),'l.d. 1, band 3',ff)
   CALL rdreal2(1,dwavex(4,1),dwavey(4,1),'l.d. 1, band 4',ff)
   CALL rdreal2(1,dwavex(5,1),dwavey(5,1),'l.d. 1, band 5',ff)
   CALL rdreal2(1,dwavex(6,1),dwavey(6,1),'l.d. 1, band 6',ff)
   CALL rdreal2(1,dwavex(7,1),dwavey(7,1),'l.d. 1, band 7',ff)
   CALL rdreal2(1,dwavex(8,1),dwavey(8,1),'l.d. 1, band 8',ff)
   CALL rdreal2(1,dbolx(1,1),dboly(1,1),'bolo. l.d. 1',ff)
   CALL rdreal(1,spot1parm(1,1),'spot1parm 1,1',ff)
   CALL rdreal(1,spot1parm(1,2),'spot1parm 1,2',ff)
   CALL rdreal(1,spot1parm(1,3),'spot1parm 1,3',ff)
   CALL rdreal(1,spot1parm(1,4),'spot1parm 1,4',ff)
   CALL rdreal(1,spot1parm(2,1),'spot1parm 2,1',ff)
   CALL rdreal(1,spot1parm(2,2),'spot1parm 2,2',ff)
   CALL rdreal(1,spot1parm(2,3),'spot1parm 2,3',ff)
   CALL rdreal(1,spot1parm(2,4),'spot1parm 2,4',ff)
   CALL rdreal(1,beam1,'beam1',ff)
   CALL rdreal(1,sw72,'rk1',ff)
   CALL rdreal(1,sdarkint1(1),'flux 1, band 1',ff)
   CALL rdreal(1,sdarkint1(2),'flux 1, band 2',ff)
   CALL rdreal(1,sdarkint1(3),'flux 1, band 3',ff)
   CALL rdreal(1,sdarkint1(4),'flux 1, band 4',ff)
   CALL rdreal(1,sdarkint1(5),'flux 1, band 5',ff)
   CALL rdreal(1,sdarkint1(6),'flux 1, band 6',ff)
   CALL rdreal(1,sdarkint1(7),'flux 1, band 7',ff)
   CALL rdreal(1,sdarkint1(8),'flux 1, band 8',ff)
   CALL rdint2(1,nalph2,nbet2,'Nalph2',ff)
   CALL rdreal(1,teff2,'Teff2',ff)
   CALL rdreal(1,temprat,'temprat',ff)
   CALL rdreal(1,tgrav2,'Tgrav2',ff)
   CALL rdreal(1,alb2,'alb2',ff)
   CALL rdreal(1,omega2,'omega2',ff)
   CALL rdreal(1,fill2,'fill2',ff)
   CALL rdreal(1,fillsum,'fillsum',ff)
   CALL rdreal(1,filldiff,'filldiff',ff)
   CALL rdreal(1,secrad,'secrad',ff)
   CALL rdreal(1,frac2,'frac2',ff)
   CALL rdreal(1,ratrad,'ratrad',ff)
   CALL rdreal(1,radsum,'radsum',ff)
   CALL rdreal(1,raddiff,'raddiff',ff)
   CALL rdreal(1,fracsum,'fracsum',ff)
   CALL rdreal(1,fracdiff,'fracdiff',ff)
   CALL rdreal(1,sw28,'radfill2',ff)
   CALL rdreal(1,q,'Q',ff)
   CALL rdreal(1,secmass,'secmass',ff)
   CALL rdreal(1,masssum,'masssum',ff)
   CALL rdreal(1,massdiff,'massdiff',ff)
   CALL rdreal(1,bigi2,'axis_I2',ff)
   CALL rdreal(1,bigbeta2,'axis_beta2',ff)
   CALL rdreal2(1,dwavex(1,2),dwavey(1,2),'l.d. 2 band 1',ff)
   CALL rdreal2(1,dwavex(2,2),dwavey(2,2),'l.d. 2 band 2',ff)
   CALL rdreal2(1,dwavex(3,2),dwavey(3,2),'l.d. 2 band 3',ff)
   CALL rdreal2(1,dwavex(4,2),dwavey(4,2),'l.d. 2 band 4',ff)
   CALL rdreal2(1,dwavex(5,2),dwavey(5,2),'l.d. 2 band 5',ff)
   CALL rdreal2(1,dwavex(6,2),dwavey(6,2),'l.d. 2 band 6',ff)
   CALL rdreal2(1,dwavex(7,2),dwavey(7,2),'l.d. 2 band 7',ff)
   CALL rdreal2(1,dwavex(8,2),dwavey(8,2),'l.d. 2 band 8',ff)
   CALL rdreal2(1,dbolx(1,2),dboly(1,2),'bolo. l.d. 2',ff)
   CALL rdreal(1,spot2parm(1,1),'spot2 parm 1,1 ',ff)
   CALL rdreal(1,spot2parm(1,2),'spot2 parm 1,2 ',ff)
   CALL rdreal(1,spot2parm(1,3),'spot2 parm 1,3 ',ff)
   CALL rdreal(1,spot2parm(1,4),'spot2 parm 1,4 ',ff)
   CALL rdreal(1,spot2parm(2,1),'spot2 parm 2,1 ',ff)
   CALL rdreal(1,spot2parm(2,2),'spot2 parm 2,2 ',ff)
   CALL rdreal(1,spot2parm(2,3),'spot2 parm 2,3 ',ff)
   CALL rdreal(1,spot2parm(2,4),'spot2 parm 2,4 ',ff)
   CALL rdreal(1,beam2,'beam2',ff)
   CALL rdreal(1,sw73,'rk2',ff)
   CALL rdreal(1,sdarkint2(1),'flux 2, band 1',ff)
   CALL rdreal(1,sdarkint2(2),'flux 2, band 2',ff)
   CALL rdreal(1,sdarkint2(3),'flux 2, band 3',ff)
   CALL rdreal(1,sdarkint2(4),'flux 2, band 4',ff)
   CALL rdreal(1,sdarkint2(5),'flux 2, band 5',ff)
   CALL rdreal(1,sdarkint2(6),'flux 2, band 6',ff)
   CALL rdreal(1,sdarkint2(7),'flux 2, band 7',ff)
   CALL rdreal(1,sdarkint2(8),'flux 2, band 8',ff)
   CALL rdint(1,iidint,'idint',ff)
   CALL rdint(1,ntheta,'Ntheta',ff)
   CALL rdint(1,nradius,'Nradius',ff)
   CALL rdreal(1,betarim,'betarim',ff)
   CALL rdreal(1,rinner,'rinner',ff)
   CALL rdreal(1,router,'router',ff)
   CALL rdreal(1,tdisk,'tdisk',ff)
   CALL rdreal(1,xi,'xi',ff)
   CALL rdreal(1,spotdparm(1,1),'disk spot 1,1',ff)
   CALL rdreal(1,spotdparm(1,2),'disk spot 1,2',ff)
   CALL rdreal(1,spotdparm(1,3),'disk spot 1,3',ff)
   CALL rdreal(1,spotdparm(1,4),'disk spot 1,4',ff)
   CALL rdreal(1,spotdparm(2,1),'disk spot 2,1',ff)
   CALL rdreal(1,spotdparm(2,2),'disk spot 2,2',ff)
   CALL rdreal(1,spotdparm(2,3),'disk spot 2,3',ff)
   CALL rdreal(1,spotdparm(2,4),'disk spot 2,4',ff)
   CALL rdreal(1,sw26,'reference phase disk fraction',ff)
   CALL rdreal(1,sw5,'asin(i)',ff)
   CALL rdreal(1,sw25,'asin(i) error',ff)
!
   DO i=2,8
      dbolx(i,1)=dbolx(1,1)
      dboly(i,1)=dboly(1,1)
      dbolx(i,2)=dbolx(1,2)
      dboly(i,2)=dboly(1,2)
   END DO
!
!  If Nbody < 3, then we are done.
!
   IF(isw30 < 3)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,tertconj,'P1Tconj',ff)
   CALL rdreal(1,tertperiod,'P1period',ff)
   CALL rdreal(1,p1ptc,'P1pTc',ff)
   CALL rdreal(1,p1mtc,'P1mTc',ff)
   CALL rdreal(1,p1qtc,'P1qTc',ff)
   CALL rdreal(1,t1off,'T1off',ff)
   CALL rdreal(1,tertt0,'P1T0',ff)
   CALL rdreal(1,tertecos,'P1e*cos',ff)
   CALL rdreal(1,tertesin,'P1e*sin',ff)
   CALL rdreal(1,sqtertecos,'P1sqrt(e)*cos',ff)
   CALL rdreal(1,sqtertesin,'P1sqrt(e)*sin',ff)
   CALL rdreal(1,tertincl,'P1incl',ff)
   CALL rdreal(1,tertomega,'P1Omega',ff)
   CALL rdreal(1,angsum1,'angsum1',ff)
   CALL rdreal(1,angdiff1,'angdiff1',ff)
   CALL rdint2(1,nalph3,nbet3,'Nalph3',ff)
   CALL rdreal(1,t3,'T3',ff)
   CALL rdreal(1,g3,'g3',ff)
   CALL rdreal(1,tertratrad,'P1ratrad',ff)
   CALL rdreal(1,tertq,'P1Q',ff)
   CALL rdreal(1,omega3,'omega3',ff)
   CALL rdreal(1,bigi3,'axis_I3',ff)
   CALL rdreal(1,bigbeta3,'axis_beta3',ff)
   CALL rdreal2(1,dwavex(1,3),dwavey(1,3),' l.d. 3, band 1',ff)
   CALL rdreal2(1,dwavex(2,3),dwavey(2,3),' l.d. 3, band 2',ff)
   CALL rdreal2(1,dwavex(3,3),dwavey(3,3),' l.d. 3, band 3',ff)
   CALL rdreal2(1,dwavex(4,3),dwavey(4,3),' l.d. 3, band 4',ff)
   CALL rdreal2(1,dwavex(5,3),dwavey(5,3),' l.d. 3, band 5',ff)
   CALL rdreal2(1,dwavex(6,3),dwavey(6,3),' l.d. 3, band 6',ff)
   CALL rdreal2(1,dwavex(7,3),dwavey(7,3),' l.d. 3, band 7',ff)
   CALL rdreal2(1,dwavex(8,3),dwavey(8,3),' l.d. 3, band 8',ff)
   CALL rdreal(1,rk3,'rk3',ff)
   CALL rdreal(1,sdarkint3(1),'flux 3, band 1',ff)
   CALL rdreal(1,sdarkint3(2),'flux 3, band 2',ff)
   CALL rdreal(1,sdarkint3(3),'flux 3, band 3',ff)
   CALL rdreal(1,sdarkint3(4),'flux 3, band 4',ff)
   CALL rdreal(1,sdarkint3(5),'flux 3, band 5',ff)
   CALL rdreal(1,sdarkint3(6),'flux 3, band 6',ff)
   CALL rdreal(1,sdarkint3(7),'flux 3, band 7',ff)
   CALL rdreal(1,sdarkint3(8),'flux 3, band 8',ff)
!
!  If Nbody < 4, then we are done.
!
   IF(isw30 < 4)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p2tconj,'P2tconj',ff)
   CALL rdreal(1,p2period,'P2period',ff)
   CALL rdreal(1,p2ptc,'P2pTc',ff)
   CALL rdreal(1,p2mtc,'P2mTc',ff)
   CALL rdreal(1,p2qtc,'P2qTc',ff)
   CALL rdreal(1,t2off,'T2off',ff)
   CALL rdreal(1,p2t0,'P2T0',ff)
   CALL rdreal(1,p2ecos,'P2ecos',ff)
   CALL rdreal(1,p2esin,'P2esin',ff)
   CALL rdreal(1,sqp2ecos,'P2sqrt(e)cos',ff)
   CALL rdreal(1,sqp2esin,'P2sqrt(e)sin',ff)
   CALL rdreal(1,p2incl,'P2incl',ff)
   CALL rdreal(1,p2omega,'P2Omega',ff)
   CALL rdreal(1,angsum2,'angsum2',ff)
   CALL rdreal(1,angdiff2,'angdiff2',ff)
   CALL rdreal(1,sw80,'Teff4',ff)
   CALL rdreal(1,sw82,'g4',ff)
   CALL rdreal(1,p2ratrad,'P2ratrad',ff)
   CALL rdreal(1,p2q,'P2Q',ff)
   CALL rdreal(1,omega4,'omega4',ff)
   CALL rdreal(1,bigi4,'axis_I4',ff)
   CALL rdreal(1,bigbeta4,'axis_beta4',ff)
   CALL rdreal2(1,dwavex(1,4),dwavey(1,4),'l.d. 4, band 1',ff)
   CALL rdreal2(1,dwavex(2,4),dwavey(2,4),'l.d. 4, band 2',ff)
   CALL rdreal2(1,dwavex(3,4),dwavey(3,4),'l.d. 4, band 3',ff)
   CALL rdreal2(1,dwavex(4,4),dwavey(4,4),'l.d. 4, band 4',ff)
   CALL rdreal2(1,dwavex(5,4),dwavey(5,4),'l.d. 4, band 5',ff)
   CALL rdreal2(1,dwavex(6,4),dwavey(6,4),'l.d. 4, band 6',ff)
   CALL rdreal2(1,dwavex(7,4),dwavey(7,4),'l.d. 4, band 7',ff)
   CALL rdreal2(1,dwavex(8,4),dwavey(8,4),'l.d. 4, band 8',ff)
   CALL rdreal(1,rk4,'rk4',ff)
   CALL rdreal(1,sdarkint4(1),'flux 4, band 1',ff)
   CALL rdreal(1,sdarkint4(2),'flux 4, band 2',ff)
   CALL rdreal(1,sdarkint4(3),'flux 4, band 3',ff)
   CALL rdreal(1,sdarkint4(4),'flux 4, band 4',ff)
   CALL rdreal(1,sdarkint4(5),'flux 4, band 5',ff)
   CALL rdreal(1,sdarkint4(6),'flux 4, band 6',ff)
   CALL rdreal(1,sdarkint4(7),'flux 4, band 7',ff)
   CALL rdreal(1,sdarkint4(8),'flux 4, band 8',ff)
   CALL rdreal(1,b2masssum,'b2masssum',ff)
   CALL rdreal(1,b2massdiff,'b2massdiff',ff)
   CALL rdreal(1,bin2q,'bin2Q',ff)
   CALL rdreal(1,b2radsum,'b2radsum',ff)
   CALL rdreal(1,b2raddiff,'b2raddiff',ff)
   CALL rdreal(1,bin2ratrad,'bin2ratrad',ff)
   CALL rdreal(1,bin2m3,'bin2M3',ff)
   CALL rdreal(1,bin2m4,'bin2M4',ff)
   CALL rdreal(1,bin2r3,'bin2R3',ff)
   CALL rdreal(1,bin2r4,'bin2R4',ff)
!
!  If Nbody < 5, then we are done.
!
   IF(isw30 < 5)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p3tconj,'P3tconj',ff)
   CALL rdreal(1,p3period,'P3period',ff)
   CALL rdreal(1,p3ptc,'P3pTc',ff)
   CALL rdreal(1,p3mtc,'P3mTc',ff)
   CALL rdreal(1,p3qtc,'P3qTc',ff)
   CALL rdreal(1,t3off,'T3off',ff)
   CALL rdreal(1,p3t0,'P3T0',ff)
   CALL rdreal(1,p3ecos,'P3ecos',ff)
   CALL rdreal(1,p3esin,'P3esin',ff)
   CALL rdreal(1,sqp3ecos,'P3sqrt(e)cos',ff)
   CALL rdreal(1,sqp3esin,'P3sqrt(e)sin',ff)
   CALL rdreal(1,p3incl,'P3incl',ff)
   CALL rdreal(1,p3omega,'P3Omega',ff)
   CALL rdreal(1,angsum3,'angsum3',ff)
   CALL rdreal(1,angdiff3,'angdiff3',ff)
   CALL rdreal(1,sw81,'Teff5',ff)
   CALL rdreal(1,sw83,'g5',ff)
   CALL rdreal(1,p3ratrad,'P3ratrad',ff)
   CALL rdreal(1,p3q,'P3Q',ff)
   CALL rdreal(1,omega5,'omega5',ff)
   CALL rdreal(1,fake,'axis_I5',ff)
   CALL rdreal(1,fake,'axis_beta5',ff)
   CALL rdreal2(1,dwavex(1,5),dwavey(1,5),'l.d. 5,band 1',ff)
   CALL rdreal2(1,dwavex(2,5),dwavey(2,5),'l.d. 5,band 2',ff)
   CALL rdreal2(1,dwavex(3,5),dwavey(3,5),'l.d. 5,band 3',ff)
   CALL rdreal2(1,dwavex(4,5),dwavey(4,5),'l.d. 5,band 4',ff)
   CALL rdreal2(1,dwavex(5,5),dwavey(5,5),'l.d. 5,band 5',ff)
   CALL rdreal2(1,dwavex(6,5),dwavey(6,5),'l.d. 5,band 6',ff)
   CALL rdreal2(1,dwavex(7,5),dwavey(7,5),'l.d. 5,band 7',ff)
   CALL rdreal2(1,dwavex(8,5),dwavey(8,5),'l.d. 5,band 8',ff)
   CALL rdreal(1,rk5,'rk5',ff)
   CALL rdreal(1,sdarkint5(1),'flux 5, band 1',ff)
   CALL rdreal(1,sdarkint5(2),'flux 5, band 2',ff)
   CALL rdreal(1,sdarkint5(3),'flux 5, band 3',ff)
   CALL rdreal(1,sdarkint5(4),'flux 5, band 4',ff)
   CALL rdreal(1,sdarkint5(5),'flux 5, band 5',ff)
   CALL rdreal(1,sdarkint5(6),'flux 5, band 6',ff)
   CALL rdreal(1,sdarkint5(7),'flux 5, band 7',ff)
   CALL rdreal(1,sdarkint5(8),'flux 5, band 8',ff)
!
!  If Nbody < 6, then we are done.
!
   IF(isw30 < 6)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p4tconj,'P4tconj',ff)
   CALL rdreal(1,p4period,'P4period',ff)
   CALL rdreal(1,p4ptc,'P4pTc',ff)
   CALL rdreal(1,p4mtc,'P4mTc',ff)
   CALL rdreal(1,p4qtc,'P4qTc',ff)
   CALL rdreal(1,t4off,'T4off',ff)
   CALL rdreal(1,p4t0,'P4T0',ff)
   CALL rdreal(1,p4ecos,'P4ecos',ff)
   CALL rdreal(1,p4esin,'P4esin',ff)
   CALL rdreal(1,sqp4ecos,'P4sqrt(e)cos',ff)
   CALL rdreal(1,sqp4esin,'P4sqrt(e)sin',ff)
   CALL rdreal(1,p4incl,'P4incl',ff)
   CALL rdreal(1,p4omega,'P4Omega',ff)
   CALL rdreal(1,angsum4,'angsum4',ff)
   CALL rdreal(1,angdiff4,'angdiff4',ff)
   CALL rdreal(1,t6,'t6',ff)
   CALL rdreal(1,g6,'g6',ff)
   CALL rdreal(1,p4ratrad,'P4ratrad',ff)
   CALL rdreal(1,p4q,'P4Q',ff)
   CALL rdreal(1,omega6,'omega6',ff)
   CALL rdreal(1,fake,'axis_I6',ff)
   CALL rdreal(1,fake,'axis_beta6',ff)
   CALL rdreal2(1,dwavex(1,6),dwavey(1,6),'l.d. 6, band 1',ff)
   CALL rdreal2(1,dwavex(2,6),dwavey(2,6),'l.d. 6, band 2',ff)
   CALL rdreal2(1,dwavex(3,6),dwavey(3,6),'l.d. 6, band 3',ff)
   CALL rdreal2(1,dwavex(4,6),dwavey(4,6),'l.d. 6, band 4',ff)
   CALL rdreal2(1,dwavex(5,6),dwavey(5,6),'l.d. 6, band 5',ff)
   CALL rdreal2(1,dwavex(6,6),dwavey(6,6),'l.d. 6, band 6',ff)
   CALL rdreal2(1,dwavex(7,6),dwavey(7,6),'l.d. 6, band 7',ff)
   CALL rdreal2(1,dwavex(8,6),dwavey(8,6),'l.d. 6, band 8',ff)
   CALL rdreal(1,rk6,'rk6',ff)
   CALL rdreal(1,sdarkint6(1),'flux 6, band 1',ff)
   CALL rdreal(1,sdarkint6(2),'flux 6, band 2',ff)
   CALL rdreal(1,sdarkint6(3),'flux 6, band 3',ff)
   CALL rdreal(1,sdarkint6(4),'flux 6, band 4',ff)
   CALL rdreal(1,sdarkint6(5),'flux 6, band 5',ff)
   CALL rdreal(1,sdarkint6(6),'flux 6, band 6',ff)
   CALL rdreal(1,sdarkint6(7),'flux 6, band 7',ff)
   CALL rdreal(1,sdarkint6(8),'flux 6, band 8',ff)
!
!  If Nbody < 7, then we are done.
!
   IF(isw30 < 7)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p5tconj,'P5tconj',ff)
   CALL rdreal(1,p5period,'P5period',ff)
   CALL rdreal(1,p5ptc,'P5pTc',ff)
   CALL rdreal(1,p5mtc,'P5mTc',ff)
   CALL rdreal(1,p5qtc,'P5qTc',ff)
   CALL rdreal(1,t5off,'T5off',ff)
   CALL rdreal(1,p5t0,'P5T0',ff)
   CALL rdreal(1,p5ecos,'P5ecos',ff)
   CALL rdreal(1,p5esin,'P5esin',ff)
   CALL rdreal(1,sqp5ecos,'P5sqrt(e)cos',ff)
   CALL rdreal(1,sqp5esin,'P5sqrt(e)sin',ff)
   CALL rdreal(1,p5incl,'P5incl',ff)
   CALL rdreal(1,p5omega,'P5Omega',ff)
   CALL rdreal(1,angsum5,'angsum5',ff)
   CALL rdreal(1,angdiff5,'angdiff5',ff)
   CALL rdreal(1,t7,'t7',ff)
   CALL rdreal(1,g7,'g7',ff)
   CALL rdreal(1,p5ratrad,'P5ratrad',ff)
   CALL rdreal(1,p5q,'P5Q',ff)
   CALL rdreal(1,omega7,'omega7',ff)
   CALL rdreal(1,fake,'axis_I7',ff)
   CALL rdreal(1,fake,'axis_beta7',ff)
   CALL rdreal2(1,dwavex(1,7),dwavey(1,7),'l.d. 7, band 1',ff)
   CALL rdreal2(1,dwavex(2,7),dwavey(2,7),'l.d. 7, band 2',ff)
   CALL rdreal2(1,dwavex(3,7),dwavey(3,7),'l.d. 7, band 3',ff)
   CALL rdreal2(1,dwavex(4,7),dwavey(4,7),'l.d. 7, band 4',ff)
   CALL rdreal2(1,dwavex(5,7),dwavey(5,7),'l.d. 7, band 5',ff)
   CALL rdreal2(1,dwavex(6,7),dwavey(6,7),'l.d. 7, band 6',ff)
   CALL rdreal2(1,dwavex(7,7),dwavey(7,7),'l.d. 7, band 7',ff)
   CALL rdreal2(1,dwavex(8,7),dwavey(8,7),'l.d. 7, band 8',ff)
   CALL rdreal(1,rk7,'rk7',ff)
   CALL rdreal(1,sdarkint7(1),'flux 7, band 1',ff)
   CALL rdreal(1,sdarkint7(2),'flux 7, band 2',ff)
   CALL rdreal(1,sdarkint7(3),'flux 7, band 3',ff)
   CALL rdreal(1,sdarkint7(4),'flux 7, band 4',ff)
   CALL rdreal(1,sdarkint7(5),'flux 7, band 5',ff)
   CALL rdreal(1,sdarkint7(6),'flux 7, band 6',ff)
   CALL rdreal(1,sdarkint7(7),'flux 7, band 7',ff)
   CALL rdreal(1,sdarkint7(8),'flux 7, band 8',ff)
!
!  If Nbody < 8, then we are done.
!
   IF(isw30 < 8)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p6tconj,'P6tconj',ff)
   CALL rdreal(1,p6period,'P6period',ff)
   CALL rdreal(1,p6ptc,'P6pTc',ff)
   CALL rdreal(1,p6mtc,'P6mTc',ff)
   CALL rdreal(1,p6qtc,'P6qTc',ff)
   CALL rdreal(1,t6off,'T6off',ff)
   CALL rdreal(1,p6t0,'P6T0',ff)
   CALL rdreal(1,p6ecos,'P6ecos',ff)
   CALL rdreal(1,p6esin,'P6esin',ff)
   CALL rdreal(1,sqp6ecos,'P6sqrt(e)cos',ff)
   CALL rdreal(1,sqp6esin,'P6sqrt(e)sin',ff)
   CALL rdreal(1,p6incl,'P6incl',ff)
   CALL rdreal(1,p6omega,'P6Omega',ff)
   CALL rdreal(1,angsum6,'angsum6',ff)
   CALL rdreal(1,angdiff6,'angdiff6',ff)
   CALL rdreal(1,t8,'t8',ff)
   CALL rdreal(1,g8,'g8',ff)
   CALL rdreal(1,p6ratrad,'P6ratrad',ff)
   CALL rdreal(1,p6q,'P6Q',ff)
   CALL rdreal(1,omega8,'omega8',ff)
   CALL rdreal(1,fake,'axis_I8',ff)
   CALL rdreal(1,fake,'axis_beta8',ff)
   CALL rdreal2(1,dwavex(1,8),dwavey(1,8),'l.d. 8, band 1',ff)
   CALL rdreal2(1,dwavex(2,8),dwavey(2,8),'l.d. 8, band 2',ff)
   CALL rdreal2(1,dwavex(3,8),dwavey(3,8),'l.d. 8, band 3',ff)
   CALL rdreal2(1,dwavex(4,8),dwavey(4,8),'l.d. 8, band 4',ff)
   CALL rdreal2(1,dwavex(5,8),dwavey(5,8),'l.d. 8, band 5',ff)
   CALL rdreal2(1,dwavex(6,8),dwavey(6,8),'l.d. 8, band 6',ff)
   CALL rdreal2(1,dwavex(7,8),dwavey(7,8),'l.d. 8, band 7',ff)
   CALL rdreal2(1,dwavex(8,8),dwavey(8,8),'l.d. 8, band 8',ff)
   CALL rdreal(1,rk8,'rk8',ff)
   CALL rdreal(1,sdarkint8(1),'flux 8, band 1',ff)
   CALL rdreal(1,sdarkint8(2),'flux 8, band 2',ff)
   CALL rdreal(1,sdarkint8(3),'flux 8, band 3',ff)
   CALL rdreal(1,sdarkint8(4),'flux 8, band 4',ff)
   CALL rdreal(1,sdarkint8(5),'flux 8, band 5',ff)
   CALL rdreal(1,sdarkint8(6),'flux 8, band 6',ff)
   CALL rdreal(1,sdarkint8(7),'flux 8, band 7',ff)
   CALL rdreal(1,sdarkint8(8),'flux 8, band 8',ff)
!
!  If Nbody < 9, then we are done.
!
   IF(isw30 < 9)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p7tconj,'P7tconj',ff)
   CALL rdreal(1,p7period,'P7period',ff)
   CALL rdreal(1,p7ptc,'P7pTc',ff)
   CALL rdreal(1,p7mtc,'P7mTc',ff)
   CALL rdreal(1,p7qtc,'P7qTc',ff)
   CALL rdreal(1,t7off,'T7off',ff)
   CALL rdreal(1,p7t0,'P7T0',ff)
   CALL rdreal(1,p7ecos,'P7ecos',ff)
   CALL rdreal(1,p7esin,'P7esin',ff)
   CALL rdreal(1,sqp7ecos,'P7sqrt(e)cos',ff)
   CALL rdreal(1,sqp7esin,'P7sqrt(e)esin',ff)
   CALL rdreal(1,p7incl,'P7incl',ff)
   CALL rdreal(1,p7omega,'P7Omega',ff)
   CALL rdreal(1,angsum7,'angsum7',ff)
   CALL rdreal(1,angdiff7,'angdiff7',ff)
   CALL rdreal(1,t9,'t9',ff)
   CALL rdreal(1,g9,'g9',ff)
   CALL rdreal(1,p7ratrad,'P7ratrad',ff)
   CALL rdreal(1,p7q,'P7Q',ff)
   CALL rdreal(1,omega9,'omega9',ff)
   CALL rdreal(1,fake,'axis_I9',ff)
   CALL rdreal(1,fake,'axis_I9',ff)
   CALL rdreal2(1,dwavex(1,9),dwavey(1,9),'l.d. 9, band 1',ff)
   CALL rdreal2(1,dwavex(2,9),dwavey(2,9),'l.d. 9, band 2',ff)
   CALL rdreal2(1,dwavex(3,9),dwavey(3,9),'l.d. 9, band 3',ff)
   CALL rdreal2(1,dwavex(4,9),dwavey(4,9),'l.d. 9, band 4',ff)
   CALL rdreal2(1,dwavex(5,9),dwavey(5,9),'l.d. 9, band 5',ff)
   CALL rdreal2(1,dwavex(6,9),dwavey(6,9),'l.d. 9, band 6',ff)
   CALL rdreal2(1,dwavex(7,9),dwavey(7,9),'l.d. 9, band 7',ff)
   CALL rdreal2(1,dwavex(8,9),dwavey(8,9),'l.d. 9, band 8',ff)
   CALL rdreal(1,rk9,'rk9',ff)
   CALL rdreal(1,sdarkint9(1),'flux 9, band 1',ff)
   CALL rdreal(1,sdarkint9(2),'flux 9, band 2',ff)
   CALL rdreal(1,sdarkint9(3),'flux 9, band 3',ff)
   CALL rdreal(1,sdarkint9(4),'flux 9, band 4',ff)
   CALL rdreal(1,sdarkint9(5),'flux 9, band 5',ff)
   CALL rdreal(1,sdarkint9(6),'flux 9, band 6',ff)
   CALL rdreal(1,sdarkint9(7),'flux 9, band 7',ff)
   CALL rdreal(1,sdarkint9(8),'flux 9, band 8',ff)
!
!  If Nbody < 10, then we are done.
!
   IF(isw30 < 10)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   CALL rdreal(1,p8tconj,'P8tconj',ff)
   CALL rdreal(1,p8period,'P8period',ff)
   CALL rdreal(1,p8ptc,'P8pTc',ff)
   CALL rdreal(1,p8mtc,'P8mTc',ff)
   CALL rdreal(1,p8qtc,'P8qTc',ff)
   CALL rdreal(1,t8off,'T8off',ff)
   CALL rdreal(1,p8t0,'P8T0',ff)
   CALL rdreal(1,p8ecos,'P8ecos',ff)
   CALL rdreal(1,p8esin,'P8esin',ff)
   CALL rdreal(1,sqp8ecos,'P8sqrt(e)cos',ff)
   CALL rdreal(1,sqp8esin,'P8sqrt(e)sin',ff)
   CALL rdreal(1,p8incl,'P8incl',ff)
   CALL rdreal(1,p8omega,'P8Omega',ff)
   CALL rdreal(1,angsum8,'angsum8',ff)
   CALL rdreal(1,angdiff8,'angdiff8',ff)
   CALL rdreal(1,t10,'t10',ff)
   CALL rdreal(1,g10,'g10',ff)
   CALL rdreal(1,p8ratrad,'P8ratrad',ff)
   CALL rdreal(1,p8q,'P8Q',ff)
   CALL rdreal(1,omega10,'omega10',ff)
   CALL rdreal(1,fake,'axis_I10',ff)
   CALL rdreal(1,fake,'axis_I10',ff)
   CALL rdreal2(1,dwavex(1,10),dwavey(1,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(2,10),dwavey(2,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(3,10),dwavey(3,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(4,10),dwavey(4,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(5,10),dwavey(5,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(6,10),dwavey(6,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(7,10),dwavey(7,10),'l.d. 10, band 1', ff)
   CALL rdreal2(1,dwavex(8,10),dwavey(8,10),'l.d. 10, band 1', ff)
   CALL rdreal(1,rk10,'rk10',ff)
   CALL rdreal(1,sdarkint10(1),'flux 10, band 1',ff)
   CALL rdreal(1,sdarkint10(2),'flux 10, band 2',ff)
   CALL rdreal(1,sdarkint10(3),'flux 10, band 3',ff)
   CALL rdreal(1,sdarkint10(4),'flux 10, band 4',ff)
   CALL rdreal(1,sdarkint10(5),'flux 10, band 5',ff)
   CALL rdreal(1,sdarkint10(6),'flux 10, band 6',ff)
   CALL rdreal(1,sdarkint10(7),'flux 10, band 7',ff)
   CALL rdreal(1,sdarkint10(8),'flux 10, band 8',ff)
!
   IF(ios == 0)THEN
      CLOSE(1)
      kkkk=99
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
   IF(ios > 0)THEN
      kkkk=0
      CALL EXECUTE_COMMAND_LINE('rm ELC.insert')
      RETURN
   END IF
!
!   Come here if there is a problem with opening the file
!
10 IF(ios > 0)THEN
      kkkk=0
      RETURN
   END IF
!
20 FORMAT(a40)
!
   RETURN
!
END SUBROUTINE newinsgridinput
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE newwritegridout(nalph1,nalph2,nalph3,nbet1,nbet2,  &
   nbet3,nradius,nref,nseg,ntheta,irvfilt,iatm,icnb,icnh,icni,  &
   icnj,icnk,icnr,icnu,icnv,idark1,idark2,idraw,iecheck,iidint,  &
   ikeep,ilaw,ism1,isw1,isw13,isw2,isw21,isw22,isw23,  &
   isw24,isw25,isw26,isw27,isw28,isw29,isw3,isw30,isw31,isw32,  &
   isw33,isw34,isw4,isw5,isw6,isw7,isw8,isw80,isw81,  &
   isw85,isw86,isw87,isw88,isw89,isw9,isw100,isynch,it1,  &
   it2,it3,it4,itconj,p1mtc,p1ptc,p2omega,p2q,p2t0,p2ecos,  &
   p2esin,p2incl,p2mtc,p2ptc,p2period,p2ratrad,p2tconj,p3omega,  &
   p3q,p3t0,p3ecos,p3esin,p3incl,p3mtc,p3ptc,p3period,p3ratrad,  &
   p3tconj,p4omega,p4q,p4t0,p4ecos,p4esin,p4incl,p4mtc,p4ptc,  &
   p4period,p4ratrad,p4tconj,p5omega,p5q,p5t0,p5ecos,p5esin,  &
   p5incl,p5mtc,p5ptc,p5period,p5ratrad,p5tconj,p6omega,p6q,  &
   p6t0,p6ecos,p6esin,p6incl,p6mtc,p6ptc,p6period,p6ratrad,  &
   p6tconj,p7omega,p7q,p7t0,p7ecos,p7esin,p7incl,p7mtc,p7ptc,  &
   p7period,p7ratrad,p7tconj,p8omega,p8q,p8t0,p8ecos,p8esin,  &
   p8incl,p8mtc,p8ptc,p8period,p8ratrad,p8tconj,pbmtc,pbptc,  &
   period,q,sa3,t0,tconj,teff1,teff2,tgrav1,tgrav2,alb1,alb2,  &
   argper,beam1,beam2,betarim,bigi,bigi2,bigi3,bigi4,bigbeta,  &
   bigbeta2,bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,  &
   b2raddiff,b2radsum,bin2ratrad,contam,contams0,contams1,  &
   contams2,contams3,dbolx,dboly,dphase,dwavex,dwavey,  &
   ecc,ecosw,fill1,fill2,finc,frac1,frac2,g10,g3,g6,g7,g8,g9,  &
   gamma,hh,massdiff,masssum,ocose,omega1,omega2,omega3,omega4,  &
   omega5,omega6,omega7,omega8,omega9,omega10,osine,  &
   primk,primmass,primrad,pshift,rlx,raddiff,radsum,  &
   ratrad,rinner,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,router,  &
   sdarkint1,sdarkint2,sdarkint3,sdarkint4,sdarkint5,sdarkint6,  &
   sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,  &
   separ,spot1parm,spot2parm,spotdparm,sw1,sw2,sw23,sw24,sw25,  &
   sw26,sw27,sw28,sw29,sw3,sw30,sw47,sw48,sw49,sw5,sw6,sw7,sw72,  &
   sw73,sw8,sw80,sw81,sw82,sw83,sw84,  &
   sw9,t10,t3,t6,t7,t8,t9,tdisk,temprat,tertomega,tertq,  &
   tertconj,tertecos,tertesin,tertincl,tertperiod,tertratrad,  &
   tertt0,wave,xi,iunit,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,  &
   bin2r4,sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
   sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
   sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
   angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
   angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,imag,fillsum,filldiff,binqtc,p1qtc,p2qtc,  &
   p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,  &
   t3off,t4off,t5off,t6off,t7off,t8off,iextension,iversion,  &
   tesscontam,tessfilt,tessbin)
!
!   November 1, 2019
!
!   Modified to handle version numbers.  If iversion=0, then
!   there is no change.  If iversion=1, then add some
!   blocks about TESS features after the Kepler block.  There
!   will be 3 items:
!
!   tesscontam
!   tessfilt
!   tessbin
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nalph1
   INTEGER, INTENT(IN)                      :: nalph2
   INTEGER, INTENT(IN)                      :: nalph3
   INTEGER, INTENT(IN)                      :: nbet1
   INTEGER, INTENT(IN)                      :: nbet2
   INTEGER, INTENT(IN)                      :: nbet3
   INTEGER, INTENT(IN)                      :: nradius
   INTEGER, INTENT(IN)                      :: nref
   INTEGER, INTENT(IN)                      :: nseg
   INTEGER, INTENT(IN)                      :: ntheta
   INTEGER, INTENT(IN)                      :: irvfilt
   INTEGER, INTENT(IN)                      :: iatm
   INTEGER, INTENT(IN)                      :: icnb
   INTEGER, INTENT(IN)                      :: icnh
   INTEGER, INTENT(IN)                      :: icni
   INTEGER, INTENT(IN)                      :: icnj
   INTEGER, INTENT(IN)                      :: icnk
   INTEGER, INTENT(IN)                      :: icnr
   INTEGER, INTENT(IN)                      :: icnu
   INTEGER, INTENT(IN)                      :: icnv
   INTEGER, INTENT(IN)                      :: idark1
   INTEGER, INTENT(IN)                      :: idark2
   INTEGER, INTENT(IN)                      :: idraw
   INTEGER, INTENT(IN)                      :: iecheck
   INTEGER, INTENT(IN)                      :: iidint
   INTEGER, INTENT(IN)                      :: ikeep
   INTEGER, INTENT(IN)                      :: ilaw
   INTEGER, INTENT(IN)                      :: ism1
   INTEGER, INTENT(IN)                      :: isw1
   INTEGER, INTENT(IN)                      :: isw13
   INTEGER, INTENT(IN)                      :: isw2
   INTEGER, INTENT(IN)                      :: isw21
   INTEGER, INTENT(IN)                      :: isw22
   INTEGER, INTENT(IN)                      :: isw23
   INTEGER, INTENT(IN)                      :: isw24
   INTEGER, INTENT(IN)                      :: isw25
   INTEGER, INTENT(IN)                      :: isw26
   INTEGER, INTENT(IN)                      :: isw27
   INTEGER, INTENT(IN)                      :: isw28
   INTEGER, INTENT(IN)                      :: isw29
   INTEGER, INTENT(IN)                      :: isw3
   INTEGER, INTENT(IN)                      :: isw30
   INTEGER, INTENT(IN)                      :: isw31
   INTEGER, INTENT(IN)                      :: isw32
   INTEGER, INTENT(IN)                      :: isw33
   INTEGER, INTENT(IN)                      :: isw34
   INTEGER, INTENT(IN)                      :: isw4
   INTEGER, INTENT(IN)                      :: isw5
   INTEGER, INTENT(IN)                      :: isw6
   INTEGER, INTENT(IN)                      :: isw7
   INTEGER, INTENT(IN)                      :: isw8
   INTEGER, INTENT(IN)                      :: isw80
   INTEGER, INTENT(IN)                      :: isw81
   INTEGER, INTENT(IN)                      :: isw85
   INTEGER, INTENT(IN)                      :: isw86
   INTEGER, INTENT(IN)                      :: isw87
   INTEGER, INTENT(IN)                      :: isw88
   INTEGER, INTENT(IN)                      :: isw89
   INTEGER, INTENT(IN)                      :: isw9
   INTEGER, INTENT(IN)                      :: isw100
   INTEGER, INTENT(IN)                      :: isynch
   INTEGER, INTENT(IN)                      :: it1
   INTEGER, INTENT(IN)                      :: it2
   INTEGER, INTENT(IN)                      :: it3
   INTEGER, INTENT(IN)                      :: it4
   INTEGER, INTENT(IN)                      :: itconj
   REAL(KIND=dp), INTENT(IN)                :: p1mtc
   REAL(KIND=dp), INTENT(IN)                :: p1ptc
   REAL(KIND=dp), INTENT(IN)                :: p2omega
   REAL(KIND=dp), INTENT(IN)                :: p2q
   REAL(KIND=dp), INTENT(IN)                :: p2t0
   REAL(KIND=dp), INTENT(IN)                :: p2ecos
   REAL(KIND=dp), INTENT(IN)                :: p2esin
   REAL(KIND=dp), INTENT(IN)                :: p2incl
   REAL(KIND=dp), INTENT(IN)                :: p2mtc
   REAL(KIND=dp), INTENT(IN)                :: p2ptc
   REAL(KIND=dp), INTENT(IN)                :: p2period
   REAL(KIND=dp), INTENT(IN)                :: p2ratrad
   REAL(KIND=dp), INTENT(IN)                :: p2tconj
   REAL(KIND=dp), INTENT(IN)                :: p3omega
   REAL(KIND=dp), INTENT(IN)                :: p3q
   REAL(KIND=dp), INTENT(IN)                :: p3t0
   REAL(KIND=dp), INTENT(IN)                :: p3ecos
   REAL(KIND=dp), INTENT(IN)                :: p3esin
   REAL(KIND=dp), INTENT(IN)                :: p3incl
   REAL(KIND=dp), INTENT(IN)                :: p3mtc
   REAL(KIND=dp), INTENT(IN)                :: p3ptc
   REAL(KIND=dp), INTENT(IN)                :: p3period
   REAL(KIND=dp), INTENT(IN)                :: p3ratrad
   REAL(KIND=dp), INTENT(IN)                :: p3tconj
   REAL(KIND=dp), INTENT(IN)                :: p4omega
   REAL(KIND=dp), INTENT(IN)                :: p4q
   REAL(KIND=dp), INTENT(IN)                :: p4t0
   REAL(KIND=dp), INTENT(IN)                :: p4ecos
   REAL(KIND=dp), INTENT(IN)                :: p4esin
   REAL(KIND=dp), INTENT(IN)                :: p4incl
   REAL(KIND=dp), INTENT(IN)                :: p4mtc
   REAL(KIND=dp), INTENT(IN)                :: p4ptc
   REAL(KIND=dp), INTENT(IN)                :: p4period
   REAL(KIND=dp), INTENT(IN)                :: p4ratrad
   REAL(KIND=dp), INTENT(IN)                :: p4tconj
   REAL(KIND=dp), INTENT(IN)                :: p5omega
   REAL(KIND=dp), INTENT(IN)                :: p5q
   REAL(KIND=dp), INTENT(IN)                :: p5t0
   REAL(KIND=dp), INTENT(IN)                :: p5ecos
   REAL(KIND=dp), INTENT(IN)                :: p5esin
   REAL(KIND=dp), INTENT(IN)                :: p5incl
   REAL(KIND=dp), INTENT(IN)                :: p5mtc
   REAL(KIND=dp), INTENT(IN)                :: p5ptc
   REAL(KIND=dp), INTENT(IN)                :: p5period
   REAL(KIND=dp), INTENT(IN)                :: p5ratrad
   REAL(KIND=dp), INTENT(IN)                :: p5tconj
   REAL(KIND=dp), INTENT(IN)                :: p6omega
   REAL(KIND=dp), INTENT(IN)                :: p6q
   REAL(KIND=dp), INTENT(IN)                :: p6t0
   REAL(KIND=dp), INTENT(IN)                :: p6ecos
   REAL(KIND=dp), INTENT(IN)                :: p6esin
   REAL(KIND=dp), INTENT(IN)                :: p6incl
   REAL(KIND=dp), INTENT(IN)                :: p6mtc
   REAL(KIND=dp), INTENT(IN)                :: p6ptc
   REAL(KIND=dp), INTENT(IN)                :: p6period
   REAL(KIND=dp), INTENT(IN)                :: p6ratrad
   REAL(KIND=dp), INTENT(IN)                :: p6tconj
   REAL(KIND=dp), INTENT(IN)                :: p7omega
   REAL(KIND=dp), INTENT(IN)                :: p7q
   REAL(KIND=dp), INTENT(IN)                :: p7t0
   REAL(KIND=dp), INTENT(IN)                :: p7ecos
   REAL(KIND=dp), INTENT(IN)                :: p7esin
   REAL(KIND=dp), INTENT(IN)                :: p7incl
   REAL(KIND=dp), INTENT(IN)                :: p7mtc
   REAL(KIND=dp), INTENT(IN)                :: p7ptc
   REAL(KIND=dp), INTENT(IN)                :: p7period
   REAL(KIND=dp), INTENT(IN)                :: p7ratrad
   REAL(KIND=dp), INTENT(IN)                :: p7tconj
   REAL(KIND=dp), INTENT(IN)                :: p8omega
   REAL(KIND=dp), INTENT(IN)                :: p8q
   REAL(KIND=dp), INTENT(IN)                :: p8t0
   REAL(KIND=dp), INTENT(IN)                :: p8ecos
   REAL(KIND=dp), INTENT(IN)                :: p8esin
   REAL(KIND=dp), INTENT(IN)                :: p8incl
   REAL(KIND=dp), INTENT(IN)                :: p8mtc
   REAL(KIND=dp), INTENT(IN)                :: p8ptc
   REAL(KIND=dp), INTENT(IN)                :: p8period
   REAL(KIND=dp), INTENT(IN)                :: p8ratrad
   REAL(KIND=dp), INTENT(IN)                :: p8tconj
   REAL(KIND=dp), INTENT(IN)                :: pbmtc
   REAL(KIND=dp), INTENT(IN)                :: pbptc
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: q
   REAL(KIND=dp), INTENT(IN)                :: sa3
   REAL(KIND=dp), INTENT(IN)                :: t0
   REAL(KIND=dp), INTENT(IN)                :: tconj
   REAL(KIND=dp), INTENT(IN)                :: teff1
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN)                :: tgrav1
   REAL(KIND=dp), INTENT(IN)                :: tgrav2
   REAL(KIND=dp), INTENT(IN)                :: alb1
   REAL(KIND=dp), INTENT(IN)                :: alb2
   REAL(KIND=dp), INTENT(IN)                :: argper
   REAL(KIND=dp), INTENT(IN)                :: beam1
   REAL(KIND=dp), INTENT(IN)                :: beam2
   REAL(KIND=dp), INTENT(IN)                :: betarim
   REAL(KIND=dp), INTENT(IN)                :: bigi
   REAL(KIND=dp), INTENT(IN)                :: bigi2
   REAL(KIND=dp), INTENT(IN)                :: bigi3
   REAL(KIND=dp), INTENT(IN)                :: bigi4
   REAL(KIND=dp), INTENT(IN)                :: bigbeta
   REAL(KIND=dp), INTENT(IN)                :: bigbeta2
   REAL(KIND=dp), INTENT(IN)                :: bigbeta3
   REAL(KIND=dp), INTENT(IN)                :: bigbeta4
   REAL(KIND=dp), INTENT(IN)                :: bin2q
   REAL(KIND=dp), INTENT(IN)                :: b2massdiff
   REAL(KIND=dp), INTENT(IN)                :: b2masssum
   REAL(KIND=dp), INTENT(IN)                :: b2raddiff
   REAL(KIND=dp), INTENT(IN)                :: b2radsum
   REAL(KIND=dp), INTENT(IN)                :: bin2ratrad
   REAL(KIND=dp), INTENT(IN)                :: contam
   REAL(KIND=dp), INTENT(IN)                :: contams0
   REAL(KIND=dp), INTENT(IN)                :: contams1
   REAL(KIND=dp), INTENT(IN)                :: contams2
   REAL(KIND=dp), INTENT(IN)                :: contams3
   REAL(KIND=dp), INTENT(IN)                :: dbolx(8,2)
   REAL(KIND=dp), INTENT(IN)                :: dboly(8,2)
   REAL(KIND=dp), INTENT(IN)                :: dphase
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: ecosw
   REAL(KIND=dp), INTENT(IN)                :: fill1
   REAL(KIND=dp), INTENT(IN)                :: fill2
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: frac1
   REAL(KIND=dp), INTENT(IN)                :: frac2
   REAL(KIND=dp), INTENT(IN)                :: g10
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: g6
   REAL(KIND=dp), INTENT(IN)                :: g7
   REAL(KIND=dp), INTENT(IN)                :: g8
   REAL(KIND=dp), INTENT(IN)                :: g9
   REAL(KIND=dp), INTENT(IN)                :: gamma
   REAL(KIND=dp), INTENT(IN)                :: hh
   REAL(KIND=dp), INTENT(IN)                :: massdiff
   REAL(KIND=dp), INTENT(IN)                :: masssum
   REAL(KIND=dp), INTENT(IN)                :: ocose
   REAL(KIND=dp), INTENT(IN)                :: omega1
   REAL(KIND=dp), INTENT(IN)                :: omega2
   REAL(KIND=dp), INTENT(IN)                :: omega3
   REAL(KIND=dp), INTENT(IN)                :: omega4
   REAL(KIND=dp), INTENT(IN)                :: omega5
   REAL(KIND=dp), INTENT(IN)                :: omega6
   REAL(KIND=dp), INTENT(IN)                :: omega7
   REAL(KIND=dp), INTENT(IN)                :: omega8
   REAL(KIND=dp), INTENT(IN)                :: omega9
   REAL(KIND=dp), INTENT(IN)                :: omega10
   REAL(KIND=dp), INTENT(IN)                :: osine
   REAL(KIND=dp), INTENT(IN)                :: primk
   REAL(KIND=dp), INTENT(IN)                :: primmass
   REAL(KIND=dp), INTENT(IN)                :: primrad
   REAL(KIND=dp), INTENT(IN)                :: pshift
   REAL(KIND=dp), INTENT(IN)                :: rlx
   REAL(KIND=dp), INTENT(IN)                :: raddiff
   REAL(KIND=dp), INTENT(IN)                :: radsum
   REAL(KIND=dp), INTENT(IN)                :: ratrad
   REAL(KIND=dp), INTENT(IN)                :: rinner
   REAL(KIND=dp), INTENT(IN)                :: rk3
   REAL(KIND=dp), INTENT(IN)                :: rk4
   REAL(KIND=dp), INTENT(IN)                :: rk5
   REAL(KIND=dp), INTENT(IN)                :: rk6
   REAL(KIND=dp), INTENT(IN)                :: rk7
   REAL(KIND=dp), INTENT(IN)                :: rk8
   REAL(KIND=dp), INTENT(IN)                :: rk9
   REAL(KIND=dp), INTENT(IN)                :: rk10
   REAL(KIND=dp), INTENT(IN)                :: router
   REAL(KIND=dp), INTENT(IN)                :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint5(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint6(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint7(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint8(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint9(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint10(8)
   REAL(KIND=dp), INTENT(IN)                :: secmass
   REAL(KIND=dp), INTENT(IN)                :: secrad
   REAL(KIND=dp), INTENT(IN)                :: separ
   REAL(KIND=dp), INTENT(IN)                :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: sw1
   REAL(KIND=dp), INTENT(IN)                :: sw2
   REAL(KIND=dp), INTENT(IN)                :: sw23
   REAL(KIND=dp), INTENT(IN)                :: sw24
   REAL(KIND=dp), INTENT(IN)                :: sw25
   REAL(KIND=dp), INTENT(IN)                :: sw26
   REAL(KIND=dp), INTENT(IN)                :: sw27
   REAL(KIND=dp), INTENT(IN)                :: sw28
   REAL(KIND=dp), INTENT(IN)                :: sw29
   REAL(KIND=dp), INTENT(IN)                :: sw3
   REAL(KIND=dp), INTENT(IN)                :: sw30
   REAL(KIND=dp), INTENT(IN)                :: sw47
   REAL(KIND=dp), INTENT(IN)                :: sw48
   REAL(KIND=dp), INTENT(IN)                :: sw49
   REAL(KIND=dp), INTENT(IN)                :: sw5
   REAL(KIND=dp), INTENT(IN)                :: sw6
   REAL(KIND=dp), INTENT(IN)                :: sw7
   REAL(KIND=dp), INTENT(IN)                :: sw72
   REAL(KIND=dp), INTENT(IN)                :: sw73
   REAL(KIND=dp), INTENT(IN)                :: sw8
   REAL(KIND=dp), INTENT(IN)                :: sw80
   REAL(KIND=dp), INTENT(IN)                :: sw81
   REAL(KIND=dp), INTENT(IN)                :: sw82
   REAL(KIND=dp), INTENT(IN)                :: sw83
   REAL(KIND=dp), INTENT(IN)                :: sw84
   REAL(KIND=dp), INTENT(IN)                :: sw9
   REAL(KIND=dp), INTENT(IN)                :: t10
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: t6
   REAL(KIND=dp), INTENT(IN)                :: t7
   REAL(KIND=dp), INTENT(IN)                :: t8
   REAL(KIND=dp), INTENT(IN)                :: t9
   REAL(KIND=dp), INTENT(IN)                :: tdisk
   REAL(KIND=dp), INTENT(IN)                :: temprat
   REAL(KIND=dp), INTENT(IN)                :: tertomega
   REAL(KIND=dp), INTENT(IN)                :: tertq
   REAL(KIND=dp), INTENT(IN)                :: tertconj
   REAL(KIND=dp), INTENT(IN)                :: tertecos
   REAL(KIND=dp), INTENT(IN)                :: tertesin
   REAL(KIND=dp), INTENT(IN)                :: tertincl
   REAL(KIND=dp), INTENT(IN)                :: tertperiod
   REAL(KIND=dp), INTENT(IN)                :: tertratrad
   REAL(KIND=dp), INTENT(IN)                :: tertt0
   REAL(KIND=dp), INTENT(IN)                :: wave(8)
   REAL(KIND=dp), INTENT(IN)                :: xi
   INTEGER, INTENT(IN)                      :: iunit
   REAL(KIND=dp), INTENT(IN)                :: fracsum
   REAL(KIND=dp), INTENT(IN)                :: fracdiff
   REAL(KIND=dp), INTENT(IN)                :: bin2m3
   REAL(KIND=dp), INTENT(IN)                :: bin2m4
   REAL(KIND=dp), INTENT(IN)                :: bin2r3
   REAL(KIND=dp), INTENT(IN)                :: bin2r4
   REAL(KIND=dp), INTENT(IN)                :: sqecos
   REAL(KIND=dp), INTENT(IN)                :: sqesin
   REAL(KIND=dp), INTENT(IN)                :: sqtertecos
   REAL(KIND=dp), INTENT(IN)                :: sqtertesin
   REAL(KIND=dp), INTENT(IN)                :: sqp2ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp2esin
   REAL(KIND=dp), INTENT(IN)                :: sqp3ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp3esin
   REAL(KIND=dp), INTENT(IN)                :: sqp4ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp4esin
   REAL(KIND=dp), INTENT(IN)                :: sqp5ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp5esin
   REAL(KIND=dp), INTENT(IN)                :: sqp6ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp6esin
   REAL(KIND=dp), INTENT(IN)                :: sqp7ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp7esin
   REAL(KIND=dp), INTENT(IN)                :: sqp8ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp8esin
   REAL(KIND=dp), INTENT(IN)                :: angsum1
   REAL(KIND=dp), INTENT(IN)                :: angdiff1
   REAL(KIND=dp), INTENT(IN)                :: angsum2
   REAL(KIND=dp), INTENT(IN)                :: angdiff2
   REAL(KIND=dp), INTENT(IN)                :: angsum3
   REAL(KIND=dp), INTENT(IN)                :: angdiff3
   REAL(KIND=dp), INTENT(IN)                :: angsum4
   REAL(KIND=dp), INTENT(IN)                :: angdiff4
   REAL(KIND=dp), INTENT(IN)                :: angsum5
   REAL(KIND=dp), INTENT(IN)                :: angdiff5
   REAL(KIND=dp), INTENT(IN)                :: angsum6
   REAL(KIND=dp), INTENT(IN)                :: angdiff6
   REAL(KIND=dp), INTENT(IN)                :: angsum7
   REAL(KIND=dp), INTENT(IN)                :: angdiff7
   REAL(KIND=dp), INTENT(IN)                :: angsum8
   REAL(KIND=dp), INTENT(IN)                :: angdiff8
   INTEGER, INTENT(IN)                      :: imag
   REAL(KIND=dp), INTENT(IN)                :: fillsum
   REAL(KIND=dp), INTENT(IN)                :: filldiff
   REAL(KIND=dp), INTENT(IN)                :: binqtc
   REAL(KIND=dp), INTENT(IN)                :: p1qtc
   REAL(KIND=dp), INTENT(IN)                :: p2qtc
   REAL(KIND=dp), INTENT(IN)                :: p3qtc
   REAL(KIND=dp), INTENT(IN)                :: p4qtc
   REAL(KIND=dp), INTENT(IN)                :: p5qtc
   REAL(KIND=dp), INTENT(IN)                :: p6qtc
   REAL(KIND=dp), INTENT(IN)                :: p7qtc
   REAL(KIND=dp), INTENT(IN)                :: p8qtc
   REAL(KIND=dp), INTENT(IN)                :: tbinoff
   REAL(KIND=dp), INTENT(IN)                :: t1off
   REAL(KIND=dp), INTENT(IN)                :: t2off
   REAL(KIND=dp), INTENT(IN)                :: t3off
   REAL(KIND=dp), INTENT(IN)                :: t4off
   REAL(KIND=dp), INTENT(IN)                :: t5off
   REAL(KIND=dp), INTENT(IN)                :: t6off
   REAL(KIND=dp), INTENT(IN)                :: t7off
   REAL(KIND=dp), INTENT(IN)                :: t8off
   INTEGER, INTENT(IN OUT)                  :: iextension
   INTEGER, INTENT(IN)                      :: iversion
   REAL(KIND=dp), INTENT(IN)                :: tesscontam
   INTEGER, INTENT(IN)                      :: tessfilt
   REAL(KIND=dp), INTENT(IN)                :: tessbin
!
   INTEGER :: iu,ib,iv,ir,ii,ij,ih,ik
!
   REAL(KIND=dp)  :: fake
!
   CHARACTER(LEN=7) :: extension
!
   IF(iextension == -99)THEN
      OPEN(UNIT=1,FILE='bestELC.inp',STATUS='unknown')
   ELSE
      IF(iextension < 0)THEN
         OPEN(UNIT=1,FILE='gridELC.inp',STATUS='unknown')
      ELSE
         IF(iextension < 1000000)iextension=1000000
         WRITE(extension,5)iextension
         OPEN(UNIT=1,FILE='ELC.'//extension,STATUS='unknown')
      END IF
   END IF
!
   fake=0.0_dp
!
!  Modify the icn? flags so that they are either 0 or 1, which conforms
!  to the output format statement.
!
   IF(icnu == 430)THEN
      iu=0
   ELSE
      iu=1
   END IF
   IF(icnb == 430)THEN
      ib=0
   ELSE
      ib=1
   END IF
   IF(icnv == 430)THEN
      iv=0
   ELSE
      iv=1
   END IF
   IF(icnr == 430)THEN
      ir=0
   ELSE
      ir=1
   END IF
   IF(icni == 430)THEN
      ii=0
   ELSE
      ii=1
   END IF
   IF(icnj == 430)THEN
      ij=0
   ELSE
      ij=1
   END IF
   IF(icnh == 430)THEN
      ih=0
   ELSE
      ih=1
   END IF
   IF(icnk == 430)THEN
      ik=0
   ELSE
      ik=1
   END IF
!
!  update the header if version 1
!
   IF(iversion == 0)WRITE(1,10)
   IF(iversion == 1)WRITE(1,15)
   WRITE(1,20)
   WRITE(1,30)
   WRITE(1,20)
   WRITE(1,40)
   WRITE(1,20)
   WRITE(1,50)iunit
   WRITE(1,20)
   WRITE(1,60)
   WRITE(1,20)
   WRITE(1,70)isw7
   WRITE(1,80)sw23
   WRITE(1,90)sw24
   WRITE(1,100)sw9
   WRITE(1,110)dphase
   WRITE(1,20)
   WRITE(1,120)
   WRITE(1,20)
   WRITE(1,130)iatm
   WRITE(1,140)iu,ib,iv,ir,ii,ij,ih,ik
   WRITE(1,150)irvfilt
   WRITE(1,160)ilaw
   WRITE(1,170)wave(1),1
   WRITE(1,170)wave(2),2
   WRITE(1,170)wave(3),3
   WRITE(1,170)wave(4),4
   WRITE(1,170)wave(5),5
   WRITE(1,170)wave(6),6
   WRITE(1,170)wave(7),7
   WRITE(1,170)wave(8),8
   WRITE(1,180)nref
   WRITE(1,190)rlx
   WRITE(1,200)isw25
   WRITE(1,210)idark1
   WRITE(1,220)idark2
   WRITE(1,230)isw5
   WRITE(1,240)isw6
   WRITE(1,250)isw86
   WRITE(1,20)
   WRITE(1,260)
   WRITE(1,20)
   WRITE(1,270)t3
   WRITE(1,280)g3
   WRITE(1,290)sa3
   WRITE(1,20)
   WRITE(1,300)
   WRITE(1,20)
   WRITE(1,310)isw27
   WRITE(1,320)isw33
   WRITE(1,330)isw31
   WRITE(1,340)iecheck
   WRITE(1,350)ism1
   WRITE(1,360)isw13
   WRITE(1,370)isw8
   WRITE(1,380)sw7
   WRITE(1,390)sw8
   WRITE(1,20)
   WRITE(1,400)
   WRITE(1,20)
   WRITE(1,410)isw2
   WRITE(1,420)isw3
   WRITE(1,430)sw2
   WRITE(1,440)sw3
   WRITE(1,20)
   WRITE(1,450)
   WRITE(1,20)
   WRITE(1,460)idraw
   WRITE(1,470)isw1
   WRITE(1,480)sw1
   WRITE(1,20)
   WRITE(1,490)
   WRITE(1,20)
   WRITE(1,500)pshift
   WRITE(1,510)ikeep
   WRITE(1,520)isynch
   WRITE(1,530)isw21
   WRITE(1,540)isw28
   WRITE(1,550)isw29
   WRITE(1,20)
   WRITE(1,560)
   WRITE(1,20)
   WRITE(1,570)imag
   WRITE(1,580)isw9
   WRITE(1,590)isw4
   WRITE(1,600)isw23
   WRITE(1,610)isw24
   WRITE(1,620)isw22
   WRITE(1,630)it4
   WRITE(1,640)sw48
   WRITE(1,650)sw6
   WRITE(1,660)isw32
   WRITE(1,20)
   WRITE(1,670)
   WRITE(1,20)
   WRITE(1,680)isw88
   WRITE(1,690)sw47
   WRITE(1,700)hh
   WRITE(1,710)isw26
   WRITE(1,720)isw80
   WRITE(1,730)itconj
   WRITE(1,740)it1
   WRITE(1,750)isw100
   WRITE(1,760)it3
   WRITE(1,770)isw81
   WRITE(1,780)isw85
   WRITE(1,790)sw84
   WRITE(1,800)it2
   WRITE(1,20)
   WRITE(1,810)
   WRITE(1,20)
   WRITE(1,820)contam
   WRITE(1,830)isw34
   WRITE(1,840)contams0
   WRITE(1,850)contams1
   WRITE(1,860)contams2
   WRITE(1,870)contams3
   WRITE(1,880)nseg
   WRITE(1,890)isw87
   WRITE(1,900)sw29
   WRITE(1,910)sw30
   WRITE(1,920)isw89
!
!  If iversion=1, then add the TESS block
!
   IF(iversion == 1)THEN
      WRITE(2,921)
      WRITE(2,922)
      WRITE(2,923)
      WRITE(2,924)tesscontam
      WRITE(2,925)tessfilt
      WRITE(2,926)tessbin
   END IF
   WRITE(1,20)
   WRITE(1,930)
   WRITE(1,20)
   WRITE(1,940)isw30
   WRITE(1,20)
   WRITE(1,950)
   WRITE(1,20)
   WRITE(1,960)period
   WRITE(1,970)t0
   WRITE(1,980)tconj
   WRITE(1,990)pbptc
   WRITE(1,1000)pbmtc
   WRITE(1,1010)binqtc
   WRITE(1,1020)tbinoff
   WRITE(1,1030)ecc
   WRITE(1,1040)argper
   WRITE(1,1050)ocose
   WRITE(1,1060)osine
   WRITE(1,1070)sqecos
   WRITE(1,1080)sqesin
   WRITE(1,1090)finc
   WRITE(1,1100)sw49
   WRITE(1,1110)primk
   WRITE(1,1120)separ
   WRITE(1,1130)gamma
   WRITE(1,1140)ecosw
   WRITE(1,20)
   WRITE(1,1150)
   WRITE(1,20)
   WRITE(1,1160)nalph1,nbet1
   WRITE(1,1170)teff1
   WRITE(1,1180)tgrav1
   WRITE(1,1190)alb1
   WRITE(1,1200)omega1
   WRITE(1,1210)fill1
   WRITE(1,1220)primrad
   WRITE(1,1230)frac1
   WRITE(1,1240)sw27
   WRITE(1,1250)primmass
   WRITE(1,1260)bigi
   WRITE(1,1270)bigbeta
   WRITE(1,1280)dwavex(1,1),dwavey(1,1)
   WRITE(1,1290)dwavex(2,1),dwavey(2,1)
   WRITE(1,1300)dwavex(3,1),dwavey(3,1)
   WRITE(1,1310)dwavex(4,1),dwavey(4,1)
   WRITE(1,1320)dwavex(5,1),dwavey(5,1)
   WRITE(1,1330)dwavex(6,1),dwavey(6,1)
   WRITE(1,1340)dwavex(7,1),dwavey(7,1)
   WRITE(1,1350)dwavex(8,1),dwavey(8,1)
   WRITE(1,1360)dbolx(1,1),dboly(1,1)
   WRITE(1,1370)spot1parm(1,1)
   WRITE(1,1380)spot1parm(1,2)
   WRITE(1,1390)spot1parm(1,3)
   WRITE(1,1400)spot1parm(1,4)
   WRITE(1,1410)spot1parm(2,1)
   WRITE(1,1420)spot1parm(2,2)
   WRITE(1,1430)spot1parm(2,3)
   WRITE(1,1440)spot1parm(2,4)
   WRITE(1,1450)beam1
   WRITE(1,1460)sw72
   WRITE(1,1470)sdarkint1(1)
   WRITE(1,1480)sdarkint1(2)
   WRITE(1,1490)sdarkint1(3)
   WRITE(1,1500)sdarkint1(4)
   WRITE(1,1510)sdarkint1(5)
   WRITE(1,1520)sdarkint1(6)
   WRITE(1,1530)sdarkint1(7)
   WRITE(1,1540)sdarkint1(8)
   WRITE(1,20)
   WRITE(1,1550)
   WRITE(1,20)
   WRITE(1,1560)nalph2,nbet2
   WRITE(1,1570)teff2
   WRITE(1,1580)temprat
   WRITE(1,1590)tgrav2
   WRITE(1,1600)alb2
   WRITE(1,1610)omega2
   WRITE(1,1620)fill2
   WRITE(1,1630)fillsum
   WRITE(1,1640)filldiff
   WRITE(1,1650)secrad
   WRITE(1,1660)frac2
   WRITE(1,1670)ratrad
   WRITE(1,1680)radsum
   WRITE(1,1690)raddiff
   WRITE(1,1700)fracsum
   WRITE(1,1710)fracdiff
   WRITE(1,1720)sw28
   WRITE(1,1730)q
   WRITE(1,1740)secmass
   WRITE(1,1750)masssum
   WRITE(1,1760)massdiff
   WRITE(1,1770)bigi2
   WRITE(1,1780)bigbeta2
   WRITE(1,1790)dwavex(1,2),dwavey(1,2)
   WRITE(1,1800)dwavex(2,2),dwavey(2,2)
   WRITE(1,1810)dwavex(3,2),dwavey(3,2)
   WRITE(1,1820)dwavex(4,2),dwavey(4,2)
   WRITE(1,1830)dwavex(5,2),dwavey(5,2)
   WRITE(1,1840)dwavex(6,2),dwavey(6,2)
   WRITE(1,1850)dwavex(7,2),dwavey(7,2)
   WRITE(1,1860)dwavex(8,2),dwavey(8,2)
   WRITE(1,1870)dbolx(1,2),dboly(1,2)
   WRITE(1,1880)spot2parm(1,1)
   WRITE(1,1890)spot2parm(1,2)
   WRITE(1,1900)spot2parm(1,3)
   WRITE(1,1910)spot2parm(1,4)
   WRITE(1,1920)spot2parm(2,1)
   WRITE(1,1930)spot2parm(2,2)
   WRITE(1,1940)spot2parm(2,3)
   WRITE(1,1950)spot2parm(2,4)
   WRITE(1,1960)beam2
   WRITE(1,1970)sw73
   WRITE(1,1980)sdarkint2(1)
   WRITE(1,1990)sdarkint2(2)
   WRITE(1,2000)sdarkint2(3)
   WRITE(1,2010)sdarkint2(4)
   WRITE(1,2020)sdarkint2(5)
   WRITE(1,2030)sdarkint2(6)
   WRITE(1,2040)sdarkint2(7)
   WRITE(1,2050)sdarkint2(8)
   WRITE(1,20)
   WRITE(1,2060)
   WRITE(1,20)
   WRITE(1,2070)iidint
   WRITE(1,2080)ntheta
   WRITE(1,2090)nradius
   WRITE(1,2100)betarim
   WRITE(1,2110)rinner
   WRITE(1,2120)router
   WRITE(1,2130)tdisk
   WRITE(1,2140)xi
   WRITE(1,2150)spotdparm(1,1)
   WRITE(1,2160)spotdparm(1,2)
   WRITE(1,2170)spotdparm(1,3)
   WRITE(1,2180)spotdparm(1,4)
   WRITE(1,2190)spotdparm(2,1)
   WRITE(1,2200)spotdparm(2,2)
   WRITE(1,2210)spotdparm(2,3)
   WRITE(1,2220)spotdparm(2,4)
   WRITE(1,2230)sw26
   WRITE(1,20)
   WRITE(1,2240)
   WRITE(1,20)
   WRITE(1,2250)sw5
   WRITE(1,2260)sw25
!
!  If Nbody < 3, then we are done.
!
   IF(isw30 < 3)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,2270)
   WRITE(1,20)
   WRITE(1,2280)tertconj
   WRITE(1,2290)tertperiod
   WRITE(1,2300)p1ptc
   WRITE(1,2310)p1mtc
   WRITE(1,2320)p1qtc
   WRITE(1,2330)t1off
   WRITE(1,2340)tertt0
   WRITE(1,2350)tertecos
   WRITE(1,2360)tertesin
   WRITE(1,2370)sqtertecos
   WRITE(1,2380)sqtertesin
   WRITE(1,2390)tertincl
   WRITE(1,2400)tertomega
   WRITE(1,2410)angsum1
   WRITE(1,2420)angdiff1
   WRITE(1,20)
   WRITE(1,2430)
   WRITE(1,20)
   WRITE(1,2440)nalph3,nbet3
   WRITE(1,2450)t3
   WRITE(1,2460)g3
   WRITE(1,2470)tertratrad
   WRITE(1,2480)tertq
   WRITE(1,2490)omega3
   WRITE(1,2500)bigi3
   WRITE(1,2510)bigbeta3
   WRITE(1,2520)dwavex(1,3),dwavey(1,3)
   WRITE(1,2530)dwavex(2,3),dwavey(2,3)
   WRITE(1,2540)dwavex(3,3),dwavey(3,3)
   WRITE(1,2550)dwavex(4,3),dwavey(4,3)
   WRITE(1,2560)dwavex(5,3),dwavey(5,3)
   WRITE(1,2570)dwavex(6,3),dwavey(6,3)
   WRITE(1,2580)dwavex(7,3),dwavey(7,3)
   WRITE(1,2590)dwavex(8,3),dwavey(8,3)
   WRITE(1,2600)rk3
   WRITE(1,2610)sdarkint3(1)
   WRITE(1,2620)sdarkint3(2)
   WRITE(1,2630)sdarkint3(3)
   WRITE(1,2640)sdarkint3(4)
   WRITE(1,2650)sdarkint3(5)
   WRITE(1,2660)sdarkint3(6)
   WRITE(1,2670)sdarkint3(7)
   WRITE(1,2680)sdarkint3(8)
!
!  If Nbody < 4, then we are done.
!
   IF(isw30 < 4)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,2690)
   WRITE(1,20)
   WRITE(1,2700)p2tconj
   WRITE(1,2710)p2period
   WRITE(1,2720)p2ptc
   WRITE(1,2730)p2mtc
   WRITE(1,2740)p2qtc
   WRITE(1,2750)t2off
   WRITE(1,2760)p2t0
   WRITE(1,2770)p2ecos
   WRITE(1,2780)p2esin
   WRITE(1,2790)sqp2ecos
   WRITE(1,2800)sqp2esin
   WRITE(1,2810)p2incl
   WRITE(1,2820)p2omega
   WRITE(1,2830)angsum2
   WRITE(1,2840)angdiff2
   WRITE(1,20)
   WRITE(1,2850)
   WRITE(1,20)
   WRITE(1,2860)sw80
   WRITE(1,2870)sw82
   WRITE(1,2880)p2ratrad
   WRITE(1,2890)p2q
   WRITE(1,2900)omega4
   WRITE(1,2910)bigi4
   WRITE(1,2920)bigbeta4
   WRITE(1,2930)dwavex(1,4),dwavey(1,4)
   WRITE(1,2940)dwavex(2,4),dwavey(2,4)
   WRITE(1,2950)dwavex(3,4),dwavey(3,4)
   WRITE(1,2960)dwavex(4,4),dwavey(4,4)
   WRITE(1,2970)dwavex(5,4),dwavey(5,4)
   WRITE(1,2980)dwavex(6,4),dwavey(6,4)
   WRITE(1,2990)dwavex(7,4),dwavey(7,4)
   WRITE(1,3000)dwavex(8,4),dwavey(8,4)
   WRITE(1,3010)rk4
   WRITE(1,3020)sdarkint4(1)
   WRITE(1,3030)sdarkint4(2)
   WRITE(1,3040)sdarkint4(3)
   WRITE(1,3050)sdarkint4(4)
   WRITE(1,3060)sdarkint4(5)
   WRITE(1,3070)sdarkint4(6)
   WRITE(1,3080)sdarkint4(7)
   WRITE(1,3090)sdarkint4(8)
   WRITE(1,20)
   WRITE(1,3100)
   WRITE(1,20)
   WRITE(1,3110)b2masssum
   WRITE(1,3120)b2massdiff
   WRITE(1,3130)bin2q
   WRITE(1,3140)b2radsum
   WRITE(1,3150)b2raddiff
   WRITE(1,3160)bin2ratrad
   WRITE(1,3170)bin2m3
   WRITE(1,3180)bin2m4
   WRITE(1,3190)bin2r3
   WRITE(1,3200)bin2r4
!
!  If Nbody < 5, then we are done.
!
   IF(isw30 < 5)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,3210)
   WRITE(1,20)
   WRITE(1,3220)p3tconj
   WRITE(1,3230)p3period
   WRITE(1,3240)p3ptc
   WRITE(1,3250)p3mtc
   WRITE(1,3260)p3qtc
   WRITE(1,3270)t3off
   WRITE(1,3280)p3t0
   WRITE(1,3290)p3ecos
   WRITE(1,3300)p3esin
   WRITE(1,3310)sqp3ecos
   WRITE(1,3320)sqp3esin
   WRITE(1,3330)p3incl
   WRITE(1,3340)p3omega
   WRITE(1,3350)angsum3
   WRITE(1,3360)angdiff3
   WRITE(1,20)
   WRITE(1,3370)
   WRITE(1,20)
   WRITE(1,3380)sw81
   WRITE(1,3390)sw83
   WRITE(1,3400)p3ratrad
   WRITE(1,3410)p3q
   WRITE(1,3420)omega5
   WRITE(1,3430)fake
   WRITE(1,3440)fake
   WRITE(1,3450)dwavex(1,5),dwavey(1,5)
   WRITE(1,3460)dwavex(2,5),dwavey(2,5)
   WRITE(1,3470)dwavex(3,5),dwavey(3,5)
   WRITE(1,3480)dwavex(4,5),dwavey(4,5)
   WRITE(1,3490)dwavex(5,5),dwavey(5,5)
   WRITE(1,3500)dwavex(6,5),dwavey(6,5)
   WRITE(1,3510)dwavex(7,5),dwavey(7,5)
   WRITE(1,3520)dwavex(8,5),dwavey(8,5)
   WRITE(1,3530)rk5
   WRITE(1,3540)sdarkint5(1)
   WRITE(1,3550)sdarkint5(2)
   WRITE(1,3560)sdarkint5(3)
   WRITE(1,3570)sdarkint5(4)
   WRITE(1,3580)sdarkint5(5)
   WRITE(1,3590)sdarkint5(6)
   WRITE(1,3600)sdarkint5(7)
   WRITE(1,3610)sdarkint5(8)
!
!  If Nbody < 6, then we are done.
!
   IF(isw30 < 6)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,3620)
   WRITE(1,20)
   WRITE(1,3630)p4tconj
   WRITE(1,3640)p4period
   WRITE(1,3650)p4ptc
   WRITE(1,3660)p4mtc
   WRITE(1,3670)p4qtc
   WRITE(1,3680)t4off
   WRITE(1,3690)p4t0
   WRITE(1,3700)p4ecos
   WRITE(1,3710)p4esin
   WRITE(1,3720)sqp4ecos
   WRITE(1,3730)sqp4esin
   WRITE(1,3740)p4incl
   WRITE(1,3750)p4omega
   WRITE(1,3760)angsum4
   WRITE(1,3770)angdiff4
   WRITE(1,20)
   WRITE(1,3780)
   WRITE(1,20)
   WRITE(1,3790)t6
   WRITE(1,3800)g6
   WRITE(1,3810)p4ratrad
   WRITE(1,3820)p4q
   WRITE(1,3830)omega6
   WRITE(1,3840)fake
   WRITE(1,3850)fake
   WRITE(1,3860)dwavex(1,6),dwavey(1,6)
   WRITE(1,3870)dwavex(2,6),dwavey(2,6)
   WRITE(1,3880)dwavex(3,6),dwavey(3,6)
   WRITE(1,3890)dwavex(4,6),dwavey(4,6)
   WRITE(1,3900)dwavex(5,6),dwavey(5,6)
   WRITE(1,3910)dwavex(6,6),dwavey(6,6)
   WRITE(1,3920)dwavex(7,6),dwavey(7,6)
   WRITE(1,3930)dwavex(8,6),dwavey(8,6)
   WRITE(1,3940)rk6
   WRITE(1,3950)sdarkint6(1)
   WRITE(1,3960)sdarkint6(2)
   WRITE(1,3970)sdarkint6(3)
   WRITE(1,3980)sdarkint6(4)
   WRITE(1,3990)sdarkint6(5)
   WRITE(1,4000)sdarkint6(6)
   WRITE(1,4010)sdarkint6(7)
   WRITE(1,4020)sdarkint6(8)
!
!  If Nbody < 7, then we are done.
!
   IF(isw30 < 7)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,4030)
   WRITE(1,20)
   WRITE(1,4040)p5tconj
   WRITE(1,4050)p5period
   WRITE(1,4060)p5ptc
   WRITE(1,4070)p5mtc
   WRITE(1,4080)p5qtc
   WRITE(1,4090)t5off
   WRITE(1,4100)p5t0
   WRITE(1,4110)p5ecos
   WRITE(1,4120)p5esin
   WRITE(1,4130)sqp5ecos
   WRITE(1,4140)sqp5esin
   WRITE(1,4150)p5incl
   WRITE(1,4160)p5omega
   WRITE(1,4170)angsum5
   WRITE(1,4180)angdiff5
   WRITE(1,20)
   WRITE(1,4190)
   WRITE(1,20)
   WRITE(1,4200)t7
   WRITE(1,4210)g7
   WRITE(1,4220)p5ratrad
   WRITE(1,4230)p5q
   WRITE(1,4240)omega7
   WRITE(1,4250)fake
   WRITE(1,4260)fake
   WRITE(1,4270)dwavex(1,7),dwavey(1,7)
   WRITE(1,4280)dwavex(2,7),dwavey(2,7)
   WRITE(1,4290)dwavex(3,7),dwavey(3,7)
   WRITE(1,4300)dwavex(4,7),dwavey(4,7)
   WRITE(1,4310)dwavex(5,7),dwavey(5,7)
   WRITE(1,4320)dwavex(6,7),dwavey(6,7)
   WRITE(1,4330)dwavex(7,7),dwavey(7,7)
   WRITE(1,4340)dwavex(8,7),dwavey(8,7)
   WRITE(1,4350)rk7
   WRITE(1,4360)sdarkint7(1)
   WRITE(1,4370)sdarkint7(2)
   WRITE(1,4380)sdarkint7(3)
   WRITE(1,4390)sdarkint7(4)
   WRITE(1,4400)sdarkint7(5)
   WRITE(1,4410)sdarkint7(6)
   WRITE(1,4420)sdarkint7(7)
   WRITE(1,4430)sdarkint7(8)
!
!  If Nbody < 8, then we re done.
!
   IF(isw30 < 8)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,4440)
   WRITE(1,20)
   WRITE(1,4450)p6tconj
   WRITE(1,4460)p6period
   WRITE(1,4470)p6ptc
   WRITE(1,4480)p6mtc
   WRITE(1,4490)p6qtc
   WRITE(1,4500)t6off
   WRITE(1,4510)p6t0
   WRITE(1,4520)p6ecos
   WRITE(1,4530)p6esin
   WRITE(1,4540)sqp6ecos
   WRITE(1,4550)sqp6esin
   WRITE(1,4560)p6incl
   WRITE(1,4570)p6omega
   WRITE(1,4580)angsum6
   WRITE(1,4590)angdiff6
   WRITE(1,20)
   WRITE(1,4600)
   WRITE(1,20)
   WRITE(1,4610)t8
   WRITE(1,4620)g8
   WRITE(1,4630)p6ratrad
   WRITE(1,4640)p6q
   WRITE(1,4650)omega8
   WRITE(1,4660)fake
   WRITE(1,4670)fake
   WRITE(1,4680)dwavex(1,8),dwavey(1,8)
   WRITE(1,4690)dwavex(2,8),dwavey(2,8)
   WRITE(1,4700)dwavex(3,8),dwavey(3,8)
   WRITE(1,4710)dwavex(4,8),dwavey(4,8)
   WRITE(1,4720)dwavex(5,8),dwavey(5,8)
   WRITE(1,4730)dwavex(6,8),dwavey(6,8)
   WRITE(1,4740)dwavex(7,8),dwavey(7,8)
   WRITE(1,4750)dwavex(8,8),dwavey(8,8)
   WRITE(1,4760)rk8
   WRITE(1,4770)sdarkint8(1)
   WRITE(1,4780)sdarkint8(2)
   WRITE(1,4790)sdarkint8(3)
   WRITE(1,4800)sdarkint8(4)
   WRITE(1,4810)sdarkint8(5)
   WRITE(1,4820)sdarkint8(6)
   WRITE(1,4830)sdarkint8(7)
   WRITE(1,4840)sdarkint8(8)
!
!  If Nbody < 9, then we are done.
!
   IF(isw30 < 9)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,4850)
   WRITE(1,20)
   WRITE(1,4860)p7tconj
   WRITE(1,4870)p7period
   WRITE(1,4880)p7ptc
   WRITE(1,4890)p7mtc
   WRITE(1,4900)p7qtc
   WRITE(1,4910)t7off
   WRITE(1,4920)p7t0
   WRITE(1,4930)p7ecos
   WRITE(1,4940)p7esin
   WRITE(1,4950)sqp7ecos
   WRITE(1,4960)sqp7esin
   WRITE(1,4970)p7incl
   WRITE(1,4980)p7omega
   WRITE(1,4990)angsum7
   WRITE(1,5000)angdiff7
   WRITE(1,20)
   WRITE(1,5010)
   WRITE(1,20)
   WRITE(1,5020)t9
   WRITE(1,5030)g9
   WRITE(1,5040)p7ratrad
   WRITE(1,5050)p7q
   WRITE(1,5060)omega9
   WRITE(1,5070)fake
   WRITE(1,5080)fake
   WRITE(1,5090)dwavex(1,9),dwavey(1,9)
   WRITE(1,5100)dwavex(2,9),dwavey(2,9)
   WRITE(1,5110)dwavex(3,9),dwavey(3,9)
   WRITE(1,5120)dwavex(4,9),dwavey(4,9)
   WRITE(1,5130)dwavex(5,9),dwavey(5,9)
   WRITE(1,5140)dwavex(6,9),dwavey(6,9)
   WRITE(1,5150)dwavex(7,9),dwavey(7,9)
   WRITE(1,5160)dwavex(8,9),dwavey(8,9)
   WRITE(1,5170)rk9
   WRITE(1,5180)sdarkint9(1)
   WRITE(1,5190)sdarkint9(2)
   WRITE(1,5200)sdarkint9(3)
   WRITE(1,5210)sdarkint9(4)
   WRITE(1,5220)sdarkint9(5)
   WRITE(1,5230)sdarkint9(6)
   WRITE(1,5240)sdarkint9(7)
   WRITE(1,5250)sdarkint9(8)
!
!  If Nbody < 10, then we are done.
!
   IF(isw30 < 10)THEN
      CLOSE(1)
      RETURN
   END IF
!
   WRITE(1,20)
   WRITE(1,5260)
   WRITE(1,20)
   WRITE(1,5270)p8tconj
   WRITE(1,5280)p8period
   WRITE(1,5290)p8ptc
   WRITE(1,5300)p8mtc
   WRITE(1,5310)p8qtc
   WRITE(1,5320)t8off
   WRITE(1,5330)p8t0
   WRITE(1,5340)p8ecos
   WRITE(1,5350)p8esin
   WRITE(1,5360)sqp8ecos
   WRITE(1,5370)sqp8esin
   WRITE(1,5380)p8incl
   WRITE(1,5390)p8omega
   WRITE(1,5400)angsum8
   WRITE(1,5410)angdiff8
   WRITE(1,20)
   WRITE(1,5420)
   WRITE(1,20)
   WRITE(1,5430)t10
   WRITE(1,5440)g10
   WRITE(1,5450)p8ratrad
   WRITE(1,5460)p8q
   WRITE(1,5470)omega10
   WRITE(1,5480)fake
   WRITE(1,5490)fake
   WRITE(1,5500)dwavex(1,10),dwavey(1,10)
   WRITE(1,5510)dwavex(2,10),dwavey(2,10)
   WRITE(1,5520)dwavex(3,10),dwavey(3,10)
   WRITE(1,5530)dwavex(4,10),dwavey(4,10)
   WRITE(1,5540)dwavex(5,10),dwavey(5,10)
   WRITE(1,5550)dwavex(6,10),dwavey(6,10)
   WRITE(1,5560)dwavex(7,10),dwavey(7,10)
   WRITE(1,5570)dwavex(8,10),dwavey(8,10)
   WRITE(1,5580)rk10
   WRITE(1,5590)sdarkint10(1)
   WRITE(1,5600)sdarkint10(2)
   WRITE(1,5610)sdarkint10(3)
   WRITE(1,5620)sdarkint10(4)
   WRITE(1,5630)sdarkint10(5)
   WRITE(1,5640)sdarkint10(6)
   WRITE(1,5650)sdarkint10(7)
   WRITE(1,5660)sdarkint10(8)
!
   CLOSE(1)
!
5  FORMAT(i7)
10 FORMAT('#1 New version 7 input, this line required')
15 FORMAT('#2 New version 7.1 input, this line required')
20 FORMAT('!')
30 FORMAT('!  Lines starting with # or ! can be inserted',' anyw'  &
      ,'here')
40 FORMAT('!  Units')
50 FORMAT(i1,24X,'iunit')
60 FORMAT('!  Parameters for light curve sampling')
70 FORMAT(i1,24X,'itime')
80 FORMAT(f15.8,10X,'t_start (if itime=2)')
90 FORMAT(f15.8,10X,'t_end   (if itime=2)')
100 FORMAT(f11.8,14X,'time step in days (if itime=2)')
110 FORMAT(f10.6,15X,'dphase in degrees (if itime=0 or 1)')
120 FORMAT('!  Control flags for filters and limb darkening')
130 FORMAT(i1,24X,'iatm (0 for black body)')
140 FORMAT(8(i1,1X),9X,'icnU,icnB,icnV,icnR,icnI,icnJ,icnH,icnK')
150 FORMAT(i1,24X,'iRVfilt')
160 FORMAT(i3,22X,'ilaw (1=lin., 2=log, 3=sqrt, 4=quad,',' 5=Kipp'  &
      ,'ing quad)')
170 FORMAT(f11.4,14X,'central wavelength for filter ',i1,' when i'  &
      ,'atm=0')
180 FORMAT(i2,23X,'Nref')
190 FORMAT(f10.5,15X,'log10(Lx) in erg/sec, tag Lx')
200 FORMAT(i1,24X,'X-ray foreshortening switch (1 for',' point so'  &
      ,'urce)')
210 FORMAT(i1,24X,'idark1')
220 FORMAT(i1,24X,'idark2')
230 FORMAT(i1,24X,'ispotprof (0=constant, 1=linear, ','2=Gaussian'  &
      ,' change in temperature profile')
240 FORMAT(i1,24X,'igrav')
250 FORMAT(i1,24X,'set to 1 to use fluxes')
260 FORMAT('!  Third light parameters')
270 FORMAT(f18.10,7X,'T3 (Kelvin), tag t3')
280 FORMAT(f15.11,10X,'g3 (log(g) in c.g.s), tag g3')
290 FORMAT(f22.16,3X,'SA3 (ratio of body 1 to body 3 areas),',' t'  &
      ,'ag SA')
300 FORMAT('!  Control flags related to speed and accuracy')
310 FORMAT(i6,19X,'Nterms for fast analytic')
320 FORMAT(i1,24X,'mandel (0 for Gimenez, 1 for Mandel &',' Agol)' )
330 FORMAT(i4,21X,'Ngap')
340 FORMAT(i2,23X,'iecheck')
350 FORMAT(i1,24X,'ism1')
360 FORMAT(i1,24X,'ifasttrans (>0 for fast transit mode)')
370 FORMAT(i6,19X,'MonteCarlo (0 for interpolation, >10 ','for Mo'  &
      ,'nte Carlo integration)')
380 FORMAT(f12.6,13X,'phaselow  (phase range if phaselow>0 and',''  &
      ,' phasehigh>0')
390 FORMAT(f12.6,13X,'phasehigh  and phaselow < phasehigh)')
400 FORMAT('!  Control flags for Roche geometry')
410 FORMAT(i1,24X,'isquare')
420 FORMAT(i1,24X,'iusepot')
430 FORMAT(f12.6,13X,'usepot1')
440 FORMAT(f12.6,13X,'usepot2')
450 FORMAT('!  Drawing flags')
460 FORMAT(i1,24X,'idraw (1 to write output drawing files)')
470 FORMAT(i1,24X,'ionephase')
480 FORMAT(f12.6,13X,'onephase')
490 FORMAT('!  Control flags for orbital elements')
500 FORMAT(f12.9,13X,'pshift, tag ps')
510 FORMAT(i1,24X,'ikeep (1 to put primary eclipse at phase 0.0)')
520 FORMAT(i1,24X,'isynch (1 to keep rotation synchronous',' at p'  &
      ,'eriastron)')
530 FORMAT(i1,24X,'ialign (0 for rotation aligned with orbit)')
540 FORMAT(i1,24X,'set to 1 to fit for Tconj of binary')
550 FORMAT(i1,24X,'set to 1 to fit for e*cos(omega), ','e*sin(ome'  &
      ,'ga) of binary')
560 FORMAT('!  Control flags for use with optimizers')
570 FORMAT(i2,23X,'imag ','(0 for input data in mag, 1 for input '  &
      ,'data in flux)')
580 FORMAT(i4,21X,'ielite')
590 FORMAT(i2,23X,'ifixgamma (0, 1, 2) or (10, 11, 12)')
600 FORMAT(i1,24X,'iwriteeclipse (1 to fit for eclipse times ','w'  &
      ,'hen Nbody >=3 and itime=2)')
610 FORMAT(i1,24X,'frac switch (>1 to enable ELCratio.* files)')
620 FORMAT(i1,24X,'set to 1 to supress optimizer screen output')
630 FORMAT(i1,24X,'set to 1 to supress demcmcELC output files')
640 FORMAT(f15.5,10X,'chi^2 threshold to write to output files')
650 FORMAT(f3.1,22X,'median fit (0 for chi^2, >0 for median)')
660 FORMAT(i14,11X,'jdum (seed for markovELC, geneticELC, ','rand'  &
      ,'omELC, demcmcELC, hammerELC)')
670 FORMAT('!  Control flags and parameters for use with ','the d'  &
      ,'ynamical integrator (Nbody >=3)')
680 FORMAT(i2,23X,'Ndynwin (number of segments to integrate)')
690 FORMAT(f15.6,10X,'Tref for dynamical integrator (Nbody >=3)')
700 FORMAT(f8.5,17X,'hh (step size in days)')
710 FORMAT(i1,24X,'iGR (1 for GR, 2 for tidal, 3 for both)')
720 FORMAT(i1,24X,'set to 1 for binary+binary model (use ','Nbody'  &
      ,'=4)')
730 FORMAT(i1,24X,'itconj (0=T_peri, 1=T_tran, 2=T_occul)')
740 FORMAT(i1,24X,'set to 1 for logarithmic mass ratios')
750 FORMAT(i1,24X,'set to 1 for planet radii in Earth radii')
760 FORMAT(i1,24X,'set to 1 to treat transits and occultations ',  &
      'together')
770 FORMAT(i1,24X,'set to 1 for transit penalty')
780 FORMAT(i1,24X,'set to 1 for secondary eclipse penalty')
790 FORMAT(f15.4,10X,'chi^2 penalty for transit or secondary ','e'  &
      ,'clipse')
800 FORMAT(i1,24X,'set to 1 for informational output (ELC only)')
810 FORMAT('! Features for Kepler data')
820 FORMAT(f16.13,9X,'Kepler contamination, tag co')
830 FORMAT(i1,24X,'Iseason (1 for seasonal Kepler contamination)')
840 FORMAT(f16.13,9X,'contamS0 (season 0 contamination, tag s0)')
850 FORMAT(f16.13,9X,'contamS1 (season 1 contamination, tag s1)')
860 FORMAT(f16.13,9X,'contamS2 (season 2 contamination, tag s2)')
870 FORMAT(f16.13,9X,'contamS3 (season 3 contamination, tag s3)')
880 FORMAT(i4,21X,'Nseg (number of segments to fit for','contamin'  &
      ,'ation)')
890 FORMAT(i1,24X,'set to 1 for fast Kepler binning')
900 FORMAT(f10.5,15X,'bin size for light curves (minutes)')
910 FORMAT(f10.5,15X,'bin size for RV curves (minutes)')
920 FORMAT(i2,23X,'NSC (number of short cadence intervals)')
!
!  If iversion=1, then add the TESS block
!
921 FORMAT('!')
922 FORMAT('! Features for TESS data')
923 FORMAT('!')
924 FORMAT(f16.13,9X,'TESS contamination, tag ct')
925 FORMAT(i1,24X,'TESS filter in ELC.atm')
926 FORMAT(f10.5,15X,'bin size for TESS light curve (minutes)')
!
930 FORMAT('!  Number of bodies (2 to 10)')
940 FORMAT(i2,23X,'Nbody')
950 FORMAT('!  Binary orbit parameters')
960 FORMAT(f22.15,3X,'Period (days), tag pe')
970 FORMAT(f22.15,3X,'T0 (time of periastron passage), tag T0')
980 FORMAT(f22.15,3X,'Tconj (time of primary eclipse), tag Tc')
990 FORMAT(f20.13,5X,'PbpTc (period + Tconj for binary), tag bp')
1000 FORMAT(f20.13,5X,'PbmTc (period - Tconj for binary), tag bm')
1010 FORMAT(f17.12,8X,'binqTc (slope in P-Tc plane for binary),',  &
      1X,'tag bq')
1020 FORMAT(f21.12,4X,'Tbinoff (offset in P-Tc plane for binary),',  &
      1X,'tag bt')
1030 FORMAT(f15.13,10X,'eccentricity, tag ec')
1040 FORMAT(f19.13,6X,'argument of periaston in degrees, tag ar')
1050 FORMAT(f20.17,5X,'e*cos(omega), tag oc')
1060 FORMAT(f20.17,5X,'e*sin(omega), tag os')
1070 FORMAT(f20.17,5X,'sqrt(e)*cos(omega), tag bc')
1080 FORMAT(f20.17,5X,'sqrt(e)*sin(omega), tag bs')
1090 FORMAT(f22.16,3X,'finc (inclination in degrees), tag in')
1100 FORMAT(f15.10,10X,'Omega_bin (nodal angle of binary ','in deg'  &
      ,'rees), tag Ob')
1110 FORMAT(f19.13,6X,'primK (K-velocity of star 1 in km/sec),',' '  &
      ,'tag pk')
1120 FORMAT(f12.6,13X,'separ (semimajor axis in solar radii), ','t'  &
      ,'ag se')
1130 FORMAT(f12.6,13X,'gamma')
1140 FORMAT(f10.7,15X,'ecosw (phase difference between eclipses)',  &
      ' tag dp')
1150 FORMAT('!  Body 1 parameters')
1160 FORMAT(2(i4,1X),15X,'Nalph1, Nbet1')
1170 FORMAT(f15.9,10X,'Teff1 (K), tag T1')
1180 FORMAT(f10.7,15X,'Tgrav1, tag g1')
1190 FORMAT(f10.7,15X,'alb1 (albedo of star 1), tag l1')
1200 FORMAT(f18.13,7X,'omega1, tag o1')
1210 FORMAT(f15.13,10X,'fill1, tag f1')
1220 FORMAT(f20.13,5X,'primrad (star 1 radius in solar radii),',' '  &
      ,'tag pr')
1230 FORMAT(f18.16,7X,'frac1 (fractional radius star 1:','  R_1/a',  &
      '), tag q1')
1240 FORMAT(f15.13,10X,'radfill1 (set to use fill1',' in terms of '  &
      ,'R_eff)')
1250 FORMAT(f22.17,3X,'primmass (star 1 mass in solar masses),',' '  &
      ,'tag pm')
1260 FORMAT(f12.7,13X,'axis_I1 (inclination of rotation axis if ',  &
      'ialign=1), tag ai')
1270 FORMAT(f12.7,13X,'axis_beta1 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ab')
1280 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','1, tag x1, y1')
1290 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','2, tag x2, y2')
1300 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','3, tag x3, y3')
1310 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','4, tag x4, y4')
1320 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','5, tag x5, y5')
1330 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','6, tag x6, y6')
1340 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','7, tag x7, y7')
1350 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','8, tag x8, y8')
1360 FORMAT(2(f8.5,1X),7X,'bolometric L.D. coefficients',' (used w'  &
      ,'hen Nref >= 0)')
1370 FORMAT(f10.7,15X,'Temperature factor spot 1, star 1, tag b1')
1380 FORMAT(f11.7,14X,'Latitude of spot 1, star 1 (degrees),',' ta'  &
      ,'g b2')
1390 FORMAT(f11.7,14X,'Longitude of spot 1, star 1 (degrees),',' t'  &
      ,'ag b3')
1400 FORMAT(f11.7,14X,'Angular radius of spot 1, star 1 ','(degree'  &
      ,'s), tag b4')
1410 FORMAT(f10.7,15X,'Temperature factor spot 2, star 1, tag b5')
1420 FORMAT(f11.7,14X,'Latitude of spot 2, star 1 (degrees),',' ta'  &
      ,'g b6')
1430 FORMAT(f11.7,14X,'Longitude of spot 2, star 1 (degrees),',' t'  &
      ,'ag b7')
1440 FORMAT(f11.7,14X,'Angular radius of spot 2, star 1 ','(degree'  &
      ,'s), tag b8')
1450 FORMAT(f13.10,12X,'beam1 (Doppler boosting factor,',' star 1)'  &
      ,', tag e1')
1460 FORMAT(f10.8,15X,'rk1 (apsidal constant, star 1), tag a1')
1470 FORMAT(f20.11,5X,'flux star 1, filter 1 (need Nterms > 0),',''  &
      ,' tag 11')
1480 FORMAT(f20.11,5X,'flux star 1, filter 2 (need Nterms > 0),',''  &
      ,' tag 12')
1490 FORMAT(f20.11,5X,'flux star 1, filter 3 (need Nterms > 0),',''  &
      ,' tag 13')
1500 FORMAT(f20.11,5X,'flux star 1, filter 4 (need Nterms > 0),',''  &
      ,' tag 14')
1510 FORMAT(f20.11,5X,'flux star 1, filter 5 (need Nterms > 0),',''  &
      ,' tag 15')
1520 FORMAT(f20.11,5X,'flux star 1, filter 6 (need Nterms > 0),',''  &
      ,' tag 16')
1530 FORMAT(f20.11,5X,'flux star 1, filter 7 (need Nterms > 0),',''  &
      ,' tag 17')
1540 FORMAT(f20.11,5X,'flux star 1, filter 8 (need Nterms > 0),',''  &
      ,' tag 18')
1550 FORMAT('!  Body 2 parameters')
1560 FORMAT(2(i4,1X),15X,'Nalph2, Nbet2')
1570 FORMAT(f15.9,10X,'Teff2 (K), tag T2')
1580 FORMAT(f20.16,5X,'temprat (T_2/T_1), tag te')
1590 FORMAT(f10.7,15X,'Tgrav2, tag g2')
1600 FORMAT(f10.7,15X,'alb2 (albedo of star 2), tag l2')
1610 FORMAT(f18.13,7X,'omega2, tag o2')
1620 FORMAT(f15.13,10X,'fill2, tag f2')
1630 FORMAT(f15.13,10X,'fillsum, tag sf')
1640 FORMAT(f16.13,9X,'filldiff, tag sd')
1650 FORMAT(f17.13,8X,'secrad (secondary star radius in solar ','r'  &
      ,'adii), tag sr')
1660 FORMAT(f18.16,7X,'frac2 (fractional radius star 2:','  R_2/a',  &
      '), tag q2')
1670 FORMAT(f20.13,5X,'ratrad (ratio of star 1 radius to ','star 2'  &
      ,' radius),  tag ra')
1680 FORMAT(f20.13,5X,'radsum (sum of radii in solar), ','tag rs')
1690 FORMAT(f20.13,5X,'raddiff (R_1 - R_2  in solar), ','tag rd')
1700 FORMAT(f17.15,8X,'fracsum ((R_1 + R_2)/a), tag fs')
1710 FORMAT(f17.15,8X,'fracdiff ((R_1 - R_2)/a), tag fd')
1720 FORMAT(f15.13,10X,'radfill2 (set to use fill2',' in terms of '  &
      ,'R_eff)')
1730 FORMAT(f24.17,1X,'Q (M_2/M_1), tag ma')
1740 FORMAT(f20.15,5X,'secmass (star 2 mass in solar masses),',' t'  &
      ,'ag sm')
1750 FORMAT(f20.15,5X,'masssum (sum of masses in solar), ',' tag m' ,'s')
1760 FORMAT(f20.15,5X,'massdiff (M_1 - M_2 in solar), tag md')
1770 FORMAT(f12.7,13X,'axis_I2 (inclination of rotation axis if ',  &
      'ialign=1), tag bi')
1780 FORMAT(f12.7,13X,'axis_beta2 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag bb')
1790 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','1, tag z1, w1')
1800 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','2, tag z2, w2')
1810 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','3, tag z3, w3')
1820 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','4, tag z4, w4')
1830 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','5, tag z5, w5')
1840 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','6, tag z6, w6')
1850 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','7, tag z7, w7')
1860 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','8, tag z8, w8')
1870 FORMAT(2(f8.5,1X),7X,'bolometric L.D. coefficients',' (used w'  &
      ,'hen Nref >= 0)')
1880 FORMAT(f10.7,15X,'Temperature factor spot 1, star 2, tag c1')
1890 FORMAT(f11.7,14X,'Latitude of spot 1, star 2 (degrees),',' ta'  &
      ,'g c2')
1900 FORMAT(f11.7,14X,'Longitude of spot 1, star 2 (degrees),',' t'  &
      ,'ag c3')
1910 FORMAT(f11.7,14X,'Angular radius of spot 1, star 2 ','(degree'  &
      ,'s), tag c4')
1920 FORMAT(f10.7,15X,'Temperature factor spot 2, star 2, tag c5')
1930 FORMAT(f11.7,14X,'Latitude of spot 2, star 2 (degrees),',' ta'  &
      ,'g c6')
1940 FORMAT(f11.7,14X,'Longitude of spot 2, star 2 (degrees),',' t'  &
      ,'ag c7')
1950 FORMAT(f11.7,14X,'Angular radius of spot 2, star 2 ','(degree'  &
      ,'s), tag c8')
1960 FORMAT(f13.10,12X,'beam2 (Doppler boosting factor,',' star 2)'  &
      ,', tag e2')
1970 FORMAT(f10.8,15X,'rk2 (apsidal constant, star 2), tag a2')
1980 FORMAT(f20.11,5X,'flux star 2, filter 1 (need Nterms > 0),',''  &
      ,' tag 21')
1990 FORMAT(f20.11,5X,'flux star 2, filter 2 (need Nterms > 0),',''  &
      ,' tag 22')
2000 FORMAT(f20.11,5X,'flux star 2, filter 3 (need Nterms > 0),',''  &
      ,' tag 23')
2010 FORMAT(f20.11,5X,'flux star 2, filter 4 (need Nterms > 0),',''  &
      ,' tag 24')
2020 FORMAT(f20.11,5X,'flux star 2, filter 5 (need Nterms > 0),',''  &
      ,' tag 25')
2030 FORMAT(f20.11,5X,'flux star 2, filter 6 (need Nterms > 0),',''  &
      ,' tag 26')
2040 FORMAT(f20.11,5X,'flux star 2, filter 7 (need Nterms > 0),',''  &
      ,' tag 27')
2050 FORMAT(f20.11,5X,'flux star 2, filter 8 (need Nterms > 0),',''  &
      ,' tag 28')
2060 FORMAT('!  Accretion disk parameters')
2070 FORMAT(i1,24X,'idint (1 for accretion disk)')
2080 FORMAT(i3,22X,'Ntheta')
2090 FORMAT(i3,22X,'Nradius')
2100 FORMAT(f11.8,14X,'beta_rim (opening angle in degrees),',' tag'  &
      ,' be')
2110 FORMAT(f11.9,14X,'rinner (radius of inner hole), tag ri')
2120 FORMAT(f11.9,14X,'router (radius of outer disk), tag ro')
2130 FORMAT(f13.6,12X,'Tdisk (temperature of inner edge in K)',' t'  &
      ,'ag td')
2140 FORMAT(f12.9,13X,'xi (power-law exponent on temperature',' pr'  &
      ,'ofile), tag xi')
2150 FORMAT(f13.10,12X,'Temperature factor spot 1, disk, tag d1')
2160 FORMAT(f13.9,12X,'Azimuth of spot 1, disk (degrees), tag d2')
2170 FORMAT(f13.9,12X,'Radial cutoff of spot 1, disk (0 <= ',' r_c'  &
      ,'ut <=1), tag d3')
2180 FORMAT(f13.9,12X,'Angular size of spot 1, disk (degrees),',' '  &
      ,'tag d4')
2190 FORMAT(f13.10,12X,'Temperature factor spot 2, disk, tag d5')
2200 FORMAT(f13.9,12X,'Azimuth of spot 2, disk (degrees), tag d6')
2210 FORMAT(f13.9,12X,'Radial cutoff of spot 2, disk (0 <= r_cut',  &
      ' <=1), tag d7')
2220 FORMAT(f13.9,12X,'Angular size of spot 2, disk (degrees),',' '  &
      ,'tag d8')
2230 FORMAT(f15.9,10X,'reference phase for disk fraction')
2240 FORMAT('!  Pulsar parameters')
2250 FORMAT(f17.11,8X,'asini (projected semimajor axis in ','secon'  &
      ,'ds)')
2260 FORMAT(f13.10,12X,'asini error')
2270 FORMAT('!  Body 3 orbital parameters')
2280 FORMAT(f21.13,4X,'P1Tconj, tag tj')
2290 FORMAT(f22.14,3X,'P1period (days), tag tt')
2300 FORMAT(f21.13,4X,'P1pTc (period + Tconj for body 3), tag 1p')
2310 FORMAT(f21.13,4X,'P1mTc (period - Tconj for body 3), tag 1m')
2320 FORMAT(f17.12,8X,'P1qTc (slope in P-Tc plane for body 3),',1X,  &
      'tag 1q')
2330 FORMAT(f21.12,4X,'T1off (offset in P-Tc plane for body 3),',  &
      1X,'tag 1t')
2340 FORMAT(f21.13,4X,'P1T0, tag tu')
2350 FORMAT(f20.17,5X,'P1e*cos(omega), tag tv')
2360 FORMAT(f20.17,5X,'P1e*sin(omega), tag tw')
2370 FORMAT(f20.17,5X,'P1sqrt(e)*cos(omega), tag 1c')
2380 FORMAT(f20.17,5X,'P1sqrt(e)*sin(omega), tag 1s')
2390 FORMAT(f20.15,5X,'P1incl (degrees), tag tx')
2400 FORMAT(f20.15,5X,'P1Omega (degrees), tag ty')
2410 FORMAT(f20.14,5X,'angsum1 (P1incl + P1Omega), tag 1a')
2420 FORMAT(f20.14,5X,'angdiff1 (P1incl - P1Omega), tag 1d')
2430 FORMAT('!  Body 3 parameters')
2440 FORMAT(2(i4,1X),15X,'Nalph3, Nbet3')
2450 FORMAT(f15.9,10X,'Teff3 (K), tag T3')
2460 FORMAT(f8.5,17X,'g3, tag g3')
2470 FORMAT(f16.11,9X,'P1ratrad (radius of star 1 to ','body 3), t'  &
      ,'ag tb')
2480 FORMAT(f20.11,5X,'P1Q (mass of EB to body 3 mass), ','tag tz')
2490 FORMAT(f18.13,7X,'omega3, tag o3')
2500 FORMAT(f12.7,13X,'axis_I3 (inclination of rotation axis if ',  &
      'ialign=1), tag ci')
2510 FORMAT(f12.7,13X,'axis_beta3 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag cb')
2520 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','1, tag m1, n1')
2530 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','2, tag m2, n2')
2540 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','3, tag m3, n3')
2550 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','4, tag m4, n4')
2560 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','5, tag m5, n5')
2570 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','6, tag m6, n6')
2580 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','7, tag m7, n7')
2590 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','8, tag m8, n8')
2600 FORMAT(f10.8,15X,'rk3 (apsidal constant, body 3), tag a3')
2610 FORMAT(f20.11,5X,'flux body 3, filter 1 (need Nterms > 0),',''  &
      ,' tag 31')
2620 FORMAT(f20.11,5X,'flux body 3, filter 2 (need Nterms > 0),',''  &
      ,' tag 32')
2630 FORMAT(f20.11,5X,'flux body 3, filter 3 (need Nterms > 0),',''  &
      ,' tag 33')
2640 FORMAT(f20.11,5X,'flux body 3, filter 4 (need Nterms > 0),',''  &
      ,' tag 34')
2650 FORMAT(f20.11,5X,'flux body 3, filter 5 (need Nterms > 0),',''  &
      ,' tag 35')
2660 FORMAT(f20.11,5X,'flux body 3, filter 6 (need Nterms > 0),',''  &
      ,' tag 36')
2670 FORMAT(f20.11,5X,'flux body 3, filter 7 (need Nterms > 0),',''  &
      ,' tag 37')
2680 FORMAT(f20.11,5X,'flux body 3, filter 8 (need Nterms > 0),',''  &
      ,' tag 38')
2690 FORMAT('!  Body 4 orbital parameters')
2700 FORMAT(f21.13,4X,'P2Tconj, tag uj')
2710 FORMAT(f22.14,3X,'P2period (days), tag ut')
2720 FORMAT(f21.13,4X,'P2pTc (period + Tconj for body 4), tag 2p')
2730 FORMAT(f21.13,4X,'P2mTc (period - Tconj for body 4), tag 2m')
2740 FORMAT(f17.12,8X,'P2qTc (slope in P-Tc plane for body 4),',1X,  &
      'tag 2q')
2750 FORMAT(f21.12,4X,'T2off (offset in P-Tc plane for body 4),',  &
      1X,'tag 2t')
2760 FORMAT(f21.13,4X,'P2T0, tag uu')
2770 FORMAT(f20.17,5X,'P2e*cos(omega), tag uv')
2780 FORMAT(f20.17,5X,'P2e*sin(omega), tag uw')
2790 FORMAT(f20.17,5X,'P2sqrt(e)*cos(omega), tag 2c')
2800 FORMAT(f20.17,5X,'P2sqrt(e)*sin(omega), tag 2s')
2810 FORMAT(f20.15,5X,'P2incl (degrees), tag ux')
2820 FORMAT(f20.15,5X,'P2Omega (degrees), tag uy')
2830 FORMAT(f20.14,5X,'angsum2 (P2incl + P2Omega), tag 2a')
2840 FORMAT(f20.14,5X,'angdiff2 (P2incl - P2Omega), tag 2d')
2850 FORMAT('!  Body 4 parameters')
2860 FORMAT(f15.9,10X,'Teff4 (K), tag T4')
2870 FORMAT(f8.5,17X,'g4, tag g4')
2880 FORMAT(f16.11,9X,'P2ratrad (radius of star 1 to ','body 4), t'  &
      ,'ag ub')
2890 FORMAT(f20.11,5X,'P2Q (mass of EB to body 4 mass), ','tag uz')
2900 FORMAT(f18.13,7X,'omega4, tag o4')
2910 FORMAT(f12.7,13X,'axis_I4 (inclination of rotation axis if ',  &
      'ialign=1), tag di')
2920 FORMAT(f12.7,13X,'axis_beta4 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag db')
2930 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','1, tag i1, j1')
2940 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','2, tag i2, j2')
2950 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','3, tag i3, j3')
2960 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','4, tag i4, j4')
2970 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','5, tag i5, j5')
2980 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','6, tag i6, j6')
2990 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','7, tag i7, j7')
3000 FORMAT(2(f11.8,1X),1X,'limb darkening coefficients,',' filter'  &
      ,' ','8, tag i8, j8')
3010 FORMAT(f10.8,15X,'rk4 (apsidal constant, body 4), tag a4')
3020 FORMAT(f20.11,5X,'flux body 4, filter 1 (need Nterms > 0),',''  &
      ,' tag 41')
3030 FORMAT(f20.11,5X,'flux body 4, filter 2 (need Nterms > 0),',''  &
      ,' tag 42')
3040 FORMAT(f20.11,5X,'flux body 4, filter 3 (need Nterms > 0),',''  &
      ,' tag 43')
3050 FORMAT(f20.11,5X,'flux body 4, filter 4 (need Nterms > 0),',''  &
      ,' tag 44')
3060 FORMAT(f20.11,5X,'flux body 4, filter 5 (need Nterms > 0),',''  &
      ,' tag 45')
3070 FORMAT(f20.11,5X,'flux body 4, filter 6 (need Nterms > 0),',''  &
      ,' tag 46')
3080 FORMAT(f20.11,5X,'flux body 4, filter 7 (need Nterms > 0),',''  &
      ,' tag 47')
3090 FORMAT(f20.11,5X,'flux body 4, filter 8 (need Nterms > 0),',''  &
      ,' tag 48')
3100 FORMAT('!  binary+binary stellar parameters')
3110 FORMAT(f21.14,4X,'bin2masssum (M_3 + M_4 in binary+binary ',''  &
      ,'mode), tag 91')
3120 FORMAT(f21.14,4X,'bin2massdiff (M_3 - M_4 in binary+binary ',  &
      'mode), tag 92')
3130 FORMAT(f21.14,4X,'bin2Q (M_4/M_3 in binary+binary ','mode), t'  &
      ,'ag 93')
3140 FORMAT(f21.14,4X,'bin2radsum (R_3 + R_4 in binary+binary ','m'  &
      ,'ode), tag 94')
3150 FORMAT(f21.14,4X,'bin2raddiff (R_3 - R_4 in binary+binary ',''  &
      ,'mode), tag 95')
3160 FORMAT(f21.14,4X,'bin2ratrad (R_3/R_4 in binary+binary ','mod'  &
      ,'e), tag 96')
3170 FORMAT(f21.15,4X,'bin2M3 (M3 in solar masses), tag 97')
3180 FORMAT(f21.15,4X,'bin2M4 (M4 in solar masses), tag 98')
3190 FORMAT(f21.15,4X,'bin2R3 (R3 in solar radii), tag 99')
3200 FORMAT(f21.15,4X,'bin2R4 (R4 in solar radii), tag 90')
3210 FORMAT('!  Body 5 orbital parameters')
3220 FORMAT(f21.13,4X,'P3Tconj, tag vj')
3230 FORMAT(f22.14,3X,'P3period (days), tag vt')
3240 FORMAT(f21.13,4X,'P3pTc (period + Tconj for body 5), tag 3p')
3250 FORMAT(f21.13,4X,'P3mTc (period - Tconj for body 5), tag 3m')
3260 FORMAT(f17.12,8X,'P3qTc (slope in P-Tc plane for body 5),',1X,  &
      'tag 3q')
3270 FORMAT(f21.12,4X,'T3off (offset in P-Tc plane for body 5),',  &
      1X,'tag 3t')
3280 FORMAT(f21.13,4X,'P3T0, tag vu')
3290 FORMAT(f20.17,5X,'P3e*cos(omega), tag vv')
3300 FORMAT(f20.17,5X,'P3e*sin(omega), tag vw')
3310 FORMAT(f20.17,5X,'P3sqrt(e)*cos(omega), tag 3c')
3320 FORMAT(f20.17,5X,'P3sqrt(e)*sin(omega), tag 3s')
3330 FORMAT(f20.15,5X,'P3incl (degrees), tag vx')
3340 FORMAT(f20.15,5X,'P3Omega (degrees), tag vy')
3350 FORMAT(f20.14,5X,'angsum3 (P3incl + P3Omega), tag 3a')
3360 FORMAT(f20.14,5X,'angdiff3 (P3incl - P3Omega), tag 3d')
3370 FORMAT('!  Body 5 parameters')
3380 FORMAT(f15.9,10X,'Teff5 (K), tag T5')
3390 FORMAT(f8.5,17X,'g5, tag g5')
3400 FORMAT(f16.11,9X,'P3ratrad (radius of star 1 to ','body 5), t'  &
      ,'ag vb')
3410 FORMAT(f20.11,5X,'P3Q (mass of EB to body 5 mass), ','tag vz')
3420 FORMAT(f12.8,13X,'omega5, tag o5')
3430 FORMAT(f12.7,13X,'axis_I5 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
3440 FORMAT(f12.7,13X,'axis_beta5 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ...')
3450 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','1, tag k1, p1')
3460 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','2, tag k2, p2')
3470 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','3, tag k3, p3')
3480 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','4, tag k4, p4')
3490 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','5, tag k5, p5')
3500 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','6, tag k6, p6')
3510 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','7, tag k7, p7')
3520 FORMAT(2(f11.8,1X),7X,'limb darkening coefficients,',' filter'  &
      ,' ','8, tag k8, p8')
3530 FORMAT(f10.8,15X,'rk5 (apsidal constant, body 5), tag a5')
3540 FORMAT(f20.11,5X,'flux body 5, filter 1 (need Nterms > 0),',''  &
      ,' tag 51')
3550 FORMAT(f20.11,5X,'flux body 5, filter 2 (need Nterms > 0),',''  &
      ,' tag 52')
3560 FORMAT(f20.11,5X,'flux body 5, filter 3 (need Nterms > 0),',''  &
      ,' tag 53')
3570 FORMAT(f20.11,5X,'flux body 5, filter 4 (need Nterms > 0),',''  &
      ,' tag 54')
3580 FORMAT(f20.11,5X,'flux body 5, filter 5 (need Nterms > 0),',''  &
      ,' tag 55')
3590 FORMAT(f20.11,5X,'flux body 5, filter 6 (need Nterms > 0),',''  &
      ,' tag 56')
3600 FORMAT(f20.11,5X,'flux body 5, filter 7 (need Nterms > 0),',''  &
      ,' tag 57')
3610 FORMAT(f20.11,5X,'flux body 5, filter 8 (need Nterms > 0),',''  &
      ,' tag 58')
3620 FORMAT('!  Body 6 orbital parameters')
3630 FORMAT(f21.13,4X,'P4Tconj, tag wj')
3640 FORMAT(f22.14,3X,'P4period (days), tag wt')
3650 FORMAT(f21.13,4X,'P4pTc (period + Tconj for body 6), tag 4p')
3660 FORMAT(f21.13,4X,'P4mTc (period - Tconj for body 6), tag 4m')
3670 FORMAT(f17.12,8X,'P4qTc (slope in P-Tc plane for body 6),',1X,  &
      'tag 4q')
3680 FORMAT(f21.12,4X,'T4off (offset in P-Tc plane for body 6),',  &
      1X,'tag 4t')
3690 FORMAT(f21.13,4X,'P4T0, tag wu')
3700 FORMAT(f20.17,5X,'P4e*cos(omega), tag wv')
3710 FORMAT(f20.17,5X,'P4e*sin(omega), tag ww')
3720 FORMAT(f20.17,5X,'P4sqrt(e)*cos(omega), tag 4c')
3730 FORMAT(f20.17,5X,'P4sqrt(e)*sin(omega), tag 4s')
3740 FORMAT(f20.15,5X,'P4incl (degrees), tag wx')
3750 FORMAT(f20.15,5X,'P4Omega (degrees), tag wy')
3760 FORMAT(f20.14,5X,'angsum4 (P4incl + P4Omega), tag 4a')
3770 FORMAT(f20.14,5X,'angdiff4 (P4incl - P4Omega), tag 4d')
3780 FORMAT('!  Body 6 parameters')
3790 FORMAT(f15.9,10X,'Teff6 (K), tag T6')
3800 FORMAT(f8.5,17X,'g6, tag g6')
3810 FORMAT(f16.11,9X,'P4ratrad (radius of star 1 to ','body 6), t'  &
      ,'ag wb')
3820 FORMAT(f20.11,5X,'P4Q (mass of EB to body 6 mass), ','tag wz')
3830 FORMAT(f12.8,13X,'omega6, tag o6')
3840 FORMAT(f12.7,13X,'axis_I6 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
3850 FORMAT(f12.7,13X,'axis_beta6 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ...')
3860 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'1, tag ..., ...')
3870 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'2, tag ..., ...')
3880 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'3, tag ..., ...')
3890 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'4, tag ..., ...')
3900 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'5, tag ..., ...')
3910 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'6, tag ..., ...')
3920 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'7, tag ..., ...')
3930 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'8, tag ..., ...')
3940 FORMAT(f10.8,15X,'rk6 (apsidal constant, body 6), tag a6')
3950 FORMAT(f20.11,5X,'flux body 6, filter 1 (need Nterms > 0),',''  &
      ,' tag 61')
3960 FORMAT(f20.11,5X,'flux body 6, filter 2 (need Nterms > 0),',''  &
      ,' tag 62')
3970 FORMAT(f20.11,5X,'flux body 6, filter 3 (need Nterms > 0),',''  &
      ,' tag 63')
3980 FORMAT(f20.11,5X,'flux body 6, filter 4 (need Nterms > 0),',''  &
      ,' tag 64')
3990 FORMAT(f20.11,5X,'flux body 6, filter 5 (need Nterms > 0),',''  &
      ,' tag 65')
4000 FORMAT(f20.11,5X,'flux body 6, filter 6 (need Nterms > 0),',''  &
      ,' tag 66')
4010 FORMAT(f20.11,5X,'flux body 6, filter 7 (need Nterms > 0),',''  &
      ,' tag 67')
4020 FORMAT(f20.11,5X,'flux body 6, filter 8 (need Nterms > 0),',''  &
      ,' tag 68')
4030 FORMAT('!  Body 7 orbital parameters')
4040 FORMAT(f21.13,4X,'P5Tconj, tag xj')
4050 FORMAT(f22.14,3X,'P5period (days), tag xt')
4060 FORMAT(f21.13,4X,'P5pTc (period + Tconj for body 7), tag 5p')
4070 FORMAT(f21.13,4X,'P5mTc (period - Tconj for body 7), tag 5m')
4080 FORMAT(f17.12,8X,'P5qTc (slope in P-Tc plane for body 7),',1X,  &
      'tag 5q')
4090 FORMAT(f21.12,4X,'T5off (offset in P-Tc plane for body 7),',  &
      1X,'tag 5t')
4100 FORMAT(f21.13,4X,'P5T0, tag xu')
4110 FORMAT(f20.17,5X,'P5e*cos(omega), tag xv')
4120 FORMAT(f20.17,5X,'P5e*sin(omega), tag xw')
4130 FORMAT(f20.17,5X,'P5sqrt(e)*cos(omega), tag 5c')
4140 FORMAT(f20.17,5X,'P5sqrt(e)*sin(omega), tag 5s')
4150 FORMAT(f20.15,5X,'P5incl (degrees), tag xx')
4160 FORMAT(f20.15,5X,'P5Omega (degrees), tag xy')
4170 FORMAT(f20.14,5X,'angsum5 (P5incl + P5Omega), tag 5a')
4180 FORMAT(f20.14,5X,'angdiff5 (P5incl - P5Omega), tag 5d')
4190 FORMAT('!  Body 7 parameters')
4200 FORMAT(f15.9,10X,'Teff7 (K), tag T7')
4210 FORMAT(f8.5,17X,'g7, tag g7')
4220 FORMAT(f16.11,9X,'P5ratrad (radius of star 1 to ','body 7), t'  &
      ,'ag xb')
4230 FORMAT(f20.11,5X,'P5Q (mass of EB to body 7 mass), ','tag xz')
4240 FORMAT(f12.8,13X,'omega7, tag o7')
4250 FORMAT(f12.7,13X,'axis_I7 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
4260 FORMAT(f12.7,13X,'axis_beta7 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ...')
4270 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'1, tag ..., ...')
4280 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'2, tag ..., ...')
4290 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'3, tag ..., ...')
4300 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'4, tag ..., ...')
4310 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'5, tag ..., ...')
4320 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'6, tag ..., ...')
4330 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'7, tag ..., ...')
4340 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'8, tag ..., ...')
4350 FORMAT(f10.8,15X,'rk7 (apsidal constant, body 7), tag a7')
4360 FORMAT(f20.11,5X,'flux body 7, filter 1 (need Nterms > 0),',''  &
      ,' tag 71')
4370 FORMAT(f20.11,5X,'flux body 7, filter 2 (need Nterms > 0),',''  &
      ,' tag 72')
4380 FORMAT(f20.11,5X,'flux body 7, filter 3 (need Nterms > 0),',''  &
      ,' tag 73')
4390 FORMAT(f20.11,5X,'flux body 7, filter 4 (need Nterms > 0),',''  &
      ,' tag 74')
4400 FORMAT(f20.11,5X,'flux body 7, filter 5 (need Nterms > 0),',''  &
      ,' tag 75')
4410 FORMAT(f20.11,5X,'flux body 7, filter 6 (need Nterms > 0),',''  &
      ,' tag 76')
4420 FORMAT(f20.11,5X,'flux body 7, filter 7 (need Nterms > 0),',''  &
      ,' tag 77')
4430 FORMAT(f20.11,5X,'flux body 7, filter 8 (need Nterms > 0),',''  &
      ,' tag 78')
4440 FORMAT('!  Body 8 orbital parameters')
4450 FORMAT(f21.13,4X,'P6Tconj, tag sj')
4460 FORMAT(f22.14,3X,'P6period (days), tag st')
4470 FORMAT(f21.13,4X,'P6pTc (period + Tconj for body 8), tag 6p')
4480 FORMAT(f21.13,4X,'P6mTc (period - Tconj for body 8), tag 6m')
4490 FORMAT(f17.12,8X,'P6qTc (slope in P-Tc plane for body 8),',1X,  &
      'tag 6q')
4500 FORMAT(f21.12,4X,'T6off (offset in P-Tc plane for body 8),',  &
      1X,'tag 6t')
4510 FORMAT(f21.13,4X,'P6T0, tag su')
4520 FORMAT(f20.17,5X,'P6e*cos(omega), tag sv')
4530 FORMAT(f20.17,5X,'P6e*sin(omega), tag sw')
4540 FORMAT(f20.17,5X,'P6sqrt(e)*cos(omega), tag 6c')
4550 FORMAT(f20.17,5X,'P6sqrt(e)*sin(omega), tag 6s')
4560 FORMAT(f20.15,5X,'P6incl (degrees), tag sx')
4570 FORMAT(f20.15,5X,'P6Omega (degrees), tag sy')
4580 FORMAT(f20.14,5X,'angsum6 (P6incl + P6Omega), tag 6a')
4590 FORMAT(f20.14,5X,'angdiff6 (P6incl - P6Omega), tag 6d')
4600 FORMAT('!  Body 8 parameters')
4610 FORMAT(f15.9,10X,'Teff8 (K), tag T8')
4620 FORMAT(f8.5,17X,'g8, tag g8')
4630 FORMAT(f16.11,9X,'P6ratrad (radius of star 1 to ','body 8), t'  &
      ,'ag sb')
4640 FORMAT(f20.11,5X,'P6Q (mass of EB to body 8 mass), ','tag sz')
4650 FORMAT(f12.8,13X,'omega8, tag o8')
4660 FORMAT(f12.7,13X,'axis_I8 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
4670 FORMAT(f12.7,13X,'axis_beta8 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ...')
4680 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'1, tag ..., ...')
4690 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'2, tag ..., ...')
4700 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'3, tag ..., ...')
4710 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'4, tag ..., ...')
4720 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'5, tag ..., ...')
4730 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'6, tag ..., ...')
4740 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'7, tag ..., ...')
4750 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'8, tag ..., ...')
4760 FORMAT(f10.8,15X,'rk8 (apsidal constant, body 8), tag a8')
4770 FORMAT(f20.11,5X,'flux body 8, filter 1 (need Nterms > 0),',''  &
      ,' tag 81')
4780 FORMAT(f20.11,5X,'flux body 8, filter 2 (need Nterms > 0),',''  &
      ,' tag 82')
4790 FORMAT(f20.11,5X,'flux body 8, filter 3 (need Nterms > 0),',''  &
      ,' tag 83')
4800 FORMAT(f20.11,5X,'flux body 8, filter 4 (need Nterms > 0),',''  &
      ,' tag 84')
4810 FORMAT(f20.11,5X,'flux body 8, filter 5 (need Nterms > 0),',''  &
      ,' tag 85')
4820 FORMAT(f20.11,5X,'flux body 8, filter 6 (need Nterms > 0),',''  &
      ,' tag 86')
4830 FORMAT(f20.11,5X,'flux body 8, filter 7 (need Nterms > 0),',''  &
      ,' tag 87')
4840 FORMAT(f20.11,5X,'flux body 8, filter 8 (need Nterms > 0),',''  &
      ,' tag 88')
4850 FORMAT('!  Body 9 orbital parameters')
4860 FORMAT(f21.13,4X,'P7Tconj, tag hj')
4870 FORMAT(f22.14,3X,'P7period (days), tag ht')
4880 FORMAT(f21.13,4X,'P7pTc (period + Tconj for body 9), tag 7p')
4890 FORMAT(f21.13,4X,'P7mTc (period - Tconj for body 9), tag 7m')
4900 FORMAT(f17.12,8X,'P7qTc (slope in P-Tc plane for body 9),',1X,  &
      'tag 7q')
4910 FORMAT(f21.12,4X,'T7off (offset in P-Tc plane for body 9),',  &
      1X,'tag 7t')
4920 FORMAT(f21.13,4X,'P7T0, tag hu')
4930 FORMAT(f20.17,5X,'P7e*cos(omega), tag hv')
4940 FORMAT(f20.17,5X,'P7e*sin(omega), tag hw')
4950 FORMAT(f20.17,5X,'P7sqrt(e)*cos(omega), tag 7c')
4960 FORMAT(f20.17,5X,'P7sqrt(e)*sin(omega), tag 7s')
4970 FORMAT(f20.15,5X,'P7incl (degrees), tag hx')
4980 FORMAT(f20.15,5X,'P7Omega (degrees), tag hy')
4990 FORMAT(f20.14,5X,'angsum7 (P7incl + P7Omega), tag 7a')
5000 FORMAT(f20.14,5X,'angdiff7 (P7incl - P7Omega), tag 7d')
5010 FORMAT('!  Body 9 parameters')
5020 FORMAT(f15.9,10X,'Teff9 (K), tag T9')
5030 FORMAT(f8.5,17X,'g9, tag g9')
5040 FORMAT(f16.11,9X,'P7ratrad (radius of star 1 to ','body 9), t'  &
      ,'ag hb')
5050 FORMAT(f20.11,5X,'P7Q (mass of EB to body 9 mass), ','tag hz')
5060 FORMAT(f12.8,13X,'omega9, tag o9')
5070 FORMAT(f12.7,13X,'axis_I9 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
5080 FORMAT(f12.7,13X,'axis_beta9 (angle of rotation axis wrt ','o'  &
      ,'rbit if ialign=1), tag ...')
5090 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'1, tag ..., ...')
5100 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'2, tag ..., ...')
5110 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'3, tag ..., ...')
5120 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'4, tag ..., ...')
5130 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'5, tag ..., ...')
5140 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'6, tag ..., ...')
5150 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'7, tag ..., ...')
5160 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'8, tag ..., ...')
5170 FORMAT(f10.8,15X,'rk9 (apsidal constant, body 9), tag a9')
5180 FORMAT(f20.11,5X,'flux body 9, filter 1 (need Nterms > 0),',''  &
      ,' tag 91')
5190 FORMAT(f20.11,5X,'flux body 9, filter 2 (need Nterms > 0),',''  &
      ,' tag 92')
5200 FORMAT(f20.11,5X,'flux body 9, filter 3 (need Nterms > 0),',''  &
      ,' tag 93')
5210 FORMAT(f20.11,5X,'flux body 9, filter 4 (need Nterms > 0),',''  &
      ,' tag 94')
5220 FORMAT(f20.11,5X,'flux body 9, filter 5 (need Nterms > 0),',''  &
      ,' tag 95')
5230 FORMAT(f20.11,5X,'flux body 9, filter 6 (need Nterms > 0),',''  &
      ,' tag 96')
5240 FORMAT(f20.11,5X,'flux body 9, filter 7 (need Nterms > 0),',''  &
      ,' tag 97')
5250 FORMAT(f20.11,5X,'flux body 9, filter 8 (need Nterms > 0),',''  &
      ,' tag 98')
5260 FORMAT('!  Body 10 orbital parameters')
5270 FORMAT(f21.13,4X,'P8Tconj, tag kj')
5280 FORMAT(f22.14,3X,'P8period (days), tag kt')
5290 FORMAT(f21.13,4X,'P8pTc (period + Tconj for body 10), tag 8p')
5300 FORMAT(f21.13,4X,'P8mTc (period - Tconj for body 10), tag 8m')
5310 FORMAT(f17.12,8X,'P8qTc (slope in P-Tc plane for body 10),',  &
      1X,'tag 8q')
5320 FORMAT(f21.12,4X,'T8off (offset in P-Tc plane for body 10),',  &
      1X,'tag 8t')
5330 FORMAT(f21.13,4X,'P8T0, tag ku')
5340 FORMAT(f20.17,5X,'P8e*cos(omega), tag kv')
5350 FORMAT(f20.17,5X,'P8e*sin(omega), tag kw')
5360 FORMAT(f20.17,5X,'P8sqrt(e)*cos(omega), tag 8c')
5370 FORMAT(f20.17,5X,'P8sqrt(e)*sin(omega), tag 8s')
5380 FORMAT(f20.15,5X,'P8incl (degrees), tag kx')
5390 FORMAT(f20.15,5X,'P8Omega (degrees), tag ky')
5400 FORMAT(f20.14,5X,'angsum8 (P8incl + P8Omega), tag 8a')
5410 FORMAT(f20.14,5X,'angdiff8 (P8incl - P8Omega), tag 8d')
5420 FORMAT('!  Body 10 parameters')
5430 FORMAT(f15.9,10X,'Teff10 (K), tag ...')
5440 FORMAT(f8.5,17X,'g10, tag g0')
5450 FORMAT(f16.11,9X,'P8ratrad (radius of star 1 to ','body 10),'  &
      ,' tag kb')
5460 FORMAT(f20.11,5X,'P8Q (mass of EB to body 10 mass), ','tag k' ,'z')
5470 FORMAT(f12.8,13X,'omega10, tag o0')
5480 FORMAT(f12.7,13X,'axis_I10 (inclination of rotation axis if ',  &
      'ialign=1), tag ...')
5490 FORMAT(f12.7,13X,'axis_beta10 (angle of rotation axis wrt ',''  &
      ,'orbit if ialign=1), tag ...')
5500 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'1, tag ..., ...')
5510 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'2, tag ..., ...')
5520 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'3, tag ..., ...')
5530 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'4, tag ..., ...')
5540 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'5, tag ..., ...')
5550 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'6, tag ..., ...')
5560 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'7, tag ..., ...')
5570 FORMAT(2(f8.5,1X),7X,'limb darkening coefficients,',' filter '  &
      ,'8, tag ..., ...')
5580 FORMAT(f10.8,15X,'rk10 (apsidal constant, body 10), tag ...')
5590 FORMAT(f20.11,5X,'flux body 10, filter 1 (need Nterms > 0),',  &
      ' tag 01')
5600 FORMAT(f20.11,5X,'flux body 10, filter 2 (need Nterms > 0),',  &
      ' tag 02')
5610 FORMAT(f20.11,5X,'flux body 10, filter 3 (need Nterms > 0),',  &
      ' tag 03')
5620 FORMAT(f20.11,5X,'flux body 10, filter 4 (need Nterms > 0),',  &
      ' tag 04')
5630 FORMAT(f20.11,5X,'flux body 10, filter 5 (need Nterms > 0),',  &
      ' tag 05')
5640 FORMAT(f20.11,5X,'flux body 10, filter 6 (need Nterms > 0),',  &
      ' tag 06')
5650 FORMAT(f20.11,5X,'flux body 10, filter 7 (need Nterms > 0),',  &
      ' tag 07')
5660 FORMAT(f20.11,5X,'flux body 10, filter 8 (need Nterms > 0),',  &
      ' tag 08')
!
   RETURN
!
END SUBROUTINE newwritegridout
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE newwritevar(nvarmax,svar,fill1,fill2,omega1,  &
   omega2,q,finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,  &
   separ,isvel1,gamma1,isvel2,gamma2,t3,g3,sa3,ecc,argper,  &
   pshift,spot1parm,spot2parm,spotdparm,period,t0,chisq,nnn,  &
   line,alb1,alb2,dwavex,dwavey,primmass,primk,primrad,ratrad,  &
   frac1,frac2,ecosw,temprat,bigi,bigbeta,density,  &
   sw5,tconj,beam1,beam2,contam,ocose,osine,isw29,tertperiod,  &
   tertt0,tertecos,tertesin,tertincl,tertomega,tertq,tgrav1,  &
   tgrav2,tertconj,omegadot,contams0,contams1,contams2,contams3,  &
   p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,  &
   p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,  &
   p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,  &
   p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,  &
   p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,  &
   p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,  &
   p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,  &
   p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad,gamma3,isvel3,  &
   sw72,sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,sdarkint3,  &
   sdarkint4,sdarkint5,isvel4,gamma4,tertratrad,p1mtc,p1ptc,  &
   p2mtc,p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,  &
   p7mtc,p7ptc,p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,  &
   bigbeta2,bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,  &
   b2raddiff,b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,  &
   masssum,omega3,omega4,omega5,omega6,omega7,omega8,omega9,  &
   omega10,raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,  &
   sdarkint6,sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,  &
   secrad,t10,t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,  &
   bin2r4,sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
   sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
   sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
   angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
   angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,fillsum,filldiff,binqtc,p1qtc,p2qtc,  &
   p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,  &
   t3off,t4off,t5off,t6off,t7off,t8off,ifixgamma,  &
   gamma1arry,gamma2arry,gamma3arry,gamma4arry,gamma5arry,  &
   icnrv1arry,icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry,  &
   nbody,orbitparm,tesscontam)
!
!   This routine will determine which variables are to be printed on the
!   screen based on the string codes in svar(1:Nvarmax).  The values of
!   the parameters are written into the string "line", which is printed
!   from markovELC, geneticELC, ...
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvarmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvarmax)
   REAL(KIND=dp), INTENT(IN)                :: fill1
   REAL(KIND=dp), INTENT(IN)                :: fill2
   REAL(KIND=dp), INTENT(IN)                :: omega1
   REAL(KIND=dp), INTENT(IN)                :: omega2
   REAL(KIND=dp), INTENT(IN)                :: q
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: teff1
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN)                :: betarim
   REAL(KIND=dp), INTENT(IN)                :: rinner
   REAL(KIND=dp), INTENT(IN)                :: router
   REAL(KIND=dp), INTENT(IN)                :: tdisk
   REAL(KIND=dp), INTENT(IN)                :: xi
   REAL(KIND=dp), INTENT(IN)                :: rlx
   REAL(KIND=dp), INTENT(IN)                :: separ
   INTEGER, INTENT(IN)                      :: isvel1
   REAL(KIND=dp), INTENT(IN)                :: gamma1
   INTEGER, INTENT(IN)                      :: isvel2
   REAL(KIND=dp), INTENT(IN)                :: gamma2
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: sa3
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN OUT)            :: argper
   REAL(KIND=dp), INTENT(IN)                :: pshift
   REAL(KIND=dp), INTENT(IN)                :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: t0
   REAL(KIND=dp), INTENT(IN)                :: chisq
   INTEGER, INTENT(IN)                      :: nnn
   CHARACTER (LEN=3000), INTENT(OUT)        :: line
   REAL(KIND=dp), INTENT(IN)                :: alb1
   REAL(KIND=dp), INTENT(IN)                :: alb2
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN)                :: primmass
   REAL(KIND=dp), INTENT(IN)                :: primk
   REAL(KIND=dp), INTENT(IN)                :: primrad
   REAL(KIND=dp), INTENT(IN)                :: ratrad
   REAL(KIND=dp), INTENT(IN)                :: frac1
   REAL(KIND=dp), INTENT(IN)                :: frac2
   REAL(KIND=dp), INTENT(IN)                :: ecosw
   REAL(KIND=dp), INTENT(IN)                :: temprat
   REAL(KIND=dp), INTENT(IN)                :: bigi
   REAL(KIND=dp), INTENT(IN)                :: bigbeta
   REAL(KIND=dp), INTENT(IN)                :: density
   REAL(KIND=dp), INTENT(IN)                :: sw5
   REAL(KIND=dp), INTENT(IN)                :: tconj
   REAL(KIND=dp), INTENT(IN)                :: beam1
   REAL(KIND=dp), INTENT(IN)                :: beam2
   REAL(KIND=dp), INTENT(IN)                :: contam
   REAL(KIND=dp), INTENT(IN)                :: ocose
   REAL(KIND=dp), INTENT(IN)                :: osine
   INTEGER, INTENT(IN)                      :: isw29
   REAL(KIND=dp), INTENT(IN)                :: tertperiod
   REAL(KIND=dp), INTENT(IN)                :: tertt0
   REAL(KIND=dp), INTENT(IN)                :: tertecos
   REAL(KIND=dp), INTENT(IN)                :: tertesin
   REAL(KIND=dp), INTENT(IN)                :: tertincl
   REAL(KIND=dp), INTENT(IN)                :: tertomega
   REAL(KIND=dp), INTENT(IN)                :: tertq
   REAL(KIND=dp), INTENT(IN)                :: tgrav1
   REAL(KIND=dp), INTENT(IN)                :: tgrav2
   REAL(KIND=dp), INTENT(IN)                :: tertconj
   REAL(KIND=dp), INTENT(IN)                :: omegadot
   REAL(KIND=dp), INTENT(IN)                :: contams0
   REAL(KIND=dp), INTENT(IN)                :: contams1
   REAL(KIND=dp), INTENT(IN)                :: contams2
   REAL(KIND=dp), INTENT(IN)                :: contams3
   REAL(KIND=dp), INTENT(IN)                :: p2tconj
   REAL(KIND=dp), INTENT(IN)                :: p2period
   REAL(KIND=dp), INTENT(IN)                :: p2t0
   REAL(KIND=dp), INTENT(IN)                :: p2ecos
   REAL(KIND=dp), INTENT(IN)                :: p2esin
   REAL(KIND=dp), INTENT(IN)                :: p2incl
   REAL(KIND=dp), INTENT(IN)                :: p2omega
   REAL(KIND=dp), INTENT(IN)                :: p2q
   REAL(KIND=dp), INTENT(IN)                :: p2ratrad
   REAL(KIND=dp), INTENT(IN)                :: p3tconj
   REAL(KIND=dp), INTENT(IN)                :: p3period
   REAL(KIND=dp), INTENT(IN)                :: p3t0
   REAL(KIND=dp), INTENT(IN)                :: p3ecos
   REAL(KIND=dp), INTENT(IN)                :: p3esin
   REAL(KIND=dp), INTENT(IN)                :: p3incl
   REAL(KIND=dp), INTENT(IN)                :: p3omega
   REAL(KIND=dp), INTENT(IN)                :: p3q
   REAL(KIND=dp), INTENT(IN)                :: p3ratrad
   REAL(KIND=dp), INTENT(IN)                :: p4tconj
   REAL(KIND=dp), INTENT(IN)                :: p4period
   REAL(KIND=dp), INTENT(IN)                :: p4t0
   REAL(KIND=dp), INTENT(IN)                :: p4ecos
   REAL(KIND=dp), INTENT(IN)                :: p4esin
   REAL(KIND=dp), INTENT(IN)                :: p4incl
   REAL(KIND=dp), INTENT(IN)                :: p4omega
   REAL(KIND=dp), INTENT(IN)                :: p4q
   REAL(KIND=dp), INTENT(IN)                :: p4ratrad
   REAL(KIND=dp), INTENT(IN)                :: p5tconj
   REAL(KIND=dp), INTENT(IN)                :: p5period
   REAL(KIND=dp), INTENT(IN)                :: p5t0
   REAL(KIND=dp), INTENT(IN)                :: p5ecos
   REAL(KIND=dp), INTENT(IN)                :: p5esin
   REAL(KIND=dp), INTENT(IN)                :: p5incl
   REAL(KIND=dp), INTENT(IN)                :: p5omega
   REAL(KIND=dp), INTENT(IN)                :: p5q
   REAL(KIND=dp), INTENT(IN)                :: p5ratrad
   REAL(KIND=dp), INTENT(IN)                :: p6tconj
   REAL(KIND=dp), INTENT(IN)                :: p6period
   REAL(KIND=dp), INTENT(IN)                :: p6t0
   REAL(KIND=dp), INTENT(IN)                :: p6ecos
   REAL(KIND=dp), INTENT(IN)                :: p6esin
   REAL(KIND=dp), INTENT(IN)                :: p6incl
   REAL(KIND=dp), INTENT(IN)                :: p6omega
   REAL(KIND=dp), INTENT(IN)                :: p6q
   REAL(KIND=dp), INTENT(IN)                :: p6ratrad
   REAL(KIND=dp), INTENT(IN)                :: p7tconj
   REAL(KIND=dp), INTENT(IN)                :: p7period
   REAL(KIND=dp), INTENT(IN)                :: p7t0
   REAL(KIND=dp), INTENT(IN)                :: p7ecos
   REAL(KIND=dp), INTENT(IN)                :: p7esin
   REAL(KIND=dp), INTENT(IN)                :: p7incl
   REAL(KIND=dp), INTENT(IN)                :: p7omega
   REAL(KIND=dp), INTENT(IN)                :: p7q
   REAL(KIND=dp), INTENT(IN)                :: p7ratrad
   REAL(KIND=dp), INTENT(IN)                :: p8tconj
   REAL(KIND=dp), INTENT(IN)                :: p8period
   REAL(KIND=dp), INTENT(IN)                :: p8t0
   REAL(KIND=dp), INTENT(IN)                :: p8ecos
   REAL(KIND=dp), INTENT(IN)                :: p8esin
   REAL(KIND=dp), INTENT(IN)                :: p8incl
   REAL(KIND=dp), INTENT(IN)                :: p8omega
   REAL(KIND=dp), INTENT(IN)                :: p8q
   REAL(KIND=dp), INTENT(IN)                :: p8ratrad
   REAL(KIND=dp), INTENT(IN)                :: gamma3
   INTEGER, INTENT(IN)                      :: isvel3
   REAL(KIND=dp), INTENT(IN)                :: sw72
   REAL(KIND=dp), INTENT(IN)                :: sw73
   REAL(KIND=dp), INTENT(IN)                :: sw49
   REAL(KIND=dp), INTENT(IN)                :: sw80
   REAL(KIND=dp), INTENT(IN)                :: sw81
   REAL(KIND=dp), INTENT(IN)                :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint5(8)
   INTEGER, INTENT(IN)                      :: isvel4
   REAL(KIND=dp), INTENT(IN)                :: gamma4
   REAL(KIND=dp), INTENT(IN)                :: tertratrad
   REAL(KIND=dp), INTENT(IN)                :: p1mtc
   REAL(KIND=dp), INTENT(IN)                :: p1ptc
   REAL(KIND=dp), INTENT(IN)                :: p2mtc
   REAL(KIND=dp), INTENT(IN)                :: p2ptc
   REAL(KIND=dp), INTENT(IN)                :: p3mtc
   REAL(KIND=dp), INTENT(IN)                :: p3ptc
   REAL(KIND=dp), INTENT(IN)                :: p4mtc
   REAL(KIND=dp), INTENT(IN)                :: p4ptc
   REAL(KIND=dp), INTENT(IN)                :: p5mtc
   REAL(KIND=dp), INTENT(IN)                :: p5ptc
   REAL(KIND=dp), INTENT(IN)                :: p6mtc
   REAL(KIND=dp), INTENT(IN)                :: p6ptc
   REAL(KIND=dp), INTENT(IN)                :: p7mtc
   REAL(KIND=dp), INTENT(IN)                :: p7ptc
   REAL(KIND=dp), INTENT(IN)                :: p8mtc
   REAL(KIND=dp), INTENT(IN)                :: p8ptc
   REAL(KIND=dp), INTENT(IN)                :: pbmtc
   REAL(KIND=dp), INTENT(IN)                :: pbptc
   REAL(KIND=dp), INTENT(IN)                :: bigi2
   REAL(KIND=dp), INTENT(IN)                :: bigi3
   REAL(KIND=dp), INTENT(IN)                :: bigi4
   REAL(KIND=dp), INTENT(IN)                :: bigbeta2
   REAL(KIND=dp), INTENT(IN)                :: bigbeta3
   REAL(KIND=dp), INTENT(IN)                :: bigbeta4
   REAL(KIND=dp), INTENT(IN)                :: bin2q
   REAL(KIND=dp), INTENT(IN)                :: b2massdiff
   REAL(KIND=dp), INTENT(IN)                :: b2masssum
   REAL(KIND=dp), INTENT(IN)                :: b2raddiff
   REAL(KIND=dp), INTENT(IN)                :: b2radsum
   REAL(KIND=dp), INTENT(IN)                :: bin2ratrad
   REAL(KIND=dp), INTENT(IN)                :: g10
   REAL(KIND=dp), INTENT(IN)                :: g6
   REAL(KIND=dp), INTENT(IN)                :: g7
   REAL(KIND=dp), INTENT(IN)                :: g8
   REAL(KIND=dp), INTENT(IN)                :: g9
   REAL(KIND=dp), INTENT(IN)                :: massdiff
   REAL(KIND=dp), INTENT(IN)                :: masssum
   REAL(KIND=dp), INTENT(IN)                :: omega3
   REAL(KIND=dp), INTENT(IN)                :: omega4
   REAL(KIND=dp), INTENT(IN)                :: omega5
   REAL(KIND=dp), INTENT(IN)                :: omega6
   REAL(KIND=dp), INTENT(IN)                :: omega7
   REAL(KIND=dp), INTENT(IN)                :: omega8
   REAL(KIND=dp), INTENT(IN)                :: omega9
   REAL(KIND=dp), INTENT(IN)                :: omega10
   REAL(KIND=dp), INTENT(IN)                :: raddiff
   REAL(KIND=dp), INTENT(IN)                :: radsum
   REAL(KIND=dp), INTENT(IN)                :: rk3
   REAL(KIND=dp), INTENT(IN)                :: rk4
   REAL(KIND=dp), INTENT(IN)                :: rk5
   REAL(KIND=dp), INTENT(IN)                :: rk6
   REAL(KIND=dp), INTENT(IN)                :: rk7
   REAL(KIND=dp), INTENT(IN)                :: rk8
   REAL(KIND=dp), INTENT(IN)                :: rk9
   REAL(KIND=dp), INTENT(IN)                :: rk10
   REAL(KIND=dp), INTENT(IN)                :: sdarkint6(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint7(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint8(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint9(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint10(8)
   REAL(KIND=dp), INTENT(IN)                :: secmass
   REAL(KIND=dp), INTENT(IN)                :: secrad
   REAL(KIND=dp), INTENT(IN)                :: t10
   REAL(KIND=dp), INTENT(IN)                :: t6
   REAL(KIND=dp), INTENT(IN)                :: t7
   REAL(KIND=dp), INTENT(IN)                :: t8
   REAL(KIND=dp), INTENT(IN)                :: t9
   REAL(KIND=dp), INTENT(IN)                :: fracsum
   REAL(KIND=dp), INTENT(IN)                :: fracdiff
   REAL(KIND=dp), INTENT(IN)                :: bin2m3
   REAL(KIND=dp), INTENT(IN)                :: bin2m4
   REAL(KIND=dp), INTENT(IN)                :: bin2r3
   REAL(KIND=dp), INTENT(IN)                :: bin2r4
   REAL(KIND=dp), INTENT(IN)                :: sqecos
   REAL(KIND=dp), INTENT(IN)                :: sqesin
   REAL(KIND=dp), INTENT(IN)                :: sqtertecos
   REAL(KIND=dp), INTENT(IN)                :: sqtertesin
   REAL(KIND=dp), INTENT(IN)                :: sqp2ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp2esin
   REAL(KIND=dp), INTENT(IN)                :: sqp3ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp3esin
   REAL(KIND=dp), INTENT(IN)                :: sqp4ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp4esin
   REAL(KIND=dp), INTENT(IN)                :: sqp5ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp5esin
   REAL(KIND=dp), INTENT(IN)                :: sqp6ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp6esin
   REAL(KIND=dp), INTENT(IN)                :: sqp7ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp7esin
   REAL(KIND=dp), INTENT(IN)                :: sqp8ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp8esin
   REAL(KIND=dp), INTENT(IN)                :: angsum1
   REAL(KIND=dp), INTENT(IN)                :: angdiff1
   REAL(KIND=dp), INTENT(IN)                :: angsum2
   REAL(KIND=dp), INTENT(IN)                :: angdiff2
   REAL(KIND=dp), INTENT(IN)                :: angsum3
   REAL(KIND=dp), INTENT(IN)                :: angdiff3
   REAL(KIND=dp), INTENT(IN)                :: angsum4
   REAL(KIND=dp), INTENT(IN)                :: angdiff4
   REAL(KIND=dp), INTENT(IN)                :: angsum5
   REAL(KIND=dp), INTENT(IN)                :: angdiff5
   REAL(KIND=dp), INTENT(IN)                :: angsum6
   REAL(KIND=dp), INTENT(IN)                :: angdiff6
   REAL(KIND=dp), INTENT(IN)                :: angsum7
   REAL(KIND=dp), INTENT(IN)                :: angdiff7
   REAL(KIND=dp), INTENT(IN)                :: angsum8
   REAL(KIND=dp), INTENT(IN)                :: angdiff8
   REAL(KIND=dp), INTENT(IN)                :: fillsum
   REAL(KIND=dp), INTENT(IN)                :: filldiff
   REAL(KIND=dp), INTENT(IN)                :: binqtc
   REAL(KIND=dp), INTENT(IN)                :: p1qtc
   REAL(KIND=dp), INTENT(IN)                :: p2qtc
   REAL(KIND=dp), INTENT(IN)                :: p3qtc
   REAL(KIND=dp), INTENT(IN)                :: p4qtc
   REAL(KIND=dp), INTENT(IN)                :: p5qtc
   REAL(KIND=dp), INTENT(IN)                :: p6qtc
   REAL(KIND=dp), INTENT(IN)                :: p7qtc
   REAL(KIND=dp), INTENT(IN)                :: p8qtc
   REAL(KIND=dp), INTENT(IN)                :: tbinoff
   REAL(KIND=dp), INTENT(IN)                :: t1off
   REAL(KIND=dp), INTENT(IN)                :: t2off
   REAL(KIND=dp), INTENT(IN)                :: t3off
   REAL(KIND=dp), INTENT(IN)                :: t4off
   REAL(KIND=dp), INTENT(IN)                :: t5off
   REAL(KIND=dp), INTENT(IN)                :: t6off
   REAL(KIND=dp), INTENT(IN)                :: t7off
   REAL(KIND=dp), INTENT(IN)                :: t8off
   INTEGER, INTENT(IN)                      :: ifixgamma
   REAL(KIND=dp), INTENT(IN)                :: gamma1arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma2arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma3arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma4arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma5arry(5)
   INTEGER, INTENT(IN)                      :: icnrv1arry(5)
   INTEGER, INTENT(IN)                      :: icnrv2arry(5)
   INTEGER, INTENT(IN)                      :: icnrv3arry(5)
   INTEGER, INTENT(IN)                      :: icnrv4arry(5)
   INTEGER, INTENT(IN)                      :: icnrv5arry(5)
   INTEGER, INTENT(IN)                      :: nbody
   REAL(KIND=dp), INTENT(IN)                :: orbitparm(27)
   REAL(KIND=dp), INTENT(IN)                :: tesscontam
!
   REAL(KIND=dp)  :: tempchi,tconj2,tconj1,g4,g5,tempgam
!
   INTEGER :: iline,ilength,i,iargper,kk,icnvrt
!
   CHARACTER(LEN=7) :: string7
!   CHARACTER(LEN=8) :: string8
!   CHARACTER(LEN=9) :: string9
   CHARACTER(LEN=10) :: string10
   CHARACTER(LEN=11) :: string11
   CHARACTER(LEN=12) :: string12
   CHARACTER(LEN=13) :: string13
   CHARACTER(LEN=14) :: string14
   CHARACTER(LEN=15) :: string15
   CHARACTER(LEN=16) :: string16
   CHARACTER(LEN=17) :: string17
   CHARACTER(LEN=18) :: string18
   CHARACTER(LEN=19) :: string19
   CHARACTER(LEN=21) :: string20
   CHARACTER(LEN=21) :: string21
!   CHARACTER(LEN=21) :: string22
!
   line=' '
   iline=0
   ilength=1
!
   ilength=ilength+7
   WRITE(string7,20)nnn
   line=TRIM(line)//string7
!
!   July 5, 2001
!
!   Check that the value of chi^ does not exceed 999,999,999,999,999
!
   ilength=ilength+7
   tempchi=chisq
   IF(chisq > 999999999999.9_dp)tempchi=999999999999.9_dp
   WRITE(string18,30)tempchi
!
   line=TRIM(line)//string18
   ilength=ilength+18
!
   iargper=0
!
!  loop over the strings and match tags.  When a tag matches,
!  add a string to the end of 'line'.
!
   DO  i=1,nvarmax
      kk=icnvrt(svar(i)(1:2))
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
      IF(kk == 48)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)binqtc
         line=TRIM(line)//string20
      END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
      IF(kk == 3528)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p1qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
      IF(kk == 3560)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p2qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
      IF(kk == 3592)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p3qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
      IF(kk == 3624)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p4qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
      IF(kk == 3656)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p5qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
      IF(kk == 3688)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p6qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
      IF(kk == 3720)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p7qtc
         line=TRIM(line)//string20
      END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
      IF(kk == 3752)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p8qtc
         line=TRIM(line)//string20
      END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
      IF(kk == 51)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)tbinoff
         line=TRIM(line)//string20
      END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
      IF(kk == 3531)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t1off
         line=TRIM(line)//string20
      END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
      IF(kk == 3563)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t2off
         line=TRIM(line)//string20
      END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
      IF(kk == 3595)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t3off
         line=TRIM(line)//string20
      END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
      IF(kk == 3627)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t4off
         line=TRIM(line)//string20
      END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
      IF(kk == 3659)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t5off
         line=TRIM(line)//string20
      END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
      IF(kk == 3691)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t6off
         line=TRIM(line)//string20
      END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
      IF(kk == 3723)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t7off
         line=TRIM(line)//string20
      END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
      IF(kk == 3755)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)t8off
         line=TRIM(line)//string20
      END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
      IF(kk == 3512)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum1
         line=TRIM(line)//string20
      END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
      IF(kk == 3544)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum2
         line=TRIM(line)//string20
      END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
      IF(kk == 3576)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum3
         line=TRIM(line)//string20
      END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
      IF(kk == 3608)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum4
         line=TRIM(line)//string20
      END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
      IF(kk == 3640)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum5
         line=TRIM(line)//string20
      END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
      IF(kk == 3672)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum6
         line=TRIM(line)//string20
      END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
      IF(kk == 3704)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum7
         line=TRIM(line)//string20
      END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
      IF(kk == 3736)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angsum8
         line=TRIM(line)//string20
      END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
      IF(kk == 3515)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff1
         line=TRIM(line)//string20
      END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
      IF(kk == 3547)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff2
         line=TRIM(line)//string20
      END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
      IF(kk == 3579)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff3
         line=TRIM(line)//string20
      END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
      IF(kk == 3611)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff4
         line=TRIM(line)//string20
      END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
      IF(kk == 3643)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff5
         line=TRIM(line)//string20
      END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
      IF(kk == 3675)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff6
         line=TRIM(line)//string20
      END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
      IF(kk == 3707)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff7
         line=TRIM(line)//string20
      END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
      IF(kk == 3739)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)angdiff8
         line=TRIM(line)//string20
      END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
      IF(kk == 178)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)fracsum
         line=TRIM(line)//string20
      END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
      IF(kk == 163)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)fracdiff
         line=TRIM(line)//string20
      END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
      IF(kk == 4790)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)bin2m3
         line=TRIM(line)//string20
      END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
      IF(kk == 4791)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)bin2m4
         line=TRIM(line)//string20
      END IF
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4792)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)bin2r3
         line=TRIM(line)//string20
      END IF
!
!  tag 90, bin2R4 (R4 in solar radii in binary+binary)
!
      IF(kk == 4783)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)bin2r4
         line=TRIM(line)//string20
      END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 50)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqesin
         line=TRIM(line)//string20
      END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 34)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqecos
         line=TRIM(line)//string20
      END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3530)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqtertesin
         line=TRIM(line)//string20
      END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3514)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqtertecos
         line=TRIM(line)//string20
      END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3562)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp2esin
         line=TRIM(line)//string20
      END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3546)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp2ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3594)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp3esin
         line=TRIM(line)//string20
      END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3578)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp3ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3626)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp4esin
         line=TRIM(line)//string20
      END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3610)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp4ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3658)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp5esin
         line=TRIM(line)//string20
      END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3642)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp5ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3690)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp6esin
         line=TRIM(line)//string20
      END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3674)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp6ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3722)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp7esin
         line=TRIM(line)//string20
      END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3706)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp7ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3754)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp8esin
         line=TRIM(line)//string20
      END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3738)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sqp8ecos
         line=TRIM(line)//string20
      END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
      IF(kk == 3524)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p1mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
      IF(kk == 3527)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p1ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
      IF(kk == 3556)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p2mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
      IF(kk == 3559)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p2ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
      IF(kk == 3588)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p3mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
      IF(kk == 3591)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p3ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
      IF(kk == 3620)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p4mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
      IF(kk == 3623)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p4ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
      IF(kk == 3652)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p5mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
      IF(kk == 3655)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p5ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
      IF(kk == 3684)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p6mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
      IF(kk == 3687)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p6ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
      IF(kk == 3716)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p7mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
      IF(kk == 3719)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p7ptc
         line=TRIM(line)//string20
      END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
      IF(kk == 3748)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p8mtc
         line=TRIM(line)//string20
      END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
      IF(kk == 3751)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)p8ptc
         line=TRIM(line)//string20
      END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
      IF(kk == 44)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)pbmtc
         line=TRIM(line)//string20
      END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
      IF(kk == 47)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)pbptc
         line=TRIM(line)//string20
      END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
      IF(kk == 40)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,210)bigi2
         line=TRIM(line)//string14
      END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
      IF(kk == 33)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,220)bigbeta2
         line=TRIM(line)//string14
      END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
      IF(kk == 72)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,210)bigi3
         line=TRIM(line)//string14
      END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
      IF(kk == 65)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,220)bigbeta3
         line=TRIM(line)//string14
      END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
      IF(kk == 104)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,210)bigi4
         line=TRIM(line)//string14
      END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
      IF(kk == 97)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,220)bigbeta4
         line=TRIM(line)//string14
      END IF
!
!  tag 91, b2masssum (M3+M4 in binary+binary)
!
      IF(kk == 4784)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)b2masssum
         line=TRIM(line)//string18
      END IF
!
!  tag 92, b2massdiff (M3-M4 in binary+binary)
!
      IF(kk == 4785)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)b2massdiff
         line=TRIM(line)//string18
      END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
      IF(kk == 4786)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,230)bin2q
         line=TRIM(line)//string19
      END IF
!
!  tag 94, b2radsum (R3+R4 in binary+binary)
!
      IF(kk == 4787)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)b2radsum
         line=TRIM(line)//string18
      END IF
!
!  tag 95, b2raddiff (R3-R4 in binary+binary)
!
      IF(kk == 4788)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)b2raddiff
         line=TRIM(line)//string18
      END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
      IF(kk == 4789)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)bin2ratrad
         line=TRIM(line)//string17
      END IF
!
!   tag g4, g4
!
      IF(kk == 1211)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g4
         line=TRIM(line)//string10
      END IF
!
!   tag g5, g5
!
      IF(kk == 1212)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g5
         line=TRIM(line)//string10
      END IF
!
!   tag g6, g6
!
      IF(kk == 1213)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g6
         line=TRIM(line)//string10
      END IF
!
!   tag g7, g7
!
      IF(kk == 1214)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g7
         line=TRIM(line)//string10
      END IF
!
!   tag g8, g8
!
      IF(kk == 1215)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g8
         line=TRIM(line)//string10
      END IF
!
!   tag g9, g9
!
      IF(kk == 1216)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g9
         line=TRIM(line)//string10
      END IF
!
!   tag g0, g10
!
      IF(kk == 1207)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)g10
         line=TRIM(line)//string10
      END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
      IF(kk == 387)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)massdiff
         line=TRIM(line)//string18
      END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
      IF(kk == 402)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)masssum
         line=TRIM(line)//string18
      END IF
!
!   tag o3, omega3
!
      IF(kk == 1466)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega3
         line=TRIM(line)//string14
      END IF
!
!   tag o4, omega4
!
      IF(kk == 1467)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega4
         line=TRIM(line)//string14
      END IF
!
!   tag o5, omega5
!
      IF(kk == 1468)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega5
         line=TRIM(line)//string14
      END IF
!
!   tag o6, omega6
!
      IF(kk == 1469)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega6
         line=TRIM(line)//string14
      END IF
!
!   tag o7, omega7
!
      IF(kk == 1470)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega7
         line=TRIM(line)//string14
      END IF
!
!   tag o8, omega8
!
      IF(kk == 1471)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega8
         line=TRIM(line)//string14
      END IF
!
!   tag o9, omega9
!
      IF(kk == 1472)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega9
         line=TRIM(line)//string14
      END IF
!
!   tag o0, omega10
!
      IF(kk == 1463)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega10
         line=TRIM(line)//string14
      END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
      IF(kk == 562)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)radsum
         line=TRIM(line)//string18
      END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
      IF(kk == 547)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)raddiff
         line=TRIM(line)//string18
      END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
      IF(kk == 1018)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk3
         line=TRIM(line)//string14
      END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
      IF(kk == 1019)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk4
         line=TRIM(line)//string14
      END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
      IF(kk == 1020)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk5
         line=TRIM(line)//string14
      END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
      IF(kk == 1021)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk6
         line=TRIM(line)//string14
      END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
      IF(kk == 1022)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk7
         line=TRIM(line)//string14
      END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
      IF(kk == 1023)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk8
         line=TRIM(line)//string14
      END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
      IF(kk == 1024)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk9
         line=TRIM(line)//string14
      END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
      IF(kk == 1015)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)rk10
         line=TRIM(line)//string14
      END IF
!
!   tag sm, secmass
!
      IF(kk == 588)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)secmass
         line=TRIM(line)//string18
      END IF
!
!   tag sr, secrad
!
      IF(kk == 593)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)secrad
         line=TRIM(line)//string18
      END IF
!
!   tag t6, t6 (Teff6)
!
      IF(kk == 1629)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t6
         line=TRIM(line)//string15
      END IF
!
!   tag t7, t7 (Teff7)
!
      IF(kk == 1630)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t7
         line=TRIM(line)//string15
      END IF
!
!   tag t8, t8 (Teff8)
!
      IF(kk == 1631)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t8
         line=TRIM(line)//string15
      END IF
!
!   tag t9, t9 (Teff9)
!
      IF(kk == 1632)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t9
         line=TRIM(line)//string15
      END IF
!
!   tag ta, t10 (Teff10)
!
      IF(kk == 608)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t10
         line=TRIM(line)//string15
      END IF
!
!  tag 61, flux star 6, band 1
!
      IF(kk == 4688)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 62, flux star 6, band 2
!
      IF(kk == 4689)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 63, flux star 6, band 3
!
      IF(kk == 4690)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 64, flux star 6, band 4
!
      IF(kk == 4691)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 65, flux star 6, band 5
!
      IF(kk == 4692)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 66, flux star 6, band 6
!
      IF(kk == 4693)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 67, flux star 6, band 7
!
      IF(kk == 4694)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 68, flux star 6, band 8
!
      IF(kk == 4695)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint6(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 71, flux star 7, band 1
!
      IF(kk == 4720)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 72, flux star 7, band 2
!
      IF(kk == 4721)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 73, flux star 7, band 3
!
      IF(kk == 4722)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 74, flux star 7, band 4
!
      IF(kk == 4723)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 75, flux star 7, band 5
!
      IF(kk == 4724)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 76, flux star 7, band 6
!
      IF(kk == 4725)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 77, flux star 7, band 7
!
      IF(kk == 4726)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 78, flux star 7, band 8
!
      IF(kk == 4727)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint7(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 81, flux star 8, band 1
!
      IF(kk == 4752)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 82, flux star 8, band 2
!
      IF(kk == 4753)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 83, flux star 8, band 3
!
      IF(kk == 4754)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 84, flux star 8, band 4
!
      IF(kk == 4755)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 85, flux star 8, band 5
!
      IF(kk == 4756)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 86, flux star 8, band 6
!
      IF(kk == 4757)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 87, flux star 8, band 7
!
      IF(kk == 4758)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 88, flux star 8, band 8
!
      IF(kk == 4759)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint8(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 91, flux star 9, band 1
!
      IF(kk == 2784)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 92, flux star 9, band 2
!
      IF(kk == 2785)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 93, flux star 9, band 3
!
      IF(kk == 2786)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 94, flux star 9, band 4
!
      IF(kk == 2787)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 95, flux star 9, band 5
!
      IF(kk == 2788)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 96, flux star 9, band 6
!
      IF(kk == 2789)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 97, flux star 9, band 7
!
      IF(kk == 2790)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 98, flux star 9, band 8
!
      IF(kk == 2791)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint9(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 01, flux star 10, band 1
!
      IF(kk == 4496)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 02, flux star 10, band 2
!
      IF(kk == 4497)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 03, flux star 10, band 3
!
      IF(kk == 4498)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 04, flux star 10, band 4
!
      IF(kk == 4499)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 05, flux star 10, band 5
!
      IF(kk == 4500)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 06, flux star 10, band 6
!
      IF(kk == 4501)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 07, flux star 10, band 7
!
      IF(kk == 4502)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 08, flux star 10, band 8
!
      IF(kk == 4503)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint10(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 11, flux star 1, band 1
!
      IF(kk == 4528)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 12, flux star 1, band 2
!
      IF(kk == 4529)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 13, flux star 1, band 3
!
      IF(kk == 4530)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 14, flux star 1, band 4
!
      IF(kk == 4531)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 15, flux star 1, band 5
!
      IF(kk == 4532)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 16, flux star 1, band 6
!
      IF(kk == 4533)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 17, flux star 1, band 7
!
      IF(kk == 4534)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 18, flux star 1, band 8
!
      IF(kk == 4535)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint1(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 21, flux star 2, band 1
!
      IF(kk == 4560)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 22, flux star 2, band 2
!
      IF(kk == 4561)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 23, flux star 2, band 3
!
      IF(kk == 4562)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 24, flux star 2, band 4
!
      IF(kk == 4563)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 25, flux star 2, band 5
!
      IF(kk == 4564)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 26, flux star 2, band 6
!
      IF(kk == 4565)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 27, flux star 2, band 7
!
      IF(kk == 4566)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 28, flux star 2, band 8
!
      IF(kk == 4567)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint2(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 31, flux star 3, band 1
!
      IF(kk == 4592)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 32, flux star 3, band 2
!
      IF(kk == 4593)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 33, flux star 3, band 3
!
      IF(kk == 4594)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 34, flux star 3, band 4
!
      IF(kk == 4595)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 35, flux star 3, band 5
!
      IF(kk == 4596)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 36, flux star 3, band 6
!
      IF(kk == 4597)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 37, flux star 3, band 7
!
      IF(kk == 4598)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 38, flux star 3, band 8
!
      IF(kk == 4599)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint3(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 41, flux star 4, band 1
!
      IF(kk == 4624)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 42, flux star 4, band 2
!
      IF(kk == 4625)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 43, flux star 4, band 3
!
      IF(kk == 4626)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 44, flux star 4, band 4
!
      IF(kk == 4627)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 45, flux star 4, band 5
!
      IF(kk == 4628)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 46, flux star 4, band 6
!
      IF(kk == 4629)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 47, flux star 4, band 7
!
      IF(kk == 4630)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 48, flux star 4, band 8
!
      IF(kk == 4631)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(8)
         line=TRIM(line)//string20
      END IF
!
!  tag 51, flux star 5, band 1
!
      IF(kk == 4656)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(1)
         line=TRIM(line)//string20
      END IF
!
!  tag 52, flux star 5, band 2
!
      IF(kk == 4657)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(2)
         line=TRIM(line)//string20
      END IF
!
!  tag 53, flux star 5, band 3
!
      IF(kk == 4658)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(3)
         line=TRIM(line)//string20
      END IF
!
!  tag 54, flux star 5, band 4
!
      IF(kk == 4659)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(4)
         line=TRIM(line)//string20
      END IF
!
!  tag 55, flux star 5, band 5
!
      IF(kk == 4660)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(5)
         line=TRIM(line)//string20
      END IF
!
!  tag 56, flux star 6, band 6
!
      IF(kk == 4661)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(6)
         line=TRIM(line)//string20
      END IF
!
!  tag 57, flux star 5, band 7
!
      IF(kk == 4662)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint4(7)
         line=TRIM(line)//string20
      END IF
!
!  tag 58, flux star 5, band 8
!
      IF(kk == 4663)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,40)sdarkint5(8)
         line=TRIM(line)//string20
      END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
      IF((kk == 450).AND.(isw29 > 0))THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)ocose
         line=TRIM(line)//string18
      END IF
!
!  tag os, osine, e*sin(omega) for binary
!
      IF((kk == 466).AND.(isw29 > 0))THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)osine
         line=TRIM(line)//string18
      END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1
!
      IF(kk == 1016)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)sw72
         line=TRIM(line)//string14
      END IF
!
!  tag a2, rk2, tidal apsidal constant for star 2
!
      IF(kk == 1017)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)sw73
         line=TRIM(line)//string14
      END IF
!
!  tag tt, tertperiod, orbital period of body 3
!
      IF(kk == 627)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)tertperiod
         line=TRIM(line)//string21
      END IF
!
!  tag ut, P2period
!
      IF(kk == 659)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p2period
         line=TRIM(line)//string21
      END IF
!
!  tag vt, P3period
!
      IF(kk == 691)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p3period
         line=TRIM(line)//string21
      END IF
!
!  tag wt, P4period
!
      IF(kk == 723)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p4period
         line=TRIM(line)//string21
      END IF
!
!  tag xt, P5period
!
      IF(kk == 755)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p5period
         line=TRIM(line)//string21
      END IF
!
!  tag st, P6period
!
      IF(kk == 595)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p6period
         line=TRIM(line)//string21
      END IF
!
!  tag ht, P7period
!
      IF(kk == 243)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p7period
         line=TRIM(line)//string21
      END IF
!
!  tag kt, P8period
!
      IF(kk == 339)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)p8period
         line=TRIM(line)//string21
      END IF
!
!  tag tu, tertT0, periastron passage of body 3 orbit
!
      IF(kk == 628)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)tertt0
         line=TRIM(line)//string19
      END IF
!
!  tag uu, P2T0
!
      IF(kk == 660)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p2t0
         line=TRIM(line)//string19
      END IF
!
!  tag vu, P3T0
!
      IF(kk == 692)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p3t0
         line=TRIM(line)//string19
      END IF
!
!  tag wu, P4T0
!
      IF(kk == 724)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p4t0
         line=TRIM(line)//string19
      END IF
!
!  tag xu, P5T0
!
      IF(kk == 756)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p5t0
         line=TRIM(line)//string19
      END IF
!
!  tag su, P6T0
!
      IF(kk == 596)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p6t0
         line=TRIM(line)//string19
      END IF
!
!  tag hu, P7T0
!
      IF(kk == 244)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p7t0
         line=TRIM(line)//string19
      END IF
!
!  tag ku, P8T0
!
      IF(kk == 340)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p8t0
         line=TRIM(line)//string19
      END IF
!
!  tag tj, tertconj, time of primary conjunction of body 3 orbit
!
      IF(kk == 617)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)tertconj
         line=TRIM(line)//string19
      END IF
!
!  tag uj, P2tconj
!
      IF(kk == 649)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p2tconj
         line=TRIM(line)//string19
      END IF
!
!  tag vj, P3tconj
!
      IF(kk == 681)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p3tconj
         line=TRIM(line)//string19
      END IF
!
!  tag wj, P4tconj
!
      IF(kk == 713)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p4tconj
         line=TRIM(line)//string19
      END IF
!
!  tag xj, P5tconj
!
      IF(kk == 745)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p5tconj
         line=TRIM(line)//string19
      END IF
!
! tag sj, P6tconj
!
      IF(kk == 585)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p6tconj
         line=TRIM(line)//string19
      END IF
!
!  tag hj, P7tconj
!
      IF(kk == 233)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p7tconj
         line=TRIM(line)//string19
      END IF
!
!  tag kj, P8tconj
!
      IF(kk == 329)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)p8tconj
         line=TRIM(line)//string19
      END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3 orbit
!
      IF(kk == 629)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)tertecos
         line=TRIM(line)//string18
      END IF
!
!  tag uv, P2ecos
!
      IF(kk == 661)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p2ecos
         line=TRIM(line)//string18
      END IF
!
!  tag vv, P3ecos
!
      IF(kk == 693)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p3ecos
         line=TRIM(line)//string18
      END IF
!
!  tag wv, P4ecos
!
      IF(kk == 725)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p4ecos
         line=TRIM(line)//string18
      END IF
!
!  tag xv, P5ecos
!
      IF(kk == 757)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p5ecos
         line=TRIM(line)//string18
      END IF
!
!  tag sv, P6ecos
!
      IF(kk == 597)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p6ecos
         line=TRIM(line)//string18
      END IF
!
!  tag hv, P7ecos
!
      IF(kk == 245)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p7ecos
         line=TRIM(line)//string18
      END IF
!
!  tag kv, P8ecos
!
      IF(kk == 341)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p8ecos
         line=TRIM(line)//string18
      END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3 orbit
!
      IF(kk == 630)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)tertesin
         line=TRIM(line)//string18
      END IF
!
!  tag uw, P2esin
!
      IF(kk == 662)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p2esin
         line=TRIM(line)//string18
      END IF
!
!  tag vw, P3esin
!
      IF(kk == 694)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p3esin
         line=TRIM(line)//string18
      END IF
!
!  tag ww, P4esin
!
      IF(kk == 726)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p4esin
         line=TRIM(line)//string18
      END IF
!
!  tag xw, P5esin
!
      IF(kk == 758)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p5esin
         line=TRIM(line)//string18
      END IF
!
!  tag sw, P6esin
!
      IF(kk == 598)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p6esin
         line=TRIM(line)//string18
      END IF
!
!  tag hw, P7esin
!
      IF(kk == 246)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p7esin
         line=TRIM(line)//string18
      END IF
!
!  tag kw, P8esin
!
      IF(kk == 342)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,50)p8esin
         line=TRIM(line)//string18
      END IF
!
!  tag tx, tertincl, inclination of body 3 orbit
!
      IF(kk == 631)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)tertincl
         line=TRIM(line)//string20
      END IF
!
!  tag ux, P2incl
!
      IF(kk == 663)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p2incl
         line=TRIM(line)//string20
      END IF
!
!  tag vx, P3incl
!
      IF(kk == 695)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p3incl
         line=TRIM(line)//string20
      END IF
!
!  tag wx, P4incl
!
      IF(kk == 727)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p4incl
         line=TRIM(line)//string20
      END IF
!
!  tag xx, P5incl
!
      IF(kk == 759)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p5incl
         line=TRIM(line)//string20
      END IF
!
!  tag sx, P6incl
!
      IF(kk == 599)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p6incl
         line=TRIM(line)//string20
      END IF
!
!  tag hx, P7incl
!
      IF(kk == 247)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p7incl
         line=TRIM(line)//string20
      END IF
!
!  tag kx, P8incl
!
      IF(kk == 343)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)p8incl
         line=TRIM(line)//string20
      END IF
!
!  tag ty, tertOmega, nodal angle of body 3 orbit
!
      IF(kk == 632)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)tertomega
         line=TRIM(line)//string20
      END IF
!
!  tag ob, Omega_bin, nodal angle of binary
!
      IF(kk == 449)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)sw49
         line=TRIM(line)//string20
      END IF
!
!  tag uy, P2Omega
!
      IF(kk == 664)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p2omega
         line=TRIM(line)//string20
      END IF
!
!  tag vy, P3Omega
!
      IF(kk == 696)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p3omega
         line=TRIM(line)//string20
      END IF
!
!  tag wy, P4Omega
!
      IF(kk == 728)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p4omega
         line=TRIM(line)//string20
      END IF
!
!  tag xy, P5Omega
!
      IF(kk == 760)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p5omega
         line=TRIM(line)//string20
      END IF
!
!  tag sy, P6Omega
!
      IF(kk == 600)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p6omega
         line=TRIM(line)//string20
      END IF
!
!  tag hy, P7Omega
!
      IF(kk == 248)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p7omega
         line=TRIM(line)//string20
      END IF
!
!  tag ky, P8Omega
!
      IF(kk == 344)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)p8omega
         line=TRIM(line)//string20
      END IF
!
!  tag tz, tertQ, mass ratio of body 3
!
      IF(kk == 633)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)tertq
         line=TRIM(line)//string21
      END IF
!
!  tag tb, tertratrad, radius ratio of body 3
!
      IF(kk == 609)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)tertratrad
         line=TRIM(line)//string17
      END IF
!
!  tag uz, P2Q
!
      IF(kk == 665)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p2q
         line=TRIM(line)//string21
      END IF
!
!  tag vz, P3Q
!
      IF(kk == 697)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p3q
         line=TRIM(line)//string21
      END IF
!
!  tag wz, P4Q
!
      IF(kk == 729)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p4q
         line=TRIM(line)//string21
      END IF
!
!  tag xz, P5Q
!
      IF(kk == 761)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p5q
         line=TRIM(line)//string21
      END IF
!
!  tag sz, P6Q
!
      IF(kk == 601)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p6q
         line=TRIM(line)//string21
      END IF
!
!  tag hz, P7Q
!
      IF(kk == 249)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p7q
         line=TRIM(line)//string21
      END IF
!
!  tag kz, P8Q
!
      IF(kk == 345)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,110)p8q
         line=TRIM(line)//string21
      END IF
!
!  tag ub, P2ratrad
!
      IF(kk == 641)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p2ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag vb, P3ratrad
!
      IF(kk == 673)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p3ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag wb, P4ratrad
!
      IF(kk == 705)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p4ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag xb, P5ratrad
!
      IF(kk == 737)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p5ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag sb, P6ratrad
!
      IF(kk == 577)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p6ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag hb, P7ratrad
!
      IF(kk == 225)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p7ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag kb, P8ratrad
!
      IF(kk == 321)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)p8ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag ct, tesscontam, TESS contamination
!
      IF(kk == 83)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)tesscontam
         line=TRIM(line)//string14
      END IF
!
!  tag co, contam, Kepler contamination
!
      IF(kk == 78)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)contam
         line=TRIM(line)//string14
      END IF
!
!  tag s0, contamS0, contamination season 0
!
      IF(kk == 1591)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)contams0
         line=TRIM(line)//string14
      END IF
!
!  tag s1, contamS1, contamination season 1
!
      IF(kk == 1592)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)contams1
         line=TRIM(line)//string14
      END IF
!
!  tag s2, contamS2, contamination season 2
!
      IF(kk == 1593)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)contams2
         line=TRIM(line)//string14
      END IF
!
!  tag s3, contamS3, contamination season 3
!
      IF(kk == 1594)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,60)contams3
         line=TRIM(line)//string14
      END IF
!
!  tag e1, beam1, Doppler boosting coefficient for star 1
!
      IF(kk == 1144)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,130)beam1
         line=TRIM(line)//string13
      END IF
!
!  tag e2, beam2, Doppler boosting coefficient for star 2
!
      IF(kk == 1145)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,130)beam2
         line=TRIM(line)//string13
      END IF
!
!  tag pm, primmass, mass of star 1 in solar masses
!
      IF(kk == 492)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,140)primmass
         line=TRIM(line)//string18
      END IF
!
!  tag pr, primrad, radius of star in solar radii
!
      IF(kk == 497)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)primrad
         line=TRIM(line)//string18
      END IF
!
!  tag pk, primK, K-velocity of star 1 in km/sec
!
      IF(kk == 490)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,160)primk
         line=TRIM(line)//string18
      END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
      IF(kk == 544)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,120)ratrad
         line=TRIM(line)//string17
      END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
      IF(kk == 1528)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,170)frac1
         line=TRIM(line)//string17
      END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
      IF(kk == 1529)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,170)frac2
         line=TRIM(line)//string17
      END IF
!
!  tag te, temprat, ratio of star 2 temperature to star 1 temperature
!
      IF(kk == 612)THEN
         iline=iline+1
         ilength=ilength+18
         WRITE(string18,150)temprat
         line=TRIM(line)//string18
      END IF
!
!  tag de, density, density of star 1 in cgs
!
      IF(kk == 100)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)density
         line=TRIM(line)//string14
      END IF
!
!  tag l1, alb1, albedo of star 1
!
      IF(kk == 1368)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)alb1
         line=TRIM(line)//string15
      END IF
!
!  tag l2, alb2, albedo of star 2
!
      IF(kk == 1369)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)alb2
         line=TRIM(line)//string15
      END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
      IF(kk == 1208)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)tgrav1
         line=TRIM(line)//string15
      END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
      IF(kk == 1209)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)tgrav2
         line=TRIM(line)//string15
      END IF
!
!  tag do, omegadot
!
      IF(kk == 110)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)omegadot
         line=TRIM(line)//string14
      END IF
!
!  tag p2, period, binary orbital period in days
!
      IF(kk == 484)THEN
         iline=iline+1
         ilength=ilength+21
         WRITE(string21,70)period
         line=TRIM(line)//string21
      END IF
!
!  tag t0, T0, time of periastron passage of binary orbit
!
      IF(kk == 1623)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)t0
         line=TRIM(line)//string19
      END IF
!
!  tag tc, Tconj, time of primary conjunction of the binary orbit
!
      IF(kk == 610)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,80)tconj
         line=TRIM(line)//string19
      END IF
!
!  tag in, finc, inclination of binary in degrees
!
      IF(kk == 269)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,90)finc
         line=TRIM(line)//string20
      END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
      IF(kk == 8)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,210)bigi
         line=TRIM(line)//string14
      END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
      IF(kk == 1)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,220)bigbeta
         line=TRIM(line)//string14
      END IF
!
!  tag ma, Q, mass ratio of binary
!
      IF(kk == 384)THEN
         iline=iline+1
         ilength=ilength+19
         WRITE(string19,230)q
         line=TRIM(line)//string19
      END IF
!
!  tag sf, fillsum, sum of fill1 and fill2
!
      IF(kk == 581)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)fillsum
         line=TRIM(line)//string15
      END IF
!
!  tag sd, filldiff, difference of fill1 and fill2
!
      IF(kk == 579)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)filldiff
         line=TRIM(line)//string14
      END IF
!
!  tag f1, fill1, Roche lobe filling factor of star 1
!
      IF(kk == 1176)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)fill1
         line=TRIM(line)//string15
      END IF
!
!  tag f2, fill2, Roche lobe filling factor of star 2
!
      IF(kk == 1177)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,170)fill2
         line=TRIM(line)//string17
      END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
      IF(kk == 552)THEN
         iline=iline+1
         ilength=ilength+12
         WRITE(string12,240)rinner
         line=TRIM(line)//string12
      END IF
!
!  tag o1, omega1, spin frequency of star 1
!
      IF(kk == 1464)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega1
         line=TRIM(line)//string14
      END IF
!
!  tag o2, spin frequency of star 2
!
      IF(kk == 1465)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,250)omega2
         line=TRIM(line)//string14
      END IF
!
!  tag ro, router, radius of outer edge of accretion disk
!
      IF(kk == 558)THEN
         iline=iline+1
         ilength=ilength+12
         WRITE(string12,240)router
         line=TRIM(line)//string12
      END IF
!
!  tag t3, Teff3, effective temperature of star 3
!
      IF(kk == 1626)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)t3
         line=TRIM(line)//string15
      END IF
!
!   tag t4, Teff4, effective temperature of star 4
!
      IF(kk == 1627)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)sw80
         line=TRIM(line)//string15
      END IF
!
!  tag t5, Teff5, effective temperature of star 5
!
      IF(kk == 1628)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)sw81
         line=TRIM(line)//string15
      END IF
!
!  tag g3, g3, gravity of star 3 (log(g))
!
      IF(kk == 1210)THEN
         iline=iline+1
         ilength=ilength+16
         WRITE(string16,260)g3
         line=TRIM(line)//string16
      END IF
!
!  tag be, betarim, opening angle of accretion disk rim
!
      IF(kk == 36)THEN
         iline=iline+1
         ilength=ilength+11
         WRITE(string11,280)betarim
         line=TRIM(line)//string11
      END IF
!
!  tag t1, Teff1, effective temperature of star 1
!
      IF(kk == 1624)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,270)teff1
         line=TRIM(line)//string15
      END IF
!
!  tag t2, Teff2, effective temperature of star 2
!
      IF(kk == 1625)THEN
         iline=iline+1
         ilength=ilength+16
         WRITE(string16,260)teff2
         line=TRIM(line)//string16
      END IF
!
!  tag xi, xi, power-law exponent of the disk temperature profile
!
      IF(kk == 744)THEN
         iline=iline+1
         ilength=ilength+10
         WRITE(string10,290)xi
         line=TRIM(line)//string10
      END IF
!
!  tag td, Tdisk, temperature of the inner edge of the accretion disk
!
      IF(kk == 611)THEN
         iline=iline+1
         ilength=ilength+16
         WRITE(string16,260)tdisk
         line=TRIM(line)//string16
      END IF
!
!  tag lx, rLx, log of the X-ray luminosity in cgs units
!
      IF(kk == 375)THEN
         iline=iline+1
         ilength=ilength+12
         WRITE(string12,300)rlx
         line=TRIM(line)//string12
      END IF
!
!  tag se, separ, semimajor axis of binary orbit
!
      IF(kk == 580)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,305)separ
         line=TRIM(line)//string17
      END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
      IF(kk == 576)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,320)sa3
         line=TRIM(line)//string15
      END IF
!
!  tag ps, pshift
!
      IF(kk == 498)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,330)pshift
         line=TRIM(line)//string13
      END IF
!
!  tag ec, ecc, eccentricity of binary orbit
!
      IF(kk == 130)THEN
         iline=iline+1
         ilength=ilength+17
         WRITE(string17,170)ecc
         line=TRIM(line)//string17
      END IF
!
!  tag ar, argper, argument of periastron of binary orbit
!
      IF(kk == 17)THEN
         iline=iline+1
         ilength=ilength+20
         WRITE(string20,100)argper
         line=TRIM(line)//string20
      END IF
!
!  tag b1, temperature factor spot 1, star 1
!
      IF(kk == 1048)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot1parm(1,1)
         line=TRIM(line)//string14
      END IF
!
!  tag b2, latitude spot 1, star 1
!
      IF(kk == 1049)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot1parm(1,2)
         line=TRIM(line)//string13
      END IF
!
!  tag b3, longitude spot 1, star 1
!
      IF(kk == 1050)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot1parm(1,3)
         line=TRIM(line)//string13
      END IF
!
!  tag  b4, radius spot 1, star 1
!
      IF(kk == 1051)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot1parm(1,4)
         line=TRIM(line)//string14
      END IF
!
!  tag b5, temperature factor spot 2, star 1
!
      IF(kk == 1052)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot1parm(2,1)
         line=TRIM(line)//string14
      END IF
!
!  tag b6,  latitude spot 2, star 1
!
      IF(kk == 1053)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot1parm(2,2)
         line=TRIM(line)//string13
      END IF
!
!  tag b7, longitude spot 2, star 1
!
      IF(kk == 1054)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot1parm(2,3)
         line=TRIM(line)//string13
      END IF
!
!  tag b8, radius spot 2, star 1
!
      IF(kk == 1055)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot1parm(2,4)
         line=TRIM(line)//string14
      END IF
!
!  tag c1, temperature factor spot 1, star 2
!
      IF(kk == 1080)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot2parm(1,1)
         line=TRIM(line)//string14
      END IF
!
!  tag c2, latitude spot 1, star 2
!
      IF(kk == 1081)THEN
         iline=iline+1
         ilength=ilength+3
         WRITE(string13,340)spot2parm(1,2)
         line=TRIM(line)//string13
      END IF
!
!  tag c3, longitude spot 1, star 2
!
      IF(kk == 1082)THEN
         iline=iline+1
         ilength=ilength+3
         WRITE(string13,340)spot2parm(1,3)
         line=TRIM(line)//string13
      END IF
!
!  tag c4, radius spot 1, star 2
!
      IF(kk == 1083)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot2parm(1,4)
         line=TRIM(line)//string14
      END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
      IF(kk == 1084)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot2parm(2,1)
         line=TRIM(line)//string14
      END IF
!
!  tag c6, latitude spot 2, star 2
!
      IF(kk == 1085)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot2parm(2,2)
         line=TRIM(line)//string13
      END IF
!
!  tag c7, longitude spot 2, star 2
!
      IF(kk == 1086)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spot2parm(2,3)
         line=TRIM(line)//string13
      END IF
!
!  tag c8, radius spot 2, star 2
!
      IF(kk == 1087)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spot2parm(2,4)
         line=TRIM(line)//string14
      END IF
!
!  tag d1, temperature factor spot 1 on disk
!
      IF(kk == 1112)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spotdparm(1,1)
         line=TRIM(line)//string14
      END IF
!
!  tag d2, azimuth spot 1 on disk
!
      IF(kk == 1113)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spotdparm(1,2)
         line=TRIM(line)//string13
      END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
      IF(kk == 1114)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spotdparm(1,3)
         line=TRIM(line)//string13
      END IF
!
!  tag d4, angular width of spot 1 on disk
!
      IF(kk == 1115)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spotdparm(1,4)
         line=TRIM(line)//string14
      END IF
!
!  tag d5, temperature factor spot 2 on disk
!
      IF(kk == 1116)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spotdparm(2,1)
         line=TRIM(line)//string14
      END IF
!
!  tag d6, azimuth spot 2 on disk
!
      IF(kk == 1117)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spotdparm(2,2)
         line=TRIM(line)//string13
      END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
      IF(kk == 1118)THEN
         iline=iline+1
         ilength=ilength+13
         WRITE(string13,340)spotdparm(2,3)
         line=TRIM(line)//string13
      END IF
!
!  tag d8, angular width of spot 2 on disk
!
      IF(kk == 1119)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,180)spotdparm(2,4)
         line=TRIM(line)//string14
      END IF
!
!  tag x1, limb darkening x-coefficient, band 1, star 1
!
      IF(kk == 1752)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(1,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x2, limb darkening x-coefficient, band 2, star 1
!
      IF(kk == 1753)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(2,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x3, limb darkening x-coefficient, band 3, star 1
!
      IF(kk == 1754)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(3,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x4, limb darkening x-coefficient, band 4, star 1
!
      IF(kk == 1755)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(4,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x5, limb darkening x-coefficient, band 5, star 1
!
      IF(kk == 1756)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(5,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x6, limb darkening x-coefficient, band 6, star 1
!
      IF(kk == 1757)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(6,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x7, limb darkening x-coefficient, band 7, star 1
!
      IF(kk == 1758)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(7,1)
         line=TRIM(line)//string14
      END IF
!
!  tag x8, limb darkening x-coefficient, band 8, star 1
!
      IF(kk == 1759)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(8,1)
         line=TRIM(line)//string14
      END IF
!
!  tag z1, limb darkening x-coefficient, band 1, star 2
!
      IF(kk == 1816)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(1,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z2, limb darkening x-coefficient, band 2, star 2
!
      IF(kk == 1817)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(2,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z3, limb darkening x-coefficient, band 3, star 2
!
      IF(kk == 1818)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(3,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z4, limb darkening x-coefficient, band 4, star 2
!
      IF(kk == 1819)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(4,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z5, limb darkening x-coefficient, band 5, star 2
!
      IF(kk == 1820)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(5,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z6, limb darkening x-coefficient, band 6, star 2
!
      IF(kk == 1821)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(6,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z7, limb darkening x-coefficient, band 7, star 2
!
      IF(kk == 1822)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(7,2)
         line=TRIM(line)//string14
      END IF
!
!  tag z8, limb darkening x-coefficient, band 8, star 2
!
      IF(kk == 1823)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(8,2)
         line=TRIM(line)//string14
      END IF
!
!  tag y1, limb darkening y-coefficient, band 1, star 1
!
      IF(kk == 1784)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(1,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y2, limb darkening y-coefficient, band 2, star 1
!
      IF(kk == 1785)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(2,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y3, limb darkening y-coefficient, band 3, star 1
!
      IF(kk == 1786)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(3,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y4, limb darkening y-coefficient, band 4, star 1
!
      IF(kk == 1787)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(4,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y5, limb darkening y-coefficient, band 5, star 1
!
      IF(kk == 1788)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(5,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y6, limb darkening y-coefficient, band 6, star 1
!
      IF(kk == 1789)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(6,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y7, limb darkening y-coefficient, band 7, star 1
!
      IF(kk == 1790)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(7,1)
         line=TRIM(line)//string14
      END IF
!
!  tag y8, limb darkening y-coefficient, band 8, star 1
!
      IF(kk == 1791)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(8,1)
         line=TRIM(line)//string14
      END IF
!
!  tag w1, limb darkening y-coefficient, band 1, star 2
!
      IF(kk == 1720)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(1,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w2, limb darkening y-coefficient, band 2, star 2
!
      IF(kk == 1721)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(2,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w3, limb darkening y-coefficient, band 3, star 2
!
      IF(kk == 1722)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(3,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w4, limb darkening y-coefficient, band 4, star 2
!
      IF(kk == 1723)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(4,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w5, limb darkening y-coefficient, band 5, star 2
!
      IF(kk == 1724)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(5,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w6, limb darkening y-coefficient, band 6, star 2
!
      IF(kk == 1725)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(6,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w7, limb darkening y-coefficient, band 7, star 2
!
      IF(kk == 1726)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(7,2)
         line=TRIM(line)//string14
      END IF
!
!  tag w8, limb darkening y-coefficient, band 8, star 2
!
      IF(kk == 1727)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(8,2)
         line=TRIM(line)//string14
      END IF
!
!  tag m1, limb darkening x-coefficient, band 1, star 3
!
      IF(kk == 1400)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(1,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m2, limb darkening x-coefficient, band 2, star 3
!
      IF(kk == 1401)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(2,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m3, limb darkening x-coefficient, band 3, star 3
!
      IF(kk == 1402)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(3,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m4, limb darkening x-coefficient, band 4, star 3
!
      IF(kk == 1403)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(4,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m5, limb darkening x-coefficient, band 5, star 3
!
      IF(kk == 1404)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(5,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m6, limb darkening x-coefficient, band 6, star 3
!
      IF(kk == 1405)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(6,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m7, limb darkening x-coefficient, band 7, star 3
!
      IF(kk == 1406)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(7,3)
         line=TRIM(line)//string14
      END IF
!
!  tag m8, limb darkening x-coefficient, band 8, star 3
!
      IF(kk == 1407)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(8,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n1, limb darkening y-coefficient, band 1, star 3
!
      IF(kk == 1432)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(1,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n2, limb darkening y-coefficient, band 2, star 3
!
      IF(kk == 1433)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(2,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n3, limb darkening y-coefficient, band 3, star 3
!
      IF(kk == 1434)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(3,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n4, limb darkening y-coefficient, band 4, star 3
!
      IF(kk == 1435)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(4,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n5, limb darkening y-coefficient, band 5, star 3
!
      IF(kk == 1436)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(5,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n6, limb darkening y-coefficient, band 6, star 3
!
      IF(kk == 1437)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(6,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n7, limb darkening y-coefficient, band 7, star 3
!
      IF(kk == 1438)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(7,3)
         line=TRIM(line)//string14
      END IF
!
!  tag n8, limb darkening y-coefficient, band 8, star 3
!
      IF(kk == 1439)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(8,3)
         line=TRIM(line)//string14
      END IF
!
!  tag i1, limb darkening x-coefficient, band 1, star 4
!
      IF(kk == 1272)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(1,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i2, limb darkening x-coefficient, band 2, star 4
!
      IF(kk == 1273)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(2,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i3, limb darkening x-coefficient, band 3, star 4
!
      IF(kk == 1274)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(3,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i4, limb darkening x-coefficient, band 4, star 4
!
      IF(kk == 1275)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(4,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i5, limb darkening x-coefficient, band 5, star 4
!
      IF(kk == 1276)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(5,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i6, limb darkening x-coefficient, band 6, star 4
!
      IF(kk == 1277)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(6,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i7, limb darkening x-coefficient, band 7, star 4
!
      IF(kk == 1278)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(7,4)
         line=TRIM(line)//string14
      END IF
!
!  tag i8, limb darkening x-coefficient, band 8, star 4
!
      IF(kk == 1279)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(8,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j1, limb darkening y-coefficient, band 1, star 4
!
      IF(kk == 1304)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(1,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j2, limb darkening y-coefficient, band 2, star 4
!
      IF(kk == 1305)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(2,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j3, limb darkening y-coefficient, band 3, star 4
!
      IF(kk == 1306)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(3,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j4, limb darkening y-coefficient, band 4, star 4
!
      IF(kk == 1307)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(4,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j5, limb darkening y-coefficient, band 5, star 4
!
      IF(kk == 1308)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(5,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j6, limb darkening y-coefficient, band 6, star 4
!
      IF(kk == 1309)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(6,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j7, limb darkening y-coefficient, band 7, star 4
!
      IF(kk == 1310)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(7,4)
         line=TRIM(line)//string14
      END IF
!
!  tag j8, limb darkening y-coefficient, band 8, star 4
!
      IF(kk == 1311)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(8,4)
         line=TRIM(line)//string14
      END IF
!
!  tag k1, limb darkening x-coefficient, band 1, star 5
!
      IF(kk == 1336)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(1,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k2, limb darkening x-coefficient, band 2, star 5
!
      IF(kk == 1337)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(2,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k3, limb darkening x-coefficient, band 3, star 5
!
      IF(kk == 1338)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(3,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k4, limb darkening x-coefficient, band 4, star 5
!
      IF(kk == 1339)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(4,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k5, limb darkening x-coefficient, band 5, star 5
!
      IF(kk == 1340)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(5,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k6, limb darkening x-coefficient, band 6, star 5
!
      IF(kk == 1341)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(6,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k7, limb darkening x-coefficient, band 7, star 5
!
      IF(kk == 1342)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(7,5)
         line=TRIM(line)//string14
      END IF
!
!  tag k8, limb darkening x-coefficient, band 8, star 5
!
      IF(kk == 1343)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavex(8,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p1, limb darkening y-coefficient, band 1, star 5
!
      IF(kk == 1496)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(1,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p2, limb darkening y-coefficient, band 2, star 5
!
      IF(kk == 1497)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(2,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p3, limb darkening y-coefficient, band 3, star 5
!
      IF(kk == 1498)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(3,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p4, limb darkening y-coefficient, band 4, star 5
!
      IF(kk == 1499)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(4,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p5, limb darkening y-coefficient, band 5, star 5
!
      IF(kk == 1500)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(5,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p6, limb darkening y-coefficient, band 6, star 5
!
      IF(kk == 1501)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(6,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p7, limb darkening y-coefficient, band 7, star 5
!
      IF(kk == 1502)THEN
         iline=iline+1
         ilength=ilength+14
         WRITE(string14,200)dwavey(7,5)
         line=TRIM(line)//string14
      END IF
!
!  tag p8, limb darkening y-coefficient, band 8, star 5
!
      IF(kk == 1503)THEN
         iline=iline+1
!              iwrite=0
         ilength=ilength+14
         WRITE(string14,200)dwavey(8,5)
         line=TRIM(line)//string14
      END IF
!
!
!  tag dp, dphi, phase difference between secondary and primary eclipse
!
      IF(kk == 111)THEN
         iline=iline+1
         ilength=ilength+15
         WRITE(string15,190)ecosw
         line=TRIM(line)//string15
         iargper=100
      END IF
!
   END DO
!
!  July 29, 2005
!
!  If the variable ecosw is assigned, then also print out the argument
!  of periastron
!
   IF(iargper > 0)THEN
      CALL getom(ecc,ecosw,argper)
      iline=iline+1
      ilength=ilength+20
      WRITE(string20,100)argper
      line=TRIM(line)//string20
   END IF
!
!  if fitting for e*cos(omega) and e*sin(omega), print out
!  the eccentricity and argument of periastron
!
   IF(isw29 > 0)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,190)ecc
      line=TRIM(line)//string15
      iline=iline+1
      ilength=ilength+20
      WRITE(string20,100)argper
      line=TRIM(line)//string20
   END IF
!
!   Print out the gamma values, if fitting RV curves.
!   If ifixgamma is 0, 1, or 2, we have one gamma
!   value per star.  If ifixgamma is 10, 11, or 12
!   then we have Nset gamma values per star
!
   IF(ifixgamma < 10)THEN
      IF(isvel1 > 0)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(isvel2 > 0)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma2
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(isvel3 > 0)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(isvel4 > 0)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
   END IF
!
   IF(ifixgamma >= 10)THEN
!
!  star 1 gammas
!
      IF(icnrv1arry(1) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1arry(1)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv1arry(2) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1arry(2)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv1arry(3) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1arry(3)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv1arry(4) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1arry(4)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv1arry(5) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma1arry(5)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
!  star 2 gammas
!
      IF(icnrv2arry(1) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma2arry(1)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv2arry(2) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma2arry(2)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv2arry(3) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(3)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv2arry(4) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma2arry(4)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv2arry(5) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma2arry(5)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
!  star 3 gammas
!
      IF(icnrv3arry(1) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(1)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv3arry(2) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(2)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv3arry(3) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(3)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv3arry(4) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(4)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv3arry(5) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma3arry(5)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
!  star 4 gammas
!
      IF(icnrv4arry(1) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4arry(1)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv4arry(2) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4arry(2)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv4arry(3) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4arry(3)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv4arry(4) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4arry(4)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv4arry(5) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma4arry(5)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
!  star 5 gammas
!
      IF(icnrv5arry(1) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma5arry(1)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv5arry(2) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma5arry(2)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv5arry(3) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma5arry(3)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv5arry(4) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma5arry(4)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
      IF(icnrv5arry(5) /= 430)THEN
         iline=iline+1
         ilength=ilength+17
         tempgam=gamma5arry(5)
         IF(tempgam >= 9999999.0_dp)tempgam=9999999.0_dp
         IF(tempgam < -999999.0_dp)tempgam=-999999.0_dp
         WRITE(string17,310)tempgam
         line=TRIM(line)//string17
      END IF
!
   END IF
!
!   if asini (sw5) > 0, record it here
!
   IF(sw5 > 0.0_dp)THEN
      iline=iline+1
      ilength=ilength+20
      WRITE(string20,90)sw5
      line=TRIM(line)//string20
   END IF
!
!    If ecc > 0, record the times of inferior and superior
!    conjunction.
!
   IF(ecc > 0.0_dp)THEN
      CALL getcontimes(finc,period,ecc,argper,t0,tconj1,tconj2)
      iline=iline+1
      ilength=ilength+19
      WRITE(string19,80)t0
      line=TRIM(line)//string19
      ilength=ilength+19
      WRITE(string19,80)tconj1
      line=TRIM(line)//string19
      iline=iline+1
      ilength=ilength+19
      WRITE(string19,80)tconj2
      line=TRIM(line)//string19
   END IF
!
!  If Nbody is 3 or more, add true anomaly, mean anomaly,
!  true longitude for each orbit
!
   IF(nbody >= 3)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(1)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(2)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(3)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(4)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(5)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(6)
      line=TRIM(line)//string15
!
   END IF
!
   IF(nbody >= 4)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(7)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(8)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(9)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 5)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(10)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(11)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(12)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 6)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(13)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(14)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(15)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 7)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(16)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(17)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(18)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 8)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(19)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(20)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(21)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 9)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(22)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(23)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(24)
      line=TRIM(line)//string15
   END IF
!
   IF(nbody >= 10)THEN
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(25)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(26)
      line=TRIM(line)//string15
!
      iline=iline+1
      ilength=ilength+15
      WRITE(string15,320)orbitparm(27)
      line=TRIM(line)//string15
   END IF
!
20 FORMAT(' ',i6)
30 FORMAT(' ',f17.4)
40 FORMAT(' ',f19.11)
50 FORMAT(' ',f17.14)
60 FORMAT(' ',f13.11)
70 FORMAT(' ',f20.14)
80 FORMAT(' ',f18.12)
90 FORMAT(' ',f19.14)
100 FORMAT(' ',f19.14)
110 FORMAT(' ',f20.12)
120 FORMAT(' ',f16.11)
130 FORMAT(' ',f12.8)
140 FORMAT(' ',f17.13)
150 FORMAT(' ',f17.12)
160 FORMAT(' ',f17.13)
170 FORMAT(' ',f16.14)
180 FORMAT(' ',f13.10)
190 FORMAT(' ',f14.12)
200 FORMAT(' ',f13.10)
210 FORMAT(' ',f13.8)
220 FORMAT(' ',f13.9)
230 FORMAT(' ',f18.12)
240 FORMAT(' ',f11.9)
250 FORMAT(' ',f13.10)
260 FORMAT(' ',f15.8)
270 FORMAT(' ',f14.7)
280 FORMAT(' ',f10.7)
290 FORMAT(' ',f9.6)
300 FORMAT(' ',1PE11.4)
305 FORMAT(' ',f16.10)
310 FORMAT(' ',f16.8)
320 FORMAT(' ',f14.9)
330 FORMAT(' ',f12.9)
340 FORMAT(' ',f12.7)
!
   RETURN
!
END SUBROUTINE newwritevar
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE obschi(nobv,sobv,obv,eobv,obsparm,ochi)
!
!  July 24, 2000
!
!  This routine will take the observed variables specified in the
!  gridloop.opt file and compute the additional chi^2
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obv(25)
   REAL(KIND=dp), INTENT(IN)                :: eobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obsparm(25)
   REAL(KIND=dp), INTENT(OUT)               :: ochi
!
   REAL(KIND=dp)  :: chisq
!
   INTEGER :: i,index,icn,icnvrt
!
!   COMMON /medblock/ rmed
!
!  loop over the strings and match tags
!
   index=1
   ochi=0.0_dp
   DO  i=1,nobv
      index=-99
      icn=icnvrt(sobv(i)(1:2))
!
!  tag m1, mass of star 1 in solar masses
!
      IF(icn == 1400)index=1
!
!  tag m2, mass of star 2 in solar masses
!
      IF(icn == 1401)index=5
!
!  tag r1, radius of star 1 in solar radii
!
      IF(icn == 1560)index=2
!
!  tag r2, radius of star 2 in solar radii
!
      IF(icn == 1561)index=6
!
!  tag g1, gravity of star 1 (log(g) in cgs)
!
      IF(icn == 1208)index=3
!
!  tag k1, K-velocity of star 1 in km/sec
!
      IF(icn == 1336)index=10
!
!  tag k2, K-velocity of star 2 in km/sec
!
      IF(icn == 1337)index=11
!
!  tag in, inclination of binary in degrees
!
      IF(icn == 269)index=12
!
!  tag ma, mass ratio of binary
!
      IF(icn == 384)index=13
!
!  tag ec, eccentricity of binary
!
      IF(icn == 130)index=14
!
!  tag ar, argument of periastron of binary
!
      IF(icn == 17)index=15
!
!  tag t1, Teff1, effective temperature of star 1
!
      IF(icn == 1624)index=16
!
!  tag t2, Teff2, effective temperature of star 2
!
      IF(icn == 1625)index=17
!
!  tag t3, Teff3, effective temperature of star 3
!
      IF(icn == 1626)index=19
!
!   tag su, the fractional sum of radii
!
      IF(icn == 596)index=18
!
!  tag g2, gravity of star 2 (log(g) in cgs)
!
      IF(icn == 1209)index=7
!
!  tag v1, Vrot1, rotational velocity of star 1 in km/sec
!
      IF(icn == 1688)index=4
!
!  tag v2, Vrot2, rotational velocity of star 2 in km/sec
!
      IF(icn == 1689)index=8
!
!  tag xe, the duration of the X-ray eclipse in degrees of phase
!
      IF(icn == 740)index=9
!
!  tag di, disk fraction
!
      IF(icn == 104)index=-1
!
!  tags d1 through d8, disk fractions in each bandpass
!
      IF(icn == 1112)index=-1
      IF(icn == 1113)index=-1
      IF(icn == 1114)index=-1
      IF(icn == 1115)index=-1
      IF(icn == 1116)index=-1
      IF(icn == 1117)index=-1
      IF(icn == 1118)index=-1
      IF(icn == 1119)index=-1
!
!  tag lr, luminosity ratio of star 1 and star 2
!
      IF(icn == 369)index=-1!lr
!
!   If the variable rmed > 1, then define chisq as the absolute deviation,
!   rather than the normal chi^2.
!
      IF((index == 9).AND.(obv(i) < 0.0_dp))GO TO 10
      IF(index >= 1)THEN
         IF(rmed >= 1.0_dp)THEN
            chisq=ABS((obv(i)-obsparm(index))/(eobv(i)))
         ELSE
            chisq=(obv(i)-obsparm(index))*(obv(i)-obsparm(index))/(eobv(i)*eobv(i))
         END IF
         ochi=ochi+chisq
      END IF
!
!   UPDATE June 3, 2002
!
!   If the observed duration of the X-ray eclipse is negative, then
!   the number is meant as an upper limit.  That is, if obv = -10.0,
!   then the eclipse duration is less than 10 degrees.
!
10    IF((index == 9).AND.(obv(i) < 0.0_dp))THEN
!
!   Here is the case where the upper limit is less than the computed
!   eclipse duration.
!
         IF(ABS(obv(i)) > obsparm(index))CYCLE
!
         IF(rmed >= 1.0_dp)THEN
            chisq=ABS((ABS(obv(i))-obsparm(index))/(eobv(i)))
         ELSE
            chisq=(ABS(obv(i))-obsparm(index))*(ABS(obv(i))-  &
               obsparm(index))/(eobv(i)*eobv(i))
         END IF
         ochi=ochi+chisq
      END IF
!
   END DO
!
   RETURN
!
END SUBROUTINE obschi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE offset(n,y,yoff,off)
!
!   Will offset the y values by offset and return new array yoff.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN)                :: y(n)
   REAL(KIND=dp), INTENT(OUT)               :: yoff(n)
   REAL(KIND=dp), INTENT(IN)                :: off
!
   INTEGER :: i
!
   DO  i=1,n
      yoff(i)=y(i)+off
   END DO
!
   RETURN
!
END SUBROUTINE offset
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE phasefold(ndatamax,isavn,savx,savy,saverr,nbin,  &
   ndata,xdata,ydata,errdata,period,t0,ikeep,ecc,argper,itime)
!
!   This routine will take data arrays in savex,savey,saverr
!   (time, mag, magerr), and fold them into the arrays
!   xdata,ydata,errdata.  The latter arrays are the ones normally
!   used in the optimization programs.
!
   USE accur
   USE getpie
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: isavn
   REAL(KIND=dp), INTENT(IN)                :: savx(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: savy(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: saverr(ndatamax)
   INTEGER, INTENT(IN)                      :: nbin
   INTEGER, INTENT(IN OUT)                  :: ndata
   REAL(KIND=dp), INTENT(OUT)               :: xdata(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydata(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errdata(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: t0
   INTEGER, INTENT(IN)                      :: ikeep
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: argper
   INTEGER, INTENT(IN)                      :: itime
!
   REAL(KIND=dp)  :: eshift,pconj,pconj2,argrad,trc,htrc,ecan,xmc,phper
   REAL(KIND=dp)  :: phper2,pshift,tshift,t1
!
   INTEGER :: i
!
!   CALL getpie(pie,twopie,halfpie,degtorad,radtodeg)
!
!   UPDATE JUNE 19, 2008
!
!   Figure out the conjunction phases if the orbit is eccentric.
!
   IF(itime == 2)THEN
      IF(ndata > 1)CALL sort3(ndata,xdata,ydata,errdata)
      RETURN
   END IF
!
   eshift=0.0_dp
   pconj=pie
   pconj2=0.0_dp
   IF(ecc <= 1.0E-07_dp)pconj=0.0_dp
!
   IF((ecc > 0.0_dp).AND.(ikeep > 0))THEN
      argrad=argper*degtorad
      trc=halfpie-argrad
      CALL checkangle(trc)
      htrc=0.5_dp*trc
      IF(ABS(halfpie-htrc) < 7.0E-06_dp)GO TO 10
      IF(ABS(1.50_dp*pie-htrc) < 7.0E-06_dp)GO TO 10
      ecan=2.0_dp*ATAN(SQRT((1.0_dp-ecc)/(1.0_dp+ecc))*TAN(htrc))
      GO TO 20
10    ecan=pie
20    xmc=ecan-ecc*SIN(ecan)
      IF(xmc < 0.0_dp)xmc=xmc+twopie
      phper=1.0_dp-xmc/(twopie)
      pconj=(xmc+argrad)/(twopie)-0.25_dp
!
!   Make sure the conjunction phase is between 0 and 1
!
      IF(pconj > 1.0_dp)pconj=pconj-1.0_dp
!
      trc=halfpie-argrad+pie
      CALL checkangle(trc)
      htrc=0.5_dp*trc
      IF(ABS(halfpie-htrc) < 7.0E-06_dp)GO TO 30
      IF(ABS(1.50_dp*pie-htrc) < 7.0E-06_dp)GO TO 30
      ecan=2.0_dp*ATAN(SQRT((1.0_dp-ecc)/(1.0_dp+ecc))*TAN(htrc))
      GO TO 40
30    ecan=pie
40    xmc=ecan-ecc*SIN(ecan)
      IF(xmc < 0.0_dp)xmc=xmc+twopie
      phper2=1.0_dp-xmc/(twopie)
      pconj2=(xmc+argrad)/(twopie)-0.25_dp
!
!   UPDATE March 14, 2008
!
!   Make sure the conjunction phase is between 0 and 1
!
      IF(pconj2 > 1.0_dp)pconj2=pconj2-1.0_dp
      IF(ikeep == 1)eshift=phper+pconj-0.5_dp
      IF(ikeep == 2)eshift=phper2+pconj2
   END IF

!   Here is the case where no binning is requested.
!
   pshift=0.0_dp
   tshift=0.0_dp
   IF(ikeep == 1)tshift=pshift+eshift-pconj
   IF(ikeep == 2)tshift=pshift+eshift-pconj2

   IF(nbin == 0)THEN
      DO  i=1,isavn
         t1=(savx(i)-t0)/period+tshift
         xdata(i)=MOD(t1,1.0_dp)
         ydata(i)=savy(i)
         errdata(i)=saverr(i)
      END DO
      ndata=isavn
!
      DO  i=1,ndata
         IF(xdata(i) < 0.0_dp)xdata(i)=xdata(i)+1.0_dp
         IF(xdata(i) > 1.0_dp)xdata(i)=xdata(i)-1.0_dp
         IF(xdata(i) < 0.0_dp)xdata(i)=xdata(i)+1.0_dp
         IF(xdata(i) > 1.0_dp)xdata(i)=xdata(i)-1.0_dp
         IF(xdata(i) < 0.0_dp)xdata(i)=xdata(i)+1.0_dp
         IF(xdata(i) > 1.0_dp)xdata(i)=xdata(i)-1.0_dp
      END DO
!
!   Sort the data by phase.
!   Put an if-then clause to cover the case when Ndata=1
!
      IF(ndata > 1)CALL sort3(ndata,xdata,ydata,errdata)
!
!   We are done, so leave.
!
      RETURN
   END IF
!
   RETURN
!
END SUBROUTINE phasefold
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printamoebachi(nn,chi1)
!
!  This routine is used by amoebaELC to print the iteration number
!  and chi^2 to the screen in a nice way.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nn
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(nn < 10)THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,10)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,20)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,30)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,40)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,50)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,60)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,70)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,80)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,90)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,100)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,110)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,120)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,130)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,140)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,150)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,160)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,170)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,180)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,190)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,200)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,210)nn,chi1
         RETURN
      END IF
      WRITE(*,220)nn,chi1
   END IF
!
   IF((nn >= 10).AND.(nn < 100))THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,230)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,240)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,250)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,260)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,270)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,280)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,290)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,300)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,310)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,320)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,330)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,340)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,350)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,360)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,370)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,380)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,390)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,400)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,410)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,420)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,430)nn,chi1
         RETURN
      END IF
      WRITE(*,440)nn,chi1
   END IF
!
   IF((nn >= 100).AND.(nn < 1000))THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,450)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,460)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,470)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,480)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,490)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,500)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,510)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,520)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,530)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,540)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,550)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,560)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,570)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,580)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,590)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,600)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,610)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,620)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,630)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,640)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,650)nn,chi1
         RETURN
      END IF
      WRITE(*,660)nn,chi1
   END IF
!
   IF((nn >= 1000).AND.(nn < 10000))THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,670)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,680)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,690)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,700)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,710)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,720)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,730)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,740)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,750)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,760)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,770)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,780)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,790)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,800)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,810)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,820)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,830)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,840)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,850)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,860)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,870)nn,chi1
         RETURN
      END IF
      WRITE(*,880)nn,chi1
   END IF
!
10 FORMAT('chi',i1,' = 999999999999999999999.999999')
20 FORMAT('chi',i1,' = ',f28.6)
30 FORMAT('chi',i1,' = ',f27.6)
40 FORMAT('chi',i1,' = ',f26.6)
50 FORMAT('chi',i1,' = ',f25.6)
60 FORMAT('chi',i1,' = ',f24.6)
70 FORMAT('chi',i1,' = ',f23.6)
80 FORMAT('chi',i1,' = ',f22.6)
90 FORMAT('chi',i1,' = ',f21.6)
100 FORMAT('chi',i1,' = ',f20.6)
110 FORMAT('chi',i1,' = ',f19.6)
120 FORMAT('chi',i1,' = ',f18.6)
130 FORMAT('chi',i1,' = ',f17.6)
140 FORMAT('chi',i1,' = ',f16.6)
150 FORMAT('chi',i1,' = ',f15.6)
160 FORMAT('chi',i1,' = ',f14.6)
170 FORMAT('chi',i1,' = ',f13.6)
180 FORMAT('chi',i1,' = ',f12.6)
190 FORMAT('chi',i1,' = ',f11.6)
200 FORMAT('chi',i1,' = ',f10.6)
210 FORMAT('chi',i1,' = ',f9.6)
220 FORMAT('chi',i1,' = ',f8.6)
230 FORMAT('chi',i2,' = 999999999999999999999.999999')
240 FORMAT('chi',i2,' = ',f28.6)
250 FORMAT('chi',i2,' = ',f27.6)
260 FORMAT('chi',i2,' = ',f26.6)
270 FORMAT('chi',i2,' = ',f25.6)
280 FORMAT('chi',i2,' = ',f24.6)
290 FORMAT('chi',i2,' = ',f23.6)
300 FORMAT('chi',i2,' = ',f22.6)
310 FORMAT('chi',i2,' = ',f21.6)
320 FORMAT('chi',i2,' = ',f20.6)
330 FORMAT('chi',i2,' = ',f19.6)
340 FORMAT('chi',i2,' = ',f18.6)
350 FORMAT('chi',i2,' = ',f17.6)
360 FORMAT('chi',i2,' = ',f16.6)
370 FORMAT('chi',i2,' = ',f15.6)
380 FORMAT('chi',i2,' = ',f14.6)
390 FORMAT('chi',i2,' = ',f13.6)
400 FORMAT('chi',i2,' = ',f12.6)
410 FORMAT('chi',i2,' = ',f11.6)
420 FORMAT('chi',i2,' = ',f10.6)
430 FORMAT('chi',i2,' = ',f9.6)
440 FORMAT('chi',i2,' = ',f8.6)
450 FORMAT('chi',i3,' = 999999999999999999999.999999')
460 FORMAT('chi',i3,' = ',f28.6)
470 FORMAT('chi',i3,' = ',f27.6)
480 FORMAT('chi',i3,' = ',f26.6)
490 FORMAT('chi',i3,' = ',f25.6)
500 FORMAT('chi',i3,' = ',f24.6)
510 FORMAT('chi',i3,' = ',f23.6)
520 FORMAT('chi',i3,' = ',f22.6)
530 FORMAT('chi',i3,' = ',f21.6)
540 FORMAT('chi',i3,' = ',f20.6)
550 FORMAT('chi',i3,' = ',f19.6)
560 FORMAT('chi',i3,' = ',f18.6)
570 FORMAT('chi',i3,' = ',f17.6)
580 FORMAT('chi',i3,' = ',f16.6)
590 FORMAT('chi',i3,' = ',f15.6)
600 FORMAT('chi',i3,' = ',f14.6)
610 FORMAT('chi',i3,' = ',f13.6)
620 FORMAT('chi',i3,' = ',f12.6)
630 FORMAT('chi',i3,' = ',f11.6)
640 FORMAT('chi',i3,' = ',f10.6)
650 FORMAT('chi',i3,' = ',f9.6)
660 FORMAT('chi',i3,' = ',f8.6)
670 FORMAT('chi',i4,' = 999999999999999999999.999999')
680 FORMAT('chi',i4,' = ',f28.6)
690 FORMAT('chi',i4,' = ',f27.6)
700 FORMAT('chi',i4,' = ',f26.6)
710 FORMAT('chi',i4,' = ',f25.6)
720 FORMAT('chi',i4,' = ',f24.6)
730 FORMAT('chi',i4,' = ',f23.6)
740 FORMAT('chi',i4,' = ',f22.6)
750 FORMAT('chi',i4,' = ',f21.6)
760 FORMAT('chi',i4,' = ',f20.6)
770 FORMAT('chi',i4,' = ',f19.6)
780 FORMAT('chi',i4,' = ',f18.6)
790 FORMAT('chi',i4,' = ',f17.6)
800 FORMAT('chi',i4,' = ',f16.6)
810 FORMAT('chi',i4,' = ',f15.6)
820 FORMAT('chi',i4,' = ',f14.6)
830 FORMAT('chi',i4,' = ',f13.6)
840 FORMAT('chi',i4,' = ',f12.6)
850 FORMAT('chi',i4,' = ',f11.6)
860 FORMAT('chi',i4,' = ',f10.6)
870 FORMAT('chi',i4,' = ',f9.6)
880 FORMAT('chi',i4,' = ',f8.6)
!
   RETURN
!
END SUBROUTINE printamoebachi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printamoebamed(nn,chi1)
!
!  used by amoeba to print out the chi^2 and the iteration
!  number in a nice way
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nn
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(nn < 10)THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,10)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,20)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,30)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,40)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,50)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,60)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,70)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,80)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,90)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,100)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,110)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,120)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,130)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,140)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,150)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,160)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,170)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,180)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,190)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,200)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,210)nn,chi1
         RETURN
      END IF
      WRITE(*,220)nn,chi1
   END IF
!
   IF((nn >= 10).AND.(nn < 100))THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,230)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,240)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,250)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,260)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,270)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,280)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,290)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,300)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,310)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,320)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,330)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,340)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,350)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,360)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,370)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,380)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,390)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,400)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,410)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,420)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,430)nn,chi1
         RETURN
      END IF
      WRITE(*,440)nn,chi1
   END IF
!
   IF((nn >= 100).AND.(nn < 1000))THEN
      IF(chi1 > 9.999999999999999E+20_dp)THEN
         WRITE(*,450)nn
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+19_dp)THEN
         WRITE(*,460)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+18_dp)THEN
         WRITE(*,470)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+17_dp)THEN
         WRITE(*,480)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+16_dp)THEN
         WRITE(*,490)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+15_dp)THEN
         WRITE(*,500)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+14_dp)THEN
         WRITE(*,510)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+13_dp)THEN
         WRITE(*,520)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+12_dp)THEN
         WRITE(*,530)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+11_dp)THEN
         WRITE(*,540)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+10_dp)THEN
         WRITE(*,550)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+09_dp)THEN
         WRITE(*,560)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+08_dp)THEN
         WRITE(*,570)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+07_dp)THEN
         WRITE(*,580)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+06_dp)THEN
         WRITE(*,590)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+05_dp)THEN
         WRITE(*,600)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+04_dp)THEN
         WRITE(*,610)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+03_dp)THEN
         WRITE(*,620)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+02_dp)THEN
         WRITE(*,630)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+01_dp)THEN
         WRITE(*,640)nn,chi1
         RETURN
      END IF
      IF(chi1 > 9.999999999999999E+00_dp)THEN
         WRITE(*,650)nn,chi1
         RETURN
      END IF
      WRITE(*,660)nn,chi1
   END IF
!
10 FORMAT('med',i1,' = 999999999999999999999.999999')
20 FORMAT('med',i1,' = ',f28.6)
30 FORMAT('med',i1,' = ',f27.6)
40 FORMAT('med',i1,' = ',f26.6)
50 FORMAT('med',i1,' = ',f25.6)
60 FORMAT('med',i1,' = ',f24.6)
70 FORMAT('med',i1,' = ',f23.6)
80 FORMAT('med',i1,' = ',f22.6)
90 FORMAT('med',i1,' = ',f21.6)
100 FORMAT('med',i1,' = ',f20.6)
110 FORMAT('med',i1,' = ',f19.6)
120 FORMAT('med',i1,' = ',f18.6)
130 FORMAT('med',i1,' = ',f17.6)
140 FORMAT('med',i1,' = ',f16.6)
150 FORMAT('med',i1,' = ',f15.6)
160 FORMAT('med',i1,' = ',f14.6)
170 FORMAT('med',i1,' = ',f13.6)
180 FORMAT('med',i1,' = ',f12.6)
190 FORMAT('med',i1,' = ',f11.6)
200 FORMAT('med',i1,' = ',f10.6)
210 FORMAT('med',i1,' = ',f9.6)
220 FORMAT('med',i1,' = ',f8.6)
230 FORMAT('med',i2,' = 999999999999999999999.999999')
240 FORMAT('med',i2,' = ',f28.6)
250 FORMAT('med',i2,' = ',f27.6)
260 FORMAT('med',i2,' = ',f26.6)
270 FORMAT('med',i2,' = ',f25.6)
280 FORMAT('med',i2,' = ',f24.6)
290 FORMAT('med',i2,' = ',f23.6)
300 FORMAT('med',i2,' = ',f22.6)
310 FORMAT('med',i2,' = ',f21.6)
320 FORMAT('med',i2,' = ',f20.6)
330 FORMAT('med',i2,' = ',f19.6)
340 FORMAT('med',i2,' = ',f18.6)
350 FORMAT('med',i2,' = ',f17.6)
360 FORMAT('med',i2,' = ',f16.6)
370 FORMAT('med',i2,' = ',f15.6)
380 FORMAT('med',i2,' = ',f14.6)
390 FORMAT('med',i2,' = ',f13.6)
400 FORMAT('med',i2,' = ',f12.6)
410 FORMAT('med',i2,' = ',f11.6)
420 FORMAT('med',i2,' = ',f10.6)
430 FORMAT('med',i2,' = ',f9.6)
440 FORMAT('med',i2,' = ',f8.6)
450 FORMAT('med',i3,' = 999999999999999999999.999999')
460 FORMAT('med',i3,' = ',f28.6)
470 FORMAT('med',i3,' = ',f27.6)
480 FORMAT('med',i3,' = ',f26.6)
490 FORMAT('med',i3,' = ',f25.6)
500 FORMAT('med',i3,' = ',f24.6)
510 FORMAT('med',i3,' = ',f23.6)
520 FORMAT('med',i3,' = ',f22.6)
530 FORMAT('med',i3,' = ',f21.6)
540 FORMAT('med',i3,' = ',f20.6)
550 FORMAT('med',i3,' = ',f19.6)
560 FORMAT('med',i3,' = ',f18.6)
570 FORMAT('med',i3,' = ',f17.6)
580 FORMAT('med',i3,' = ',f16.6)
590 FORMAT('med',i3,' = ',f15.6)
600 FORMAT('med',i3,' = ',f14.6)
610 FORMAT('med',i3,' = ',f13.6)
620 FORMAT('med',i3,' = ',f12.6)
630 FORMAT('med',i3,' = ',f11.6)
640 FORMAT('med',i3,' = ',f10.6)
650 FORMAT('med',i3,' = ',f9.6)
660 FORMAT('med',i3,' = ',f8.6)
!
   RETURN
!
END SUBROUTINE printamoebamed
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printbig(chi1)
!
   USE accur
!
   IMPLICIT NONE

   REAL(KIND=dp), INTENT(IN)                       :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1
!
10 FORMAT('chi_big = 99999999999999999999.999999')
20 FORMAT('chi_big = ',f28.6)
30 FORMAT('chi_big = ',f27.6)
40 FORMAT('chi_big = ',f26.6)
50 FORMAT('chi_big = ',f25.6)
60 FORMAT('chi_big = ',f24.6)
70 FORMAT('chi_big = ',f23.6)
80 FORMAT('chi_big = ',f22.6)
90 FORMAT('chi_big = ',f21.6)
100 FORMAT('chi_big = ',f20.6)
110 FORMAT('chi_big = ',f19.6)
120 FORMAT('chi_big = ',f18.6)
130 FORMAT('chi_big = ',f17.6)
140 FORMAT('chi_big = ',f16.6)
150 FORMAT('chi_big = ',f15.6)
160 FORMAT('chi_big = ',f14.6)
170 FORMAT('chi_big = ',f13.6)
180 FORMAT('chi_big = ',f12.6)
190 FORMAT('chi_big = ',f11.6)
200 FORMAT('chi_big = ',f10.6)
210 FORMAT('chi_big = ',f9.6)
220 FORMAT('chi_big = ',f8.6)
!
   RETURN
!
END SUBROUTINE printbig
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printbigmed(chi1)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                   :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1
!
10 FORMAT('med_big = 99999999999999999999.999999')
20 FORMAT('med_big = ',f28.6)
30 FORMAT('med_big = ',f27.6)
40 FORMAT('med_big = ',f26.6)
50 FORMAT('med_big = ',f25.6)
60 FORMAT('med_big = ',f24.6)
70 FORMAT('med_big = ',f23.6)
80 FORMAT('med_big = ',f22.6)
90 FORMAT('med_big = ',f21.6)
100 FORMAT('med_big = ',f20.6)
110 FORMAT('med_big = ',f19.6)
120 FORMAT('med_big = ',f18.6)
130 FORMAT('med_big = ',f17.6)
140 FORMAT('med_big = ',f16.6)
150 FORMAT('med_big = ',f15.6)
160 FORMAT('med_big = ',f14.6)
170 FORMAT('med_big = ',f13.6)
180 FORMAT('med_big = ',f12.6)
190 FORMAT('med_big = ',f11.6)
200 FORMAT('med_big = ',f10.6)
210 FORMAT('med_big = ',f9.6)
220 FORMAT('med_big = ',f8.6)
!
   RETURN
!
END SUBROUTINE printbigmed
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printchi(chi1)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1
!
10 FORMAT('chi1 = 999999999999999999999.999999')
20 FORMAT('chi1 = ',f28.6)
30 FORMAT('chi1 = ',f27.6)
40 FORMAT('chi1 = ',f26.6)
50 FORMAT('chi1 = ',f25.6)
60 FORMAT('chi1 = ',f24.6)
70 FORMAT('chi1 = ',f23.6)
80 FORMAT('chi1 = ',f22.6)
90 FORMAT('chi1 = ',f21.6)
100 FORMAT('chi1 = ',f20.6)
110 FORMAT('chi1 = ',f19.6)
120 FORMAT('chi1 = ',f18.6)
130 FORMAT('chi1 = ',f17.6)
140 FORMAT('chi1 = ',f16.6)
150 FORMAT('chi1 = ',f15.6)
160 FORMAT('chi1 = ',f14.6)
170 FORMAT('chi1 = ',f13.6)
180 FORMAT('chi1 = ',f12.6)
190 FORMAT('chi1 = ',f11.6)
200 FORMAT('chi1 = ',f10.6)
210 FORMAT('chi1 = ',f9.6)
220 FORMAT('chi1 = ',f8.6)
!
   RETURN
!
END SUBROUTINE printchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printgriditer(kmodel,instring1,iter,instring2,vs,  &
   isw29)
!
!  This subroutine is used by gridELC to print information about the
!  iterations.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: kmodel
   CHARACTER(LEN=*), INTENT(IN)             :: instring1
   INTEGER, INTENT(IN)                      :: iter
   CHARACTER(LEN=*), INTENT(IN)             :: instring2
   CHARACTER(LEN=*), INTENT(IN)             :: vs
   INTEGER, INTENT(IN)                      :: isw29
!
   INTEGER :: l1,l2,icnvrt,ll1,ll2,kk,k
!
   CHARACTER(LEN=80) :: outstring1,outstring2,outstring3
!
   IF(kmodel < 0)RETURN
   IF(kmodel >= 1000000)RETURN
!
   l1=LEN_TRIM(instring1)
   l1=l1+1
   IF(kmodel < 10)WRITE(outstring1,10)instring1(1:l1),kmodel
   IF((kmodel >= 10).AND.(kmodel < 100))THEN
      WRITE(outstring1,20)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100).AND.(kmodel < 1000))THEN
      WRITE(outstring1,30)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 1000).AND.(kmodel < 10000))THEN
      WRITE(outstring1,40)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 10000).AND.(kmodel < 100000))THEN
      WRITE(outstring1,50)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100000).AND.(kmodel < 1000000))THEN
      WRITE(outstring1,60)instring1(1:l1),kmodel
   END IF
!
   IF(iter < 0)RETURN
   IF(iter >= 1000000)RETURN
!
   l2=LEN_TRIM(instring2)
   l2=l2+1
   IF(iter < 10)WRITE(outstring2,10)instring2(1:l2),iter
   IF((iter >= 10).AND.(iter < 100))THEN
      WRITE(outstring2,20)instring2(1:l2),iter
   END IF
   IF((iter >= 100).AND.(iter < 1000))THEN
      WRITE(outstring2,30)instring2(1:l2),iter
   END IF
   IF((iter >= 1000).AND.(iter < 10000))THEN
      WRITE(outstring2,40)instring2(1:l2),iter
   END IF
   IF((iter >= 10000).AND.(iter < 100000))THEN
      WRITE(outstring2,50)instring2(1:l2),iter
   END IF
   IF((iter >= 100000).AND.(iter < 1000000))THEN
      WRITE(outstring2,60)instring2(1:l2),iter
   END IF
!
   ll1=LEN_TRIM(outstring1)
   ll2=LEN_TRIM(outstring2)
!
!  Figure out the variable that is being iterated on
!
   kk=icnvrt(vs(1:2))
!
!  tag ct, tesscontam
!
   IF(kk == 83)THEN
      outstring3=' tesscontam'
   END IF
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
   IF(kk == 48)THEN
      outstring3=' binqTc'
   END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
   IF(kk == 3528)THEN
      outstring3=' P1qTc'
   END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
   IF(kk == 3560)THEN
      outstring3=' P2qTc'
   END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
   IF(kk == 3592)THEN
      outstring3=' P3qTc'
   END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
   IF(kk == 3624)THEN
      outstring3=' P4qTc'
   END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
   IF(kk == 3656)THEN
      outstring3=' P5qTc'
   END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
   IF(kk == 3688)THEN
      outstring3=' P6qTc'
   END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
   IF(kk == 3720)THEN
      outstring3=' P7qTc'
   END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
   IF(kk == 3752)THEN
      outstring3=' P8qTc'
   END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
   IF(kk == 51)THEN
      outstring3=' Tbinoff'
   END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
   IF(kk == 3531)THEN
      outstring3=' T1off'
   END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
   IF(kk == 3563)THEN
      outstring3=' T2off'
   END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
   IF(kk == 3595)THEN
      outstring3=' T3off'
   END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
   IF(kk == 3627)THEN
      outstring3=' T4off'
   END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
   IF(kk == 3659)THEN
      outstring3=' T5off'
   END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
   IF(kk == 3691)THEN
      outstring3=' T6off'
   END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
   IF(kk == 3723)THEN
      outstring3=' T7off'
   END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
   IF(kk == 3755)THEN
      outstring3=' T8off'
   END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
   IF(kk == 581)THEN
      outstring3=' fillsum'
   END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
   IF(kk == 579)THEN
      outstring3=' filldiff'
   END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
   IF(kk == 3512)THEN
      outstring3=' angsum1'
   END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
   IF(kk == 3544)THEN
      outstring3=' angsum2'
   END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
   IF(kk == 3576)THEN
      outstring3=' angsum3'
   END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
   IF(kk == 3608)THEN
      outstring3=' angsum4'
   END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
   IF(kk == 3640)THEN
      outstring3=' angsum5'
   END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
   IF(kk == 3672)THEN
      outstring3=' angsum6'
   END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
   IF(kk == 3704)THEN
      outstring3=' angsum7'
   END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
   IF(kk == 3736)THEN
      outstring3=' angsum8'
   END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
   IF(kk == 3515)THEN
      outstring3=' angdiff1'
   END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
   IF(kk == 3547)THEN
      outstring3=' angdiff2'
   END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
   IF(kk == 3579)THEN
      outstring3=' angdiff3'
   END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
   IF(kk == 3611)THEN
      outstring3=' angdiff4'
   END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
   IF(kk == 3643)THEN
      outstring3=' angdiff5'
   END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
   IF(kk == 3675)THEN
      outstring3=' angdiff6'
   END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
   IF(kk == 3707)THEN
      outstring3=' angdiff7'
   END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
   IF(kk == 3739)THEN
      outstring3=' angdiff8'
   END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
   IF(kk == 178)THEN
      outstring3=' fracsum'
   END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
   IF(kk == 163)THEN
      outstring3=' fracdiff'
   END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
   IF(kk == 4790)THEN
      outstring3=' bin2M3'
   END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
   IF(kk == 4791)THEN
      outstring3=' bin2M4'
   END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 50)THEN
      outstring3=' sqrt(e)sin(omega)'
   END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 34)THEN
      outstring3=' sqrt(e)cos(omega)'
   END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3530)THEN
      outstring3=' sqP1esin'
   END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3514)THEN
      outstring3=' sqP1ecos'
   END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3562)THEN
      outstring3=' sqP2esin'
   END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3546)THEN
      outstring3=' sqP2ecos'
   END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3594)THEN
      outstring3=' sqP3esin'
   END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3578)THEN
      outstring3=' sqP3ecos'
   END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3626)THEN
      outstring3=' sqP4esin'
   END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3610)THEN
      outstring3=' sqP4ecos'
   END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3658)THEN
      outstring3=' sqP5esin'
   END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3642)THEN
      outstring3=' sqP5ecos'
   END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3690)THEN
      outstring3=' sqP6esin'
   END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3674)THEN
      outstring3=' sqP6ecos'
   END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3722)THEN
      outstring3=' sqP7esin'
   END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3706)THEN
      outstring3=' sqP7ecos'
   END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3754)THEN
      outstring3=' sqP8esin'
   END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3738)THEN
      outstring3=' sqP8ecos'
   END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
   IF(kk == 3524)THEN
      outstring3=' P1-Tc'
   END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
   IF(kk == 3527)THEN
      outstring3=' P1+Tc'
   END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
   IF(kk == 3556)THEN
      outstring3=' P2-Tc'
   END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
   IF(kk == 3559)THEN
      outstring3=' P2+Tc'
   END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
   IF(kk == 3588)THEN
      outstring3=' P3-Tc'
   END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
   IF(kk == 3591)THEN
      outstring3=' P3+Tc'
   END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
   IF(kk == 3620)THEN
      outstring3=' P4-Tc'
   END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
   IF(kk == 3623)THEN
      outstring3=' P4+Tc'
   END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
   IF(kk == 3652)THEN
      outstring3=' P5-Tc'
   END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
   IF(kk == 3655)THEN
      outstring3=' P5+Tc'
   END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
   IF(kk == 3684)THEN
      outstring3=' P6-Tc'
   END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
   IF(kk == 3687)THEN
      outstring3=' P6+Tc'
   END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
   IF(kk == 3716)THEN
      outstring3=' P7-Tc'
   END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
   IF(kk == 3719)THEN
      outstring3=' P7+Tc'
   END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
   IF(kk == 3748)THEN
      outstring3=' P8-Tc'
   END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
   IF(kk == 3751)THEN
      outstring3=' P8+Tc'
   END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
   IF(kk == 44)THEN
      outstring3=' Pbin-Tc'
   END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
   IF(kk == 47)THEN
      outstring3=' Pbin+Tc'
   END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
   IF(kk == 40)THEN
      outstring3=' axis_I2'
   END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
   IF(kk == 33)THEN
      outstring3=' axis_beta2'
   END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
   IF(kk == 72)THEN
      outstring3=' axis_I3'
   END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
   IF(kk == 65)THEN
      outstring3=' axis_beta3'
   END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
   IF(kk == 104)THEN
      outstring3=' axis_I4'
   END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
   IF(kk == 97)THEN
      outstring3=' axis_beta4'
   END IF
!
!  tag 91, bin2masssum (M3+M4 in binary+binary)
!
   IF(kk == 4784)THEN
      outstring3=' bin2masssum'
   END IF
!
!  tag 92, bin2massdiff (M3-M4 in binary+binary)
!
   IF(kk == 4785)THEN
      outstring3=' bin2massdiff'
   END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
   IF(kk == 4786)THEN
      outstring3=' bin2Q'
   END IF
!
!  tag 94, bin2radsum (R3+R4 in binary+binary)
!
   IF(kk == 4787)THEN
      outstring3=' bin2radsum'
   END IF
!
!  tag 95, bin2raddiff (R3-R4 in binary+binary)
!
   IF(kk == 4788)THEN
      outstring3=' bin2raddiff'
   END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
   IF(kk == 4789)THEN
      outstring3=' bin2ratrad'
   END IF
!
!   tag g6, g6
!
   IF(kk == 1213)THEN
      outstring3=' g6'
   END IF
!
!   tag g7, g7
!
   IF(kk == 1214)THEN
      outstring3=' g7'
   END IF
!
!   tag g8, g8
!
   IF(kk == 1215)THEN
      outstring3=' g8'
   END IF
!
!   tag g9, g9
!
   IF(kk == 1216)THEN
      outstring3=' g9'
   END IF
!
!   tag g0, g10
!
   IF(kk == 1207)THEN
      outstring3=' g10'
   END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
   IF(kk == 387)THEN
      outstring3=' massdiff'
   END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
   IF(kk == 402)THEN
      outstring3=' masssum'
   END IF
!
!   tag o3, omega3
!
   IF(kk == 1466)THEN
      outstring3=' omega3'
   END IF
!
!   tag o4, omega4
!
   IF(kk == 1467)THEN
      outstring3=' omega4'
   END IF
!
!   tag o5, omega5
!
   IF(kk == 1468)THEN
      outstring3=' omega5'
   END IF
!
!   tag o6, omega6
!
   IF(kk == 1469)THEN
      outstring3=' omega6'
   END IF
!
!   tag o7, omega7
!
   IF(kk == 1470)THEN
      outstring3=' omega7'
   END IF
!
!   tag o8, omega8
!
   IF(kk == 1471)THEN
      outstring3=' omega8'
   END IF
!
!   tag o9, omega9
!
   IF(kk == 1472)THEN
      outstring3=' omega9'
   END IF
!
!   tag o0, omega10
!
   IF(kk == 1463)THEN
      outstring3=' omega10'
   END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
   IF(kk == 562)THEN
      outstring3=' radsum'
   END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
   IF(kk == 547)THEN
      outstring3=' raddiff'
   END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
   IF(kk == 1018)THEN
      outstring3=' rk3'
   END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
   IF(kk == 1019)THEN
      outstring3=' rk4'
   END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
   IF(kk == 1020)THEN
      outstring3=' rk5'
   END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
   IF(kk == 1021)THEN
      outstring3=' rk6'
   END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
   IF(kk == 1022)THEN
      outstring3=' rk7'
   END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
   IF(kk == 1023)THEN
      outstring3=' rk8'
   END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
   IF(kk == 1024)THEN
      outstring3=' rk9'
   END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
   IF(kk == 1015)THEN
      outstring3=' rk10'
   END IF
!
!   tag sm, secmass
!
   IF(kk == 588)THEN
      outstring3=' secmass'
   END IF
!
!   tag sr, secrad
!
   IF(kk == 593)THEN
      outstring3=' secrad'
   END IF
!
!   tag t6, t6 (Teff6)
!
   IF(kk == 1629)THEN
      outstring3=' Teff6'
   END IF
!
!   tag t7, t7 (Teff7)
!
   IF(kk == 1630)THEN
      outstring3=' Teff7'
   END IF
!
!   tag t8, t8 (Teff8)
!
   IF(kk == 1631)THEN
      outstring3=' Teff8'
   END IF
!
!   tag t9, t9 (Teff9)
!
   IF(kk == 1632)THEN
      outstring3=' Teff9'
   END IF
!
!   tag ta, t10 (Teff10)
!
   IF(kk == 608)THEN
      outstring3=' Teff10'
   END IF
!
!  tag 61, flux star 6, band 1
!
   IF(kk == 4688)THEN
      outstring3=' flux6_U'
   END IF
!
!  tag 62, flux star 6, band 2
!
   IF(kk == 4689)THEN
      outstring3=' flux6_B'
   END IF
!
!  tag 63, flux star 6, band 3
!
   IF(kk == 4690)THEN
      outstring3=' flux6_V'
   END IF
!
!  tag 64, flux star 6, band 4
!
   IF(kk == 4691)THEN
      outstring3=' flux6_R'
   END IF
!
!  tag 65, flux star 6, band 5
!
   IF(kk == 4692)THEN
      outstring3=' flux6_I'
   END IF
!
!  tag 66, flux star 6, band 6
!
   IF(kk == 4693)THEN
      outstring3=' flux6_J'
   END IF
!
!  tag 67, flux star 6, band 7
!
   IF(kk == 4694)THEN
      outstring3=' flux6_H'
   END IF
!
!  tag 68, flux star 6, band 8
!
   IF(kk == 4695)THEN
      outstring3=' flux6_K'
   END IF
!
!  tag 71, flux star 7, band 1
!
   IF(kk == 4720)THEN
      outstring3=' flux7_U'
   END IF
!
!  tag 72, flux star 7, band 2
!
   IF(kk == 4721)THEN
      outstring3=' flux7_B'
   END IF
!
!  tag 73, flux star 7, band 3
!
   IF(kk == 4722)THEN
      outstring3=' flux7_V'
   END IF
!
!  tag 74, flux star 7, band 4
!
   IF(kk == 4723)THEN
      outstring3=' flux7_R'
   END IF
!
!  tag 75, flux star 7, band 5
!
   IF(kk == 4724)THEN
      outstring3=' flux7_I'
   END IF
!
!  tag 76, flux star 7, band 6
!
   IF(kk == 4725)THEN
      outstring3=' flux7_J'
   END IF
!
!  tag 77, flux star 7, band 7
!
   IF(kk == 4726)THEN
      outstring3=' flux7_H'
   END IF
!
!  tag 78, flux star 7, band 8
!
   IF(kk == 4727)THEN
      outstring3=' flux7_K'
   END IF
!
!  tag 81, flux star 8, band 1
!
   IF(kk == 4752)THEN
      outstring3=' flux8_U'
   END IF
!
!  tag 82, flux star 8, band 2
!
   IF(kk == 4753)THEN
      outstring3=' flux8_B'
   END IF
!
!  tag 83, flux star 8, band 3
!
   IF(kk == 4754)THEN
      outstring3=' flux8_V'
   END IF
!
!  tag 84, flux star 8, band 4
!
   IF(kk == 4755)THEN
      outstring3=' flux8_R'
   END IF
!
!  tag 85, flux star 8, band 5
!
   IF(kk == 4756)THEN
      outstring3=' flux8_I'
   END IF
!
!  tag 86, flux star 8, band 6
!
   IF(kk == 4757)THEN
      outstring3=' flux8_J'
   END IF
!
!  tag 87, flux star 8, band 7
!
   IF(kk == 4758)THEN
      outstring3=' flux8_H'
   END IF
!
!  tag 88, flux star 8, band 8
!
   IF(kk == 4759)THEN
      outstring3=' flux8_K'
   END IF
!
!  tag 91, flux star 9, band 1
!
   IF(kk == 2784)THEN
      outstring3=' flux9_U'
   END IF
!
!  tag 92, flux star 9, band 2
!
   IF(kk == 2785)THEN
      outstring3=' flux9_B'
   END IF
!
!  tag 93, flux star 9, band 3
!
   IF(kk == 2786)THEN
      outstring3=' flux9_V'
   END IF
!
!  tag 94, flux star 9, band 4
!
   IF(kk == 2787)THEN
      outstring3=' flux9_R'
   END IF
!
!  tag 95, flux star 9, band 5
!
   IF(kk == 2788)THEN
      outstring3=' flux9_I'
   END IF
!
!  tag 96, flux star 9, band 6
!
   IF(kk == 2789)THEN
      outstring3=' flux9_J'
   END IF
!
!  tag 97, flux star 9, band 7
!
   IF(kk == 2790)THEN
      outstring3=' flux9_H'
   END IF
!
!  tag 98, flux star 9, band 8
!
   IF(kk == 2791)THEN
      outstring3=' flux9_K'
   END IF
!
!  tag 01, flux star 10, band 1
!
   IF(kk == 4496)THEN
      outstring3=' flux10_U'
   END IF
!
!  tag 02, flux star 10, band 2
!
   IF(kk == 4497)THEN
      outstring3=' flux10_B'
   END IF
!
!  tag 03, flux star 10, band 3
!
   IF(kk == 4498)THEN
      outstring3=' flux10_V'
   END IF
!
!  tag 04, flux star 10, band 4
!
   IF(kk == 4499)THEN
      outstring3=' flux10_R'
   END IF
!
!  tag 05, flux star 10, band 5
!
   IF(kk == 4500)THEN
      outstring3=' flux10_I'
   END IF
!
!  tag 06, flux star 10, band 6
!
   IF(kk == 4501)THEN
      outstring3=' flux10_J'
   END IF
!
!  tag 07, flux star 10, band 7
!
   IF(kk == 4502)THEN
      outstring3=' flux10_H'
   END IF
!
!  tag 08, flux star 10, band 8
!
   IF(kk == 4503)THEN
      outstring3=' flux10_K'
   END IF
!
!  tag 11, flux star 1, band 1
!
   IF(kk == 4528)THEN
      outstring3=' flux1_U'
   END IF
!
!  tag 12, flux star 1, band 2
!
   IF(kk == 4529)THEN
      outstring3=' flux1_B'
   END IF
!
!  tag 13, flux star 1, band 3
!
   IF(kk == 4530)THEN
      outstring3=' flux1_V'
   END IF
!
!  tag 14, flux star 1, band 4
!
   IF(kk == 4531)THEN
      outstring3=' flux1_R'
   END IF
!
!  tag 15, flux star 1, band 5
!
   IF(kk == 4532)THEN
      outstring3=' flux1_I'
   END IF
!
!  tag 16, flux star 1, band 6
!
   IF(kk == 4533)THEN
      outstring3=' flux1_J'
   END IF
!
!  tag 17, flux star 1, band 7
!
   IF(kk == 4534)THEN
      outstring3=' flux1_H'
   END IF
!
!  tag 18, flux star 1, band 8
!
   IF(kk == 4535)THEN
      outstring3=' flux1_K'
   END IF
!
!  tag 21, flux star 2, band 1
!
   IF(kk == 4560)THEN
      outstring3=' flux2_U'
   END IF
!
!  tag 22, flux star 2, band 2
!
   IF(kk == 4561)THEN
      outstring3=' flux2_B'
   END IF
!
!  tag 23, flux star 2, band 3
!
   IF(kk == 4562)THEN
      outstring3=' flux2_V'
   END IF
!
!  tag 24, flux star 2, band 4
!
   IF(kk == 4563)THEN
      outstring3=' flux2_R'
   END IF
!
!  tag 25, flux star 2, band 5
!
   IF(kk == 4564)THEN
      outstring3=' flux2_I'
   END IF
!
!  tag 26, flux star 2, band 6
!
   IF(kk == 4565)THEN
      outstring3=' flux2_J'
   END IF
!
!  tag 27, flux star 2, band 7
!
   IF(kk == 4566)THEN
      outstring3=' flux2_H'
   END IF
!
!  tag 28, flux star 2, band 8
!
   IF(kk == 4567)THEN
      outstring3=' flux2_K'
   END IF
!
!  tag 31, flux star 3, band 1
!
   IF(kk == 4592)THEN
      outstring3=' flux3_U'
   END IF
!
!  tag 32, flux star 3, band 2
!
   IF(kk == 4593)THEN
      outstring3=' flux3_B'
   END IF
!
!  tag 33, flux star 3, band 3
!
   IF(kk == 4594)THEN
      outstring3=' flux3_V'
   END IF
!
!  tag 34, flux star 3, band 4
!
   IF(kk == 4595)THEN
      outstring3=' flux3_R'
   END IF
!
!  tag 35, flux star 3, band 5
!
   IF(kk == 4596)THEN
      outstring3=' flux3_I'
   END IF
!
!  tag 36, flux star 3, band 6
!
   IF(kk == 4597)THEN
      outstring3=' flux3_J'
   END IF
!
!  tag 37, flux star 3, band 7
!
   IF(kk == 4598)THEN
      outstring3=' flux3_H'
   END IF
!
!  tag 38, flux star 3, band 8
!
   IF(kk == 4599)THEN
      outstring3=' flux3_K'
   END IF
!
!  tag 41, flux star 4, band 1
!
   IF(kk == 4624)THEN
      outstring3=' flux4_U'
   END IF
!
!  tag 42, flux star 4, band 2
!
   IF(kk == 4625)THEN
      outstring3=' flux4_B'
   END IF
!
!  tag 43, flux star 4, band 3
!
   IF(kk == 4626)THEN
      outstring3=' flux4_V'
   END IF
!
!  tag 44, flux star 4, band 4
!
   IF(kk == 4627)THEN
      outstring3=' flux4_R'
   END IF
!
!  tag 45, flux star 4, band 5
!
   IF(kk == 4628)THEN
      outstring3=' flux4_I'
   END IF
!
!  tag 46, flux star 4, band 6
!
   IF(kk == 4629)THEN
      outstring3=' flux4_J'
   END IF
!
!  tag 47, flux star 4, band 7
!
   IF(kk == 4630)THEN
      outstring3=' flux4_H'
   END IF
!
!  tag 48, flux star 4, band 8
!
   IF(kk == 4631)THEN
      outstring3=' flux4_K'
   END IF
!
!  tag 51, flux star 5, band 1
!
   IF(kk == 4656)THEN
      outstring3=' flux5_U'
   END IF
!
!  tag 52, flux star 5, band 2
!
   IF(kk == 4657)THEN
      outstring3=' flux5_B'
   END IF
!
!  tag 53, flux star 5, band 3
!
   IF(kk == 4658)THEN
      outstring3=' flux5_V'
   END IF
!
!  tag 54, flux star 5, band 4
!
   IF(kk == 4659)THEN
      outstring3=' flux5_R'
   END IF
!
!  tag 55, flux star 5, band 5
!
   IF(kk == 4660)THEN
      outstring3=' flux5_I'
   END IF
!
!  tag 56, flux star 6, band 6
!
   IF(kk == 4661)THEN
      outstring3=' flux5_J'
   END IF
!
!  tag 57, flux star 5, band 7
!
   IF(kk == 4662)THEN
      outstring3=' flux5_H'
   END IF
!
!  tag 58, flux star 5, band 8
!
   IF(kk == 4663)THEN
      outstring3=' flux5_K'
   END IF
!
!  tag ob, Omega_bin, nodal angle of binary
!
   IF(kk == 449)THEN
      outstring3=' Omega_bin'
   END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
   IF((kk == 450).AND.(isw29 > 0))THEN
      outstring3=' ecos(omega)'
   END IF
!
!  tag os, osine, e*sin(omega) for binary
!
   IF((kk == 466).AND.(isw29 > 0))THEN
      outstring3=' esin(omega)'
   END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1
!
   IF(kk == 1016)THEN
      outstring3=' rk1'
   END IF
!
!  tag a2, rk2, tidal apsidal constant for star 2
!
   IF(kk == 1017)THEN
      outstring3=' rk2'
   END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
   IF(kk == 649)THEN
      outstring3=' P2tconj'
   END IF
!
!  tag ut, P2period
!
   IF(kk == 659)THEN
      outstring3=' P2period'
   END IF
!
!  tag uu, P2T0
!
   IF(kk == 660)THEN
      outstring3=' P2T0'
   END IF
!
!  tag uv, P2ecos
!
   IF(kk == 661)THEN
      outstring3=' P2ecos'
   END IF
!
!  tag uw, P2esin
!
   IF(kk == 662)THEN
      outstring3=' P2esin'
   END IF
!
!  tag ux, P2incl
!
   IF(kk == 663)THEN
      outstring3=' P2incl'
   END IF
!
!  tag uy, P2Omega
!
   IF(kk == 664)THEN
      outstring3=' P2Omega'
   END IF
!
!  tag uz, P2Q
!
   IF(kk == 665)THEN
      outstring3=' P2Q'
   END IF
!
!  tag ub, P2ratrad
!
   IF(kk == 641)THEN
      outstring3=' P2ratrad'
   END IF
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
   IF(kk == 681)THEN
      outstring3=' P3tconj'
   END IF
!
!  tag vt, P3period
!
   IF(kk == 691)THEN
      outstring3=' P3period'
   END IF
!
!  tag vu, P3T0
!
   IF(kk == 692)THEN
      outstring3=' P3T0'
   END IF
!
!  tag vv, P3ecos
!
   IF(kk == 693)THEN
      outstring3=' P3ecos'
   END IF
!
!  tag vw, P3esin
!
   IF(kk == 694)THEN
      outstring3=' P3esin'
   END IF
!
!  tag vx, P3incl
!
   IF(kk == 695)THEN
      outstring3=' P3incl'
   END IF
!
!  tag vy, P3Omega
!
   IF(kk == 696)THEN
      outstring3=' P3Omega'
   END IF
!
!  tag vz, P3Q
!
   IF(kk == 697)THEN
      outstring3=' P3Q'
   END IF
!
!  tag vb, P3ratrad
!
   IF(kk == 673)THEN
      outstring3=' P3ratrad'
   END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
   IF(kk == 713)THEN
      outstring3=' P4tconj'
   END IF
!
!  tag wt, P4period
!
   IF(kk == 723)THEN
      outstring3=' P4period'
   END IF
!
!  tag wu, P4T0
!
   IF(kk == 724)THEN
      outstring3=' P4T0'
   END IF
!
!  tag wv, P4ecos
!
   IF(kk == 725)THEN
      outstring3=' P4ecos'
   END IF
!
!  tag ww, P4esin
!
   IF(kk == 726)THEN
      outstring3=' P4esin'
   END IF
!
!  tag wx, P4incl
!
   IF(kk == 727)THEN
      outstring3=' P4incl'
   END IF
!
!  tag wy, P4Omega
!
   IF(kk == 728)THEN
      outstring3=' P4Omega'
   END IF
!
!  tag wz, P4Q
!
   IF(kk == 729)THEN
      outstring3=' P4Q'
   END IF
!
!  tag wb, P4ratrad
!
   IF(kk == 705)THEN
      outstring3=' P4ratrad'
   END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
   IF(kk == 745)THEN
      outstring3=' P5tconj'
   END IF
!
!  tag xt, P5period
!
   IF(kk == 755)THEN
      outstring3=' P5period'
   END IF
!
!  tag xu, P5T0
!
   IF(kk == 756)THEN
      outstring3=' P5T0'
   END IF
!
!  tag xv, P5ecos
!
   IF(kk == 757)THEN
      outstring3=' P5ecos'
   END IF
!
!  tag xw, P5esin
!
   IF(kk == 758)THEN
      outstring3=' P5esin'
   END IF
!
!  tag xx, P5incl
!
   IF(kk == 759)THEN
      outstring3=' P5incl'
   END IF
!
!  tag xy, P5Omega
!
   IF(kk == 760)THEN
      outstring3=' P5Omega'
   END IF
!
!  tag xz, P5Q
!
   IF(kk == 761)THEN
      outstring3=' P5Q'
   END IF
!
!  tag xb, P5ratrad
!
   IF(kk == 737)THEN
      outstring3=' P5ratrad'
   END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
   IF(kk == 585)THEN
      outstring3=' P6tconj'
   END IF
!
!  tag st, P6period
!
   IF(kk == 595)THEN
      outstring3=' P6period'
   END IF
!
!  tag su, P6T0
!
   IF(kk == 596)THEN
      outstring3=' P6T0'
   END IF
!
!  tag sv, P6ecos
!
   IF(kk == 597)THEN
      outstring3=' P6ecos'
   END IF
!
!  tag sw, P6esin
!
   IF(kk == 598)THEN
      outstring3=' P6esin'
   END IF
!
!  tag sx, P6incl
!
   IF(kk == 599)THEN
      outstring3=' P6incl'
   END IF
!
!  tag sy, P6Omega
!
   IF(kk == 600)THEN
      outstring3=' P6Omega'
   END IF
!
!  tag sz, P6Q
!
   IF(kk == 601)THEN
      outstring3=' P6Q'
   END IF
!
!  tag sb, P6ratrad
!
   IF(kk == 577)THEN
      outstring3=' P6ratrad'
   END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
   IF(kk == 233)THEN
      outstring3=' P7tconj'
   END IF
!
!  tag ht, P7period
!
   IF(kk == 243)THEN
      outstring3=' P7period'
   END IF
!
!  tag hu, P7T0
!
   IF(kk == 244)THEN
      outstring3=' P7T0'
   END IF
!
!  tag hv, P7ecos
!
   IF(kk == 245)THEN
      outstring3=' P7ecos'
   END IF
!
!  tag hw, P7esin
!
   IF(kk == 246)THEN
      outstring3=' P7esin'
   END IF
!
!  tag hx, P7incl
!
   IF(kk == 247)THEN
      outstring3=' P7incl'
   END IF
!
!  tag hy, P7Omega
!
   IF(kk == 248)THEN
      outstring3=' P7Omega'
   END IF
!
!  tag hz, P7Q
!
   IF(kk == 249)THEN
      outstring3=' P7Q'
   END IF
!
!  tag hb, P7ratrad
!
   IF(kk == 225)THEN
      outstring3=' P7ratrad'
   END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
   IF(kk == 329)THEN
      outstring3=' P8tconj'
   END IF
!
!  tag kt, P8period
!
   IF(kk == 339)THEN
      outstring3=' P8period'
   END IF
!
!  tag ku, P8T0
!
   IF(kk == 340)THEN
      outstring3=' P8T0'
   END IF
!
!  tag kv, P8ecos
!
   IF(kk == 341)THEN
      outstring3=' P8ecos'
   END IF
!
!  tag kw, P8esin
!
   IF(kk == 342)THEN
      outstring3=' P8esin'
   END IF
!
!  tag kx, P8incl
!
   IF(kk == 343)THEN
      outstring3=' P8incl'
   END IF
!
!  tag ky, P8Omega
!
   IF(kk == 344)THEN
      outstring3=' P8Omega'
   END IF
!
!  tag kz, P8Q
!
   IF(kk == 345)THEN
      outstring3=' P8Q'
   END IF
!
!  tag kb, P8ratrad
!
   IF(kk == 321)THEN
      outstring3=' P8ratrad'
   END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
   IF(kk == 1208)THEN
      outstring3=' Tgrav1'
   END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
   IF(kk == 1209)THEN
      outstring3=' Tgrav2'
   END IF
!
!  tag s0, contamS0, contamination season 0
!
   IF(kk == 1591)THEN
      outstring3=' contamS0'
   END IF
!
!  tag s1, contamS1, contamination season 1
!
   IF(kk == 1592)THEN
      outstring3=' contamS1'
   END IF
!
!  tag s2, contamS2, contamination season 2
!
   IF(kk == 1593)THEN
      outstring3=' contamS2'
   END IF
!
!  tag s3, contamS3, contamination season 3
!
   IF(kk == 1594)THEN
      outstring3=' contamS3'
   END IF
!
!  tag do, omegadot
!
   IF(kk == 110)THEN
      outstring3=' omega_dot'
   END IF
!
!  tag tt, tertperiod, orbital period of body 3
!
   IF(kk == 627)THEN
      outstring3=' P1period'
   END IF
!
!  tag tu, tertT0, periastron passage of body 3 orbit
!
   IF(kk == 628)THEN
      outstring3=' P1T0'
   END IF
!
!  tag tj, tertconj, time of primary conjunction of body 3 orbit
!
   IF(kk == 617)THEN
      outstring3=' P1tconj'
   END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3 orbit
!
   IF(kk == 629)THEN
      outstring3=' P1ecos'
   END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3 orbit
!
   IF(kk == 630)THEN
      outstring3=' P1esin'
   END IF
!
!  tag tx, tertincl, inclination of body 3 orbit
!
   IF(kk == 631)THEN
      outstring3=' P1incl'
   END IF
!
!  tag ty, tertOmega, nodal angle of body 3 orbit
!
   IF(kk == 632)THEN
      outstring3=' P1Omega'
   END IF
!
!  tag tz, tertQ, mass ratio of body 3
!
   IF(kk == 633)THEN
      outstring3=' P1Q'
   END IF
!
!  tag tb, tertratrad, radius ratio of body 3
!
   IF(kk == 609)THEN
      outstring3=' P1ratrad'
   END IF
!
!  tag co, contam, Kepler contamination
!
   IF(kk == 78)THEN
      outstring3=' contam'
   END IF
!
!  tag e1, beam1, Doppler boosting coefficient for star 1
!
   IF(kk == 1144)THEN
      outstring3=' beam1'
   END IF
!
!  tag e2, beam2, Doppler boosting coefficient for star 2
!
   IF(kk == 1145)THEN
      outstring3=' beam2'
   END IF
!
!  tag pm, primmass, mass of star 1 in solar masses
!
   IF(kk == 492)THEN
      outstring3=' primmass'
   END IF
!
!  tag pr, primrad, radius of star in solar radii
!
   IF(kk == 497)THEN
      outstring3=' primrad'
   END IF
!
!  tag te, temprat, ratio of star 2 temperature to star 1 temperature
!
   IF(kk == 612)THEN
      outstring3=' temprat'
   END IF
!
!  tag pk, primK, K-velocity of star 1 in km/sec
!
   IF(kk == 490)THEN
      outstring3=' primK'
   END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
   IF(kk == 544)THEN
      outstring3=' ratrad'
   END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
   IF(kk == 1528)THEN
      outstring3=' frac1'
   END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
   IF(kk == 1529)THEN
      outstring3=' frac2'
   END IF
!
!  tag de, density, density of star 1 in cgs
!
   IF(kk == 100)THEN
      outstring3=' density'
   END IF
!
!  tag l1, alb1, albedo of star 1
!
   IF(kk == 1368)THEN
      outstring3=' al1'
   END IF
!
!  tag l2, alb2, albedo of star 2
!
   IF(kk == 1369)THEN
      outstring3=' al2'
   END IF
!
!  tag dp, dphi, phase difference between secondary and primary eclipse
!
   IF(kk == 111)THEN
      outstring3=' dphi'
   END IF
!
!  tag tc, Tconj, time of primary conjunction of the binary orbit
!
   IF(kk == 610)THEN
      outstring3=' Tconj'
   END IF
!
!  tag t0, T0, time of periastron passage of binary orbit
!
   IF(kk == 1623)THEN
      outstring3=' T0'
   END IF
!
!  tag p2, period, binary orbital period in days
!
   IF(kk == 484)THEN
      outstring3=' P'
   END IF
!
!  tag in, finc, inclination of binary in degrees
!
   IF(kk == 269)THEN
      outstring3=' i'
   END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
   IF(kk == 8)THEN
      outstring3=' bigI'
   END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
   IF(kk == 1)THEN
      outstring3=' bigbeta'
   END IF
!
!  tag ma, Q, mass ratio of binary
!
   IF(kk == 384)THEN
      outstring3=' Q'
   END IF
!
!  tag f1, fill1, Roche lobe filling factor of star 1
!
   IF(kk == 1176)THEN
      outstring3=' fi1'
   END IF
!
!  tag f2, fill2, Roche lobe filling factor of star 2
!
   IF(kk == 1177)THEN
      outstring3=' fi2'
   END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
   IF(kk == 552)THEN
      outstring3=' rin'
   END IF
!
!  tag o1, omega1, spin frequency of star 1
!
   IF(kk == 1464)THEN
      outstring3=' o1'
   END IF
!
!  tag o2, spin frequency of star 2
!
   IF(kk == 1465)THEN
      outstring3=' o2'
   END IF
!
!  tag ro, router, radius of outer edge of accretion disk
!
   IF(kk == 558)THEN
      outstring3=' rout'
   END IF
!
!  tag t3, Teff3, effective temperature of star 3
!
   IF(kk == 1626)THEN
      outstring3=' Teff3'
   END IF
!
!  tag t4, Teff4, effective temperature of star 4
!
   IF(kk == 1627)THEN
      outstring3=' Teff4'
   END IF
!
!  tag t5, Teff5, effective temperature of star 5
!
   IF(kk == 1628)THEN
      outstring3=' Teff5'
   END IF
!
!  tag g3, g3, gravity of star 3 (log(g))
!
   IF(kk == 1210)THEN
      outstring3=' g3'
   END IF
!
!  tag be, betarim, opening angle of accretion disk rim
!
   IF(kk == 36)THEN
      outstring3=' beta'
   END IF
!
!  tag t1, Teff1, effective temperature of star 1
!
   IF(kk == 1624)THEN
      outstring3=' Teff1'
   END IF
!
!  tag t2, Teff2, effective temperature of star 2
!
   IF(kk == 1625)THEN
      outstring3=' Teff2'
   END IF
!
!  tag xi, xi, power-law exponent of the disk temperature profile
!
   IF(kk == 744)THEN
      outstring3=' xi'
   END IF
!
!  tag td, Tdisk, temperature of the inner edge of the accretion disk
!
   IF(kk == 611)THEN
      outstring3=' Td'
   END IF
!
!  tag lx, rLx, log of the X-ray luminosity in cgs units
!
   IF(kk == 375)THEN
      outstring3=' Lx'
   END IF
!
!  tag se, separ, semimajor axis of binary orbit
!
   IF(kk == 580)THEN
      outstring3=' separ'
   END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
   IF(kk == 576)THEN
      outstring3=' SA3'
   END IF
!
!  tag ps, pshift
!
   IF(kk == 498)THEN
      outstring3=' pshift'
   END IF
!
!  tag ec, ecc, eccentricity of binary orbit
!
   IF(kk == 130)THEN
      outstring3=' e'
   END IF
!
!  tag ar, argper, argument of periastron of binary orbit
!
   IF(kk == 17)THEN
      outstring3=' argper'
   END IF
!
!  tag b1, temperature factor spot 1, star 1
!
   IF(kk == 1048)THEN
      outstring3=' TF_spot1_star1'
   END IF
!
!  tag b2, latitude spot 1, star 1
!
   IF(kk == 1049)THEN
      outstring3=' lat_spot1_star1'
   END IF
!
!  tag b3, longitude spot 1, star 1
!
   IF(kk == 1050)THEN
      outstring3=' lon_spot1_star1'
   END IF
!
!  tag  b4, radius spot 1, star 1
!
   IF(kk == 1051)THEN
      outstring3=' rad_spot1_star1'
   END IF
!
!  tag b5, temperature factor spot 2, star 1
!
   IF(kk == 1052)THEN
      outstring3=' TF_spot2_star1'
   END IF
!
!  tag b6,  latitude spot 2, star 1
!
   IF(kk == 1053)THEN
      outstring3=' lat_spot2_star1'
   END IF
!
!  tag b7, longitude spot 2, star 1
!
   IF(kk == 1054)THEN
      outstring3=' lon_spot2_star1'
   END IF
!
!  tag b8, radius spot 2, star 1
!
   IF(kk == 1055)THEN
      outstring3=' rad_spot2_star1'
   END IF
!
!  tag c1, temperature factor spot 1, star 2
!
   IF(kk == 1080)THEN
      outstring3=' TF_spot1_star2'
   END IF
!
!  tag c2, latitude spot 1, star 2
!
   IF(kk == 1081)THEN
      outstring3=' lat_spot1_star2'
   END IF
!
!  tag c3, longitude spot 1, star 2
!
   IF(kk == 1082)THEN
      outstring3=' lon_spot1_star2'
   END IF
!
!  tag c4, radius spot 1, star 2
!
   IF(kk == 1083)THEN
      outstring3=' rad_spot1_star2'
   END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
   IF(kk == 1084)THEN
      outstring3=' TF_spot2_star2'
   END IF
!
!  tag c6, latitude spot 2, star 2
!
   IF(kk == 1085)THEN
      outstring3=' lat_spot2_star2'
   END IF
!
!  tag c7, longitude spot 2, star 2
!
   IF(kk == 1086)THEN
      outstring3=' lon_spot2_star2'
   END IF
!
!  tag c8, radius spot 2, star 2
!
   IF(kk == 1087)THEN
      outstring3=' rad_spot2_star2'
   END IF
!
!  tag d1, temperature factor spot 1 on disk
!
   IF(kk == 1112)THEN
      outstring3=' TF_spot1_disk'
   END IF
!
!  tag d2, azimuth spot 1 on disk
!
   IF(kk == 1113)THEN
      outstring3=' azi_spot1_disk'
   END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
   IF(kk == 1114)THEN
      outstring3=' cut_spot1_disk'
   END IF
!
!  tag d4, angular width of spot 1 on disk
!
   IF(kk == 1115)THEN
      outstring3=' wid_spot1_disk'
   END IF
!
!  tag d5, temperature factor spot 2 on disk
!
   IF(kk == 1116)THEN
      outstring3=' TF_spot2_disk'
   END IF
!
!  tag d6, azimuth spot 2 on disk
!
   IF(kk == 1117)THEN
      outstring3=' azi_spot2_disk'
   END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
   IF(kk == 1118)THEN
      outstring3=' cut_spot2_disk'
   END IF
!
!  tag d8, angular width of spot 2 on disk
!
   IF(kk == 1119)THEN
      outstring3=' wid_spot2_disk'
   END IF
!
!  tag x1, limb darkening x-coefficient, band 1, star 1
!
   IF(kk == 1752)THEN
      outstring3=' x1(U)'
   END IF
!
!  tag x2, limb darkening x-coefficient, band 2, star 1
!
   IF(kk == 1753)THEN
      outstring3=' x1(B)'
   END IF
!
!  tag x3, limb darkening x-coefficient, band 3, star 1
!
   IF(kk == 1754)THEN
      outstring3=' x1(V)'
   END IF
!
!  tag x4, limb darkening x-coefficient, band 4, star 1
!
   IF(kk == 1755)THEN
      outstring3=' x1(R)'
   END IF
!
!  tag x5, limb darkening x-coefficient, band 5, star 1
!
   IF(kk == 1756)THEN
      outstring3=' x1(I)'
   END IF
!
!  tag x6, limb darkening x-coefficient, band 6, star 1
!
   IF(kk == 1757)THEN
      outstring3=' x1(J)'
   END IF
!
!  tag x7, limb darkening x-coefficient, band 7, star 1
!
   IF(kk == 1758)THEN
      outstring3=' x1(H)'
   END IF
!
!  tag x8, limb darkening x-coefficient, band 8, star 1
!
   IF(kk == 1759)THEN
      outstring3=' x1(K)'
   END IF
!
!  tag z1, limb darkening x-coefficient, band 1, star 2
!
   IF(kk == 1816)THEN
      outstring3=' x2(U)'
   END IF
!
!  tag z2, limb darkening x-coefficient, band 2, star 2
!
   IF(kk == 1817)THEN
      outstring3=' x2(B)'
   END IF
!
!  tag z3, limb darkening x-coefficient, band 3, star 2
!
   IF(kk == 1818)THEN
      outstring3=' x2(V)'
   END IF
!
!  tag z4, limb darkening x-coefficient, band 4, star 2
!
   IF(kk == 1819)THEN
      outstring3=' x2(R)'
   END IF
!
!  tag z5, limb darkening x-coefficient, band 5, star 2
!
   IF(kk == 1820)THEN
      outstring3=' x2(I)'
   END IF
!
!  tag z6, limb darkening x-coefficient, band 6, star 2
!
   IF(kk == 1821)THEN
      outstring3=' x2(J)'
   END IF
!
!  tag z7, limb darkening x-coefficient, band 7, star 2
!
   IF(kk == 1822)THEN
      outstring3=' x2(H)'
   END IF
!
!  tag z8, limb darkening x-coefficient, band 8, star 2
!
   IF(kk == 1823)THEN
      outstring3=' x2(K)'
   END IF
!
!  tag y1, limb darkening y-coefficient, band 1, star 1
!
   IF(kk == 1784)THEN
      outstring3=' y1(U)'
   END IF
!
!  tag y2, limb darkening y-coefficient, band 2, star 1
!
   IF(kk == 1785)THEN
      outstring3=' y1(B)'
   END IF
!
!  tag y3, limb darkening y-coefficient, band 3, star 1
!
   IF(kk == 1786)THEN
      outstring3=' y1(V)'
   END IF
!
!  tag y4, limb darkening y-coefficient, band 4, star 1
!
   IF(kk == 1787)THEN
      outstring3=' y1(R)'
   END IF
!
!  tag y5, limb darkening y-coefficient, band 5, star 1
!
   IF(kk == 1788)THEN
      outstring3=' y1(I)'
   END IF
!
!  tag y6, limb darkening y-coefficient, band 6, star 1
!
   IF(kk == 1789)THEN
      outstring3=' y1(J)'
   END IF
!
!  tag y7, limb darkening y-coefficient, band 7, star 1
!
   IF(kk == 1790)THEN
      outstring3=' y1(H)'
   END IF
!
!  tag y8, limb darkening y-coefficient, band 8, star 1
!
   IF(kk == 1791)THEN
      outstring3=' y1(K)'
   END IF
!
!  tag w1, limb darkening y-coefficient, band 1, star 2
!
   IF(kk == 1720)THEN
      outstring3=' y2(U)'
   END IF
!
!  tag w2, limb darkening y-coefficient, band 2, star 2
!
   IF(kk == 1721)THEN
      outstring3=' y2(B)'
   END IF
!
!  tag w3, limb darkening y-coefficient, band 3, star 2
!
   IF(kk == 1722)THEN
      outstring3=' y2(V)'
   END IF
!
!  tag w4, limb darkening y-coefficient, band 4, star 2
!
   IF(kk == 1723)THEN
      outstring3=' y2(R)'
   END IF
!
!  tag w5, limb darkening y-coefficient, band 5, star 2
!
   IF(kk == 1724)THEN
      outstring3=' y2(I)'
   END IF
!
!  tag w6, limb darkening y-coefficient, band 6, star 2
!
   IF(kk == 1725)THEN
      outstring3=' y2(J)'
   END IF
!
!  tag w7, limb darkening y-coefficient, band 7, star 2
!
   IF(kk == 1726)THEN
      outstring3=' y2(H)'
   END IF
!
!  tag w8, limb darkening y-coefficient, band 8, star 2
!
   IF(kk == 1727)THEN
      outstring3=' y2(K)'
   END IF
!
!  tag m1, limb darkening x-coefficient, band 1, star 3
!
   IF(kk == 1400)THEN
      outstring3=' x3(U)'
   END IF
!
!  tag m2, limb darkening x-coefficient, band 2, star 3
!
   IF(kk == 1401)THEN
      outstring3=' x3(B)'
   END IF
!
!  tag m3, limb darkening x-coefficient, band 3, star 3
!
   IF(kk == 1402)THEN
      outstring3=' x3(V)'
   END IF
!
!  tag m4, limb darkening x-coefficient, band 4, star 3
!
   IF(kk == 1403)THEN
      outstring3=' x3(R)'
   END IF
!
!  tag m5, limb darkening x-coefficient, band 5, star 3
!
   IF(kk == 1404)THEN
      outstring3=' x3(I)'
   END IF
!
!  tag m6, limb darkening x-coefficient, band 6, star 3
!
   IF(kk == 1405)THEN
      outstring3=' x3(J)'
   END IF
!
!  tag m7, limb darkening x-coefficient, band 7, star 3
!
   IF(kk == 1406)THEN
      outstring3=' x3(H)'
   END IF
!
!  tag m8, limb darkening x-coefficient, band 8, star 3
!
   IF(kk == 1407)THEN
      outstring3=' x3(K)'
   END IF
!
!  tag n1, limb darkening y-coefficient, band 1, star 3
!
   IF(kk == 1432)THEN
      outstring3=' y3(U)'
   END IF
!
!  tag n2, limb darkening y-coefficient, band 2, star 3
!
   IF(kk == 1433)THEN
      outstring3=' y3(B)'
   END IF
!
!  tag n3, limb darkening y-coefficient, band 3, star 3
!
   IF(kk == 1434)THEN
      outstring3=' y3(V)'
   END IF
!
!  tag n4, limb darkening y-coefficient, band 4, star 3
!
   IF(kk == 1435)THEN
      outstring3=' y3(R)'
   END IF
!
!  tag n5, limb darkening y-coefficient, band 5, star 3
!
   IF(kk == 1436)THEN
      outstring3=' y3(I)'
   END IF
!
!  tag n6, limb darkening y-coefficient, band 6, star 3
!
   IF(kk == 1437)THEN
      outstring3=' y3(J)'
   END IF
!
!  tag n7, limb darkening y-coefficient, band 7, star 3
!
   IF(kk == 1438)THEN
      outstring3=' y3(H)'
   END IF
!
!  tag n8, limb darkening y-coefficient, band 8, star 3
!
   IF(kk == 1439)THEN
      outstring3=' y3(K)'
   END IF
!
!  tag i1, limb darkening x-coefficient, band 1, star 4
!
   IF(kk == 1272)THEN
      outstring3=' x4(U)'
   END IF
!
!  tag i2, limb darkening x-coefficient, band 2, star 4
!
   IF(kk == 1273)THEN
      outstring3=' x4(B)'
   END IF
!
!  tag i3, limb darkening x-coefficient, band 3, star 4
!
   IF(kk == 1274)THEN
      outstring3=' x4(V)'
   END IF
!
!  tag i4, limb darkening x-coefficient, band 4, star 4
!
   IF(kk == 1275)THEN
      outstring3=' x4(R)'
   END IF
!
!  tag i5, limb darkening x-coefficient, band 5, star 4
!
   IF(kk == 1276)THEN
      outstring3=' x4(I)'
   END IF
!
!  tag i6, limb darkening x-coefficient, band 6, star 4
!
   IF(kk == 1277)THEN
      outstring3=' x4(J)'
   END IF
!
!  tag i7, limb darkening x-coefficient, band 7, star 4
!
   IF(kk == 1278)THEN
      outstring3=' x4(H)'
   END IF
!
!  tag i8, limb darkening x-coefficient, band 8, star 4
!
   IF(kk == 1279)THEN
      outstring3=' x4(K)'
   END IF
!
!  tag j1, limb darkening y-coefficient, band 1, star 4
!
   IF(kk == 1304)THEN
      outstring3=' y4(U)'
   END IF
!
!  tag j2, limb darkening y-coefficient, band 2, star 4
!
   IF(kk == 1305)THEN
      outstring3=' y4(B)'
   END IF
!
!  tag j3, limb darkening y-coefficient, band 3, star 4
!
   IF(kk == 1306)THEN
      outstring3=' y4(V)'
   END IF
!
!  tag j4, limb darkening y-coefficient, band 4, star 4
!
   IF(kk == 1307)THEN
      outstring3=' y4(R)'
   END IF
!
!  tag j5, limb darkening y-coefficient, band 5, star 4
!
   IF(kk == 1308)THEN
      outstring3=' y4(I)'
   END IF
!
!  tag j6, limb darkening y-coefficient, band 6, star 4
!
   IF(kk == 1309)THEN
      outstring3=' y4(J)'
   END IF
!
!  tag j7, limb darkening y-coefficient, band 7, star 4
!
   IF(kk == 1310)THEN
      outstring3=' y4(H)'
   END IF
!
!  tag j8, limb darkening y-coefficient, band 8, star 4
!
   IF(kk == 1311)THEN
      outstring3=' y4(K)'
   END IF
!
!  tag k1, limb darkening x-coefficient, band 1, star 5
!
   IF(kk == 1336)THEN
      outstring3=' x5(U)'
   END IF
!
!  tag k2, limb darkening x-coefficient, band 2, star 5
!
   IF(kk == 1337)THEN
      outstring3=' x5(B)'
   END IF
!
!  tag k3, limb darkening x-coefficient, band 3, star 5
!
   IF(kk == 1338)THEN
      outstring3=' x5(V)'
   END IF
!
!  tag k4, limb darkening x-coefficient, band 4, star 5
!
   IF(kk == 1339)THEN
      outstring3=' x5(R)'
   END IF
!
!  tag k5, limb darkening x-coefficient, band 5, star 5
!
   IF(kk == 1340)THEN
      outstring3=' x5(I)'
   END IF
!
!  tag k6, limb darkening x-coefficient, band 6, star 5
!
   IF(kk == 1341)THEN
      outstring3=' x5(J)'
   END IF
!
!  tag k7, limb darkening x-coefficient, band 7, star 5
!
   IF(kk == 1342)THEN
      outstring3=' x5(H)'
   END IF
!
!  tag k8, limb darkening x-coefficient, band 8, star 5
!
   IF(kk == 1343)THEN
      outstring3=' x5(K)'
   END IF
!
!  tag p1, limb darkening y-coefficient, band 1, star 5
!
   IF(kk == 1496)THEN
      outstring3=' y5(U)'
   END IF
!
!  tag p2, limb darkening y-coefficient, band 2, star 5
!
   IF(kk == 1497)THEN
      outstring3=' y5(B)'
   END IF
!
!  tag p3, limb darkening y-coefficient, band 3, star 5
!
   IF(kk == 1498)THEN
      outstring3=' y5(V)'
   END IF
!
!  tag p4, limb darkening y-coefficient, band 4, star 5
!
   IF(kk == 1499)THEN
      outstring3=' y5(R)'
   END IF
!
!  tag p5, limb darkening y-coefficient, band 5, star 5
!
   IF(kk == 1500)THEN
      outstring3=' y5(I)'
   END IF
!
!  tag p6, limb darkening y-coefficient, band 6, star 5
!
   IF(kk == 1501)THEN
      outstring3=' y5(J)'
   END IF
!
!  tag p7, limb darkening y-coefficient, band 7, star 5
!
   IF(kk == 1502)THEN
      outstring3=' y5(H)'
   END IF
!
!  tag p8, limb darkening y-coefficient, band 8, star 5
!
   IF(kk == 1503)THEN
      outstring3=' y5(K)'
   END IF
!
   k=LEN_TRIM(outstring3)
   WRITE(*,70)outstring1(1:ll1),outstring2(1:ll2),outstring3(1:k)
!
10 FORMAT(a,i1)
20 FORMAT(a,i2)
30 FORMAT(a,i3)
40 FORMAT(a,i4)
50 FORMAT(a,i5)
60 FORMAT(a,i6)
70 FORMAT(a,', ',a,', variable',a)
!
   RETURN
!
END SUBROUTINE printgriditer
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printiter(kmodel,instring1,iter,instring2)
!
!   Will print out information about iterations and generations
!   to the screen in a nice way
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: kmodel
   CHARACTER (LEN=*), INTENT(IN)            :: instring1
   INTEGER, INTENT(IN)                      :: iter
   CHARACTER (LEN=*), INTENT(IN)            :: instring2
!
   INTEGER :: l1,l2,ll1,ll2
!
   CHARACTER (LEN=80 ) :: outstring1,outstring2
!
   IF(kmodel < 0)RETURN
   IF(kmodel >= 1000000)RETURN
!
   l1=LEN_TRIM(instring1)
   l1=l1+1
   IF(kmodel < 10)WRITE(outstring1,10)instring1(1:l1),kmodel
   IF((kmodel >= 10).AND.(kmodel < 100))THEN
      WRITE(outstring1,20)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100).AND.(kmodel < 1000))THEN
      WRITE(outstring1,30)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 1000).AND.(kmodel < 10000))THEN
      WRITE(outstring1,40)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 10000).AND.(kmodel < 100000))THEN
      WRITE(outstring1,50)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100000).AND.(kmodel < 1000000))THEN
      WRITE(outstring1,60)instring1(1:l1),kmodel
   END IF
!
   IF(iter < 0)RETURN
   IF(iter >= 1000000)RETURN
!
   l2=LEN_TRIM(instring2)
   l2=l2+1
   IF(iter < 10)WRITE(outstring2,10)instring2(1:l2),iter
   IF((iter >= 10).AND.(iter < 100))THEN
      WRITE(outstring2,20)instring2(1:l2),iter
   END IF
   IF((iter >= 100).AND.(iter < 1000))THEN
      WRITE(outstring2,30)instring2(1:l2),iter
   END IF
   IF((iter >= 1000).AND.(iter < 10000))THEN
      WRITE(outstring2,40)instring2(1:l2),iter
   END IF
   IF((iter >= 10000).AND.(iter < 100000))THEN
      WRITE(outstring2,50)instring2(1:l2),iter
   END IF
   IF((iter >= 100000).AND.(iter < 1000000))THEN
      WRITE(outstring2,60)instring2(1:l2),iter
   END IF
!
   ll1=LEN_TRIM(outstring1)
   ll2=LEN_TRIM(outstring2)
!
   WRITE(*,70)outstring1(1:ll1),outstring2(1:ll2)
!
10 FORMAT(a,i1)
20 FORMAT(a,i2)
30 FORMAT(a,i3)
40 FORMAT(a,i4)
50 FORMAT(a,i5)
60 FORMAT(a,i6)
70 FORMAT(a,', ',a)
   RETURN
!
END SUBROUTINE printiter
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printiter1(kmodel,instring1)
!
!  Used by the optimizers to print out generation information
!  to the screen in a nice way
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: kmodel
   CHARACTER (LEN=*), INTENT(IN)            :: instring1
!
   INTEGER :: l1,ll1
!
   CHARACTER (LEN=80 ) :: outstring1
!
   IF(kmodel < 0)RETURN
   IF(kmodel >= 1000000)RETURN
!
   l1=LEN_TRIM(instring1)
   l1=l1+1
   IF(kmodel < 10)WRITE(outstring1,10)instring1(1:l1),kmodel
   IF((kmodel >= 10).AND.(kmodel < 100))THEN
      WRITE(outstring1,20)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100).AND.(kmodel < 1000))THEN
      WRITE(outstring1,30)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 1000).AND.(kmodel < 10000))THEN
      WRITE(outstring1,40)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 10000).AND.(kmodel < 100000))THEN
      WRITE(outstring1,50)instring1(1:l1),kmodel
   END IF
   IF((kmodel >= 100000).AND.(kmodel < 1000000))THEN
      WRITE(outstring1,60)instring1(1:l1),kmodel
   END IF
!
   ll1=LEN_TRIM(outstring1)
!
   WRITE(*,70)outstring1(1:ll1)
!
10 FORMAT(a,i1)
20 FORMAT(a,i2)
30 FORMAT(a,i3)
40 FORMAT(a,i4)
50 FORMAT(a,i5)
60 FORMAT(a,i6)
70 FORMAT(a)
   RETURN
!
END SUBROUTINE printiter1
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printmed (chi1)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1
!
10 FORMAT('med1 = 999999999999999999999.999999')
20 FORMAT('med1 = ',f28.6)
30 FORMAT('med1 = ',f27.6)
40 FORMAT('med1 = ',f26.6)
50 FORMAT('med1 = ',f25.6)
60 FORMAT('med1 = ',f24.6)
70 FORMAT('med1 = ',f23.6)
80 FORMAT('med1 = ',f22.6)
90 FORMAT('med1 = ',f21.6)
100 FORMAT('med1 = ',f20.6)
110 FORMAT('med1 = ',f19.6)
120 FORMAT('med1 = ',f18.6)
130 FORMAT('med1 = ',f17.6)
140 FORMAT('med1 = ',f16.6)
150 FORMAT('med1 = ',f15.6)
160 FORMAT('med1 = ',f14.6)
170 FORMAT('med1 = ',f13.6)
180 FORMAT('med1 = ',f12.6)
190 FORMAT('med1 = ',f11.6)
200 FORMAT('med1 = ',f10.6)
210 FORMAT('med1 = ',f9.6)
220 FORMAT('med1 = ',f8.6)
!
   RETURN
!
END SUBROUTINE printmed
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE prints(chi1)
!
!  Will print 'S = ###########.##' in a compact way
!  so that the spacing between the equals sign and the leading
!  number is the same.
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      WRITE(*,*)' '
      RETURN
   END IF
   WRITE(*,220)chi1
   WRITE(*,*)' '
!
10 FORMAT('SMALL = 999999999999999999999.999999')
20 FORMAT('SMALL = ',f28.6)
30 FORMAT('SMALL = ',f27.6)
40 FORMAT('SMALL = ',f26.6)
50 FORMAT('SMALL = ',f25.6)
60 FORMAT('SMALL = ',f24.6)
70 FORMAT('SMALL = ',f23.6)
80 FORMAT('SMALL = ',f22.6)
90 FORMAT('SMALL = ',f21.6)
100 FORMAT('SMALL = ',f20.6)
110 FORMAT('SMALL = ',f19.6)
120 FORMAT('SMALL = ',f18.6)
130 FORMAT('SMALL = ',f17.6)
140 FORMAT('SMALL = ',f16.6)
150 FORMAT('SMALL = ',f15.6)
160 FORMAT('SMALL = ',f14.6)
170 FORMAT('SMALL = ',f13.6)
180 FORMAT('SMALL = ',f12.6)
190 FORMAT('SMALL = ',f11.6)
200 FORMAT('SMALL = ',f10.6)
210 FORMAT('SMALL = ',f9.6)
220 FORMAT('SMALL = ',f8.6)
!
   RETURN
!
END SUBROUTINE prints
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printsmall(chi1)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+00_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1

10 FORMAT('chi_small = 99999999999999999999.999999')
20 FORMAT('chi_small = ',f28.6)
30 FORMAT('chi_small = ',f27.6)
40 FORMAT('chi_small = ',f26.6)
50 FORMAT('chi_small = ',f25.6)
60 FORMAT('chi_small = ',f24.6)
70 FORMAT('chi_small = ',f23.6)
80 FORMAT('chi_small = ',f22.6)
90 FORMAT('chi_small = ',f21.6)
100 FORMAT('chi_small = ',f20.6)
110 FORMAT('chi_small = ',f19.6)
120 FORMAT('chi_small = ',f18.6)
130 FORMAT('chi_small = ',f17.6)
140 FORMAT('chi_small = ',f16.6)
150 FORMAT('chi_small = ',f15.6)
160 FORMAT('chi_small = ',f14.6)
170 FORMAT('chi_small = ',f13.6)
180 FORMAT('chi_small = ',f12.6)
190 FORMAT('chi_small = ',f11.6)
200 FORMAT('chi_small = ',f10.6)
210 FORMAT('chi_small = ',f9.6)
220 FORMAT('chi_small = ',f8.6)
!
   RETURN
!
END SUBROUTINE printsmall
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE printsmallmed(chi1)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: chi1
!
   IF(chi1 > 9.999999999999999E+20_dp)THEN
      WRITE(*,10)
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+19_dp)THEN
      WRITE(*,20)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+18_dp)THEN
      WRITE(*,30)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+17_dp)THEN
      WRITE(*,40)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+16_dp)THEN
      WRITE(*,50)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+15_dp)THEN
      WRITE(*,60)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+14_dp)THEN
      WRITE(*,70)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+13_dp)THEN
      WRITE(*,80)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+12_dp)THEN
      WRITE(*,90)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+11_dp)THEN
      WRITE(*,100)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+10_dp)THEN
      WRITE(*,110)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+09_dp)THEN
      WRITE(*,120)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+08_dp)THEN
      WRITE(*,130)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+07_dp)THEN
      WRITE(*,140)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+06_dp)THEN
      WRITE(*,150)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+05_dp)THEN
      WRITE(*,160)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+04_dp)THEN
      WRITE(*,170)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+03_dp)THEN
      WRITE(*,180)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+02_dp)THEN
      WRITE(*,190)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999E+01_dp)THEN
      WRITE(*,200)chi1
      RETURN
   END IF
   IF(chi1 > 9.999999999999999_dp)THEN
      WRITE(*,210)chi1
      RETURN
   END IF
   WRITE(*,220)chi1
!
10 FORMAT('med_small = 99999999999999999999.999999')
20 FORMAT('med_small = ',f28.6)
30 FORMAT('med_small = ',f27.6)
40 FORMAT('med_small = ',f26.6)
50 FORMAT('med_small = ',f25.6)
60 FORMAT('med_small = ',f24.6)
70 FORMAT('med_small = ',f23.6)
80 FORMAT('med_small = ',f22.6)
90 FORMAT('med_small = ',f21.6)
100 FORMAT('med_small = ',f20.6)
110 FORMAT('med_small = ',f19.6)
120 FORMAT('med_small = ',f18.6)
130 FORMAT('med_small = ',f17.6)
140 FORMAT('med_small = ',f16.6)
150 FORMAT('med_small = ',f15.6)
160 FORMAT('med_small = ',f14.6)
170 FORMAT('med_small = ',f13.6)
180 FORMAT('med_small = ',f12.6)
190 FORMAT('med_small = ',f11.6)
200 FORMAT('med_small = ',f10.6)
210 FORMAT('med_small = ',f9.6)
220 FORMAT('med_small = ',f8.6)
!
   RETURN
!
END SUBROUTINE printsmallmed
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE quadreg(x,y,xzero)
!
!  Fits a parabola to three points, used by stepELC.for
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: x(3)
   REAL(KIND=dp), INTENT(IN)                :: y(3)
   REAL(KIND=dp), INTENT(OUT)               :: xzero
!
   REAL(KIND=dp)  :: x1,x2,x3,y1,y2,y3,denom,a,b
!
   x1=x(1)
   x2=x(2)
   x3=x(3)
   y1=y(1)
   y2=y(2)
   y3=y(3)
!
   denom=(x1-x2)*(x1-x3)*(x2-x3)
   a=(x3*(-y1+y2)+x2*(y1-y3)+x1*(-y2+y3))/denom
   b=(x3**2*(y1-y2)+x1**2*(y2-y3)+x2**2*(-y1+y3))/denom
   xzero=-b/(2.0_dp*a)
!
   RETURN
!
END SUBROUTINE quadreg
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE readchol(nvar,nvmax,svar,covchol,invcovchol,  &
   aveparm)
!
!   Will read the covariance file written by ELCcovarience,
!   namely demcmcELC.cov.  Some basic checking is done to make
!   sure the number of parameters and the order of the parameters
!   is the same.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvar
   INTEGER, INTENT(IN)                      :: nvmax
   CHARACTER(LEN=40), INTENT(IN)            :: svar(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: covchol(nvar,nvar)
   REAL(KIND=dp), INTENT(OUT)               :: invcovchol(nvar,nvar)
   REAL(KIND=dp), INTENT(OUT)               :: aveparm(nvar)
!
   INTEGER :: i,icnvrt,ntemp,ios,j,k,iosr
!
   CHARACTER(LEN=40) :: tempstr
!
   ios=0
   OPEN(UNIT=146,FILE='demcmcELC.cov',STATUS='old',IOSTAT=ios,ERR=10)
!
!   Read the number of variables.  If that does not match the Nvar of
!   the current run, set defaults and exit.
!
   READ(146,*)ntemp
   IF(nvar /= ntemp)THEN
      WRITE(*,60)
      DO i=1,nvar
         aveparm(i)=0.0_dp
         DO j=i,nvar
            IF(i == j)THEN
               covchol(i,j)=1.0_dp
               invcovchol(i,j)=1.0_dp
            ELSE
               covchol(i,j)=0.0_dp
               invcovchol(i,j)=0.0_dp
            END IF
         END DO
      END DO
      CLOSE(146)
      RETURN
   END IF
!
!  Read the strings (from gridloop.opt of the run that made
!  the covariance file).  If those strings don't match the strings
!  from the current run, set defaults and exit.
!
   DO k=1,nvar
      READ(146,50)tempstr
      IF(icnvrt(svar(k)(1:2)) /= icnvrt(tempstr(1:2)))THEN
         WRITE(*,70)
         DO i=1,nvar
            aveparm(i)=0.0_dp
            DO j=i,nvar
               IF(i == j)THEN
                  covchol(i,j)=1.0_dp
                  invcovchol(i,j)=1.0_dp
               ELSE
                  covchol(i,j)=0.0_dp
                  invcovchol(i,j)=0.0_dp
               END IF
            END DO
         END DO
         CLOSE(146)
         RETURN
      END IF
   END DO
!
!   read the average parameters
!
   iosr=0
   DO i=1,nvar
      READ(146,*,IOSTAT=iosr,ERR=20)aveparm(i)
   END DO
!
!   read covchol
!
   iosr=0
   DO i=1,nvar
      DO j=1,nvar
         READ(146,*,IOSTAT=iosr,ERR=30)covchol(i,j)
      END DO
   END DO
!
!   read invcovchol
!
   iosr=0
   DO i=1,nvar
      DO j=1,nvar
         READ(146,*,IOSTAT=iosr,ERR=40)invcovchol(i,j)
      END DO
   END DO
!
   CLOSE(146)
!
!   normal return
!
   RETURN
!
!  demcmcELC.cov does not exist, set defaults
!
10 IF(ios /= 0)THEN
      WRITE(*,80)
      DO i=1,nvar
         aveparm(i)=0.0_dp
         DO j=i,nvar
            IF(i == j)THEN
               covchol(i,j)=1.0_dp
               invcovchol(i,j)=1.0_dp
            ELSE
               covchol(i,j)=0.0_dp
               invcovchol(i,j)=0.0_dp
            END IF
         END DO
      END DO
      RETURN
   END IF
!
!   error reading aveparm, set defaults
!
20 IF(iosr /= 0)THEN
      WRITE(*,90)
      DO i=1,nvar
         aveparm(i)=0.0_dp
         DO j=i,nvar
            IF(i == j)THEN
               covchol(i,j)=1.0_dp
               invcovchol(i,j)=1.0_dp
            ELSE
               covchol(i,j)=0.0_dp
               invcovchol(i,j)=0.0_dp
            END IF
         END DO
      END DO
      RETURN
   END IF
!
!   error reading covchol, set defaults
!
30 IF(iosr /= 0)THEN
      WRITE(*,100)
      DO i=1,nvar
         aveparm(i)=0.0_dp
         DO j=i,nvar
            IF(i == j)THEN
               covchol(i,j)=1.0_dp
               invcovchol(i,j)=1.0_dp
            ELSE
               covchol(i,j)=0.0_dp
               invcovchol(i,j)=0.0_dp
            END IF
         END DO
      END DO
      RETURN
   END IF
!
!   error reading covchol, set defaults
!
40 IF(iosr /= 0)THEN
      WRITE(*,110)
      DO i=1,nvar
         aveparm(i)=0.0_dp
         DO j=i,nvar
            IF(i == j)THEN
               covchol(i,j)=1.0_dp
               invcovchol(i,j)=1.0_dp
            ELSE
               covchol(i,j)=0.0_dp
               invcovchol(i,j)=0.0_dp
            END IF
         END DO
      END DO
      RETURN
   END IF
!
50 FORMAT(a40)
60 FORMAT('Error:  incompatable Nvar, setting defaults')
70 FORMAT('Error:  incompatable parameter order, setting defaults')
80 FORMAT('Error:  file demcmcELC.cov not found, setting defaults')
90 FORMAT('Error reading aveparm, setting defaults')
100 FORMAT('Error reading covchol, setting defaults')
110 FORMAT('Error reading invcovchol, setting defaults')
!
   RETURN
!
END SUBROUTINE readchol
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE recordloopopt(udatafile,bdatafile,vdatafile,  &
   rdatafile,idatafile,jdatafile,hdatafile,kdatafile,rv1file,  &
   rv2file,nvmax,nvar,svar,var,vstart,vstep,nstep,nobv,sobv,obv,  &
   eobv,vstep1,rv3file,rv4file,rv5file,iextension)
!
!    November 15, 1999
!
!    This routine will write an input file to set up the optimizer (either
!    the 'grid search' or the Levenburg-Marquardt routine), based on
!    the final parameters derived by the optimizer.
!
!     UPDATE September 21, 2008
!
!     make the dimension of sobv, eobv, and obv 11
!
!
   USE accur
!
   IMPLICIT NONE
!
   CHARACTER(LEN=40), INTENT(IN)            :: udatafile
   CHARACTER(LEN=40), INTENT(IN)            :: bdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: vdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: rdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: idatafile
   CHARACTER(LEN=40), INTENT(IN)            :: jdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: hdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: kdatafile
   CHARACTER(LEN=40), INTENT(IN)            :: rv1file
   CHARACTER(LEN=40), INTENT(IN)            :: rv2file
   INTEGER, INTENT(IN)                      :: nvmax
   INTEGER, INTENT(IN)                      :: nvar
   CHARACTER(LEN=40), INTENT(IN)            :: svar(nvmax)
   REAL(KIND=dp), INTENT(IN OUT)            :: var(nvmax)
   REAL(KIND=dp), INTENT(IN)                :: vstart(nvmax)
   REAL(KIND=dp), INTENT(IN)                :: vstep(nvmax)
   INTEGER, INTENT(IN)                      :: nstep(nvmax)
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER(LEN=40), INTENT(IN)            :: sobv(19)
   REAL(KIND=dp), INTENT(IN)                :: obv(19)
   REAL(KIND=dp), INTENT(IN)                :: eobv(19)
   REAL(KIND=dp), INTENT(IN)                :: vstep1(nvmax)
   CHARACTER(LEN=40), INTENT(IN)            :: rv3file
   CHARACTER(LEN=40), INTENT(IN)            :: rv4file
   CHARACTER(LEN=40), INTENT(IN)            :: rv5file
   INTEGER, INTENT(IN OUT)                  :: iextension
!
   REAL(KIND=dp)  :: r1,r2
!
   INTEGER :: i,ios
!
   CHARACTER(LEN=7) :: extension
!
   ios=0
   IF(iextension < 0)THEN
      OPEN(UNIT=11,FILE='gridELC.opt',STATUS='unknown',IOSTAT=ios)
   ELSE
      IF(iextension < 1000000)iextension=1000000
      WRITE(extension,55)iextension
      OPEN(UNIT=11,FILE='gridELC.'//extension,STATUS='unknown', IOSTAT=ios)
   END IF
!
   WRITE(11,60)udatafile
   WRITE(11,60)bdatafile
   WRITE(11,60)vdatafile
   WRITE(11,60)rdatafile
   WRITE(11,60)idatafile
   WRITE(11,60)jdatafile
   WRITE(11,60)hdatafile
   WRITE(11,60)kdatafile
   WRITE(11,60)rv1file
   WRITE(11,60)rv2file
   WRITE(11,60)rv3file
   WRITE(11,60)rv4file
   WRITE(11,60)rv5file
!
   WRITE(11,70)nvar
!
   DO  i=1,nvar
      WRITE(11,60)svar(i)
      IF((svar(i)(1:2) == 'f1').OR.(svar(i)(1:2) == 'F1'))THEN
         IF(var(i) > 1.0_dp)var(i)=1.0_dp
      END IF
      IF((svar(i)(1:2) == 'f2').OR.(svar(i)(1:2) == 'F2'))THEN
         IF(var(i) > 1.0_dp)var(i)=1.0_dp
      END IF
   END DO
!
   DO  i=1,nvar
      IF(ABS(vstep1(i)-vstart(i)) > EPSILON(vstep1(i)))THEN
         r1=(var(i)-vstart(i))/(vstep1(i)-vstart(i))
         r2=(vstep1(i)-var(i))/(vstep1(i)-vstart(i))
      ELSE
         r1=0.0_dp
         r2=0.0_dp
      END IF
      WRITE(11,80)var(i),vstep(i),nstep(i),r1,r2,svar(i)(1:2),i
   END DO
!
   IF(nobv < 1)GO TO 50
   WRITE(11,70)nobv
   DO  i=1,nobv
      WRITE(11,60)sobv(i)
   END DO
!
   DO  i=1,nobv
      WRITE(11,90)obv(i),eobv(i)
   END DO
!
50 CLOSE(11)
!
55 FORMAT(i7)
60 FORMAT(a40)
70 FORMAT(i2)
80 FORMAT(f25.12,1X,f18.10,1X,i7,2X,2(f10.7,1X),1X,a2,1X,i2)
90 FORMAT(f23.9,3X,f15.10)
!
   RETURN
!
END SUBROUTINE recordloopopt
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
FUNCTION rlogplus(rlogx,rlogy)
!
!   Given logx and logy, this function returns
!   logz=log(x+y).   It avoids problems of dynamic
!   range when the exponentiated values of x or y
!   are very large or very small.
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: rlogx
   REAL(KIND=dp), INTENT(IN)                :: rlogy
!
   REAL(KIND=dp)  :: rlogplus
!
   IF(rlogx > rlogy)THEN
      rlogplus=rlogx+LOG(1.0_dp+EXP(rlogy-rlogx))
   ELSE
      rlogplus=rlogy+LOG(1.0_dp+EXP(rlogx-rlogy))
   END IF
!
   RETURN
!
END FUNCTION rlogplus
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE rnkpop(n,arr,indx,irank)
!
!  Used by geneticELC to rank populations.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN OUT)            :: arr(n)
   INTEGER, INTENT(IN OUT)                  :: indx(n)
   INTEGER, INTENT(OUT)                     :: irank(n)
!
   INTEGER :: i
!
   CALL indexx(n,arr,indx)
!
   DO  i=1,n
      irank(indx(i))=n-i+1
   END DO
   RETURN
!
END SUBROUTINE rnkpop
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE sampleellipsoid(nvar,centroid,cholc,pnts,idum)
!
!   samples points uniformly from the bounding ellipsoid
!
   USE accur
   USE ran_lec
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvar
   REAL(KIND=dp), INTENT(IN)                :: centroid(100)
   REAL(KIND=dp), INTENT(IN)                :: cholc(100,100)
   REAL(KIND=dp), INTENT(OUT)               :: pnts(100)
   INTEGER(KIND=8), INTENT(IN OUT)          :: idum
!
   REAL(KIND=dp)  :: ptonhs,rs,pdf,pnt,projfac
!
   INTEGER :: i,j,k,ntrip
!
   DIMENSION  ptonhs(100),pnt(100)
!
!  Find a random vector and compute its length.
!
   ntrip=0
99 projfac=0.0_dp
   ntrip=ntrip+1
   DO i=1,nvar
      pnt(i)=gasdev6(idum)
      projfac=projfac+pnt(i)*pnt(i)
   END DO
!
!   Project that point onto the unit hypersphere.
!
   DO i=1,nvar
      ptonhs(i)=pnt(i)/SQRT(projfac)
   END DO
!
!   Find a random radius on [0,1]
!
   rs=ran6(idum)
   pdf=rs**(1.0_dp/REAL(nvar,KIND=dp))
!
!   Scale the point to a uniform distribution within the
!   unit hypersphere.
!
   DO i=1,nvar
      pnt(i)=pdf*ptonhs(i)
   END DO
!
!   Scale and rotate to match the ellipsoid.
!
   DO j=1,nvar
      pnts(j)=0.0_dp
      DO k=1,nvar
         pnts(j)=pnts(j)+pnt(k)*cholc(k,j)
      END DO
   END DO
!
!   Check to see the point is in the unit hypercube.  If not,
!   then start over.
!
   DO i=1,nvar
      pnts(i)=pnts(i)+centroid(i)
      IF(ntrip < 50)THEN
         IF((pnts(i) < 0.0_dp).OR.(pnts(i) > 1.0_dp))GO TO 99
      ELSE
         IF(pnts(i) < 0.0_dp)pnts(i)=0.0_dp
         IF(pnts(i) > 1.0_dp)pnts(i)=1.0_dp
      END IF
   END DO
!
   RETURN
!
END SUBROUTINE sampleellipsoid
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE scale(n,y,yoff,off)
!
!   Will scale the y values by offset and return new array yoff.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: n
   REAL(KIND=dp), INTENT(IN)                :: y(n)
   REAL(KIND=dp), INTENT(OUT)               :: yoff(n)
   REAL(KIND=dp), INTENT(IN)                :: off
!
   INTEGER :: i
!
   DO  i=1,n
      yoff(i)=y(i)*off
   END DO
!
   RETURN
!
END SUBROUTINE scale
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE secpenalty(tseps,penaltyarr,sw84,chpensec,  &
   nmeclpse,ncycle)
!
!  Will check to see if the secondary is eclipsed,
!  and if so assess a penalty given by sw84.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmeclpse
   REAL(KIND=dp), INTENT(IN)                :: tseps(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: penaltyarr(3)
   REAL(KIND=dp), INTENT(IN)                :: sw84
   REAL(KIND=dp), INTENT(OUT)               :: chpensec
   INTEGER, INTENT(IN)                      :: ncycle(40)
!
   INTEGER :: i
!
   chpensec=0.0_dp
   penaltyarr(3)=0.0_dp
!
   DO i=1,ncycle(2)
      IF(tseps(2,i) < 1.0_dp)THEN
         penaltyarr(3)=sw84
         chpensec=sw84
      END IF
   END DO
!
   RETURN
!
END SUBROUTINE secpenalty
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE select(np,jfit,fdif,idad)
!
   USE accur
   USE medblock
   USE ran_lec
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: np
   INTEGER, INTENT(IN)                      :: jfit(np)
   REAL(KIND=dp), INTENT(IN)                :: fdif
   INTEGER, INTENT(OUT)                     :: idad
!
   REAL(KIND=dp)  :: urand,dice,rtfit
!
   INTEGER :: np1,i
!
!   COMMON /ranblock/ idum
!
   np1=np+1
   urand=ran6(idum)
   dice=urand*REAL(np*np1,KIND=dp)
   rtfit=0.0_dp
!
!!pgi$r opt O1
!
   DO  i=1,np
      rtfit=rtfit+REAL(np1,KIND=dp)+fdif*REAL(np1-2*jfit(i),KIND=dp)
      IF(rtfit >= dice)THEN
         idad=i
         EXIT
      END IF
   END DO
   RETURN
!
END SUBROUTINE select
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE setfold(nset,ndatamax,nrvarray,savxarray,savyarray,  &
   sverrarr,nbin,xdataarray,ydataarray,edataarr,period,  &
   t0,ikeep,ecc,argper,itime)
!
!   This routine will take data arrays in savex,savey,saverr
!   (time, mag, magerr), and fold them into the arrays
!   xdata,ydata,errdata.  The latter arrays are the ones normally
!   used in the optimization programs.
!
   USE accur
   USE getpie
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nset
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: nrvarray(5)
   REAL(KIND=dp), INTENT(IN)                :: savxarray(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: savyarray(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: sverrarr(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nbin
   REAL(KIND=dp), INTENT(OUT)               :: xdataarray(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: ydataarray(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: edataarr(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: t0
   INTEGER, INTENT(IN)                      :: ikeep
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: argper
   INTEGER, INTENT(IN)                      :: itime
!
   REAL(KIND=dp)  :: xdata,ydata,errdata,phper2,pshift,tshift,t1
   REAL(KIND=dp)  :: eshift,pconj,pconj2,argrad,trc,htrc,ecan,xmc,phper
!
   INTEGER :: ndata,i,iset
!
   DIMENSION  xdata(ndatamax),ydata(ndatamax),errdata(ndatamax)
!
!   CALL getpie(pie,twopie,halfpie,degtorad,radtodeg)
!
!   UPDATE JUNE 19, 2008
!
!   Figure out the conjunction phases if the orbit is eccentric.
!
   IF(itime == 2)THEN
      RETURN
   END IF
!
   eshift=0.0_dp
   pconj=pie
   pconj2=0.0_dp
   IF(ecc <= 1.0E-07_dp)pconj=0.0_dp
!
   IF((ecc > 0.0_dp).AND.(ikeep > 0))THEN
      argrad=argper*degtorad
      trc=halfpie-argrad
      CALL checkangle(trc)
      htrc=0.5_dp*trc
      IF(ABS(halfpie-htrc) < 7.0E-06_dp)GO TO 10
      IF(ABS(1.50_dp*pie-htrc) < 7.0E-06_dp)GO TO 10
      ecan=2.0_dp*ATAN(SQRT((1.0_dp-ecc)/(1.0_dp+ecc))*TAN(htrc))
      GO TO 20
10    ecan=pie
20    xmc=ecan-ecc*SIN(ecan)
      IF(xmc < 0.0_dp)xmc=xmc+twopie
      phper=1.0_dp-xmc/(twopie)
      pconj=(xmc+argrad)/(twopie)-0.25_dp
!
!   Make sure the conjunction phase is between 0 and 1
!
      IF(pconj > 1.0_dp)pconj=pconj-1.0_dp
!
      trc=halfpie-argrad+pie
      CALL checkangle(trc)
      htrc=0.5_dp*trc
      IF(ABS(halfpie-htrc) < 7.0E-06_dp)GO TO 30
      IF(ABS(1.50_dp*pie-htrc) < 7.0E-06_dp)GO TO 30
      ecan=2.0_dp*ATAN(SQRT((1.0_dp-ecc)/(1.0_dp+ecc))*TAN(htrc))
      GO TO 40
30    ecan=pie
40    xmc=ecan-ecc*SIN(ecan)
      IF(xmc < 0.0_dp)xmc=xmc+twopie
      phper2=1.0_dp-xmc/(twopie)
      pconj2=(xmc+argrad)/(twopie)-0.25_dp
!
!   UPDATE March 14, 2008
!
!   Make sure the conjunction phase is between 0 and 1
!
      IF(pconj2 > 1.0_dp)pconj2=pconj2-1.0_dp
      IF(ikeep == 1)eshift=phper+pconj-0.5_dp
      IF(ikeep == 2)eshift=phper2+pconj2
   END IF

!   Here is the case where no binning is requested.
!
   pshift=0.0_dp
   tshift=0.0_dp
   IF(ikeep == 1)tshift=pshift+eshift-pconj
   IF(ikeep == 2)tshift=pshift+eshift-pconj2

   IF(nbin == 0)THEN
      DO iset=1,nset
         DO  i=1,nrvarray(iset)
            t1=(savxarray(i,iset)-t0)/period+tshift
            xdataarray(i,iset)=MOD(t1,1.0_dp)
            ydataarray(i,iset)=savyarray(i,iset)
            edataarr(i,iset)=sverrarr(i,iset)
         END DO
!
!            Ndata=isavN
!
         DO  i=1,nrvarray(iset)
            IF(xdataarray(i,iset) < 0.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)+1.0_dp
            IF(xdataarray(i,iset) > 1.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)-1.0_dp
            IF(xdataarray(i,iset) < 0.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)+1.0_dp
            IF(xdataarray(i,iset) > 1.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)-1.0_dp
            IF(xdataarray(i,iset) < 0.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)+1.0_dp
            IF(xdataarray(i,iset) > 1.0_dp)xdataarray(i,iset)=  &
               xdataarray(i,iset)-1.0_dp
         END DO
      END DO
!
!   Sort the data by phase.
!   Put an if-then clause to cover the case when Ndata=1
!
      DO iset=1,nset
         DO i=1,nrvarray(iset)
            xdata(i)=xdataarray(i,iset)
            ydata(i)=ydataarray(i,iset)
            errdata(i)=edataarr(i,iset)
         END DO
         ndata=nrvarray(iset)
         IF(ndata > 1)CALL sort3(ndata,xdata,ydata,errdata)
         DO i=1,nrvarray(iset)
            xdataarray(i,iset)=xdata(i)
            ydataarray(i,iset)=ydata(i)
            edataarr(i,iset)=errdata(i)
         END DO
      END DO
!
!   We are done, so leave.
!
      RETURN
   END IF
!
   RETURN
!
END SUBROUTINE setfold
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE setupdata(ichecklim,it2,isw31,gaplow,gaphigh,nsc,  &
   xsc,ysc,itime,isw7,rmed,sw6,idraw,ifixgamma,isw4,gamma1,  &
   gamma,teff2,rinner,fill2,isw9save,isw9,montemax,xsob,  &
   arrsobx,arrsoby,nvmax,nvar,nstep,var,svar,sss,isw28,finc,  &
   period,ecc,argper,t0,tconj,nobv,nrv3,udatafile,bdatafile,  &
   vdatafile,rdatafile,idatafile,jdatafile,hdatafile,kdatafile,  &
   rv1file,rv2file,vstart,vstep,sobv,obv,eobv,ifrac,ilum,iidint,  &
   ilaw,ilimbcheck,stepsave,icnu,icnb,icnv,icnr,icni,icnj,icnh,  &
   icnk,icnrv1,icnrv2,ndatamax,ndatau,xdatau,ydatau,erru,ndatab,  &
   xdatab,ydatab,errb,ndatav,xdatav,ydatav,errv,ndatar,xdatar,  &
   ydatar,errr,ndatai,xdatai,ydatai,erri,ndataj,xdataj,ydataj,  &
   errj,ndatah,xdatah,ydatah,errh,ndatak,xdatak,ydatak,errk,  &
   nrv1,xrv1,yrv1,erv1,nrv2,xrv2,yrv2,erv2,isavnu,svxdatau,  &
   svydatau,svrru,isavnb,svxdatab,svydatab,svrrb,isavnv,  &
   svxdatav,svydatav,svrrv,isavnr,svxdatar,svydatar,  &
   svrrr,isavni,svxdatai,svydatai,svrri,isavnj,svxdataj,  &
   svydataj,svrrj,isavnh,svxdatah,svydatah,svrrh,isavnk,  &
   svxdatak,svydatak,svrrk,isavrv1,svxrv1,svyrv1,  &
   svrv1,isavrv2,svxrv2,svyrv2,svrv2,icnrv3,icnrv4,  &
   icnarry,isw30,isw23,nobscycle,obsttimes,obsterr,xrv3,yrv3,  &
   erv3,nmeclpse,nrv4,xrv4,yrv4,erv4,isw88,isw89,  &
   ndynwin,dynwinlow,dynwinhigh,tstart,tend,hh,tstep,rv3file,  &
   rv4file,rv5file,nset,nrv1arry,icnrv1arry,xrv1arry,  &
   yrv1arry,erv1arry,nrv2arry,icnrv2arry,xrv2arry,  &
   yrv2arry,erv2arry,nrv3arry,icnrv3arry,xrv3arry,  &
   yrv3arry,erv3arry,nrv4arry,icnrv4arry,xrv4arry,  &
   yrv4arry,erv4arry,nrv5arry,icnrv5arry,xrv5arry,  &
   yrv5arry,erv5arry,svxrv1arry,svyrv1arry,  &
   svrv1arry,svxrv2arry,svyrv2arry,svrv2arry,  &
   svxrv3arry,svyrv3arry,svrv3arry,svxrv4arry,  &
   svyrv4arry,svrv4arry,svxrv5arry,svyrv5arry,  &
   svrv5arry)
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ichecklim
   INTEGER, INTENT(OUT)                     :: it2
   INTEGER, INTENT(IN OUT)                  :: isw31
   REAL(KIND=dp), INTENT(OUT)               :: gaplow(9999)
   REAL(KIND=dp), INTENT(OUT)               :: gaphigh(9999)
   INTEGER, INTENT(OUT)                     :: nsc
   REAL(KIND=dp), INTENT(OUT)               :: xsc(9999)
   REAL(KIND=dp), INTENT(OUT)               :: ysc(9999)
   INTEGER, INTENT(OUT)                     :: itime
   INTEGER, INTENT(IN)                      :: isw7
   REAL(KIND=dp), INTENT(OUT)               :: rmed
   REAL(KIND=dp), INTENT(IN)                :: sw6
   INTEGER, INTENT(OUT)                     :: idraw
   INTEGER, INTENT(OUT)                     :: ifixgamma
   INTEGER, INTENT(IN)                      :: isw4
   REAL(KIND=dp), INTENT(OUT)               :: gamma1
   REAL(KIND=dp), INTENT(IN)                :: gamma
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN OUT)            :: rinner
   REAL(KIND=dp), INTENT(IN)                :: fill2
   INTEGER, INTENT(OUT)                     :: isw9save
   INTEGER, INTENT(IN)                      :: isw9
   INTEGER, INTENT(IN)                      :: montemax
   REAL(KIND=dp), INTENT(IN OUT)            :: xsob(2)
   REAL(KIND=dp), INTENT(OUT)               :: arrsobx(montemax)
   REAL(KIND=dp), INTENT(OUT)               :: arrsoby(montemax)
   INTEGER, INTENT(IN)                      :: nvmax
   INTEGER, INTENT(OUT)                     :: nvar
   INTEGER, INTENT(OUT)                     :: nstep(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: var(nvmax)
   CHARACTER (LEN=40), INTENT(OUT)          :: svar(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: sss(nvmax)
   INTEGER, INTENT(IN)                      :: isw28
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: argper
   REAL(KIND=dp), INTENT(IN OUT)            :: t0
   REAL(KIND=dp), INTENT(IN OUT)            :: tconj
   INTEGER, INTENT(OUT)                     :: nobv
   INTEGER, INTENT(OUT)                     :: nrv3
   CHARACTER (LEN=40), INTENT(OUT)          :: udatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: bdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: vdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: rdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: idatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: jdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: hdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: kdatafile
   CHARACTER (LEN=40), INTENT(OUT)          :: rv1file
   CHARACTER (LEN=40), INTENT(OUT)          :: rv2file
   REAL(KIND=dp), INTENT(OUT)               :: vstart(nvmax)
   REAL(KIND=dp), INTENT(OUT)               :: vstep(nvmax)
   CHARACTER (LEN=40), INTENT(OUT)          :: sobv(19)
   REAL(KIND=dp), INTENT(OUT)               :: obv(19)
   REAL(KIND=dp), INTENT(OUT)               :: eobv(19)
   INTEGER, INTENT(OUT)                     :: ifrac
   INTEGER, INTENT(OUT)                     :: ilum
   INTEGER, INTENT(IN)                      :: iidint
   INTEGER, INTENT(IN)                      :: ilaw
   INTEGER, INTENT(OUT)                     :: ilimbcheck
   REAL(KIND=dp), INTENT(OUT)               :: stepsave(nvmax)
   INTEGER, INTENT(OUT)                     :: icnu
   INTEGER, INTENT(OUT)                     :: icnb
   INTEGER, INTENT(OUT)                     :: icnv
   INTEGER, INTENT(OUT)                     :: icnr
   INTEGER, INTENT(OUT)                     :: icni
   INTEGER, INTENT(OUT)                     :: icnj
   INTEGER, INTENT(OUT)                     :: icnh
   INTEGER, INTENT(OUT)                     :: icnk
   INTEGER, INTENT(OUT)                     :: icnrv1
   INTEGER, INTENT(OUT)                     :: icnrv2
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(OUT)                     :: ndatau
   REAL(KIND=dp), INTENT(OUT)               :: xdatau(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatau(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erru(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatab
   REAL(KIND=dp), INTENT(OUT)               :: xdatab(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatab(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errb(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatav
   REAL(KIND=dp), INTENT(OUT)               :: xdatav(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatav(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errv(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatar
   REAL(KIND=dp), INTENT(OUT)               :: xdatar(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatar(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errr(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatai
   REAL(KIND=dp), INTENT(OUT)               :: xdatai(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatai(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erri(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndataj
   REAL(KIND=dp), INTENT(OUT)               :: xdataj(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydataj(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errj(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatah
   REAL(KIND=dp), INTENT(OUT)               :: xdatah(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatah(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errh(ndatamax)
   INTEGER, INTENT(OUT)                     :: ndatak
   REAL(KIND=dp), INTENT(OUT)               :: xdatak(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: ydatak(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: errk(ndatamax)
   INTEGER, INTENT(OUT)                     :: nrv1
   REAL(KIND=dp), INTENT(OUT)               :: xrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erv1(ndatamax)
   INTEGER, INTENT(OUT)                     :: nrv2
   REAL(KIND=dp), INTENT(OUT)               :: xrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erv2(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnu
   REAL(KIND=dp), INTENT(OUT)               :: svxdatau(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatau(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrru(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnb
   REAL(KIND=dp), INTENT(OUT)               :: svxdatab(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatab(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrb(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnv
   REAL(KIND=dp), INTENT(OUT)               :: svxdatav(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatav(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrv(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnr
   REAL(KIND=dp), INTENT(OUT)               :: svxdatar(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatar(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrr(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavni
   REAL(KIND=dp), INTENT(OUT)               :: svxdatai(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatai(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrri(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnj
   REAL(KIND=dp), INTENT(OUT)               :: svxdataj(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydataj(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrj(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnh
   REAL(KIND=dp), INTENT(OUT)               :: svxdatah(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatah(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrh(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavnk
   REAL(KIND=dp), INTENT(OUT)               :: svxdatak(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svydatak(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrrk(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavrv1
   REAL(KIND=dp), INTENT(OUT)               :: svxrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv1(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrv1(ndatamax)
   INTEGER, INTENT(OUT)                     :: isavrv2
   REAL(KIND=dp), INTENT(OUT)               :: svxrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv2(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: svrv2(ndatamax)
   INTEGER, INTENT(OUT)                     :: icnrv3
   INTEGER, INTENT(OUT)                     :: icnrv4
   INTEGER, INTENT(OUT)                     :: icnarry(40)
   INTEGER, INTENT(IN)                      :: isw30
   INTEGER, INTENT(IN)                      :: isw23
   INTEGER, INTENT(OUT)                     :: nobscycle(40)
   INTEGER, INTENT(IN)                      :: nmeclpse
   REAL(KIND=dp), INTENT(OUT)               :: obsttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: obsterr(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: xrv3(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv3(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erv3(ndatamax)
   INTEGER, INTENT(OUT)                     :: nrv4
   REAL(KIND=dp), INTENT(OUT)               :: xrv4(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: yrv4(ndatamax)
   REAL(KIND=dp), INTENT(OUT)               :: erv4(ndatamax)
   INTEGER, INTENT(IN)                      :: isw88
   INTEGER, INTENT(IN)                      :: isw89
   INTEGER, INTENT(OUT)                     :: ndynwin
   REAL(KIND=dp), INTENT(OUT)               :: dynwinlow(1000)
   REAL(KIND=dp), INTENT(OUT)               :: dynwinhigh(1000)
   REAL(KIND=dp), INTENT(IN)                :: tstart
   REAL(KIND=dp), INTENT(IN OUT)            :: tend
   REAL(KIND=dp), INTENT(IN)                :: hh
   REAL(KIND=dp), INTENT(IN)                :: tstep
   CHARACTER (LEN=40), INTENT(OUT)          :: rv3file
   CHARACTER (LEN=40), INTENT(OUT)          :: rv4file
   CHARACTER (LEN=40), INTENT(OUT)          :: rv5file
   INTEGER, INTENT(OUT)                     :: nset
   INTEGER, INTENT(OUT)                     :: nrv1arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv1arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: erv1arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv2arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv2arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: erv2arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv3arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv3arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: erv3arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv4arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv4arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: erv4arry(ndatamax,5)
   INTEGER, INTENT(OUT)                     :: nrv5arry(5)
   INTEGER, INTENT(OUT)                     :: icnrv5arry(5)
   REAL(KIND=dp), INTENT(OUT)               :: xrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: yrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: erv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svxrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svyrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(OUT)               :: svrv5arry(ndatamax,5)
!
   INTEGER :: i,icn,icnvrt,j,kk,mmm,icnrv5,ngap,icount
!
   sobv(1)='none'
   sobv(2)='none'
   sobv(3)='none'
   sobv(4)='none'
   sobv(5)='none'
   sobv(6)='none'
   sobv(7)='none'
   sobv(8)='none'
   sobv(9)='none'
   sobv(10)='none'
   sobv(11)='none'
   sobv(12)='none'
   sobv(12)='none'
   sobv(13)='none'
   sobv(14)='none'
   sobv(15)='none'
   sobv(16)='none'
   sobv(17)='none'
   sobv(18)='none'
   sobv(19)='none'
   it2=0
   icount=0
!
!   if isw31 >= 1, load the gap parameters
!
   DO i=1,999
      gaplow(i)=0.0_dp
      gaphigh(i)=0.0_dp
   END DO
   ngap=isw31
   IF(isw31 >= 1)CALL getgap(isw31,gaplow,gaphigh)
!
   nsc=isw89
   CALL getsc(nsc,xsc,ysc)
!
!  tstart=sw23 and tend=sw24 in main calling program
!
   ndynwin=isw88
   CALL getwin(ndynwin,dynwinlow,dynwinhigh,tstart,tend,hh)
!
   CALL checkgap(ndynwin,dynwinlow,dynwinhigh,isw31,gaplow,  &
      gaphigh,tstart,tend,tstep)
!
!   Use these flags when fitting for the period and/or T0
!
   itime=isw7
!
!   if sw6 > 1.0, then use median fitting
!
   rmed=sw6
!
!   Disable the draw option
!
   idraw=0
!
!   Do we force the gamma to be the input value?
!
   ifixgamma=isw4
!
   gamma1=gamma
!
!   Fix the inner disk radius at fill2.
!
   IF((teff2 > 0.0_dp).AND.(iidint >= 1))rinner=fill2
!
!   If the flag isw9 (=ielite) is more than 0, insert the parameters
!   set in the ELC.inp file into the population.
!
   isw9save=isw9
!
!   Initialize the Sobel sequence here.
!
   mmm=-11
   CALL sobseq(mmm,xsob)
   DO i=1,montemax
      CALL sobseq(2,xsob)
      arrsobx(i)=xsob(1)
      arrsoby(i)=xsob(2)
   END DO
!
!   Initialize the steps.
!
   DO i=1,nvmax
      nstep(i)=1
      var(i)=0.0_dp
      svar(i)='none'
      sss(i)=0.0_dp
   END DO
!
!   If isw28 is greater than 0, then set the value of T0 based
!   on the time of transit Tconj.
!
   IF(isw28 > 0)THEN
      CALL gett0(finc,period,ecc,argper,t0,tconj)
   END IF
!
   CALL initndata(ndatau,ndatab,ndatav,ndatar,ndatai,ndataj,  &
      ndatah,ndatak,nrv1,nrv2,nobv,nrv3,nrv4)
!
!   Get the parameters for the grid search.
!
   CALL getloopopt(udatafile,bdatafile,vdatafile,rdatafile,  &
      idatafile,jdatafile,hdatafile,kdatafile,rv1file,rv2file,  &
      nvmax,nvar,svar,var,vstart,vstep,nstep,nobv,sobv,obv,eobv,  &
      rv3file,rv4file,rv5file)
!
!   Check for unknown tags
!
   CALL checktags(nvmax,svar,sobv)
!
!   Check to see that the lower bound is less than the upper bound
!
   IF(ichecklim >= 1)THEN
      DO  i=1,nvar
         IF(vstart(i) >= vstep(i))THEN
            WRITE(*,30)i,svar(i)
            WRITE(*,40)vstart(i),vstep(i)
            STOP
         END IF
      END DO
   END IF
!
!   Here is a new block to allow for the inclusion of the disk fraction
!   in the total chi^2.  Add also the ability to include the luminosity
!   ratio in the total chi^2
!
   ifrac=-99
   ilum=-99
   DO  i=1,nobv
      icn=icnvrt(sobv(i)(1:2))
      IF((icn == 104).AND.(iidint >= 1))ifrac=99
      IF((icn == 1112).AND.(iidint >= 1))ifrac=99
      IF((icn == 1113).AND.(iidint >= 1))ifrac=99
      IF((icn == 1114).AND.(iidint >= 1))ifrac=99
      IF((icn == 1115).AND.(iidint >= 1))ifrac=99
      IF((icn == 1116).AND.(iidint >= 1))ifrac=99
      IF((icn == 1117).AND.(iidint >= 1))ifrac=99
      IF((icn == 1118).AND.(iidint >= 1))ifrac=99
      IF((icn == 1119).AND.(iidint >= 1))ifrac=99
!
!   add strings z1 to z8 (upper limits)
!
      IF((icn == 1816).AND.(iidint >= 1))ifrac=99
      IF((icn == 1817).AND.(iidint >= 1))ifrac=99
      IF((icn == 1818).AND.(iidint >= 1))ifrac=99
      IF((icn == 1819).AND.(iidint >= 1))ifrac=99
      IF((icn == 1820).AND.(iidint >= 1))ifrac=99
      IF((icn == 1821).AND.(iidint >= 1))ifrac=99
      IF((icn == 1822).AND.(iidint >= 1))ifrac=99
      IF((icn == 1823).AND.(iidint >= 1))ifrac=99
!
!  include luminosity ratios?
!
      IF((icn == 369))ilum=99   !tag lr
      IF((icn == 1370))ilum=99  !tag l3
      IF((icn == 1371))ilum=99  !tag l4
!
!  star 2 to star 1 luminosity ratios by filter
!
      IF(icn == 4529)ilum=999
      IF(icn == 4561)ilum=999
      IF(icn == 4593)ilum=999
      IF(icn == 4625)ilum=999
      IF(icn == 4657)ilum=999
      IF(icn == 4689)ilum=999
      IF(icn == 4721)ilum=999
      IF(icn == 4753)ilum=999
   END DO
!
   ilimbcheck=-55
   DO j=1,nvar
      stepsave(j)=vstep(j)
      kk=icnvrt(svar(j)(1:2))
      IF(kk >= 1752.AND.kk <= 1759)ilimbcheck=99
      IF(kk >= 1784.AND.kk <= 1791)ilimbcheck=99
      IF(kk >= 1816.AND.kk <= 1823)ilimbcheck=99
      IF(kk >= 1720.AND.kk <= 1727)ilimbcheck=99
   END DO
!
   IF(ilaw /= 4)ilimbcheck=-99
!
!   Figure out which data files were specified.
!
   icnu=icnvrt(udatafile(1:2))
   icnb=icnvrt(bdatafile(1:2))
   icnv=icnvrt(vdatafile(1:2))
   icnr=icnvrt(rdatafile(1:2))
   icni=icnvrt(idatafile(1:2))
   icnj=icnvrt(jdatafile(1:2))
   icnh=icnvrt(hdatafile(1:2))
   icnk=icnvrt(kdatafile(1:2))
   icnrv1=icnvrt(rv1file(1:2))
   icnrv2=icnvrt(rv2file(1:2))
   icnrv3=icnvrt(rv3file(1:2))
   icnrv4=icnvrt(rv4file(1:2))
   icnrv5=icnvrt(rv5file(1:2))
!
!   icn? = 430 indicates that no file was specified.  Load the
!   files listed.
!
   IF(icnu /= 430)CALL loaddata(ndatamax,udatafile,ndatau,xdatau,ydatau,erru)
   IF(icnb /= 430)CALL loaddata(ndatamax,bdatafile,ndatab,xdatab,ydatab,errb)
   IF(icnv /= 430)CALL loaddata(ndatamax,vdatafile,ndatav,xdatav,ydatav,errv)
   IF(icnr /= 430)CALL loaddata(ndatamax,rdatafile,ndatar,xdatar,ydatar,errr)
   IF(icni /= 430)CALL loaddata(ndatamax,idatafile,ndatai,xdatai,ydatai,erri)
   IF(icnj /= 430)CALL loaddata(ndatamax,jdatafile,ndataj,xdataj,ydataj,errj)
   IF(icnh /= 430)CALL loaddata(ndatamax,hdatafile,ndatah,xdatah,ydatah,errh)
   IF(icnk /= 430)CALL loaddata(ndatamax,kdatafile,ndatak,xdatak,ydatak,errk)
!
!   Check to see if any of the data times are in gaps when itime=2
!
   IF((itime >= 2).AND.(ngap >= 1))THEN
      IF(icnu /= 430)THEN
         DO i=1,ndatau
            DO j=1,ngap
               IF((xdatau(i) >= gaplow(j)).AND.(xdatau(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(1,xdatau(i),udatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnb /= 430)THEN
         DO i=1,ndatab
            DO j=1,ngap
               IF((xdatab(i) >= gaplow(j)).AND.(xdatab(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(2,xdatab(i),bdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnv /= 430)THEN
         DO i=1,ndatav
            DO j=1,ngap
               IF((xdatav(i) >= gaplow(j)).AND.(xdatav(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(3,xdatav(i),vdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnr /= 430)THEN
         DO i=1,ndatar
            DO j=1,ngap
               IF((xdatar(i) >= gaplow(j)).AND.(xdatar(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(4,xdatar(i),rdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icni /= 430)THEN
         DO i=1,ndatai
            DO j=1,ngap
               IF((xdatai(i) >= gaplow(j)).AND.(xdatai(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(5,xdatai(i),idatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnj /= 430)THEN
         DO i=1,ndataj
            DO j=1,ngap
               IF((xdataj(i) >= gaplow(j)).AND.(xdataj(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(6,xdataj(i),jdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnh /= 430)THEN
         DO i=1,ndatah
            DO j=1,ngap
               IF((xdatah(i) >= gaplow(j)).AND.(xdatah(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(7,xdatah(i),hdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
      IF(icnk /= 430)THEN
         DO i=1,ndatak
            DO j=1,ngap
               IF((xdatak(i) >= gaplow(j)).AND.(xdatak(i) <= gaphigh(j)))THEN
                  icount=icount+1
                  CALL gaperrorlc(8,xdatak(i),kdatafile,i,j)
               END IF
            END DO
         END DO
      END IF
!
   END IF
!
!   Stop if light curve data are in the gaps
!
   IF(icount > 0)STOP
!
!   If ifixgamma is 11 or 12, then we have multiple RV data sets.
!   Call the special subroutine to load those data.
!
   nset=0
   icount=0
   IF(ifixgamma < 10)THEN
      IF(icnrv1 /= 430)CALL loaddata(ndatamax,rv1file,nrv1,xrv1,yrv1,erv1)
      IF(icnrv2 /= 430)CALL loaddata(ndatamax,rv2file,nrv2,xrv2,yrv2,erv2)
      IF(icnrv3 /= 430)CALL loaddata(ndatamax,rv3file,nrv3,xrv3,yrv3,erv3)
      IF(icnrv4 /= 430)CALL loaddata(ndatamax,rv4file,nrv4,xrv4,yrv4,erv4)
!
      IF((itime >= 2).AND.(ngap >= 1))THEN
         IF(icnrv1 /= 430)THEN
            DO i=1,nrv1
               DO j=1,ngap
                  IF((xrv1(i) >= gaplow(j)).AND.(xrv1(i) <= gaphigh(j)))THEN
                     icount=icount+1
                     CALL gaperrorrv(1,xrv1(i),rv1file,i,j)
                  END IF
               END DO
            END DO
         END IF
!
         IF(icnrv2 /= 430)THEN
            DO i=1,nrv2
               DO j=1,ngap
                  IF((xrv2(i) >= gaplow(j)).AND.(xrv2(i) <= gaphigh(j)))THEN
                     icount=icount+1
                     CALL gaperrorrv(2,xrv2(i),rv2file,i,j)
                  END IF
               END DO
            END DO
         END IF
!
         IF(icnrv3 /= 430)THEN
            DO i=1,nrv3
               DO j=1,ngap
                  IF((xrv3(i) >= gaplow(j)).AND.(xrv3(i) <= gaphigh(j)))THEN
                     icount=icount+1
                     CALL gaperrorrv(3,xrv3(i),rv3file,i,j)
                  END IF
               END DO
            END DO
         END IF
!
         IF(icnrv4 /= 430)THEN
            DO i=1,nrv4
               DO j=1,ngap
                  IF((xrv4(i) >= gaplow(j)).AND.(xrv4(i) <= gaphigh(j)))THEN
                     icount=icount+1
                     CALL gaperrorrv(4,xrv4(i),rv4file,i,j)
                  END IF
               END DO
            END DO
         END IF
!
      END IF
   ELSE
      CALL loadrvdata(nset,nrv1arry,icnrv1arry,xrv1arry,  &
         yrv1arry,erv1arry,nrv2arry,icnrv2arry,xrv2arry,  &
         yrv2arry,erv2arry,nrv3arry,icnrv3arry,xrv3arry,  &
         yrv3arry,erv3arry,nrv4arry,icnrv4arry,xrv4arry,  &
         yrv4arry,erv4arry,nrv5arry,icnrv5arry,xrv5arry,  &
         yrv5arry,erv5arry,ndatamax,svxrv1arry,svyrv1arry, &
         svrv1arry,svxrv2arry,svyrv2arry,svrv2arry,svxrv3arry, & 
         svyrv3arry,svrv3arry,svxrv4arry,svyrv4arry,svrv4arry, &
         svxrv5arry,svyrv5arry,svrv5arry,itime,ngap,gaplow, &
         gaphigh,icount)
   END IF 
!
!   Stop if RV data appear in the gaps.
!
   IF(icount > 0)STOP
!
!   If we are fitting for the period and/or T0, we have to make
!   copies of the arrys.
!
   IF(icnu /= 430)CALL kopydata(ndatamax,ndatau,xdatau,ydatau,  &
      erru,isavnu,svxdatau,svydatau,svrru)
   IF(icnb /= 430)CALL kopydata(ndatamax,ndatab,xdatab,ydatab,  &
      errb,isavnb,svxdatab,svydatab,svrrb)
   IF(icnv /= 430)CALL kopydata(ndatamax,ndatav,xdatav,ydatav,  &
      errv,isavnv,svxdatav,svydatav,svrrv)
   IF(icni /= 430)CALL kopydata(ndatamax,ndatai,xdatai,ydatai,  &
      erri,isavni,svxdatai,svydatai,svrri)
   IF(icnj /= 430)CALL kopydata(ndatamax,ndataj,xdataj,ydataj,  &
      errj,isavnj,svxdataj,svydataj,svrrj)
   IF(icnh /= 430)CALL kopydata(ndatamax,ndatah,xdatah,ydatah,  &
      errh,isavnh,svxdatah,svydatah,svrrh)
   IF(icnk /= 430)CALL kopydata(ndatamax,ndatak,xdatak,ydatak,  &
      errk,isavnk,svxdatak,svydatak,svrrk)
   IF(icnr /= 430)CALL kopydata(ndatamax,ndatar,xdatar,ydatar,  &
      errr,isavnr,svxdatar,svydatar,svrrr)
!
!   Skip this part if ifixgamma is 11 or 12
!
   IF(ifixgamma < 10)THEN
      IF(icnrv1 /= 430)CALL kopydata(ndatamax,nrv1,xrv1,yrv1,  &
         erv1,isavrv1,svxrv1,svyrv1,svrv1)
      IF(icnrv2 /= 430)CALL kopydata(ndatamax,nrv2,xrv2,yrv2,  &
         erv2,isavrv2,svxrv2,svyrv2,svrv2)
   END IF
!
!   Sort the data files by phase just to be on the safe side.
!
!   Put an if-then clause to cover the case when Ndata=1
!
   IF((icnu /= 430).AND.(ndatau > 1))CALL sort3(ndatau,xdatau,ydatau,erru)
   IF((icnb /= 430).AND.(ndatab > 1))CALL sort3(ndatab,xdatab,ydatab,errb)
   IF((icnv /= 430).AND.(ndatav > 1))CALL sort3(ndatav,xdatav,ydatav,errv)
   IF((icnr /= 430).AND.(ndatar > 1))CALL sort3(ndatar,xdatar,ydatar,errr)
   IF((icni /= 430).AND.(ndatai > 1))CALL sort3(ndatai,xdatai,ydatai,erri)
   IF((icnj /= 430).AND.(ndataj > 1))CALL sort3(ndataj,xdataj,ydataj,errj)
   IF((icnh /= 430).AND.(ndatah > 1))CALL sort3(ndatah,xdatah,ydatah,errh)
   IF((icnk /= 430).AND.(ndatak > 1))CALL sort3(ndatak,xdatak,ydatak,errk)
!
!   If ifixgamma is 11 or 12 then skip this part
!
   IF(ifixgamma < 10)THEN
      IF((icnrv1 /= 430).AND.(nrv1 > 1))CALL sort3(nrv1,xrv1,yrv1,erv1)
      IF((icnrv2 /= 430).AND.(nrv2 > 1))CALL sort3(nrv2,xrv2,yrv2,erv2)
   END IF
!
!  If we are fitting eclipse times ((isw30.ge.3).and.(isw23.eq.1))
!  then load the data
!
!          icnRV3=430
!          icnRV4=430
!
!   Initialize the icnarry to 430 values (no eclipse times to be fit).
!
   DO i=1,40
      icnarry(i)=430
   END DO
!
!          NRV3=0
!          NRV4=0
   IF((isw30 >= 3).AND.(isw23 >= 1))THEN
      CALL loadtimes(icnarry,nobscycle,obsttimes,obsterr,nmeclpse)
   END IF
!
30 FORMAT('error on variable ',i2,' (',a2,'):  lower bound is no'  &
      ,'t less ','than the upper bound')
40 FORMAT(24X,2(f16.9,2X))
!
   RETURN
!
END SUBROUTINE setupdata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE timechi(icnarray,ncycle,ttimes,tseps,nobscycle,  &
   obsttimes,obsterr,chitmarr,chitimetot,nmeclpse,it3,  &
   resttimes)
!
!  Will compute the chi^2 contributions from the eclipse
!  times.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmeclpse
   INTEGER, INTENT(IN)                      :: icnarray(40)
   INTEGER, INTENT(IN)                      :: ncycle(40)
   REAL(KIND=dp), INTENT(IN)                :: ttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(IN)                :: tseps(40,nmeclpse)
   INTEGER, INTENT(IN)                      :: nobscycle(40)
   REAL(KIND=dp), INTENT(IN)                :: obsttimes(40,nmeclpse)
   REAL(KIND=dp), INTENT(IN)                :: obsterr(40,nmeclpse)
   REAL(KIND=dp), INTENT(OUT)               :: chitmarr(40)
   REAL(KIND=dp), INTENT(OUT)               :: chitimetot
   INTEGER, INTENT(IN)                      :: it3
   REAL(KIND=dp), INTENT(OUT)               :: resttimes(40,nmeclpse)
!
   REAL(KIND=dp)  :: tempttimes,ssum,chismall,chisave,chi,temptseps
!
   INTEGER :: i,ngood,jcount,j,k,ksave
!
   DIMENSION tempttimes(9999),temptseps(9999)
!
   DO i=1,40
      chitmarr(i)=0.0_dp
      DO j=1,nmeclpse
         resttimes(i,j)=0.0_dp
      END DO
   END DO
   chitimetot=0.0_dp
   ksave=1
!
!   If it3 is equal to 1, put all body 3 events into
!   one array and do the chi^2.  It is assumed the observed
!   times are in position 3 of ELCeclipsetimes.opt
!
   IF((it3 == 1).AND.(icnarray(3) /= 430))THEN
      ngood=0
      jcount=0
      DO i=3,6
         IF(icnarray(3) /= 430)THEN
            DO j=1,ncycle(i)
               IF(tseps(i,j) <= 1.0_dp)THEN
                  ngood=ngood+1
                  jcount=jcount+1
                  tempttimes(jcount)=ttimes(i,j)
               END IF
            END DO
         END IF
      END DO
      IF(ngood == 0)THEN
         chitmarr(3)=1.0E+20_dp
         chitmarr(4)=1.0E+20_dp
         chitmarr(5)=1.0E+20_dp
         chitmarr(6)=1.0E+20_dp
         chitimetot=1.0E+20_dp
         RETURN
      END IF
!
      ssum=0.0_dp
      DO j=1,nobscycle(3)
         chismall=1.0E+99_dp
         chisave=chismall
         DO k=1,jcount
            chi=(tempttimes(k)-obsttimes(3,j))/obsterr(3,j)
            chi=chi*chi
            IF(chi < chismall)THEN
               chismall=chi
               chisave=chi
               ksave=k
            END IF
         END DO
         resttimes(3,j)=obsttimes(3,j)-tempttimes(ksave)
         ssum=ssum+chisave
      END DO
      chitmarr(3)=ssum
   END IF
!
!  similar for body 4 events, put file in position 7
!
   IF((it3 == 1).AND.(icnarray(7) /= 430))THEN
      ngood=0
      jcount=0
      DO i=7,10
         IF(icnarray(7) /= 430)THEN
            DO j=1,ncycle(i)
               IF(tseps(i,j) <= 1.0_dp)THEN
                  ngood=ngood+1
                  jcount=jcount+1
                  tempttimes(jcount)=ttimes(i,j)
               END IF
            END DO
         END IF
      END DO
      IF(ngood == 0)THEN
         chitmarr(7)=1.0E+20_dp
         chitmarr(8)=1.0E+20_dp
         chitmarr(9)=1.0E+20_dp
         chitmarr(10)=1.0E+20_dp
         chitimetot=1.0E+20_dp
         RETURN
      END IF
!
      ssum=0.0_dp
      DO j=1,nobscycle(7)
         chismall=1.0E+99_dp
         chisave=chismall
         DO k=1,jcount
            chi=(tempttimes(k)-obsttimes(7,j))/obsterr(7,j)
            chi=chi*chi
            IF(chi < chismall)THEN
               chismall=chi
               chisave=chi
               ksave=k
            END IF
         END DO
         ssum=ssum+chisave
         resttimes(7,j)=obsttimes(7,j)-tempttimes(ksave)
      END DO
      chitmarr(7)=ssum
   END IF
!
!  if it3  is 2, then put body 3 and body 4 events together
!
   IF((it3 == 2).AND.(icnarray(3) /= 430))THEN
      ngood=0
      jcount=0
      DO i=3,10
         IF(icnarray(3) /= 430)THEN
            DO j=1,ncycle(i)
               IF(tseps(i,j) <= 100.0_dp)THEN
                  ngood=ngood+1
                  jcount=jcount+1
                  tempttimes(jcount)=ttimes(i,j)
                  temptseps(jcount)=tseps(i,j)
               END IF
            END DO
         END IF
      END DO
      IF(ngood == 0)THEN
         chitmarr(3)=1.0E+20_dp
         chitmarr(4)=1.0E+20_dp
         chitmarr(5)=1.0E+20_dp
         chitmarr(6)=1.0E+20_dp
         chitmarr(7)=1.0E+20_dp
         chitmarr(8)=1.0E+20_dp
         chitmarr(9)=1.0E+20_dp
         chitmarr(10)=1.0E+20_dp
         chitimetot=1.0E+20_dp
         RETURN
      END IF
!
      ssum=0.0_dp
      DO j=1,nobscycle(3)
         chismall=1.0E+99_dp
         chisave=chismall
         ksave=1
         DO k=1,jcount
            chi=(tempttimes(k)-obsttimes(3,j))/obsterr(3,j)
            chi=chi*chi
            IF(chi < chismall)THEN
               chismall=chi
               chisave=chi
               ksave=k
            END IF
         END DO
!              WRITE(*,40)tempTtimes(ksave),obsTtimes(3,j),obsTerr(3,j),
!     &         tempTseps(ksave)
         ssum=ssum+chisave
         resttimes(3,j)=obsttimes(3,j)-tempttimes(ksave)
      END DO
      chitmarr(3)=ssum
   END IF
!
!   Go through each data set and match measured eclipses with
!   model ones.
!
!   if it3=3, then consider events where the impact parameter
!   is larger than 1.  Give an additional penalty of impact**4
!
   DO  i=1,40
      IF(icnarray(i) /= 430)THEN
         ngood=0
         DO j=1,ncycle(i)
            IF(tseps(i,j) <= 100.0_dp)ngood=ngood+1
         END DO
         IF((ngood == 0).AND.(ncycle(i) > 0))THEN
            chitmarr(i)=1.0E+20_dp
            CYCLE
         END IF
         IF(ncycle(i) <= 0)THEN
            chitmarr(i)=1.0E+20_dp
            CYCLE
         END IF
         ssum=0.0_dp
         DO j=1,nobscycle(i)
            chismall=1.0E+99_dp
            chisave=chismall
            DO k=1,ncycle(i)
               IF(tseps(i,k) <= 100.0_dp)THEN
                  chi=(ttimes(i,k)-obsttimes(i,j))/obsterr(i,j)
                  chi=chi*chi
                  IF(tseps(i,k) > 1.0_dp)chi=chi+tseps(i,k)**4
                  IF(chi < chismall)THEN
                     chismall=chi
                     chisave=chi
                     ksave=k
                  END IF
               END IF
            END DO
            ssum=ssum+chisave
            resttimes(i,j)=obsttimes(i,j)-ttimes(i,ksave)
         END DO
         chitmarr(i)=ssum
      END IF
   END DO
!
   IF(it3 >= 3)GO TO 30
!
   DO  i=1,40
      IF((it3 > 0).AND.(i > 2))CYCLE
      IF(icnarray(i) /= 430)THEN
         ngood=0
         DO j=1,ncycle(i)
            IF(tseps(i,j) <= 1.0_dp)ngood=ngood+1
         END DO
         IF((ngood == 0).AND.(ncycle(i) > 0))THEN
            chitmarr(i)=1.0E+20_dp
            CYCLE
         END IF
         IF(ncycle(i) <= 0)THEN
            chitmarr(i)=1.0E+20_dp
            CYCLE
         END IF
         ssum=0.0_dp
         DO j=1,nobscycle(i)
            chismall=1.0E+99_dp
            chisave=chismall
            DO k=1,ncycle(i)
               IF(tseps(i,k) <= 1.0_dp)THEN
                  chi=(ttimes(i,k)-obsttimes(i,j))/obsterr(i,j)
                  chi=chi*chi
                  IF(chi < chismall)THEN
                     chismall=chi
                     chisave=chi
                     ksave=k
                  END IF
               END IF
            END DO
            ssum=ssum+chisave
            resttimes(i,j)=obsttimes(i,j)-ttimes(i,ksave)
         END DO
         chitmarr(i)=ssum
      END IF
   END DO
!
30 chitimetot=0.0_dp
   DO i=1,40
      chitimetot=chitimetot+chitmarr(i)
   END DO
!
!40        FORMAT(2(f10.5,2X),2(2X,f9.5))
!
   RETURN
!
END SUBROUTINE timechi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE tranpenalty(tseps,penaltyarr,sw84,chipenalty,  &
   nmaxeclipse,ncycle)
!
!  Will check to see if body 3 transits the primary and secondary,
!  and if so assess a penalty given by sw84.
!
   USE accur

   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmaxeclipse
   REAL(KIND=dp), INTENT(IN)                :: tseps(40,nmaxeclipse)
   REAL(KIND=dp), INTENT(OUT)               :: penaltyarr(3)
   REAL(KIND=dp), INTENT(IN)                :: sw84
   REAL(KIND=dp), INTENT(OUT)               :: chipenalty
   INTEGER, INTENT(IN)                      :: ncycle(40)
!
   INTEGER :: i
!
   chipenalty=0.0_dp
   penaltyarr(1)=0.0_dp
   penaltyarr(2)=0.0_dp
!
   DO i=1,ncycle(3)
      IF(tseps(3,i) < 1.0_dp)THEN
         penaltyarr(1)=sw84
         chipenalty=sw84
      END IF
   END DO
!
   DO i=1,ncycle(5)
      IF(tseps(5,i) < 0.0_dp)THEN
         penaltyarr(2)=sw84
         chipenalty=sw84
      END IF
   END DO
!
   RETURN
!
END SUBROUTINE tranpenalty
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE varassign(nvarmax,svar,var,fill1,fill2,omega1,  &
   omega2,q,finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,  &
   separ,gamma,t3,g3,sa3,ecc,argper,pshift,spot1parm,spot2parm,  &
   spotdparm,period,t0,alb1,alb2,dwavex,dwavey,primmass,primk,  &
   primrad,ratrad,frac1,frac2,ecosw,temprat,bigi,bigbeta,  &
   density,tconj,beam1,beam2,contam,ocose,osine,  &
   isw29,tertperiod,tertt0,tertecos,tertesin,tertincl,tertomega,  &
   tertq,tgrav1,tgrav2,tertconj,omegadot,contams0,contams1,  &
   contams2,contams3,p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,  &
   p2omega,p2q,p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,  &
   p3incl,p3omega,p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,  &
   p4esin,p4incl,p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,  &
   p5ecos,p5esin,p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,  &
   p6t0,p6ecos,p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,  &
   p7period,p7t0,p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,  &
   p8tconj,p8period,p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,  &
   p8ratrad,sw72,sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,  &
   sdarkint3,sdarkint4,sdarkint5,tertratrad,p1mtc,p1ptc,p2mtc,  &
   p2ptc,p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,  &
   p7ptc,p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,  &
   bigbeta3,bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
   b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
   omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
   raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
   sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
   t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,  &
   sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
   sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
   sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
   angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
   angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,fillsum,filldiff,binqtc,p1qtc,p2qtc,p3qtc,  &
   p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,t3off,  &
   t4off,t5off,t6off,t7off,t8off,tesscontam)
!
!   August 13, 2001
!
!   This is a new subroutine, which is the inverse of assignvar.  That it,
!   the routine has values for the parameters (fill1, fill2, omega1, ...)
!   and it will assign them to the var string based on the variables
!   selected in gridloop.opt file.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvarmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvarmax)
   REAL(KIND=dp), INTENT(OUT)               :: var(nvarmax)
   REAL(KIND=dp), INTENT(IN)                :: fill1
   REAL(KIND=dp), INTENT(IN)                :: fill2
   REAL(KIND=dp), INTENT(IN)                :: omega1
   REAL(KIND=dp), INTENT(IN)                :: omega2
   REAL(KIND=dp), INTENT(IN)                :: q
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: teff1
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN)                :: betarim
   REAL(KIND=dp), INTENT(IN)                :: rinner
   REAL(KIND=dp), INTENT(IN)                :: router
   REAL(KIND=dp), INTENT(IN)                :: tdisk
   REAL(KIND=dp), INTENT(IN)                :: xi
   REAL(KIND=dp), INTENT(IN)                :: rlx
   REAL(KIND=dp), INTENT(IN)                :: separ
   REAL(KIND=dp), INTENT(IN)                :: gamma
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: sa3
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: argper
   REAL(KIND=dp), INTENT(IN)                :: pshift
   REAL(KIND=dp), INTENT(IN)                :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: t0
   REAL(KIND=dp), INTENT(IN)                :: alb1
   REAL(KIND=dp), INTENT(IN)                :: alb2
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN)                :: primmass
   REAL(KIND=dp), INTENT(IN)                :: primk
   REAL(KIND=dp), INTENT(IN)                :: primrad
   REAL(KIND=dp), INTENT(IN)                :: ratrad
   REAL(KIND=dp), INTENT(IN)                :: frac1
   REAL(KIND=dp), INTENT(IN)                :: frac2
   REAL(KIND=dp), INTENT(IN)                :: ecosw
   REAL(KIND=dp), INTENT(IN)                :: temprat
   REAL(KIND=dp), INTENT(IN)                :: bigi
   REAL(KIND=dp), INTENT(IN)                :: bigbeta
   REAL(KIND=dp), INTENT(IN)                :: density
   REAL(KIND=dp), INTENT(IN)                :: tconj
   REAL(KIND=dp), INTENT(IN)                :: beam1
   REAL(KIND=dp), INTENT(IN)                :: beam2
   REAL(KIND=dp), INTENT(IN)                :: contam
   REAL(KIND=dp), INTENT(IN)                :: ocose
   REAL(KIND=dp), INTENT(IN)                :: osine
   INTEGER, INTENT(IN)                      :: isw29
   REAL(KIND=dp), INTENT(IN)                :: tertperiod
   REAL(KIND=dp), INTENT(IN)                :: tertt0
   REAL(KIND=dp), INTENT(IN)                :: tertecos
   REAL(KIND=dp), INTENT(IN)                :: tertesin
   REAL(KIND=dp), INTENT(IN)                :: tertincl
   REAL(KIND=dp), INTENT(IN)                :: tertomega
   REAL(KIND=dp), INTENT(IN)                :: tertq
   REAL(KIND=dp), INTENT(IN)                :: tgrav1
   REAL(KIND=dp), INTENT(IN)                :: tgrav2
   REAL(KIND=dp), INTENT(IN)                :: tertconj
   REAL(KIND=dp), INTENT(IN)                :: omegadot
   REAL(KIND=dp), INTENT(IN)                :: contams0
   REAL(KIND=dp), INTENT(IN)                :: contams1
   REAL(KIND=dp), INTENT(IN)                :: contams2
   REAL(KIND=dp), INTENT(IN)                :: contams3
   REAL(KIND=dp), INTENT(IN)                :: p2tconj
   REAL(KIND=dp), INTENT(IN)                :: p2period
   REAL(KIND=dp), INTENT(IN)                :: p2t0
   REAL(KIND=dp), INTENT(IN)                :: p2ecos
   REAL(KIND=dp), INTENT(IN)                :: p2esin
   REAL(KIND=dp), INTENT(IN)                :: p2incl
   REAL(KIND=dp), INTENT(IN)                :: p2omega
   REAL(KIND=dp), INTENT(IN)                :: p2q
   REAL(KIND=dp), INTENT(IN)                :: p2ratrad
   REAL(KIND=dp), INTENT(IN)                :: p3tconj
   REAL(KIND=dp), INTENT(IN)                :: p3period
   REAL(KIND=dp), INTENT(IN)                :: p3t0
   REAL(KIND=dp), INTENT(IN)                :: p3ecos
   REAL(KIND=dp), INTENT(IN)                :: p3esin
   REAL(KIND=dp), INTENT(IN)                :: p3incl
   REAL(KIND=dp), INTENT(IN)                :: p3omega
   REAL(KIND=dp), INTENT(IN)                :: p3q
   REAL(KIND=dp), INTENT(IN)                :: p3ratrad
   REAL(KIND=dp), INTENT(IN)                :: p4tconj
   REAL(KIND=dp), INTENT(IN)                :: p4period
   REAL(KIND=dp), INTENT(IN)                :: p4t0
   REAL(KIND=dp), INTENT(IN)                :: p4ecos
   REAL(KIND=dp), INTENT(IN)                :: p4esin
   REAL(KIND=dp), INTENT(IN)                :: p4incl
   REAL(KIND=dp), INTENT(IN)                :: p4omega
   REAL(KIND=dp), INTENT(IN)                :: p4q
   REAL(KIND=dp), INTENT(IN)                :: p4ratrad
   REAL(KIND=dp), INTENT(IN)                :: p5tconj
   REAL(KIND=dp), INTENT(IN)                :: p5period
   REAL(KIND=dp), INTENT(IN)                :: p5t0
   REAL(KIND=dp), INTENT(IN)                :: p5ecos
   REAL(KIND=dp), INTENT(IN)                :: p5esin
   REAL(KIND=dp), INTENT(IN)                :: p5incl
   REAL(KIND=dp), INTENT(IN)                :: p5omega
   REAL(KIND=dp), INTENT(IN)                :: p5q
   REAL(KIND=dp), INTENT(IN)                :: p5ratrad
   REAL(KIND=dp), INTENT(IN)                :: p6tconj
   REAL(KIND=dp), INTENT(IN)                :: p6period
   REAL(KIND=dp), INTENT(IN)                :: p6t0
   REAL(KIND=dp), INTENT(IN)                :: p6ecos
   REAL(KIND=dp), INTENT(IN)                :: p6esin
   REAL(KIND=dp), INTENT(IN)                :: p6incl
   REAL(KIND=dp), INTENT(IN)                :: p6omega
   REAL(KIND=dp), INTENT(IN)                :: p6q
   REAL(KIND=dp), INTENT(IN)                :: p6ratrad
   REAL(KIND=dp), INTENT(IN)                :: p7tconj
   REAL(KIND=dp), INTENT(IN)                :: p7period
   REAL(KIND=dp), INTENT(IN)                :: p7t0
   REAL(KIND=dp), INTENT(IN)                :: p7ecos
   REAL(KIND=dp), INTENT(IN)                :: p7esin
   REAL(KIND=dp), INTENT(IN)                :: p7incl
   REAL(KIND=dp), INTENT(IN)                :: p7omega
   REAL(KIND=dp), INTENT(IN)                :: p7q
   REAL(KIND=dp), INTENT(IN)                :: p7ratrad
   REAL(KIND=dp), INTENT(IN)                :: p8tconj
   REAL(KIND=dp), INTENT(IN)                :: p8period
   REAL(KIND=dp), INTENT(IN)                :: p8t0
   REAL(KIND=dp), INTENT(IN)                :: p8ecos
   REAL(KIND=dp), INTENT(IN)                :: p8esin
   REAL(KIND=dp), INTENT(IN)                :: p8incl
   REAL(KIND=dp), INTENT(IN)                :: p8omega
   REAL(KIND=dp), INTENT(IN)                :: p8q
   REAL(KIND=dp), INTENT(IN)                :: p8ratrad
   REAL(KIND=dp), INTENT(IN)                :: sw72
   REAL(KIND=dp), INTENT(IN)                :: sw73
   REAL(KIND=dp), INTENT(IN)                :: sw49
   REAL(KIND=dp), INTENT(IN)                :: sw80
   REAL(KIND=dp), INTENT(IN)                :: sw81
   REAL(KIND=dp), INTENT(IN)                :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint5(8)
   REAL(KIND=dp), INTENT(IN)                :: tertratrad
   REAL(KIND=dp), INTENT(IN)                :: p1mtc
   REAL(KIND=dp), INTENT(IN)                :: p1ptc
   REAL(KIND=dp), INTENT(IN)                :: p2mtc
   REAL(KIND=dp), INTENT(IN)                :: p2ptc
   REAL(KIND=dp), INTENT(IN)                :: p3mtc
   REAL(KIND=dp), INTENT(IN)                :: p3ptc
   REAL(KIND=dp), INTENT(IN)                :: p4mtc
   REAL(KIND=dp), INTENT(IN)                :: p4ptc
   REAL(KIND=dp), INTENT(IN)                :: p5mtc
   REAL(KIND=dp), INTENT(IN)                :: p5ptc
   REAL(KIND=dp), INTENT(IN)                :: p6mtc
   REAL(KIND=dp), INTENT(IN)                :: p6ptc
   REAL(KIND=dp), INTENT(IN)                :: p7mtc
   REAL(KIND=dp), INTENT(IN)                :: p7ptc
   REAL(KIND=dp), INTENT(IN)                :: p8mtc
   REAL(KIND=dp), INTENT(IN)                :: p8ptc
   REAL(KIND=dp), INTENT(IN)                :: pbmtc
   REAL(KIND=dp), INTENT(IN)                :: pbptc
   REAL(KIND=dp), INTENT(IN)                :: bigi2
   REAL(KIND=dp), INTENT(IN)                :: bigi3
   REAL(KIND=dp), INTENT(IN)                :: bigi4
   REAL(KIND=dp), INTENT(IN)                :: bigbeta2
   REAL(KIND=dp), INTENT(IN)                :: bigbeta3
   REAL(KIND=dp), INTENT(IN)                :: bigbeta4
   REAL(KIND=dp), INTENT(IN)                :: bin2q
   REAL(KIND=dp), INTENT(IN)                :: b2massdiff
   REAL(KIND=dp), INTENT(IN)                :: b2masssum
   REAL(KIND=dp), INTENT(IN)                :: b2raddiff
   REAL(KIND=dp), INTENT(IN)                :: b2radsum
   REAL(KIND=dp), INTENT(IN)                :: bin2ratrad
   REAL(KIND=dp), INTENT(IN)                :: g10
   REAL(KIND=dp), INTENT(IN)                :: g6
   REAL(KIND=dp), INTENT(IN)                :: g7
   REAL(KIND=dp), INTENT(IN)                :: g8
   REAL(KIND=dp), INTENT(IN)                :: g9
   REAL(KIND=dp), INTENT(IN)                :: massdiff
   REAL(KIND=dp), INTENT(IN)                :: masssum
   REAL(KIND=dp), INTENT(IN)                :: omega3
   REAL(KIND=dp), INTENT(IN)                :: omega4
   REAL(KIND=dp), INTENT(IN)                :: omega5
   REAL(KIND=dp), INTENT(IN)                :: omega6
   REAL(KIND=dp), INTENT(IN)                :: omega7
   REAL(KIND=dp), INTENT(IN)                :: omega8
   REAL(KIND=dp), INTENT(IN)                :: omega9
   REAL(KIND=dp), INTENT(IN)                :: omega10
   REAL(KIND=dp), INTENT(IN)                :: raddiff
   REAL(KIND=dp), INTENT(IN)                :: radsum
   REAL(KIND=dp), INTENT(IN)                :: rk3
   REAL(KIND=dp), INTENT(IN)                :: rk4
   REAL(KIND=dp), INTENT(IN)                :: rk5
   REAL(KIND=dp), INTENT(IN)                :: rk6
   REAL(KIND=dp), INTENT(IN)                :: rk7
   REAL(KIND=dp), INTENT(IN)                :: rk8
   REAL(KIND=dp), INTENT(IN)                :: rk9
   REAL(KIND=dp), INTENT(IN)                :: rk10
   REAL(KIND=dp), INTENT(IN)                :: sdarkint6(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint7(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint8(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint9(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint10(8)
   REAL(KIND=dp), INTENT(IN)                :: secmass
   REAL(KIND=dp), INTENT(IN)                :: secrad
   REAL(KIND=dp), INTENT(IN)                :: t10
   REAL(KIND=dp), INTENT(IN)                :: t6
   REAL(KIND=dp), INTENT(IN)                :: t7
   REAL(KIND=dp), INTENT(IN)                :: t8
   REAL(KIND=dp), INTENT(IN)                :: t9
   REAL(KIND=dp), INTENT(IN)                :: fracsum
   REAL(KIND=dp), INTENT(IN)                :: fracdiff
   REAL(KIND=dp), INTENT(IN)                :: bin2m3
   REAL(KIND=dp), INTENT(IN)                :: bin2m4
   REAL(KIND=dp), INTENT(IN)                :: bin2r3
   REAL(KIND=dp), INTENT(IN)                :: bin2r4
   REAL(KIND=dp), INTENT(IN)                :: sqecos
   REAL(KIND=dp), INTENT(IN)                :: sqesin
   REAL(KIND=dp), INTENT(IN)                :: sqtertecos
   REAL(KIND=dp), INTENT(IN)                :: sqtertesin
   REAL(KIND=dp), INTENT(IN)                :: sqp2ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp2esin
   REAL(KIND=dp), INTENT(IN)                :: sqp3ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp3esin
   REAL(KIND=dp), INTENT(IN)                :: sqp4ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp4esin
   REAL(KIND=dp), INTENT(IN)                :: sqp5ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp5esin
   REAL(KIND=dp), INTENT(IN)                :: sqp6ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp6esin
   REAL(KIND=dp), INTENT(IN)                :: sqp7ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp7esin
   REAL(KIND=dp), INTENT(IN)                :: sqp8ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp8esin
   REAL(KIND=dp), INTENT(IN)                :: angsum1
   REAL(KIND=dp), INTENT(IN)                :: angdiff1
   REAL(KIND=dp), INTENT(IN)                :: angsum2
   REAL(KIND=dp), INTENT(IN)                :: angdiff2
   REAL(KIND=dp), INTENT(IN)                :: angsum3
   REAL(KIND=dp), INTENT(IN)                :: angdiff3
   REAL(KIND=dp), INTENT(IN)                :: angsum4
   REAL(KIND=dp), INTENT(IN)                :: angdiff4
   REAL(KIND=dp), INTENT(IN)                :: angsum5
   REAL(KIND=dp), INTENT(IN)                :: angdiff5
   REAL(KIND=dp), INTENT(IN)                :: angsum6
   REAL(KIND=dp), INTENT(IN)                :: angdiff6
   REAL(KIND=dp), INTENT(IN)                :: angsum7
   REAL(KIND=dp), INTENT(IN)                :: angdiff7
   REAL(KIND=dp), INTENT(IN)                :: angsum8
   REAL(KIND=dp), INTENT(IN)                :: angdiff8
   REAL(KIND=dp), INTENT(IN)                :: fillsum
   REAL(KIND=dp), INTENT(IN)                :: filldiff
   REAL(KIND=dp), INTENT(IN)                :: binqtc
   REAL(KIND=dp), INTENT(IN)                :: p1qtc
   REAL(KIND=dp), INTENT(IN)                :: p2qtc
   REAL(KIND=dp), INTENT(IN)                :: p3qtc
   REAL(KIND=dp), INTENT(IN)                :: p4qtc
   REAL(KIND=dp), INTENT(IN)                :: p5qtc
   REAL(KIND=dp), INTENT(IN)                :: p6qtc
   REAL(KIND=dp), INTENT(IN)                :: p7qtc
   REAL(KIND=dp), INTENT(IN)                :: p8qtc
   REAL(KIND=dp), INTENT(IN)                :: tbinoff
   REAL(KIND=dp), INTENT(IN)                :: t1off
   REAL(KIND=dp), INTENT(IN)                :: t2off
   REAL(KIND=dp), INTENT(IN)                :: t3off
   REAL(KIND=dp), INTENT(IN)                :: t4off
   REAL(KIND=dp), INTENT(IN)                :: t5off
   REAL(KIND=dp), INTENT(IN)                :: t6off
   REAL(KIND=dp), INTENT(IN)                :: t7off
   REAL(KIND=dp), INTENT(IN)                :: t8off
   REAL(KIND=dp), INTENT(IN)                :: tesscontam
!
   INTEGER :: i,kk,icnvrt
!
   REAL(KIND=dp)  :: g4,g5
!
!   loop over the gridloop.opt variables and match the tag codes
!   to the variables
!
   g4=0.0_dp
   g5=0.0_dp
   DO  i=1,nvarmax
      kk=icnvrt(svar(i)(1:2))
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
      IF(kk == 48)THEN
         var(i)=binqtc
      END IF
!
!  tag ct, tesscontam
!
      IF(kk == 83)THEN
         var(i)=tesscontam
      END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
      IF(kk == 3528)THEN
         var(i)=p1qtc
      END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
      IF(kk == 3560)THEN
         var(i)=p2qtc
      END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
      IF(kk == 3592)THEN
         var(i)=p3qtc
      END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
      IF(kk == 3624)THEN
         var(i)=p4qtc
      END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
      IF(kk == 3656)THEN
         var(i)=p5qtc
      END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
      IF(kk == 3688)THEN
         var(i)=p6qtc
      END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
      IF(kk == 3720)THEN
         var(i)=p7qtc
      END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
      IF(kk == 3752)THEN
         var(i)=p8qtc
      END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
      IF(kk == 51)THEN
         var(i)=tbinoff
      END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
      IF(kk == 3531)THEN
         var(i)=t1off
      END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
      IF(kk == 3563)THEN
         var(i)=t2off
      END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
      IF(kk == 3595)THEN
         var(i)=t3off
      END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
      IF(kk == 3627)THEN
         var(i)=t4off
      END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
      IF(kk == 3659)THEN
         var(i)=t5off
      END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
      IF(kk == 3691)THEN
         var(i)=t6off
      END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
      IF(kk == 3723)THEN
         var(i)=t7off
      END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
      IF(kk == 3755)THEN
         var(i)=t8off
      END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
      IF(kk == 581)THEN
         var(i)=fillsum
      END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
      IF(kk == 579)THEN
         var(i)=filldiff
      END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
      IF(kk == 3512)THEN
         var(i)=angsum1
      END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
      IF(kk == 3544)THEN
         var(i)=angsum2
      END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
      IF(kk == 3576)THEN
         var(i)=angsum3
      END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
      IF(kk == 3608)THEN
         var(i)=angsum4
      END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
      IF(kk == 3640)THEN
         var(i)=angsum5
      END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
      IF(kk == 3672)THEN
         var(i)=angsum6
      END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
      IF(kk == 3704)THEN
         var(i)=angsum7
      END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
      IF(kk == 3736)THEN
         var(i)=angsum8
      END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
      IF(kk == 3515)THEN
         var(i)=angdiff1
      END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
      IF(kk == 3547)THEN
         var(i)=angdiff2
      END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
      IF(kk == 3579)THEN
         var(i)=angdiff3
      END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
      IF(kk == 3611)THEN
         var(i)=angdiff4
      END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
      IF(kk == 3643)THEN
         var(i)=angdiff5
      END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
      IF(kk == 3675)THEN
         var(i)=angdiff6
      END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
      IF(kk == 3707)THEN
         var(i)=angdiff7
      END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
      IF(kk == 3739)THEN
         var(i)=angdiff8
      END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
      IF(kk == 178)THEN
         var(i)=fracsum
      END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
      IF(kk == 163)THEN
         var(i)=fracdiff
      END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
      IF(kk == 4790)THEN
         var(i)=bin2m3
      END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
      IF(kk == 4791)THEN
         var(i)=bin2m4
      END IF
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4792)THEN
         var(i)=bin2r3
      END IF
!
!  tag 90, bin2R4 (R4 in solar radii in binary+binary)
!
      IF(kk == 4783)THEN
         var(i)=bin2r4
      END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 50)THEN
         var(i)=sqesin
      END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 34)THEN
         var(i)=sqecos
      END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3530)THEN
         var(i)=sqtertesin
      END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3514)THEN
         var(i)=sqtertecos
      END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3562)THEN
         var(i)=sqp2esin
      END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3546)THEN
         var(i)=sqp2ecos
      END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3594)THEN
         var(i)=sqp3esin
      END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3578)THEN
         var(i)=sqp3ecos
      END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3626)THEN
         var(i)=sqp4esin
      END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3610)THEN
         var(i)=sqp4ecos
      END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3658)THEN
         var(i)=sqp5esin
      END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3642)THEN
         var(i)=sqp5ecos
      END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3690)THEN
         var(i)=sqp6esin
      END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3674)THEN
         var(i)=sqp6ecos
      END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3722)THEN
         var(i)=sqp7esin
      END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3706)THEN
         var(i)=sqp7ecos
      END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3754)THEN
         var(i)=sqp8esin
      END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3738)THEN
         var(i)=sqp8ecos
      END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
      IF(kk == 3524)THEN
         var(i)=p1mtc
      END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
      IF(kk == 3527)THEN
         var(i)=p1ptc
      END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
      IF(kk == 3556)THEN
         var(i)=p2mtc
      END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
      IF(kk == 3559)THEN
         var(i)=p2ptc
      END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
      IF(kk == 3588)THEN
         var(i)=p3mtc
      END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
      IF(kk == 3591)THEN
         var(i)=p3ptc
      END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
      IF(kk == 3620)THEN
         var(i)=p4mtc
      END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
      IF(kk == 3623)THEN
         var(i)=p4ptc
      END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
      IF(kk == 3652)THEN
         var(i)=p5mtc
      END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
      IF(kk == 3655)THEN
         var(i)=p5ptc
      END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
      IF(kk == 3684)THEN
         var(i)=p6mtc
      END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
      IF(kk == 3687)THEN
         var(i)=p6ptc
      END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
      IF(kk == 3716)THEN
         var(i)=p7mtc
      END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
      IF(kk == 3719)THEN
         var(i)=p7ptc
      END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
      IF(kk == 3748)THEN
         var(i)=p8mtc
      END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
      IF(kk == 3751)THEN
         var(i)=p8ptc
      END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
      IF(kk == 44)THEN
         var(i)=pbmtc
      END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
      IF(kk == 47)THEN
         var(i)=pbptc
      END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
      IF(kk == 40)THEN
         var(i)=bigi2
      END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
      IF(kk == 33)THEN
         var(i)=bigbeta2
      END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
      IF(kk == 72)THEN
         var(i)=bigi3
      END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
      IF(kk == 65)THEN
         var(i)=bigbeta3
      END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
      IF(kk == 104)THEN
         var(i)=bigi4
      END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
      IF(kk == 97)THEN
         var(i)=bigbeta4
      END IF
!
!  tag 91, b2masssum (M3+M4 in binary+binary)
!
      IF(kk == 4784)THEN
         var(i)=b2masssum
      END IF
!
!  tag 92, b2massdiff (M3-M4 in binary+binary)
!
      IF(kk == 4785)THEN
         var(i)=b2massdiff
      END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
      IF(kk == 4786)THEN
         var(i)=bin2q
      END IF
!
!  tag 94, b2radsum (R3+R4 in binary+binary)
!
      IF(kk == 4787)THEN
         var(i)=b2radsum
      END IF
!
!  tag 95, b2raddiff (R3-R4 in binary+binary)
!
      IF(kk == 4788)THEN
         var(i)=b2raddiff
      END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
      IF(kk == 4789)THEN
         var(i)=bin2ratrad
      END IF
!
!   tag g4, g4
!
      IF(kk == 1211)THEN
         var(i)=g4
      END IF
!
!   tag g5, g5
!
      IF(kk == 1212)THEN
         var(i)=g5
      END IF
!
!   tag g6, g6
!
      IF(kk == 1213)THEN
         var(i)=g6
      END IF
!
!   tag g7, g7
!
      IF(kk == 1214)THEN
         var(i)=g7
      END IF
!
!   tag g8, g8
!
      IF(kk == 1215)THEN
         var(i)=g8
      END IF
!
!   tag g9, g9
!
      IF(kk == 1216)THEN
         var(i)=g9
      END IF
!
!   tag g0, g10
!
      IF(kk == 1207)THEN
         var(i)=g10
      END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
      IF(kk == 387)THEN
         var(i)=massdiff
      END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
      IF(kk == 402)THEN
         var(i)=masssum
      END IF
!
!   tag o3, omega3
!
      IF(kk == 1466)THEN
         var(i)=omega3
      END IF
!
!   tag o4, omega4
!
      IF(kk == 1467)THEN
         var(i)=omega4
      END IF
!
!   tag o5, omega5
!
      IF(kk == 1468)THEN
         var(i)=omega5
      END IF
!
!   tag o6, omega6
!
      IF(kk == 1469)THEN
         var(i)=omega6
      END IF
!
!   tag o7, omega7
!
      IF(kk == 1470)THEN
         var(i)=omega7
      END IF
!
!   tag o8, omega8
!
      IF(kk == 1471)THEN
         var(i)=omega8
      END IF
!
!   tag o9, omega9
!
      IF(kk == 1472)THEN
         var(i)=omega9
      END IF
!
!   tag o0, omega10
!
      IF(kk == 1463)THEN
         var(i)=omega10
      END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
      IF(kk == 562)THEN
         var(i)=radsum
      END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
      IF(kk == 547)THEN
         var(i)=raddiff
      END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
      IF(kk == 1018)THEN
         var(i)=rk3
      END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
      IF(kk == 1019)THEN
         var(i)=rk4
      END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
      IF(kk == 1020)THEN
         var(i)=rk5
      END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
      IF(kk == 1021)THEN
         var(i)=rk6
      END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
      IF(kk == 1022)THEN
         var(i)=rk7
      END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
      IF(kk == 1023)THEN
         var(i)=rk8
      END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
      IF(kk == 1024)THEN
         var(i)=rk9
      END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
      IF(kk == 1015)THEN
         var(i)=rk10
      END IF
!
!   tag sm, secmass
!
      IF(kk == 588)THEN
         var(i)=secmass
      END IF
!
!   tag sr, secrad
!
      IF(kk == 593)THEN
         var(i)=secrad
      END IF
!
!   tag t6, t6 (Teff6)
!
      IF(kk == 1629)THEN
         var(i)=t6
      END IF
!
!   tag t7, t7 (Teff7)
!
      IF(kk == 1630)THEN
         var(i)=t7
      END IF
!
!   tag t8, t8 (Teff8)
!
      IF(kk == 1631)THEN
         var(i)=t8
      END IF
!
!   tag t9, t9 (Teff9)
!
      IF(kk == 1632)THEN
         var(i)=t9
      END IF
!
!   tag ta, t10 (Teff10)
!
      IF(kk == 608)THEN
         var(i)=t10
      END IF
!
!  tag 61, flux star 6, band 1
!
      IF(kk == 4688)THEN
         var(i)=sdarkint6(1)
      END IF
!
!  tag 62, flux star 6, band 2
!
      IF(kk == 4689)THEN
         var(i)=sdarkint6(2)
      END IF
!
!  tag 63, flux star 6, band 3
!
      IF(kk == 4690)THEN
         var(i)=sdarkint6(3)
      END IF
!
!  tag 64, flux star 6, band 4
!
      IF(kk == 4691)THEN
         var(i)=sdarkint6(4)
      END IF
!
!  tag 65, flux star 6, band 5
!
      IF(kk == 4692)THEN
         var(i)=sdarkint6(5)
      END IF
!
!  tag 66, flux star 6, band 6
!
      IF(kk == 4693)THEN
         var(i)=sdarkint6(6)
      END IF
!
!  tag 67, flux star 6, band 7
!
      IF(kk == 4694)THEN
         var(i)=sdarkint6(7)
      END IF
!
!  tag 68, flux star 6, band 8
!
      IF(kk == 4695)THEN
         var(i)=sdarkint6(8)
      END IF
!
!  tag 71, flux star 7, band 1
!
      IF(kk == 4720)THEN
         var(i)=sdarkint7(1)
      END IF
!
!  tag 72, flux star 7, band 2
!
      IF(kk == 4721)THEN
         var(i)=sdarkint7(2)
      END IF
!
!  tag 73, flux star 7, band 3
!
      IF(kk == 4722)THEN
         var(i)=sdarkint7(3)
      END IF
!
!  tag 74, flux star 7, band 4
!
      IF(kk == 4723)THEN
         var(i)=sdarkint7(4)
      END IF
!
!  tag 75, flux star 7, band 5
!
      IF(kk == 4724)THEN
         var(i)=sdarkint7(5)
      END IF
!
!  tag 76, flux star 7, band 6
!
      IF(kk == 4725)THEN
         var(i)=sdarkint7(6)
      END IF
!
!  tag 77, flux star 7, band 7
!
      IF(kk == 4726)THEN
         var(i)=sdarkint7(7)
      END IF
!
!  tag 78, flux star 7, band 8
!
      IF(kk == 4727)THEN
         var(i)=sdarkint7(8)
      END IF
!
!  tag 81, flux star 8, band 1
!
      IF(kk == 4752)THEN
         var(i)=sdarkint8(1)
      END IF
!
!  tag 82, flux star 8, band 2
!
      IF(kk == 4753)THEN
         var(i)=sdarkint8(2)
      END IF
!
!  tag 83, flux star 8, band 3
!
      IF(kk == 4754)THEN
         var(i)=sdarkint8(3)
      END IF
!
!  tag 84, flux star 8, band 4
!
      IF(kk == 4755)THEN
         var(i)=sdarkint8(4)
      END IF
!
!  tag 85, flux star 8, band 5
!
      IF(kk == 4756)THEN
         var(i)=sdarkint8(5)
      END IF
!
!  tag 86, flux star 8, band 6
!
      IF(kk == 4757)THEN
         var(i)=sdarkint8(6)
      END IF
!
!  tag 87, flux star 8, band 7
!
      IF(kk == 4758)THEN
         var(i)=sdarkint8(7)
      END IF
!
!  tag 88, flux star 8, band 8
!
      IF(kk == 4759)THEN
         var(i)=sdarkint8(8)
      END IF
!
!  tag 91, flux star 9, band 1
!
      IF(kk == 2784)THEN
         var(i)=sdarkint9(1)
      END IF
!
!  tag 92, flux star 9, band 2
!
      IF(kk == 2785)THEN
         var(i)=sdarkint9(2)
      END IF
!
!  tag 93, flux star 9, band 3
!
      IF(kk == 2786)THEN
         var(i)=sdarkint9(3)
      END IF
!
!  tag 94, flux star 9, band 4
!
      IF(kk == 2787)THEN
         var(i)=sdarkint9(4)
      END IF
!
!  tag 95, flux star 9, band 5
!
      IF(kk == 2788)THEN
         var(i)=sdarkint9(5)
      END IF
!
!  tag 96, flux star 9, band 6
!
      IF(kk == 2789)THEN
         var(i)=sdarkint9(6)
      END IF
!
!  tag 97, flux star 9, band 7
!
      IF(kk == 2790)THEN
         var(i)=sdarkint9(7)
      END IF
!
!  tag 98, flux star 9, band 8
!
      IF(kk == 2791)THEN
         var(i)=sdarkint9(8)
      END IF
!
!  tag 01, flux star 10, band 1
!
      IF(kk == 4496)THEN
         var(i)=sdarkint10(1)
      END IF
!
!  tag 02, flux star 10, band 2
!
      IF(kk == 4497)THEN
         var(i)=sdarkint10(2)
      END IF
!
!  tag 03, flux star 10, band 3
!
      IF(kk == 4498)THEN
         var(i)=sdarkint10(3)
      END IF
!
!  tag 04, flux star 10, band 4
!
      IF(kk == 4499)THEN
         var(i)=sdarkint10(4)
      END IF
!
!  tag 05, flux star 10, band 5
!
      IF(kk == 4500)THEN
         var(i)=sdarkint10(5)
      END IF
!
!  tag 06, flux star 10, band 6
!
      IF(kk == 4501)THEN
         var(i)=sdarkint10(6)
      END IF
!
!  tag 07, flux star 10, band 7
!
      IF(kk == 4502)THEN
         var(i)=sdarkint10(7)
      END IF
!
!  tag 08, flux star 10, band 8
!
      IF(kk == 4503)THEN
         var(i)=sdarkint10(8)
      END IF
!QQQQQQ
!
!  tag 11, flux star 1, band 1
!
      IF(kk == 4528)THEN
         var(i)=sdarkint1(1)
      END IF
!
!  tag 12, flux star 1, band 2
!
      IF(kk == 4529)THEN
         var(i)=sdarkint1(2)
      END IF
!
!  tag 13, flux star 1, band 3
!
      IF(kk == 4530)THEN
         var(i)=sdarkint1(3)
      END IF
!
!  tag 14, flux star 1, band 4
!
      IF(kk == 4531)THEN
         var(i)=sdarkint1(4)
      END IF
!
!  tag 15, flux star 1, band 5
!
      IF(kk == 4532)THEN
         var(i)=sdarkint1(5)
      END IF
!
!  tag 16, flux star 1, band 6
!
      IF(kk == 4533)THEN
         var(i)=sdarkint1(6)
      END IF
!
!  tag 17, flux star 1, band 7
!
      IF(kk == 4534)THEN
         var(i)=sdarkint1(7)
      END IF
!
!  tag 18, flux star 1, band 8
!
      IF(kk == 4535)THEN
         var(i)=sdarkint1(8)
      END IF
!
!  tag 21, flux star 2, band 1
!
      IF(kk == 4560)THEN
         var(i)=sdarkint2(1)
      END IF
!
!  tag 22, flux star 2, band 2
!
      IF(kk == 4561)THEN
         var(i)=sdarkint2(2)
      END IF
!
!  tag 23, flux star 2, band 3
!
      IF(kk == 4562)THEN
         var(i)=sdarkint2(3)
      END IF
!
!  tag 24, flux star 2, band 4
!
      IF(kk == 4563)THEN
         var(i)=sdarkint2(4)
      END IF
!
!  tag 25, flux star 2, band 5
!
      IF(kk == 4564)THEN
         var(i)=sdarkint2(5)
      END IF
!
!  tag 26, flux star 2, band 6
!
      IF(kk == 4565)THEN
         var(i)=sdarkint2(6)
      END IF
!
!  tag 27, flux star 2, band 7
!
      IF(kk == 4566)THEN
         var(i)=sdarkint2(7)
      END IF
!
!  tag 28, flux star 2, band 8
!
      IF(kk == 4567)THEN
         var(i)=sdarkint2(8)
      END IF
!
!  tag 31, flux star 3, band 1
!
      IF(kk == 4592)THEN
         var(i)=sdarkint3(1)
      END IF
!
!  tag 32, flux star 3, band 2
!
      IF(kk == 4593)THEN
         var(i)=sdarkint3(2)
      END IF
!
!  tag 33, flux star 3, band 3
!
      IF(kk == 4594)THEN
         var(i)=sdarkint3(3)
      END IF
!
!  tag 34, flux star 3, band 4
!
      IF(kk == 4595)THEN
         var(i)=sdarkint3(4)
      END IF
!
!  tag 35, flux star 3, band 5
!
      IF(kk == 4596)THEN
         var(i)=sdarkint3(5)
      END IF
!
!  tag 36, flux star 3, band 6
!
      IF(kk == 4597)THEN
         var(i)=sdarkint3(6)
      END IF
!
!  tag 37, flux star 3, band 7
!
      IF(kk == 4598)THEN
         var(i)=sdarkint3(7)
      END IF
!
!  tag 38, flux star 3, band 8
!
      IF(kk == 4599)THEN
         var(i)=sdarkint3(8)
      END IF
!
!  tag 41, flux star 4, band 1
!
      IF(kk == 4624)THEN
         var(i)=sdarkint4(1)
      END IF
!
!  tag 42, flux star 4, band 2
!
      IF(kk == 4625)THEN
         var(i)=sdarkint4(2)
      END IF
!
!  tag 43, flux star 4, band 3
!
      IF(kk == 4626)THEN
         var(i)=sdarkint4(3)
      END IF
!
!  tag 44, flux star 4, band 4
!
      IF(kk == 4627)THEN
         var(i)=sdarkint4(4)
      END IF
!
!  tag 45, flux star 4, band 5
!
      IF(kk == 4628)THEN
         var(i)=sdarkint4(5)
      END IF
!
!  tag 46, flux star 4, band 6
!
      IF(kk == 4629)THEN
         var(i)=sdarkint4(6)
      END IF
!
!  tag 47, flux star 4, band 7
!
      IF(kk == 4630)THEN
         var(i)=sdarkint4(7)
      END IF
!
!  tag 48, flux star 4, band 8
!
      IF(kk == 4631)THEN
         var(i)=sdarkint4(8)
      END IF
!
!  tag 51, flux star 5, band 1
!
      IF(kk == 4656)THEN
         var(i)=sdarkint5(1)
      END IF
!
!  tag 52, flux star 5, band 2
!
      IF(kk == 4657)THEN
         var(i)=sdarkint5(2)
      END IF
!
!  tag 53, flux star 5, band 3
!
      IF(kk == 4658)THEN
         var(i)=sdarkint5(3)
      END IF
!
!  tag 54, flux star 5, band 4
!
      IF(kk == 4659)THEN
         var(i)=sdarkint5(4)
      END IF
!
!  tag 55, flux star 5, band 5
!
      IF(kk == 4660)THEN
         var(i)=sdarkint5(5)
      END IF
!
!  tag 56, flux star 5, band 6
!
      IF(kk == 4661)THEN
         var(i)=sdarkint5(6)
      END IF
!
!  tag 57, flux star 5, band 7
!
      IF(kk == 4662)THEN
         var(i)=sdarkint5(7)
      END IF
!
!  tag 58, flux star 5, band 8
!
      IF(kk == 4663)THEN
         var(i)=sdarkint5(8)
      END IF
!
!  tag a1, tidal apsidal constant, star 1
!
      IF(kk == 1016)THEN
         var(i)=sw72
      END IF
!
!  tag a2, tidal apsidal constant, star 2
!
      IF(kk == 1017)THEN
         var(i)=sw73
      END IF
!
!  tag Ob, nodal angle of binary
!
      IF(kk == 449)THEN
         var(i)=sw49
      END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
      IF(kk == 649)THEN
         var(i)=p2tconj
      END IF
!
!  tag ut, P2period
!
      IF(kk == 659)THEN
         var(i)=p2period
      END IF
!
!  tag uu, P2T0
!
      IF(kk == 660)THEN
         var(i)=p2t0
      END IF
!
!  tag uv, P2ecos
!
      IF(kk == 661)THEN
         var(i)=p2ecos
      END IF
!
!  tag uw, P2esin
!
      IF(kk == 662)THEN
         var(i)=p2esin
      END IF
!
!  tag ux, P2incl
!
      IF(kk == 663)THEN
         var(i)=p2incl
      END IF
!
!  tag uy, P2Omega
!
      IF(kk == 664)THEN
         var(i)=p2omega
      END IF
!
!  tag uz, P2Q
!
      IF(kk == 665)THEN
         var(i)=p2q
      END IF
!
!  tag ub, P2ratrad
!
      IF(kk == 641)THEN
         var(i)=p2ratrad
      END IF
!
! planet 3 parameters
!
!  tag vj, P3tconj
!
      IF(kk == 681)THEN
         var(i)=p3tconj
      END IF
!
!  tag vt, P3period
!
      IF(kk == 691)THEN
         var(i)=p3period
      END IF
!
!  tag vu, P3T0
!
      IF(kk == 692)THEN
         var(i)=p3t0
      END IF
!
!  tag vv, P3ecos
!
      IF(kk == 693)THEN
         var(i)=p3ecos
      END IF
!
!  tag vw, P3esin
!
      IF(kk == 694)THEN
         var(i)=p3esin
      END IF
!
!  tag vx, P3incl
!
      IF(kk == 695)THEN
         var(i)=p3incl
      END IF
!
!  tag vy, P3Omega
!
      IF(kk == 696)THEN
         var(i)=p3omega
      END IF
!
!  tag vz, P3Q
!
      IF(kk == 697)THEN
         var(i)=p3q
      END IF
!
!  tag vb, P3ratrad
!
      IF(kk == 673)THEN
         var(i)=p3ratrad
      END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
      IF(kk == 713)THEN
         var(i)=p4tconj
      END IF
!
!  tag wt, P4period
!
      IF(kk == 723)THEN
         var(i)=p4period
      END IF
!
!  tag wu, P4T0
!
      IF(kk == 724)THEN
         var(i)=p4t0
      END IF
!
!  tag wv, P4ecos
!
      IF(kk == 725)THEN
         var(i)=p4ecos
      END IF
!
!  tag ww, P4esin
!
      IF(kk == 726)THEN
         var(i)=p4esin
      END IF
!
!  tag wx, P4incl
!
      IF(kk == 727)THEN
         var(i)=p4incl
      END IF
!
!  tag wy, P4Omega
!
      IF(kk == 728)THEN
         var(i)=p4omega
      END IF
!
!  tag wz, P4Q
!
      IF(kk == 729)THEN
         var(i)=p4q
      END IF
!
!  tag wb, P4ratrad
!
      IF(kk == 705)THEN
         var(i)=p4ratrad
      END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
      IF(kk == 745)THEN
         var(i)=p5tconj
      END IF
!
!  tag xt, P5period
!
      IF(kk == 755)THEN
         var(i)=p5period
      END IF
!
!  tag xu, P5T0
!
      IF(kk == 756)THEN
         var(i)=p5t0
      END IF
!
!  tag xv, P5ecos
!
      IF(kk == 757)THEN
         var(i)=p5ecos
      END IF
!
!  tag xw, P5esin
!
      IF(kk == 758)THEN
         var(i)=p5esin
      END IF
!
!  tag xx, P5incl
!
      IF(kk == 759)THEN
         var(i)=p5incl
      END IF
!
!  tag xy, P5Omega
!
      IF(kk == 760)THEN
         var(i)=p5omega
      END IF
!
!  tag xz, P5Q
!
      IF(kk == 761)THEN
         var(i)=p5q
      END IF
!
!  tag xb, P5ratrad
!
      IF(kk == 737)THEN
         var(i)=p5ratrad
      END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
      IF(kk == 585)THEN
         var(i)=p6tconj
      END IF
!
!  tag st, P6period
!
      IF(kk == 595)THEN
         var(i)=p6period
      END IF
!
!  tag su, P6T0
!
      IF(kk == 596)THEN
         var(i)=p6t0
      END IF
!
!  tag sv, P6ecos
!
      IF(kk == 597)THEN
         var(i)=p6ecos
      END IF
!
!  tag sw, P6esin
!
      IF(kk == 598)THEN
         var(i)=p6esin
      END IF
!
!  tag sx, P6incl
!
      IF(kk == 599)THEN
         var(i)=p6incl
      END IF
!
!  tag sy, P6Omega
!
      IF(kk == 600)THEN
         var(i)=p6omega
      END IF
!
!  tag sz, P6Q
!
      IF(kk == 601)THEN
         var(i)=p6q
      END IF
!
!  tag sb, P6ratrad
!
      IF(kk == 577)THEN
         var(i)=p6ratrad
      END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
      IF(kk == 233)THEN
         var(i)=p7tconj
      END IF
!
!  tag ht, P7period
!
      IF(kk == 243)THEN
         var(i)=p7period
      END IF
!
!  tag hu, P7T0
!
      IF(kk == 244)THEN
         var(i)=p7t0
      END IF
!
!  tag hv, P7ecos
!
      IF(kk == 245)THEN
         var(i)=p7ecos
      END IF
!
!  tag hw, P7esin
!
      IF(kk == 246)THEN
         var(i)=p7esin
      END IF
!
!  tag hx, P7incl
!
      IF(kk == 247)THEN
         var(i)=p7incl
      END IF
!
!  tag hy, P7Omega
!
      IF(kk == 248)THEN
         var(i)=p7omega
      END IF
!
!  tag hz, P7Q
!
      IF(kk == 249)THEN
         var(i)=p7q
      END IF
!
!  tag hb, P7ratrad
!
      IF(kk == 225)THEN
         var(i)=p7ratrad
      END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
      IF(kk == 329)THEN
         var(i)=p8tconj
      END IF
!
!  tag kt, P8period
!
      IF(kk == 339)THEN
         var(i)=p8period
      END IF
!
!  tag ku, P8T0
!
      IF(kk == 340)THEN
         var(i)=p8t0
      END IF
!
!  tag kv, P8ecos
!
      IF(kk == 341)THEN
         var(i)=p8ecos
      END IF
!
!  tag kw, P8esin
!
      IF(kk == 342)THEN
         var(i)=p8esin
      END IF
!
!  tag kx, P8incl
!
      IF(kk == 343)THEN
         var(i)=p8incl
      END IF
!
!  tag ky, P8Omega
!
      IF(kk == 344)THEN
         var(i)=p8omega
      END IF
!
!  tag kz, P8Q
!
      IF(kk == 345)THEN
         var(i)=p8q
      END IF
!
!  tag kb, P8ratrad
!
      IF(kk == 42)THEN
         var(i)=p8ratrad
      END IF
!
!  tag s0, seasonal contamination season 0
!
      IF(kk == 1591)THEN
         var(i)=contams0
      END IF
!
!  tag s1, seasonal contamination season 1
!
      IF(kk == 1592)THEN
         var(i)=contams1
      END IF
!
!  tag s2, seasonal contamination season 2
!
      IF(kk == 1593)THEN
         var(i)=contams2
      END IF
!
!  tag s3, seasonal contamination s3
!
      IF(kk == 1594)THEN
         var(i)=contams3
      END IF
!
!  tag do, omegadot
!
      IF(kk == 110)THEN
         var(i)=omegadot
      END IF
!
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
      IF(kk == 1208)THEN
         var(i)=tgrav1
      END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
      IF(kk == 1209)THEN
         var(i)=tgrav2
      END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
      IF((isw29 > 0).AND.(kk == 450))THEN
         var(i)=ocose
      END IF
!
!  tag os, osine, e*sin(omega) for binary
!
      IF((isw29 > 0).AND.(kk == 466))THEN
         var(i)=osine
      END IF
!
!  tag tj, tertconj, third body conjunction
!
      IF(kk == 617)THEN
         var(i)=tertconj
      END IF
!
!  tag tt, tertperiod, third body perioe
!
      IF(kk == 627)THEN
         var(i)=tertperiod
      END IF
!
!  tag tu, tertT0, third body periastron
!
      IF(kk == 628)THEN
         var(i)=tertt0
      END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3
!
      IF(kk == 629)THEN
         var(i)=tertecos
      END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3
!
      IF(kk == 630)THEN
         var(i)=tertesin
      END IF
!
!  tag tx, tertincl, inclination for body 3
!
      IF(kk == 631)THEN
         var(i)=tertincl
      END IF
!
!  tag ty, tertOmega, Omega for body 3
!
      IF(kk == 632)THEN
         var(i)=tertomega
      END IF
!
!  tag tz, tertQ, third body mass ratio
!
      IF(kk == 633)THEN
         var(i)=tertq
      END IF
!
!  tag tb, tertratrad, third body radius ratio
!
      IF(kk == 609)THEN
         var(i)=tertratrad
      END IF
!
!  tag co, contam, Kepler contamination
!
      IF(kk == 78)THEN
         var(i)=contam
      END IF
!
!  tag e1, beam1, Doppler beaming coefficient star 1
!
      IF(kk == 1144)THEN
         var(i)=beam1
      END IF
!
!  tag e2, beam2, Doppler beaming coefficient star 2
!
      IF(kk == 1145)THEN
         var(i)=beam2
      END IF
!
!  tag tc, Tconj, conjunction time for binary
!
      IF(kk == 610)THEN
         var(i)=tconj
      END IF
!
!  tag de, density for primary star
!
      IF(kk == 100)THEN
         var(i)=density
      END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
      IF(kk == 8)THEN
         var(i)=bigi
      END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
      IF(kk == 1)THEN
         var(i)=bigbeta
      END IF
!
!  tag dp, ecosw, phase difference of secondary eclipse
!
      IF(kk == 111)THEN
         var(i)=ecosw
      END IF
!
!  tag te, temprat, temperature ratio star 2 to star 1
!
      IF(kk == 612)THEN
         var(i)=temprat
      END IF
!
!  tag pm, primmass, primary mass in solar masses
!
      IF(kk == 492)THEN
         var(i)=primmass
      END IF
!
!  tag pr, primrad, primary radius in solar masses
!
      IF(kk == 497)THEN
         var(i)=primrad
      END IF
!
!  tag pk, primK, K-velocity of primary in km/sec
!
      IF(kk == 490)THEN
         var(i)=primk
      END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
      IF(kk == 544)THEN
         var(i)=ratrad
      END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
      IF(kk == 1528)THEN
         var(i)=frac1
      END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
      IF(kk == 1529)THEN
         var(i)=frac2
      END IF
!
!  tag l1, alb1, star 1 albedo
!
      IF(kk == 1368)THEN
         var(i)=alb1
      END IF
!
!  tag l2, alb2, star 2 albedo
!
      IF(kk == 1369)THEN
         var(i)=alb2
      END IF
!
!  tag pe, period, binary period in days
!
      IF(kk == 484)THEN
         var(i)=period
      END IF
!
!  tag t0, T0, time of periastron passage of binary
!
      IF(kk == 1623)THEN
         var(i)=t0
      END IF
!
!  tag d1, temperature factor spot 1 on disk
!
      IF(kk == 1112)THEN
         var(i)=spotdparm(1,1)
      END IF
!
!  tag d5, temperature factor spot 2 on disk
!
      IF(kk == 1116)THEN
         var(i)=spotdparm(2,1)
      END IF
!
!  tag d2, azimuth spot 1 on disk
!
      IF(kk == 1113)THEN
         var(i)=spotdparm(1,2)
      END IF
!
!  tag d6, azimuth spot 2 on disk
!
      IF(kk == 1117)THEN
         var(i)=spotdparm(2,2)
      END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
      IF(kk == 1114)THEN
         var(i)=spotdparm(1,3)
      END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
      IF(kk == 1118)THEN
         var(i)=spotdparm(2,3)
      END IF
!
!  tag d4, angular width of spot 1 on disk
!
      IF(kk == 1115)THEN
         var(i)=spotdparm(1,4)
      END IF
!
!  tag d8, angular width of spot 2 on disk
!
      IF(kk == 1119)THEN
         var(i)=spotdparm(2,4)
      END IF
!
!  tag c1, temperature factor spot 1, star 2
!
      IF(kk == 1080)THEN
         var(i)=spot2parm(1,1)
      END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
      IF(kk == 1084)THEN
         var(i)=spot2parm(2,1)
      END IF
!
!  tag b1, temperature factor spot 1, star 1
!
      IF(kk == 1048)THEN
         var(i)=spot1parm(1,1)
      END IF
!
!  tag b5, temperature factor spot 2, star 1
!
      IF(kk == 1052)THEN
         var(i)=spot1parm(2,1)
      END IF
!
!  tag c2, latitude spot 1, star 2
!
      IF(kk == 1081)THEN
         var(i)=spot2parm(1,2)
      END IF
!
!  tag c6, latitude spot 2, star 2
!
      IF(kk == 1085)THEN
         var(i)=spot2parm(2,2)
      END IF
!
!  tag b2, latitude spot 1, star 1
!
      IF(kk == 1049)THEN
         var(i)=spot1parm(1,2)
      END IF
!
!  tag b6,  latitude spot 2, star 1
!
      IF(kk == 1053)THEN
         var(i)=spot1parm(2,2)
      END IF
!
!  tag c3, longitude spot 1, star 2
!
      IF(kk == 1082)THEN
         var(i)=spot2parm(1,3)
      END IF
!
!  tag c7, longitude spot 2, star 2
!
      IF(kk == 1086)THEN
         var(i)=spot2parm(2,3)
      END IF
!
!  tag b3, longitude spot 1, star 1
!
      IF(kk == 1050)THEN
         var(i)=spot1parm(1,3)
      END IF
!
!  tag b7, longitude spot 2, star 1
!
      IF(kk == 1054)THEN
         var(i)=spot1parm(2,3)
      END IF
!
!  tag c4, radius spot 1, star 2
!
      IF(kk == 1083)THEN
         var(i)=spot2parm(1,4)
      END IF
!
!  tag c8, radius spot 2, star 2
!
      IF(kk == 1087)THEN
         var(i)=spot2parm(2,4)
      END IF
!
!  tag b4, radius spot 1, star 1
!
      IF(kk == 1051)THEN
         var(i)=spot1parm(1,4)
      END IF
!
!  tag b8,  radius spot 2, star 1
!
      IF(kk == 1055)THEN
         var(i)=spot1parm(2,4)
      END IF
!
!  tag ps, pshift
!
      IF(kk == 498)THEN
         var(i)=pshift
      END IF
!
!  tag in, finc, inclination of binary
!
      IF(kk == 269)THEN
         var(i)=finc
      END IF
!
!  tag ma, Q, mass ratio of binary
!
      IF(kk == 384)THEN
         var(i)=q
      END IF
!
!  tag ec, ecc, eccentricity of binary
!
      IF(kk == 130)THEN
         var(i)=ecc
      END IF
!
!  tag ar, argper, argument of periastron of binary
!
      IF(kk == 17)THEN
         var(i)=argper
      END IF
!
!  tag f1, fill1, Roche lobe filling factor star 1
!
      IF(kk == 1176)THEN
         var(i)=fill1
      END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
      IF(kk == 552)THEN
         var(i)=rinner
      END IF
!
!  tag f2, fill 2, Roche lobe filling factor star 2
!
      IF(kk == 1177)THEN
         var(i)=fill2
      END IF
!
!  tag o1, omega1, spin rate of star 1
!
      IF(kk == 1464)THEN
         var(i)=omega1
      END IF
!
!  tag o2, omega2, spin rate of star 2
!
      IF(kk == 1465)THEN
         var(i)=omega2
      END IF
!
!  tag ro, router, outer radius of accretion disk
!
      IF(kk == 558)THEN
         var(i)=router
      END IF
!
!  tag td, Tdisk, temperature of inner disk
!
      IF(kk == 611)THEN
         var(i)=tdisk
      END IF
!
!  tag be, betarim, opening angle of disk
!
      IF(kk == 36)THEN
         var(i)=betarim
      END IF
!
!  tag t1, Teff1, temperature of star 1
!
      IF(kk == 1624)THEN
         var(i)=teff1
      END IF
!
!  tag t2, Teff2, temperature of star 2
!
      IF(kk == 1625)THEN
         var(i)=teff2
      END IF
!
!  tag xi, xi, power-law exponent on disk temperature profile
!
      IF(kk == 744)THEN
         var(i)=xi
      END IF
!
!  tag lx, rLx, log of the X-ray luminosity
!
      IF(kk == 375)THEN
         var(i)=rlx
      END IF
!
!  tag se, separ, binary semimajor axis
!
      IF(kk == 580)THEN
         var(i)=separ
      END IF
!
!  tag ga, gamma, gamma-velocity of binary
!
      IF(kk == 192)THEN
         var(i)=gamma
      END IF
!
!  tag t3, Teff3, temperature of star 3
!
      IF(kk == 1626)THEN
         var(i)=t3
      END IF
!
!  tag t4, Teff4, temperature of star 4
!
      IF(kk == 1627)THEN
         var(i)=sw80
      END IF
!
!  tag t5, Teff5, temperature of star 5
!
      IF(kk == 1628)THEN
         var(i)=sw81
      END IF
!
!  tag g3, g3, log(g) of star 3
!
      IF(kk == 1210)THEN
         var(i)=g3
      END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
      IF(kk == 576)THEN
         var(i)=sa3
      END IF
!
!   Here are the assignments for the limb darkening parameters.
!   use tags x1, x2, to x8 for the x-coefficient for star 1
!   and y1, y2, to y8 for the y-coefficient for star 1.
!
!   Use z1, z2, to z8 for the x-coefficient for star 2 and
!   use w1, w2, to w8 for the y-coefficient for star 2.
!
      IF(kk == 1752)var(i)=dwavex(1,1)
      IF(kk == 1753)var(i)=dwavex(2,1)
      IF(kk == 1754)var(i)=dwavex(3,1)
      IF(kk == 1755)var(i)=dwavex(4,1)
      IF(kk == 1756)var(i)=dwavex(5,1)
      IF(kk == 1757)var(i)=dwavex(6,1)
      IF(kk == 1758)var(i)=dwavex(7,1)
      IF(kk == 1759)var(i)=dwavex(8,1)
!
      IF(kk == 1784)var(i)=dwavey(1,1)
      IF(kk == 1785)var(i)=dwavey(2,1)
      IF(kk == 1786)var(i)=dwavey(3,1)
      IF(kk == 1787)var(i)=dwavey(4,1)
      IF(kk == 1788)var(i)=dwavey(5,1)
      IF(kk == 1789)var(i)=dwavey(6,1)
      IF(kk == 1790)var(i)=dwavey(7,1)
      IF(kk == 1791)var(i)=dwavey(8,1)
!
      IF(kk == 1816)var(i)=dwavex(1,2)
      IF(kk == 1817)var(i)=dwavex(2,2)
      IF(kk == 1818)var(i)=dwavex(3,2)
      IF(kk == 1819)var(i)=dwavex(4,2)
      IF(kk == 1820)var(i)=dwavex(5,2)
      IF(kk == 1821)var(i)=dwavex(6,2)
      IF(kk == 1822)var(i)=dwavex(7,2)
      IF(kk == 1823)var(i)=dwavex(8,2)
!
      IF(kk == 1720)var(i)=dwavey(1,2)
      IF(kk == 1721)var(i)=dwavey(2,2)
      IF(kk == 1722)var(i)=dwavey(3,2)
      IF(kk == 1723)var(i)=dwavey(4,2)
      IF(kk == 1724)var(i)=dwavey(5,2)
      IF(kk == 1725)var(i)=dwavey(6,2)
      IF(kk == 1726)var(i)=dwavey(7,2)
      IF(kk == 1727)var(i)=dwavey(8,2)
!
!   body 3 limb darkening, use tags m1 through m8
!   for the first coefficient, and tags n1 through
!   n8 for the second coefficient
!
      IF(kk == 1400)var(i)=dwavex(1,3)
      IF(kk == 1401)var(i)=dwavex(2,3)
      IF(kk == 1402)var(i)=dwavex(3,3)
      IF(kk == 1403)var(i)=dwavex(4,3)
      IF(kk == 1404)var(i)=dwavex(5,3)
      IF(kk == 1405)var(i)=dwavex(6,3)
      IF(kk == 1406)var(i)=dwavex(7,3)
      IF(kk == 1407)var(i)=dwavex(8,3)
!
      IF(kk == 1432)var(i)=dwavey(1,3)
      IF(kk == 1433)var(i)=dwavey(2,3)
      IF(kk == 1434)var(i)=dwavey(3,3)
      IF(kk == 1435)var(i)=dwavey(4,3)
      IF(kk == 1436)var(i)=dwavey(5,3)
      IF(kk == 1437)var(i)=dwavey(6,3)
      IF(kk == 1438)var(i)=dwavey(7,3)
      IF(kk == 1439)var(i)=dwavey(8,3)
!
!   body 4 limb darkening, use tags i1 through i8
!   for the first coefficient, and tags j1 through
!   j8 for the second coefficient
!
      IF(kk == 1272)var(i)=dwavex(1,4)
      IF(kk == 1273)var(i)=dwavex(2,4)
      IF(kk == 1274)var(i)=dwavex(3,4)
      IF(kk == 1275)var(i)=dwavex(4,4)
      IF(kk == 1276)var(i)=dwavex(5,4)
      IF(kk == 1277)var(i)=dwavex(6,4)
      IF(kk == 1278)var(i)=dwavex(7,4)
      IF(kk == 1279)var(i)=dwavex(8,4)
!
      IF(kk == 1304)var(i)=dwavey(1,4)
      IF(kk == 1305)var(i)=dwavey(2,4)
      IF(kk == 1306)var(i)=dwavey(3,4)
      IF(kk == 1307)var(i)=dwavey(4,4)
      IF(kk == 1308)var(i)=dwavey(5,4)
      IF(kk == 1309)var(i)=dwavey(6,4)
      IF(kk == 1310)var(i)=dwavey(7,4)
      IF(kk == 1311)var(i)=dwavey(8,4)
!
!   body 5 limb darkening, use tags k1 through k8
!   for the first coefficient, and tags p1 through
!   p8 for the second coefficient
!
      IF(kk == 1336)var(i)=dwavex(1,4)
      IF(kk == 1337)var(i)=dwavex(2,4)
      IF(kk == 1338)var(i)=dwavex(3,4)
      IF(kk == 1339)var(i)=dwavex(4,4)
      IF(kk == 1340)var(i)=dwavex(5,4)
      IF(kk == 1341)var(i)=dwavex(6,4)
      IF(kk == 1342)var(i)=dwavex(7,4)
      IF(kk == 1343)var(i)=dwavex(8,4)
!
      IF(kk == 1496)var(i)=dwavey(1,4)
      IF(kk == 1497)var(i)=dwavey(2,4)
      IF(kk == 1498)var(i)=dwavey(3,4)
      IF(kk == 1499)var(i)=dwavey(4,4)
      IF(kk == 1500)var(i)=dwavey(5,4)
      IF(kk == 1501)var(i)=dwavey(6,4)
      IF(kk == 1502)var(i)=dwavey(7,4)
      IF(kk == 1503)var(i)=dwavey(8,4)

   END DO
!
   RETURN
!
END SUBROUTINE varassign
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE wdiskobschi(ochidisk,nobv,sobv)
!
!  July 24, 2000
!
!  This routine will take the observed variables specified in the
!  gridloop.opt file and compute the additional chi^2 associated with
!  the disk fraction
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: ochidisk(8)
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: ii,icn,icnvrt,iwrite,ilength,lll
!
   CHARACTER(LEN=33) :: section,outstring
   CHARACTER(LEN=80) :: line
!
!   COMMON /medblock/ rmed
!
   iwrite=0
   ilength=0
!
   section='1234567890123456'
   section='                '
   line='  -->'
!
!   UPDATE May 27, 2002
!
!   If rmed > 1, then we are doing median fitting.  In that case, write
!   to a different format statement.
!
!   UPDATE October 27, 2008
!
!   Update this routine so that one can specify which filter the disk
!   fraction is, and also have the ability to specify two or more disk
!   fractions.
!
   DO  ii=1,nobv
      icn=icnvrt(sobv(ii)(1:2))
!
!  tags d1 or z1
!
      IF(icn == 1112.OR.icn == 1816)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Ufrac',ochidisk(1),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Ufrac',ochidisk(1),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d2 or z2
!
      IF(icn == 1113.OR.icn == 1817)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Bfrac',ochidisk(2),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Bfrac',ochidisk(2),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d3 or z3
!
      IF(icn == 1114.OR.icn == 1818)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Vfrac',ochidisk(3),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Vfrac',ochidisk(3),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d4 or z4
!
      IF(icn == 1115.OR.icn == 1819)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Rfrac',ochidisk(4),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Rfrac',ochidisk(4),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d5 or z5
!
      IF(icn == 1116.OR.icn == 1820)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Ifrac',ochidisk(5),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Ifrac',ochidisk(5),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d6 or z6
!
      IF(icn == 1117.OR.icn == 1821)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Jfrac',ochidisk(6),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Jfrac',ochidisk(6),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d7 or z7
!
      IF(icn == 1118.OR.icn == 1822)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Hfrac',ochidisk(7),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Hfrac',ochidisk(7),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags d8 or z8
!
      IF(icn == 1119.OR.icn == 1823)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' med_Kfrac',ochidisk(8),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring (' chi_Kfrac',ochidisk(8),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20) line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
   END DO
!
   IF(iwrite == 0)WRITE(*,20)line
!
20 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE wdiskobschi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE welcdata(ndatamax,ndata,xdata,ydata,errdata,  &
   fileout)
!
!  August 2, 2001
!
!  When the period and/or T0 is being fitted for,
!  the folded data files will be written.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: ndata
   REAL(KIND=dp), INTENT(IN)                :: xdata(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydata(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errdata(ndatamax)
   CHARACTER (LEN=*), INTENT(IN)            :: fileout
!
   INTEGER :: i
!
   OPEN(UNIT=51,FILE=fileout,STATUS='unknown')
!
   DO  i=1,ndata
      WRITE(51,20)xdata(i),ydata(i),errdata(i)
   END DO
!
   CLOSE(51)
!
20 FORMAT(f21.11,3X,f21.12,3X,f18.12)
!
   RETURN
!
END SUBROUTINE welcdata
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE wlrobschi(ochilr,ochilr3,ochilr4,sobv)
!
!  July 24, 2000
!
!  This routine will take the observed variables specified in the
!  gridloop.opt file associated with luminosity ratios and print
!  the additional chi^2
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: ochilr
   REAL(KIND=dp), INTENT(IN)                :: ochilr3
   REAL(KIND=dp), INTENT(IN)                :: ochilr4
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: ilength,iwrite,i,icn,icnvrt,lll
!
   CHARACTER(LEN=36) :: section,outstring
   CHARACTER(LEN=80) :: line
!
!   COMMON /medblock/ rmed
!
   ilength=0
   iwrite=0
!
   section='1234567890123456'
   section='                '
   line='  -->'
!
!   If rmed > 1, then we are doing median fitting.  In that case, write
!   to a different format statement.
!
   DO i=1,19   !Nvmax
      icn=icnvrt(sobv(i)(1:2))
!
!  tag lr, secondary to primary luminosity ratio
!
      IF(icn == 369)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med(lumrat2-1)',ochilr,outstring,lll)
            ilength=ilength+lll
            section=outstring
         ELSE
            CALL chistring(' chi(lumrat2-1)',ochilr,outstring,lll)
            ilength=ilength+lll
            section=outstring
         END IF
         line=TRIM(line)//section
         iwrite=100
      END IF
!
!  tag l3, body 3 to primary luminosity ratio
!
      IF(icn == 1370)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med(lumrat3-1)',ochilr3,outstring,lll)
            ilength=ilength+lll
            section=outstring
         ELSE
            CALL chistring(' chi(lumrat3-1)',ochilr3,outstring,lll)
            ilength=ilength+lll
            section=outstring
         END IF
         line=TRIM(line)//section
         iwrite=100
      END IF
!
!  tag l4, body 4 to primary luminosity ratio
!
      IF(icn == 1371)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med(lumrat4-1)',ochilr4,outstring,lll)
            ilength=ilength+lll
            section=outstring
         ELSE
            CALL chistring(' chi(lumrat4-1)',ochilr4,outstring,lll)
            ilength=ilength+lll
            section=outstring
         END IF
         line=TRIM(line)//section
         iwrite=100
      END IF
!
   END DO
!
   IF(iwrite /= 0)WRITE(*,10)line
!
10 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE wlrobschi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE wlumratobschi(ochilumrat,nobv,sobv)
!
!  July 24, 2000
!
!  This routine will take the observed variables specified in the
!  gridloop.opt file and compute the additional chi^2 associated with
!  the flux ratios
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: ochilumrat(8)
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(19)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: ii,icn,icnvrt,iwrite,ilength,lll
!
   CHARACTER(LEN=33) :: section,outstring
   CHARACTER(LEN=80) :: line
!
!   COMMON /medblock/ rmed
!
   iwrite=0
   ilength=0
!
   section='1234567890123456'
   section='                '
   line='  -->'
!
!   UPDATE May 27, 2002
!
!   If rmed > 1, then we are doing median fitting.  In that case, write
!   to a different format statement.
!
!   UPDATE October 27, 2008
!
!   Update this routine so that one can specify which filter the lumrat
!   fraction is, and also have the ability to specify two or more lumrat
!   fractions.
!
   DO  ii=1,nobv
      icn=icnvrt(sobv(ii)(1:2))
!
!  tags 12 or 1u
!
      IF(icn == 4529.OR.icn == 3532)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Ulumrat',ochilumrat(1),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Ulumrat',ochilumrat(1),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 22 or 2u
!
      IF(icn == 4561.OR.icn == 3564)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Blumrat',ochilumrat(2),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Blumrat',ochilumrat(2),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 32 or 3u
!
      IF(icn == 4593.OR.icn == 3596)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Vlumrat',ochilumrat(3),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Vlumrat',ochilumrat(3),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 42 or 4u
!
      IF(icn == 4625.OR.icn == 3628)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Rlumrat',ochilumrat(4),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Rlumrat',ochilumrat(4),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 52 or 5u
!
      IF(icn == 4657.OR.icn == 3660)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Ilumrat',ochilumrat(5),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Ilumrat',ochilumrat(5),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 62 or 6u
!
      IF(icn == 4689.OR.icn == 3692)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Jlumrat',ochilumrat(6),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Jlumrat',ochilumrat(6),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 72 or 7u
!
      IF(icn == 4721.OR.icn == 3724)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Hlumrat',ochilumrat(7),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Hlumrat',ochilumrat(7),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
!  tags 82 or 8u
!
      IF(icn == 4753.OR.icn == 3756)THEN
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' med_Klumrat',ochilumrat(8),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         ELSE
            CALL chistring(' chi_Klumrat',ochilumrat(8),outstring,lll)
            ilength=ilength+lll
            section=outstring
            iwrite=0
         END IF
         line=TRIM(line)//section
         IF(ilength >= 55)THEN
            WRITE(*,20)line
            iwrite=100
            ilength=0
            line='  -->'
         END IF
      END IF
!
   END DO
!
   IF(iwrite == 0)WRITE(*,20)line
!
20 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE wlumratobschi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE wobschi(nobv,sobv,obv,eobv,obsparm,ochi)
!
!  July 24, 2000
!
!  This routine will take the observed variables specified in the
!  gridloop.opt file and compute the additional chi^2
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nobv
   CHARACTER (LEN=40), INTENT(IN)           :: sobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obv(25)
   REAL(KIND=dp), INTENT(IN)                :: eobv(25)
   REAL(KIND=dp), INTENT(IN)                :: obsparm(25)
   REAL(KIND=dp), INTENT(OUT)               :: ochi
!
   REAL(KIND=dp)  :: chisq  !,rmed
!
   INTEGER :: iline,iwrite,ilength,i,icn,icnvrt,index,lll
!
   CHARACTER(LEN=30) :: section(25),outstring
   CHARACTER(LEN=80) :: line
!
!   COMMON /medblock/ rmed
!
   iline=0
   iwrite=0
   ilength=0
!
   DO  i=1,10
      section(i)='12345678901234567890123456789'
      section(i)='                             '
   END DO
   line='  -->'
!
   ochi=0.0_dp
   DO  i=1,nobv
!
      icn=icnvrt(sobv(i)(1:2))
!
!   Escape if icn=104 (disk fraction requested).
!
      IF(icn == 104)CYCLE
!
!   Escape if icn=369 (luminosity ratio requested).
!
      IF(icn == 369)CYCLE
!
!   Put an escape if one of the variables is not valid.
!
      index=-1
!
!  tag m1, mass of star 1 in solar masses
!
      IF(icn == 1400)index=1
!
!  tag m2, mass of star 2 in solar masses
!
      IF(icn == 1401)index=5
!
!  tag r1, radius of star 1 in solar radii
!
      IF(icn == 1560)index=2
!
!  tag r2, radius of star 2 in solar radii
!
      IF(icn == 1561)index=6
!
!  tag g1, gravity of star 1 (log(g) in cgs)
!
      IF(icn == 1208)index=3
!
!  tag k1, K-velocity of star 1 in km/sec
!
      IF(icn == 1336)index=10
!
!  tag k2, K-velocity of star 2 in km/sec
!
      IF(icn == 1337)index=11
!
!  tag in, inclination of binary in degrees
!
      IF(icn == 269)index=12
!
!  tag ma, mass ratio of binary
!
      IF(icn == 384)index=13
!
!  tag ec, eccentricity of binary
!
      IF(icn == 130)index=14
!
!  tag ar, argument of periastron of binary
!
      IF(icn == 17)index=15
!
!  tag t1, Teff1, effective temperature of star 1
!
      IF(icn == 1624)index=16
!
!  tag t2, Teff2, effective temperature of star 2
!
      IF(icn == 1625)index=17
!
!  tag t3, Teff3, effective temperature of star 3
!
      IF(icn == 1626)index=19
!
!   tag su, the fractional sum of radii
!
      IF(icn == 596)index=18
!
!  tag g2, gravity of star 2 (log(g) in cgs)
!
      IF(icn == 1209)index=7
!
!  tag v1, Vrot1, rotational velocity of star 1 in km/sec
!
      IF(icn == 1688)index=4
!
!  tag v2, Vrot2, rotational velocity of star 2 in km/sec
!
      IF(icn == 1689)index=8
!
!   Here is the escape.
!
      IF(index < 0)CYCLE
!
!   If the variable rmed > 1, then define chisq as the absolute
!   deviation, rather than the normal chi^2.
!
!   If the observed duration of the X-ray eclipse is negative, then
!   the number is meant as an upper limit.  That is, if obv = -10.0,
!   then the eclipse duration is less than 10 degrees.
!
      IF(index == 9)THEN
         IF(obv(i) < 0.0_dp)THEN
!
!   Here is the case where the upper limit is less than the computed
!   eclipse duration.
!
            IF(ABS(obv(i)) > obsparm(index))THEN
               chisq=0.0_dp
               iline=iline+1
               GO TO 20
            ELSE
               IF(rmed >= 1.0_dp)THEN
                  chisq=ABS((ABS(obv(i))-obsparm(index))/(eobv(i)))
               ELSE
                  chisq=(ABS(obv(i))-obsparm(index))*(ABS(obv(i))-  &
                     obsparm(index))/(eobv(i)*eobv(i))
               END IF
               iline=iline+1
               GO TO 20
            END IF
         ELSE
            IF(rmed >= 1.0_dp)THEN
               chisq=ABS((ABS(obv(i))-obsparm(index))/(eobv(i)))
            ELSE
               chisq=(ABS(obv(i))-obsparm(index))*(ABS(obv(i))-  &
                  obsparm(index))/(eobv(i)*eobv(i))
            END IF
            iline=iline+1
            GO TO 20
         END IF
      END IF
!
      IF(rmed >= 1.0_dp)THEN
         chisq=ABS((obv(i)-obsparm(index))/(eobv(i)))
      ELSE
         chisq=(obv(i)-obsparm(index))*(obv(i)-obsparm(index))/(eobv(i)*eobv(i))
      END IF
      iline=iline+1
!
!   If the variable rmed > 1, then define chisq as the absolute
!   deviation, rather than the normal chi^2.  In that case, write
!   using different format statements.
!
20    IF(rmed >= 1.0_dp)THEN
         IF(index == 1)THEN
            CALL chistring(' med(m1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 2)THEN
            CALL chistring(' med(r1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 3)THEN
            CALL chistring(' med(g1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 4)THEN
            CALL chistring(' med(v1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 5)THEN
            CALL chistring(' med(m2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 6)THEN
            CALL chistring(' med(r2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 7)THEN
            CALL chistring(' med(g2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 8)THEN
            CALL chistring(' med(v2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 9)THEN
            CALL chistring(' med(duras)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 10)THEN
            CALL chistring(' med(k1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 11)THEN
            CALL chistring(' med(k2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 12)THEN
            CALL chistring(' med(incl)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 13)THEN
            CALL chistring(' med(Q)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 14)THEN
            CALL chistring(' med(ecc)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 15)THEN
            CALL chistring(' med(arg)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 16)THEN
            CALL chistring(' med(t1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 17)THEN
            CALL chistring(' med(t2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 18)THEN
            CALL chistring(' med(sum)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 19)THEN
            CALL chistring(' med(t3)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
      ELSE
         IF(index == 1)THEN
            CALL chistring(' chi(m1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 2)THEN
            CALL chistring(' chi(r1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 3)THEN
            CALL chistring(' chi(g1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 4)THEN
            CALL chistring(' chi(v1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 5)THEN
            CALL chistring(' chi(m2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 6)THEN
            CALL chistring(' chi(r2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 7)THEN
            CALL chistring(' chi(g2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 8)THEN
            CALL chistring(' chi(v2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 9)THEN
            CALL chistring(' chi(duras)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 10)THEN
            CALL chistring(' chi(k1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 11)THEN
            CALL chistring(' chi(k2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 12)THEN
            CALL chistring(' chi(inc)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 13)THEN
            CALL chistring(' chi(Q)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 14)THEN
            CALL chistring(' chi(ecc)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 15)THEN
            CALL chistring(' chi(arg)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 16)THEN
            CALL chistring(' chi(t1)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 17)THEN
            CALL chistring(' chi(t2)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 18)THEN
            CALL chistring(' chi(sum)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
         IF(index == 19)THEN
            CALL chistring(' chi(t3)',chisq,outstring,lll)
            ilength=ilength+lll
            section(iline)=outstring
            iwrite=0
         END IF
      END IF
!
      line=TRIM(line)//section(iline)
      ochi=ochi+chisq
      IF(ilength >= 55)THEN
         WRITE(*,40)line
         iwrite=100
         iline=0
         ilength=0
         line='  -->'
      END IF
!
   END DO
!
   IF(iline > 0.AND.iwrite == 0)WRITE(*,40)line
!
40 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE wobschi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writebody3grid(nalph3,nbet3,tertperiod,tertt0,  &
   tertecos,tertesin,tertincl,tertomega,tertq,dwavex,dwavey,  &
   itconj,it1,it2,it3,it4,tertconj,tertratrad,hh,sw72,sw73,  &
   p2tconj,p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,  &
   p2ratrad,p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,  &
   p3q,p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,  &
   p4omega,p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,  &
   p5incl,p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,  &
   p6esin,p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,  &
   p7ecos,p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,  &
   p8t0,p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad)
!
!    will write the correctly formatted file ELCbody3.inp and return
!    default parameters
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nalph3
   INTEGER, INTENT(IN)                      :: nbet3
   REAL(KIND=dp), INTENT(IN)                :: tertperiod
   REAL(KIND=dp), INTENT(IN)                :: tertt0
   REAL(KIND=dp), INTENT(IN)                :: tertecos
   REAL(KIND=dp), INTENT(IN)                :: tertesin
   REAL(KIND=dp), INTENT(IN)                :: tertincl
   REAL(KIND=dp), INTENT(IN)                :: tertomega
   REAL(KIND=dp), INTENT(IN)                :: tertq
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   INTEGER, INTENT(IN)                      :: itconj
   INTEGER, INTENT(IN)                      :: it1
   INTEGER, INTENT(IN)                      :: it2
   INTEGER, INTENT(IN)                      :: it3
   INTEGER, INTENT(IN)                      :: it4
   REAL(KIND=dp), INTENT(IN)                :: tertconj
   REAL(KIND=dp), INTENT(IN)                :: tertratrad
   REAL(KIND=dp), INTENT(IN)                :: hh
   REAL(KIND=dp), INTENT(IN)                :: sw72
   REAL(KIND=dp), INTENT(IN)                :: sw73
   REAL(KIND=dp), INTENT(IN)                :: p2tconj
   REAL(KIND=dp), INTENT(IN)                :: p2period
   REAL(KIND=dp), INTENT(IN)                :: p2t0
   REAL(KIND=dp), INTENT(IN)                :: p2ecos
   REAL(KIND=dp), INTENT(IN)                :: p2esin
   REAL(KIND=dp), INTENT(IN)                :: p2incl
   REAL(KIND=dp), INTENT(IN)                :: p2omega
   REAL(KIND=dp), INTENT(IN)                :: p2q
   REAL(KIND=dp), INTENT(IN)                :: p2ratrad
   REAL(KIND=dp), INTENT(IN)                :: p3tconj
   REAL(KIND=dp), INTENT(IN)                :: p3period
   REAL(KIND=dp), INTENT(IN)                :: p3t0
   REAL(KIND=dp), INTENT(IN)                :: p3ecos
   REAL(KIND=dp), INTENT(IN)                :: p3esin
   REAL(KIND=dp), INTENT(IN)                :: p3incl
   REAL(KIND=dp), INTENT(IN)                :: p3omega
   REAL(KIND=dp), INTENT(IN)                :: p3q
   REAL(KIND=dp), INTENT(IN)                :: p3ratrad
   REAL(KIND=dp), INTENT(IN)                :: p4tconj
   REAL(KIND=dp), INTENT(IN)                :: p4period
   REAL(KIND=dp), INTENT(IN)                :: p4t0
   REAL(KIND=dp), INTENT(IN)                :: p4ecos
   REAL(KIND=dp), INTENT(IN)                :: p4esin
   REAL(KIND=dp), INTENT(IN)                :: p4incl
   REAL(KIND=dp), INTENT(IN)                :: p4omega
   REAL(KIND=dp), INTENT(IN)                :: p4q
   REAL(KIND=dp), INTENT(IN)                :: p4ratrad
   REAL(KIND=dp), INTENT(IN)                :: p5tconj
   REAL(KIND=dp), INTENT(IN)                :: p5period
   REAL(KIND=dp), INTENT(IN)                :: p5t0
   REAL(KIND=dp), INTENT(IN)                :: p5ecos
   REAL(KIND=dp), INTENT(IN)                :: p5esin
   REAL(KIND=dp), INTENT(IN)                :: p5incl
   REAL(KIND=dp), INTENT(IN)                :: p5omega
   REAL(KIND=dp), INTENT(IN)                :: p5q
   REAL(KIND=dp), INTENT(IN)                :: p5ratrad
   REAL(KIND=dp), INTENT(IN)                :: p6tconj
   REAL(KIND=dp), INTENT(IN)                :: p6period
   REAL(KIND=dp), INTENT(IN)                :: p6t0
   REAL(KIND=dp), INTENT(IN)                :: p6ecos
   REAL(KIND=dp), INTENT(IN)                :: p6esin
   REAL(KIND=dp), INTENT(IN)                :: p6incl
   REAL(KIND=dp), INTENT(IN)                :: p6omega
   REAL(KIND=dp), INTENT(IN)                :: p6q
   REAL(KIND=dp), INTENT(IN)                :: p6ratrad
   REAL(KIND=dp), INTENT(IN)                :: p7tconj
   REAL(KIND=dp), INTENT(IN)                :: p7period
   REAL(KIND=dp), INTENT(IN)                :: p7t0
   REAL(KIND=dp), INTENT(IN)                :: p7ecos
   REAL(KIND=dp), INTENT(IN)                :: p7esin
   REAL(KIND=dp), INTENT(IN)                :: p7incl
   REAL(KIND=dp), INTENT(IN)                :: p7omega
   REAL(KIND=dp), INTENT(IN)                :: p7q
   REAL(KIND=dp), INTENT(IN)                :: p7ratrad
   REAL(KIND=dp), INTENT(IN)                :: p8tconj
   REAL(KIND=dp), INTENT(IN)                :: p8period
   REAL(KIND=dp), INTENT(IN)                :: p8t0
   REAL(KIND=dp), INTENT(IN)                :: p8ecos
   REAL(KIND=dp), INTENT(IN)                :: p8esin
   REAL(KIND=dp), INTENT(IN)                :: p8incl
   REAL(KIND=dp), INTENT(IN)                :: p8omega
   REAL(KIND=dp), INTENT(IN)                :: p8q
   REAL(KIND=dp), INTENT(IN)                :: p8ratrad
!
   OPEN(UNIT=1,FILE='gridELCbody3.inp',STATUS='unknown')
!
   WRITE(1,10)nalph3
   WRITE(1,20)nbet3
   WRITE(1,30)itconj
   WRITE(1,40)it1
   WRITE(1,50)it2
   WRITE(1,60)it3
   WRITE(1,70)it4
   WRITE(1,80)tertconj
   WRITE(1,130)tertperiod
   WRITE(1,140)tertt0
   WRITE(1,150)tertecos
   WRITE(1,160)tertesin
   WRITE(1,170)tertincl
   WRITE(1,180)tertomega
   WRITE(1,190)tertq
   WRITE(1,200)dwavex(1,3),dwavey(1,3)
   WRITE(1,210)dwavex(2,3),dwavey(2,3)
   WRITE(1,220)dwavex(3,3),dwavey(3,3)
   WRITE(1,230)dwavex(4,3),dwavey(4,3)
   WRITE(1,240)dwavex(5,3),dwavey(5,3)
   WRITE(1,250)dwavex(6,3),dwavey(6,3)
   WRITE(1,260)dwavex(7,3),dwavey(7,3)
   WRITE(1,270)dwavex(8,3),dwavey(8,3)
   WRITE(1,90)tertratrad
   WRITE(1,100)hh
   WRITE(1,110)sw72
   WRITE(1,120)sw73
   WRITE(1,280)p2tconj
   WRITE(1,290)p2period
   WRITE(1,300)p2t0
   WRITE(1,310)p2ecos
   WRITE(1,320)p2esin
   WRITE(1,330)p2incl
   WRITE(1,340)p2omega
   WRITE(1,350)p2q
   WRITE(1,360)p2ratrad
   WRITE(1,370)p3tconj
   WRITE(1,380)p3period
   WRITE(1,390)p3t0
   WRITE(1,400)p3ecos
   WRITE(1,410)p3esin
   WRITE(1,420)p3incl
   WRITE(1,430)p3omega
   WRITE(1,440)p3q
   WRITE(1,450)p3ratrad
   WRITE(1,460)p4tconj
   WRITE(1,470)p4period
   WRITE(1,480)p4t0
   WRITE(1,490)p4ecos
   WRITE(1,500)p4esin
   WRITE(1,510)p4incl
   WRITE(1,520)p4omega
   WRITE(1,530)p4q
   WRITE(1,540)p4ratrad
   WRITE(1,550)p5tconj
   WRITE(1,560)p5period
   WRITE(1,570)p5t0
   WRITE(1,580)p5ecos
   WRITE(1,590)p5esin
   WRITE(1,600)p5incl
   WRITE(1,610)p5omega
   WRITE(1,620)p5q
   WRITE(1,630)p5ratrad
   WRITE(1,640)p6tconj
   WRITE(1,650)p6period
   WRITE(1,660)p6t0
   WRITE(1,670)p6ecos
   WRITE(1,680)p6esin
   WRITE(1,690)p6incl
   WRITE(1,700)p6omega
   WRITE(1,710)p6q
   WRITE(1,720)p6ratrad
   WRITE(1,730)p7tconj
   WRITE(1,740)p7period
   WRITE(1,750)p7t0
   WRITE(1,760)p7ecos
   WRITE(1,770)p7esin
   WRITE(1,780)p7incl
   WRITE(1,790)p7omega
   WRITE(1,800)p7q
   WRITE(1,810)p7ratrad
   WRITE(1,820)p8tconj
   WRITE(1,830)p8period
   WRITE(1,840)p8t0
   WRITE(1,850)p8ecos
   WRITE(1,860)p8esin
   WRITE(1,870)p8incl
   WRITE(1,880)p8omega
   WRITE(1,890)p8q
   WRITE(1,900)p8ratrad
   WRITE(1,910)dwavex(1,4),dwavey(1,4)
   WRITE(1,920)dwavex(2,4),dwavey(2,4)
   WRITE(1,930)dwavex(3,4),dwavey(3,4)
   WRITE(1,940)dwavex(4,4),dwavey(4,4)
   WRITE(1,950)dwavex(5,4),dwavey(5,4)
   WRITE(1,960)dwavex(6,4),dwavey(6,4)
   WRITE(1,970)dwavex(7,4),dwavey(7,4)
   WRITE(1,980)dwavex(8,4),dwavey(8,4)
   WRITE(1,990)dwavex(1,5),dwavey(1,5)
   WRITE(1,1000)dwavex(2,5),dwavey(2,5)
   WRITE(1,1010)dwavex(3,5),dwavey(3,5)
   WRITE(1,1020)dwavex(4,5),dwavey(4,5)
   WRITE(1,1030)dwavex(5,5),dwavey(5,5)
   WRITE(1,1040)dwavex(6,5),dwavey(6,5)
   WRITE(1,1050)dwavex(7,5),dwavey(7,5)
   WRITE(1,1060)dwavex(8,5),dwavey(8,5)
!
   CLOSE(1)
!
10 FORMAT(i4,21X,'Nalph3')
20 FORMAT(i4,21X,'Nbet3')
30 FORMAT(i1,24X,'itconj (0=T_peri, 1=T_tran, 2=T_occul)')
40 FORMAT(i1,24X,'set to 1 for logarithmic mass ratios')
50 FORMAT(i1,24X,'set to 1 for informational output')
60 FORMAT(i1,24X,'set to 1 to treat transits and ','occultations'  &
      ,' together')
70 FORMAT(i1,24X,'set to 1 to supress demcmcELC output files')
80 FORMAT(f21.13,4X,'tertconj             tag tj')
90 FORMAT(f19.13,6X,'tertratrad (P1 radius to star 1 radius,''T'  &
      ,'ag tb)')
100 FORMAT(f16.8,9X,'hh (step size for dynamical integration)')
110 FORMAT(f10.8,15X,'rk1  (apsidal constant, star 1   tag a1)')
120 FORMAT(f10.8,15X,'rk2  (apsidal constant, star 2   tag a2)')

130 FORMAT(f22.14,3X,'tertperiod (days)    tag tt')
140 FORMAT(f21.13,4X,'tertT0               tag tu')
150 FORMAT(f20.17,5X,'terte*cos(omega)     tag tv')
160 FORMAT(f20.17,5X,'terte*sin(omega)     tag tw')
170 FORMAT(f20.15,5X,'tertincl (degrees)   tag tx')
180 FORMAT(f20.15,5X,'tertOmega (degrees)  tag ty')
190 FORMAT(f23.11,2X,'tertQ (EB/body3)     tag tz')
200 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 1',  &
      ' body 3')
210 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 2',  &
      ' body 3')
220 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 3',  &
      ' body 3')
230 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 4',  &
      ' body 3')
240 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 5',  &
      ' body 3')
250 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 6',  &
      ' body 3')
260 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 7',  &
      ' body 3')
270 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 8',  &
      ' body 3')
280 FORMAT(f18.11,7X,'P2tconj              tag uj')
290 FORMAT(f22.14,3X,'P2period (days)      tag ut')
300 FORMAT(f21.13,4X,'P2T0                 tag uu')
310 FORMAT(f20.17,5X,'P2ecos               tag uv')
320 FORMAT(f20.17,5X,'P2esin               tag uw')
330 FORMAT(f20.15,5X,'P2incl (degrees)     tag ux')
340 FORMAT(f20.15,5X,'P2Omega (degrees)    tag uy')
350 FORMAT(f23.11,2X,'P2Q (EB/body3)       tag uz')
360 FORMAT(f18.11,7X,'P2ratrad             tag ub')
370 FORMAT(f18.11,7X,'P3tconj              tag vj')
380 FORMAT(f22.14,3X,'P3period (days)      tag vt')
390 FORMAT(f21.13,4X,'P3T0                 tag vu')
400 FORMAT(f20.17,5X,'P3ecos               tag vv')
410 FORMAT(f20.17,5X,'P3esin               tag vw')
420 FORMAT(f20.15,5X,'P3incl (degrees)     tag vx')
430 FORMAT(f20.15,5X,'P3Omega (degrees)    tag vy')
440 FORMAT(f23.11,2X,'P3Q (EB/body3)       tag vz')
450 FORMAT(f18.11,7X,'P3ratrad             tag vb')
460 FORMAT(f18.11,7X,'P4tconj              tag wj')
470 FORMAT(f22.14,3X,'P4period (days)      tag wt')
480 FORMAT(f21.13,4X,'P4T0                 tag wu')
490 FORMAT(f20.17,5X,'P4ecos               tag wv')
500 FORMAT(f20.17,5X,'P4esin               tag ww')
510 FORMAT(f20.15,5X,'P4incl (degrees)     tag wx')
520 FORMAT(f20.15,5X,'P4Omega (degrees)    tag wy')
530 FORMAT(f23.11,2X,'P4Q (EB/body3)       tag wz')
540 FORMAT(f18.11,7X,'P4ratrad             tag wb')
550 FORMAT(f18.11,7X,'P5tconj              tag xj')
560 FORMAT(f22.14,3X,'P5period (days)      tag xt')
570 FORMAT(f21.13,4X,'P5T0                 tag xu')
580 FORMAT(f20.17,5X,'P5ecos               tag xv')
590 FORMAT(f20.17,5X,'P5esin               tag xw')
600 FORMAT(f20.15,5X,'P5incl (degrees)     tag xx')
610 FORMAT(f20.15,5X,'P5Omega (degrees)    tag xy')
620 FORMAT(f23.11,2X,'P5Q (EB/body3)       tag xz')
630 FORMAT(f18.11,7X,'P5ratrad             tag xb')
640 FORMAT(f18.11,7X,'P6tconj              tag sj')
650 FORMAT(f22.14,3X,'P6period (days)      tag st')
660 FORMAT(f21.13,4X,'P6T0                 tag su')
670 FORMAT(f20.17,5X,'P6ecos               tag sv')
680 FORMAT(f20.17,5X,'P6esin               tag sw')
690 FORMAT(f20.15,5X,'P6incl (degrees)     tag sx')
700 FORMAT(f20.15,5X,'P6Omega (degrees)    tag sy')
710 FORMAT(f23.11,2X,'P6Q (EB/body3)       tag sz')
720 FORMAT(f18.11,7X,'P6ratrad             tag sb')
730 FORMAT(f18.11,7X,'P7tconj              tag hj')
740 FORMAT(f22.14,3X,'P7period (days)      tag ht')
750 FORMAT(f21.13,4X,'P7T0                 tag hu')
760 FORMAT(f20.17,5X,'P7ecos               tag hv')
770 FORMAT(f20.17,5X,'P7esin               tag hw')
780 FORMAT(f20.15,5X,'P7incl (degrees)     tag hx')
790 FORMAT(f20.15,5X,'P7Omega (degrees)    tag hy')
800 FORMAT(f23.11,2X,'P7Q (EB/body3)       tag hz')
810 FORMAT(f18.11,7X,'P7ratrad             tag hb')
820 FORMAT(f18.11,7X,'P8tconj              tag kj')
830 FORMAT(f22.14,3X,'P8period (days)      tag kt')
840 FORMAT(f21.13,4X,'P8T0                 tag ku')
850 FORMAT(f20.17,5X,'P8ecos               tag kv')
860 FORMAT(f20.17,5X,'P8esin               tag kw')
870 FORMAT(f20.15,5X,'P8incl (degrees)     tag kx')
880 FORMAT(f20.15,5X,'P8Omega (degrees)    tag ky')
890 FORMAT(f23.11,2X,'P8Q (EB/body3)       tag kz')
900 FORMAT(f18.11,7X,'P8ratrad             tag kb')
910 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 1',  &
      ' body 4')
920 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 2',  &
      ' body 4')
930 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 3',  &
      ' body 4')
940 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 4',  &
      ' body 4')
950 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 5',  &
      ' body 4')
960 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 6',  &
      ' body 4')
970 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 7',  &
      ' body 4')
980 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 8',  &
      ' body 4')
990 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 1',  &
      ' body 5')
1000 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 2',  &
      ' body 5')
1010 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 3',  &
      ' body 5')
1020 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 4',  &
      ' body 5')
1030 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 5',  &
      ' body 5')
1040 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 6',  &
      ' body 5')
1050 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 7',  &
      ' body 5')
1060 FORMAT(2(f11.7,1X),1X,'limb darkening coefficients filter 8',  &
      ' body 5')
!
   RETURN
!
END SUBROUTINE writebody3grid
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writebound(nvarmax,svar,nn,varx,vstart,vstep,  &
   isw29)
!
!   December 8, 2018
!
!   Routine for printing out-of-bounds messages for simplexELC
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvarmax
   CHARACTER(LEN=40), INTENT(IN)            :: svar(nvarmax)
   INTEGER, INTENT(IN)                      :: nn
   REAL(KIND=dp), INTENT(IN)                :: varx
   REAL(KIND=dp), INTENT(IN)                :: vstart(nvarmax)
   REAL(KIND=dp), INTENT(IN)                :: vstep(nvarmax)
   INTEGER, INTENT(IN)                      :: isw29
!
   REAL(KIND=dp)  :: varxtemp
!
   INTEGER :: kk,icnvrt,lll,lll1,lll2
!
   CHARACTER (LEN=30) :: outstring,outstring1,outstring2,outstring3
!
!   figure out which variable is being fitted for
!
   kk=icnvrt(svar(nn)(1:2))
!
!  tag ct, tesscontam
!
   IF(kk == 83)THEN
      outstring3=' tesscontam'
   END IF
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
   IF(kk == 48)THEN
      outstring3=' binqTc'
   END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
   IF(kk == 3528)THEN
      outstring3=' P1qTc'
   END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
   IF(kk == 3560)THEN
      outstring3=' P2qTc'
   END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
   IF(kk == 3592)THEN
      outstring3=' P3qTc'
   END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
   IF(kk == 3624)THEN
      outstring3=' P4qTc'
   END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
   IF(kk == 3656)THEN
      outstring3=' P5qTc'
   END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
   IF(kk == 3688)THEN
      outstring3=' P6qTc'
   END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
   IF(kk == 3720)THEN
      outstring3=' P7qTc'
   END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
   IF(kk == 3752)THEN
      outstring3=' P8qTc'
   END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
   IF(kk == 51)THEN
      outstring3=' Tbinoff'
   END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
   IF(kk == 3531)THEN
      outstring3=' T1off'
   END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
   IF(kk == 3563)THEN
      outstring3=' T2off'
   END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
   IF(kk == 3595)THEN
      outstring3=' T3off'
   END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
   IF(kk == 3627)THEN
      outstring3=' T4off'
   END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
   IF(kk == 3659)THEN
      outstring3=' T5off'
   END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
   IF(kk == 3691)THEN
      outstring3=' T6off'
   END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
   IF(kk == 3723)THEN
      outstring3=' T7off'
   END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
   IF(kk == 3755)THEN
      outstring3=' T8off'
   END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
   IF(kk == 581)THEN
      outstring3=' fillsum'
   END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
   IF(kk == 579)THEN
      outstring3=' filldiff'
   END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
   IF(kk == 3512)THEN
      outstring3=' angsum1'
   END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
   IF(kk == 3544)THEN
      outstring3=' angsum2'
   END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
   IF(kk == 3576)THEN
      outstring3=' angsum3'
   END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
   IF(kk == 3608)THEN
      outstring3=' angsum4'
   END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
   IF(kk == 3640)THEN
      outstring3=' angsum5'
   END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
   IF(kk == 3672)THEN
      outstring3=' angsum6'
   END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
   IF(kk == 3704)THEN
      outstring3=' angsum7'
   END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
   IF(kk == 3736)THEN
      outstring3=' angsum8'
   END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
   IF(kk == 3515)THEN
      outstring3=' angdiff1'
   END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
   IF(kk == 3547)THEN
      outstring3=' angdiff2'
   END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
   IF(kk == 3579)THEN
      outstring3=' angdiff3'
   END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
   IF(kk == 3611)THEN
      outstring3=' angdiff4'
   END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
   IF(kk == 3643)THEN
      outstring3=' angdiff5'
   END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
   IF(kk == 3675)THEN
      outstring3=' angdiff6'
   END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
   IF(kk == 3707)THEN
      outstring3=' angdiff7'
   END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
   IF(kk == 3739)THEN
      outstring3=' angdiff8'
   END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
   IF(kk == 178)THEN
      outstring3=' fracsum'
   END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
   IF(kk == 163)THEN
      outstring3=' fracdiff'
   END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
   IF(kk == 4790)THEN
      outstring3=' bin2M3'
   END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
   IF(kk == 4791)THEN
      outstring3=' bin2M4'
   END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 50)THEN
      outstring3=' sqrt(e)sin(omega)'
   END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
   IF(kk == 34)THEN
      outstring3=' sqrt(e)cos(omega)'
   END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3530)THEN
      outstring3=' sqP1esin'
   END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
   IF(kk == 3514)THEN
      outstring3=' sqP1ecos'
   END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3562)THEN
      outstring3=' sqP2esin'
   END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
   IF(kk == 3546)THEN
      outstring3=' sqP2ecos'
   END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3594)THEN
      outstring3=' sqP3esin'
   END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
   IF(kk == 3578)THEN
      outstring3=' sqP3ecos'
   END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3626)THEN
      outstring3=' sqP4esin'
   END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
   IF(kk == 3610)THEN
      outstring3=' sqP4ecos'
   END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3658)THEN
      outstring3=' sqP5esin'
   END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
   IF(kk == 3642)THEN
      outstring3=' sqP5ecos'
   END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3690)THEN
      outstring3=' sqP6esin'
   END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
   IF(kk == 3674)THEN
      outstring3=' sqP6ecos'
   END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3722)THEN
      outstring3=' sqP7esin'
   END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
   IF(kk == 3706)THEN
      outstring3=' sqP7ecos'
   END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3754)THEN
      outstring3=' sqP8esin'
   END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
   IF(kk == 3738)THEN
      outstring3=' sqP8ecos'
   END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
   IF(kk == 3524)THEN
      outstring3=' P1-Tc'
   END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
   IF(kk == 3527)THEN
      outstring3=' P1+Tc'
   END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
   IF(kk == 3556)THEN
      outstring3=' P2-Tc'
   END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
   IF(kk == 3559)THEN
      outstring3=' P2+Tc'
   END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
   IF(kk == 3588)THEN
      outstring3=' P3-Tc'
   END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
   IF(kk == 3591)THEN
      outstring3=' P3+Tc'
   END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
   IF(kk == 3620)THEN
      outstring3=' P4-Tc'
   END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
   IF(kk == 3623)THEN
      outstring3=' P4+Tc'
   END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
   IF(kk == 3652)THEN
      outstring3=' P5-Tc'
   END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
   IF(kk == 3655)THEN
      outstring3=' P5+Tc'
   END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
   IF(kk == 3684)THEN
      outstring3=' P6-Tc'
   END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
   IF(kk == 3687)THEN
      outstring3=' P6+Tc'
   END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
   IF(kk == 3716)THEN
      outstring3=' P7-Tc'
   END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
   IF(kk == 3719)THEN
      outstring3=' P7+Tc'
   END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
   IF(kk == 3748)THEN
      outstring3=' P8-Tc'
   END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
   IF(kk == 3751)THEN
      outstring3=' P8+Tc'
   END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
   IF(kk == 44)THEN
      outstring3=' Pbin-Tc'
   END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
   IF(kk == 47)THEN
      outstring3=' Pbin+Tc'
   END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
   IF(kk == 40)THEN
      outstring3=' axis_I2'
   END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
   IF(kk == 33)THEN
      outstring3=' axis_beta2'
   END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
   IF(kk == 72)THEN
      outstring3=' axis_I3'
   END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
   IF(kk == 65)THEN
      outstring3=' axis_beta3'
   END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
   IF(kk == 104)THEN
      outstring3=' axis_I4'
   END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
   IF(kk == 97)THEN
      outstring3=' axis_beta4'
   END IF
!
!  tag 91, bin2masssum (M3+M4 in binary+binary)
!
   IF(kk == 4784)THEN
      outstring3=' bin2masssum'
   END IF
!
!  tag 92, bin2massdiff (M3-M4 in binary+binary)
!
   IF(kk == 4785)THEN
      outstring3=' bin2massdiff'
   END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
   IF(kk == 4786)THEN
      outstring3=' bin2Q'
   END IF
!
!  tag 94, bin2radsum (R3+R4 in binary+binary)
!
   IF(kk == 4787)THEN
      outstring3=' bin2radsum'
   END IF
!
!  tag 95, bin2raddiff (R3-R4 in binary+binary)
!
   IF(kk == 4788)THEN
      outstring3=' bin2raddiff'
   END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
   IF(kk == 4789)THEN
      outstring3=' bin2ratrad'
   END IF
!
!   tag g6, g6
!
   IF(kk == 1213)THEN
      outstring3=' g6'
   END IF
!
!   tag g7, g7
!
   IF(kk == 1214)THEN
      outstring3=' g7'
   END IF
!
!   tag g8, g8
!
   IF(kk == 1215)THEN
      outstring3=' g8'
   END IF
!
!   tag g9, g9
!
   IF(kk == 1216)THEN
      outstring3=' g9'
   END IF
!
!   tag g0, g10
!
   IF(kk == 1207)THEN
      outstring3=' g10'
   END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
   IF(kk == 387)THEN
      outstring3=' massdiff'
   END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
   IF(kk == 402)THEN
      outstring3=' masssum'
   END IF
!
!   tag o3, omega3
!
   IF(kk == 1466)THEN
      outstring3=' omega3'
   END IF
!
!   tag o4, omega4
!
   IF(kk == 1467)THEN
      outstring3=' omega4'
   END IF
!
!   tag o5, omega5
!
   IF(kk == 1468)THEN
      outstring3=' omega5'
   END IF
!
!   tag o6, omega6
!
   IF(kk == 1469)THEN
      outstring3=' omega6'
   END IF
!
!   tag o7, omega7
!
   IF(kk == 1470)THEN
      outstring3=' omega7'
   END IF
!
!   tag o8, omega8
!
   IF(kk == 1471)THEN
      outstring3=' omega8'
   END IF
!
!   tag o9, omega9
!
   IF(kk == 1472)THEN
      outstring3=' omega9'
   END IF
!
!   tag o0, omega10
!
   IF(kk == 1463)THEN
      outstring3=' omega10'
   END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
   IF(kk == 562)THEN
      outstring3=' radsum'
   END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
   IF(kk == 547)THEN
      outstring3=' raddiff'
   END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
   IF(kk == 1018)THEN
      outstring3=' rk3'
   END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
   IF(kk == 1019)THEN
      outstring3=' rk4'
   END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
   IF(kk == 1020)THEN
      outstring3=' rk5'
   END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
   IF(kk == 1021)THEN
      outstring3=' rk6'
   END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
   IF(kk == 1022)THEN
      outstring3=' rk7'
   END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
   IF(kk == 1023)THEN
      outstring3=' rk8'
   END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
   IF(kk == 1024)THEN
      outstring3=' rk9'
   END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
   IF(kk == 1015)THEN
      outstring3=' rk10'
   END IF
!
!   tag sm, secmass
!
   IF(kk == 588)THEN
      outstring3=' secmass'
   END IF
!
!   tag sr, secrad
!
   IF(kk == 593)THEN
      outstring3=' secrad'
   END IF
!
!   tag t6, t6 (Teff6)
!
   IF(kk == 1629)THEN
      outstring3=' Teff6'
   END IF
!
!   tag t7, t7 (Teff7)
!
   IF(kk == 1630)THEN
      outstring3=' Teff7'
   END IF
!
!   tag t8, t8 (Teff8)
!
   IF(kk == 1631)THEN
      outstring3=' Teff8'
   END IF
!
!   tag t9, t9 (Teff9)
!
   IF(kk == 1632)THEN
      outstring3=' Teff9'
   END IF
!
!   tag ta, t10 (Teff10)
!
   IF(kk == 608)THEN
      outstring3=' Teff10'
   END IF
!
!  tag 61, flux star 6, band 1
!
   IF(kk == 4688)THEN
      outstring3=' flux6_U'
   END IF
!
!  tag 62, flux star 6, band 2
!
   IF(kk == 4689)THEN
      outstring3=' flux6_B'
   END IF
!
!  tag 63, flux star 6, band 3
!
   IF(kk == 4690)THEN
      outstring3=' flux6_V'
   END IF
!
!  tag 64, flux star 6, band 4
!
   IF(kk == 4691)THEN
      outstring3=' flux6_R'
   END IF
!
!  tag 65, flux star 6, band 5
!
   IF(kk == 4692)THEN
      outstring3=' flux6_I'
   END IF
!
!  tag 66, flux star 6, band 6
!
   IF(kk == 4693)THEN
      outstring3=' flux6_J'
   END IF
!
!  tag 67, flux star 6, band 7
!
   IF(kk == 4694)THEN
      outstring3=' flux6_H'
   END IF
!
!  tag 68, flux star 6, band 8
!
   IF(kk == 4695)THEN
      outstring3=' flux6_K'
   END IF
!
!  tag 71, flux star 7, band 1
!
   IF(kk == 4720)THEN
      outstring3=' flux7_U'
   END IF
!
!  tag 72, flux star 7, band 2
!
   IF(kk == 4721)THEN
      outstring3=' flux7_B'
   END IF
!
!  tag 73, flux star 7, band 3
!
   IF(kk == 4722)THEN
      outstring3=' flux7_V'
   END IF
!
!  tag 74, flux star 7, band 4
!
   IF(kk == 4723)THEN
      outstring3=' flux7_R'
   END IF
!
!  tag 75, flux star 7, band 5
!
   IF(kk == 4724)THEN
      outstring3=' flux7_I'
   END IF
!
!  tag 76, flux star 7, band 6
!
   IF(kk == 4725)THEN
      outstring3=' flux7_J'
   END IF
!
!  tag 77, flux star 7, band 7
!
   IF(kk == 4726)THEN
      outstring3=' flux7_H'
   END IF
!
!  tag 78, flux star 7, band 8
!
   IF(kk == 4727)THEN
      outstring3=' flux7_K'
   END IF
!
!  tag 81, flux star 8, band 1
!
   IF(kk == 4752)THEN
      outstring3=' flux8_U'
   END IF
!
!  tag 82, flux star 8, band 2
!
   IF(kk == 4753)THEN
      outstring3=' flux8_B'
   END IF
!
!  tag 83, flux star 8, band 3
!
   IF(kk == 4754)THEN
      outstring3=' flux8_V'
   END IF
!
!  tag 84, flux star 8, band 4
!
   IF(kk == 4755)THEN
      outstring3=' flux8_R'
   END IF
!
!  tag 85, flux star 8, band 5
!
   IF(kk == 4756)THEN
      outstring3=' flux8_I'
   END IF
!
!  tag 86, flux star 8, band 6
!
   IF(kk == 4757)THEN
      outstring3=' flux8_J'
   END IF
!
!  tag 87, flux star 8, band 7
!
   IF(kk == 4758)THEN
      outstring3=' flux8_H'
   END IF
!
!  tag 88, flux star 8, band 8
!
   IF(kk == 4759)THEN
      outstring3=' flux8_K'
   END IF
!
!  tag 91, flux star 9, band 1
!
   IF(kk == 2784)THEN
      outstring3=' flux9_U'
   END IF
!
!  tag 92, flux star 9, band 2
!
   IF(kk == 2785)THEN
      outstring3=' flux9_B'
   END IF
!
!  tag 93, flux star 9, band 3
!
   IF(kk == 2786)THEN
      outstring3=' flux9_V'
   END IF
!
!  tag 94, flux star 9, band 4
!
   IF(kk == 2787)THEN
      outstring3=' flux9_R'
   END IF
!
!  tag 95, flux star 9, band 5
!
   IF(kk == 2788)THEN
      outstring3=' flux9_I'
   END IF
!
!  tag 96, flux star 9, band 6
!
   IF(kk == 2789)THEN
      outstring3=' flux9_J'
   END IF
!
!  tag 97, flux star 9, band 7
!
   IF(kk == 2790)THEN
      outstring3=' flux9_H'
   END IF
!
!  tag 98, flux star 9, band 8
!
   IF(kk == 2791)THEN
      outstring3=' flux9_K'
   END IF
!
!  tag 01, flux star 10, band 1
!
   IF(kk == 4496)THEN
      outstring3=' flux10_U'
   END IF
!
!  tag 02, flux star 10, band 2
!
   IF(kk == 4497)THEN
      outstring3=' flux10_B'
   END IF
!
!  tag 03, flux star 10, band 3
!
   IF(kk == 4498)THEN
      outstring3=' flux10_V'
   END IF
!
!  tag 04, flux star 10, band 4
!
   IF(kk == 4499)THEN
      outstring3=' flux10_R'
   END IF
!
!  tag 05, flux star 10, band 5
!
   IF(kk == 4500)THEN
      outstring3=' flux10_I'
   END IF
!
!  tag 06, flux star 10, band 6
!
   IF(kk == 4501)THEN
      outstring3=' flux10_J'
   END IF
!
!  tag 07, flux star 10, band 7
!
   IF(kk == 4502)THEN
      outstring3=' flux10_H'
   END IF
!
!  tag 08, flux star 10, band 8
!
   IF(kk == 4503)THEN
      outstring3=' flux10_K'
   END IF
!
!  tag 11, flux star 1, band 1
!
   IF(kk == 4528)THEN
      outstring3=' flux1_U'
   END IF
!
!  tag 12, flux star 1, band 2
!
   IF(kk == 4529)THEN
      outstring3=' flux1_B'
   END IF
!
!  tag 13, flux star 1, band 3
!
   IF(kk == 4530)THEN
      outstring3=' flux1_V'
   END IF
!
!  tag 14, flux star 1, band 4
!
   IF(kk == 4531)THEN
      outstring3=' flux1_R'
   END IF
!
!  tag 15, flux star 1, band 5
!
   IF(kk == 4532)THEN
      outstring3=' flux1_I'
   END IF
!
!  tag 16, flux star 1, band 6
!
   IF(kk == 4533)THEN
      outstring3=' flux1_J'
   END IF
!
!  tag 17, flux star 1, band 7
!
   IF(kk == 4534)THEN
      outstring3=' flux1_H'
   END IF
!
!  tag 18, flux star 1, band 8
!
   IF(kk == 4535)THEN
      outstring3=' flux1_K'
   END IF
!
!  tag 21, flux star 2, band 1
!
   IF(kk == 4560)THEN
      outstring3=' flux2_U'
   END IF
!
!  tag 22, flux star 2, band 2
!
   IF(kk == 4561)THEN
      outstring3=' flux2_B'
   END IF
!
!  tag 23, flux star 2, band 3
!
   IF(kk == 4562)THEN
      outstring3=' flux2_V'
   END IF
!
!  tag 24, flux star 2, band 4
!
   IF(kk == 4563)THEN
      outstring3=' flux2_R'
   END IF
!
!  tag 25, flux star 2, band 5
!
   IF(kk == 4564)THEN
      outstring3=' flux2_I'
   END IF
!
!  tag 26, flux star 2, band 6
!
   IF(kk == 4565)THEN
      outstring3=' flux2_J'
   END IF
!
!  tag 27, flux star 2, band 7
!
   IF(kk == 4566)THEN
      outstring3=' flux2_H'
   END IF
!
!  tag 28, flux star 2, band 8
!
   IF(kk == 4567)THEN
      outstring3=' flux2_K'
   END IF
!
!  tag 31, flux star 3, band 1
!
   IF(kk == 4592)THEN
      outstring3=' flux3_U'
   END IF
!
!  tag 32, flux star 3, band 2
!
   IF(kk == 4593)THEN
      outstring3=' flux3_B'
   END IF
!
!  tag 33, flux star 3, band 3
!
   IF(kk == 4594)THEN
      outstring3=' flux3_V'
   END IF
!
!  tag 34, flux star 3, band 4
!
   IF(kk == 4595)THEN
      outstring3=' flux3_R'
   END IF
!
!  tag 35, flux star 3, band 5
!
   IF(kk == 4596)THEN
      outstring3=' flux3_I'
   END IF
!
!  tag 36, flux star 3, band 6
!
   IF(kk == 4597)THEN
      outstring3=' flux3_J'
   END IF
!
!  tag 37, flux star 3, band 7
!
   IF(kk == 4598)THEN
      outstring3=' flux3_H'
   END IF
!
!  tag 38, flux star 3, band 8
!
   IF(kk == 4599)THEN
      outstring3=' flux3_K'
   END IF
!
!  tag 41, flux star 4, band 1
!
   IF(kk == 4624)THEN
      outstring3=' flux4_U'
   END IF
!
!  tag 42, flux star 4, band 2
!
   IF(kk == 4625)THEN
      outstring3=' flux4_B'
   END IF
!
!  tag 43, flux star 4, band 3
!
   IF(kk == 4626)THEN
      outstring3=' flux4_V'
   END IF
!
!  tag 44, flux star 4, band 4
!
   IF(kk == 4627)THEN
      outstring3=' flux4_R'
   END IF
!
!  tag 45, flux star 4, band 5
!
   IF(kk == 4628)THEN
      outstring3=' flux4_I'
   END IF
!
!  tag 46, flux star 4, band 6
!
   IF(kk == 4629)THEN
      outstring3=' flux4_J'
   END IF
!
!  tag 47, flux star 4, band 7
!
   IF(kk == 4630)THEN
      outstring3=' flux4_H'
   END IF
!
!  tag 48, flux star 4, band 8
!
   IF(kk == 4631)THEN
      outstring3=' flux4_K'
   END IF
!
!  tag 51, flux star 5, band 1
!
   IF(kk == 4656)THEN
      outstring3=' flux5_U'
   END IF
!
!  tag 52, flux star 5, band 2
!
   IF(kk == 4657)THEN
      outstring3=' flux5_B'
   END IF
!
!  tag 53, flux star 5, band 3
!
   IF(kk == 4658)THEN
      outstring3=' flux5_V'
   END IF
!
!  tag 54, flux star 5, band 4
!
   IF(kk == 4659)THEN
      outstring3=' flux5_R'
   END IF
!
!  tag 55, flux star 5, band 5
!
   IF(kk == 4660)THEN
      outstring3=' flux5_I'
   END IF
!
!  tag 56, flux star 6, band 6
!
   IF(kk == 4661)THEN
      outstring3=' flux5_J'
   END IF
!
!  tag 57, flux star 5, band 7
!
   IF(kk == 4662)THEN
      outstring3=' flux5_H'
   END IF
!
!  tag 58, flux star 5, band 8
!
   IF(kk == 4663)THEN
      outstring3=' flux5_K'
   END IF
!
!  tag ob, Omega_bin, nodal angle of binary
!
   IF(kk == 449)THEN
      outstring3=' Omega_bin'
   END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
   IF((kk == 450).AND.(isw29 > 0))THEN
      outstring3=' ecos(omega)'
   END IF
!
!  tag os, osine, e*sin(omega) for binary
!
   IF((kk == 466).AND.(isw29 > 0))THEN
      outstring3=' esin(omega)'
   END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1
!
   IF(kk == 1016)THEN
      outstring3=' rk1'
   END IF
!
!  tag a2, rk2, tidal apsidal constant for star 2
!
   IF(kk == 1017)THEN
      outstring3=' rk2'
   END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
   IF(kk == 649)THEN
      outstring3=' P2tconj'
   END IF
!
!  tag ut, P2period
!
   IF(kk == 659)THEN
      outstring3=' P2period'
   END IF
!
!  tag uu, P2T0
!
   IF(kk == 660)THEN
      outstring3=' P2T0'
   END IF
!
!  tag uv, P2ecos
!
   IF(kk == 661)THEN
      outstring3=' P2ecos'
   END IF
!
!  tag uw, P2esin
!
   IF(kk == 662)THEN
      outstring3=' P2esin'
   END IF
!
!  tag ux, P2incl
!
   IF(kk == 663)THEN
      outstring3=' P2incl'
   END IF
!
!  tag uy, P2Omega
!
   IF(kk == 664)THEN
      outstring3=' P2Omega'
   END IF
!
!  tag uz, P2Q
!
   IF(kk == 665)THEN
      outstring3=' P2Q'
   END IF
!
!  tag ub, P2ratrad
!
   IF(kk == 641)THEN
      outstring3=' P2ratrad'
   END IF
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
   IF(kk == 681)THEN
      outstring3=' P3tconj'
   END IF
!
!  tag vt, P3period
!
   IF(kk == 691)THEN
      outstring3=' P3period'
   END IF
!
!  tag vu, P3T0
!
   IF(kk == 692)THEN
      outstring3=' P3T0'
   END IF
!
!  tag vv, P3ecos
!
   IF(kk == 693)THEN
      outstring3=' P3ecos'
   END IF
!
!  tag vw, P3esin
!
   IF(kk == 694)THEN
      outstring3=' P3esin'
   END IF
!
!  tag vx, P3incl
!
   IF(kk == 695)THEN
      outstring3=' P3incl'
   END IF
!
!  tag vy, P3Omega
!
   IF(kk == 696)THEN
      outstring3=' P3Omega'
   END IF
!
!  tag vz, P3Q
!
   IF(kk == 697)THEN
      outstring3=' P3Q'
   END IF
!
!  tag vb, P3ratrad
!
   IF(kk == 673)THEN
      outstring3=' P3ratrad'
   END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
   IF(kk == 713)THEN
      outstring3=' P4tconj'
   END IF
!
!  tag wt, P4period
!
   IF(kk == 723)THEN
      outstring3=' P4period'
   END IF
!
!  tag wu, P4T0
!
   IF(kk == 724)THEN
      outstring3=' P4T0'
   END IF
!
!  tag wv, P4ecos
!
   IF(kk == 725)THEN
      outstring3=' P4ecos'
   END IF
!
!  tag ww, P4esin
!
   IF(kk == 726)THEN
      outstring3=' P4esin'
   END IF
!
!  tag wx, P4incl
!
   IF(kk == 727)THEN
      outstring3=' P4incl'
   END IF
!
!  tag wy, P4Omega
!
   IF(kk == 728)THEN
      outstring3=' P4Omega'
   END IF
!
!  tag wz, P4Q
!
   IF(kk == 729)THEN
      outstring3=' P4Q'
   END IF
!
!  tag wb, P4ratrad
!
   IF(kk == 705)THEN
      outstring3=' P4ratrad'
   END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
   IF(kk == 745)THEN
      outstring3=' P5tconj'
   END IF
!
!  tag xt, P5period
!
   IF(kk == 755)THEN
      outstring3=' P5period'
   END IF
!
!  tag xu, P5T0
!
   IF(kk == 756)THEN
      outstring3=' P5T0'
   END IF
!
!  tag xv, P5ecos
!
   IF(kk == 757)THEN
      outstring3=' P5ecos'
   END IF
!
!  tag xw, P5esin
!
   IF(kk == 758)THEN
      outstring3=' P5esin'
   END IF
!
!  tag xx, P5incl
!
   IF(kk == 759)THEN
      outstring3=' P5incl'
   END IF
!
!  tag xy, P5Omega
!
   IF(kk == 760)THEN
      outstring3=' P5Omega'
   END IF
!
!  tag xz, P5Q
!
   IF(kk == 761)THEN
      outstring3=' P5Q'
   END IF
!
!  tag xb, P5ratrad
!
   IF(kk == 737)THEN
      outstring3=' P5ratrad'
   END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
   IF(kk == 585)THEN
      outstring3=' P6tconj'
   END IF
!
!  tag st, P6period
!
   IF(kk == 595)THEN
      outstring3=' P6period'
   END IF
!
!  tag su, P6T0
!
   IF(kk == 596)THEN
      outstring3=' P6T0'
   END IF
!
!  tag sv, P6ecos
!
   IF(kk == 597)THEN
      outstring3=' P6ecos'
   END IF
!
!  tag sw, P6esin
!
   IF(kk == 598)THEN
      outstring3=' P6esin'
   END IF
!
!  tag sx, P6incl
!
   IF(kk == 599)THEN
      outstring3=' P6incl'
   END IF
!
!  tag sy, P6Omega
!
   IF(kk == 600)THEN
      outstring3=' P6Omega'
   END IF
!
!  tag sz, P6Q
!
   IF(kk == 601)THEN
      outstring3=' P6Q'
   END IF
!
!  tag sb, P6ratrad
!
   IF(kk == 577)THEN
      outstring3=' P6ratrad'
   END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
   IF(kk == 233)THEN
      outstring3=' P7tconj'
   END IF
!
!  tag ht, P7period
!
   IF(kk == 243)THEN
      outstring3=' P7period'
   END IF
!
!  tag hu, P7T0
!
   IF(kk == 244)THEN
      outstring3=' P7T0'
   END IF
!
!  tag hv, P7ecos
!
   IF(kk == 245)THEN
      outstring3=' P7ecos'
   END IF
!
!  tag hw, P7esin
!
   IF(kk == 246)THEN
      outstring3=' P7esin'
   END IF
!
!  tag hx, P7incl
!
   IF(kk == 247)THEN
      outstring3=' P7incl'
   END IF
!
!  tag hy, P7Omega
!
   IF(kk == 248)THEN
      outstring3=' P7Omega'
   END IF
!
!  tag hz, P7Q
!
   IF(kk == 249)THEN
      outstring3=' P7Q'
   END IF
!
!  tag hb, P7ratrad
!
   IF(kk == 225)THEN
      outstring3=' P7ratrad'
   END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
   IF(kk == 329)THEN
      outstring3=' P8tconj'
   END IF
!
!  tag kt, P8period
!
   IF(kk == 339)THEN
      outstring3=' P8period'
   END IF
!
!  tag ku, P8T0
!
   IF(kk == 340)THEN
      outstring3=' P8T0'
   END IF
!
!  tag kv, P8ecos
!
   IF(kk == 341)THEN
      outstring3=' P8ecos'
   END IF
!
!  tag kw, P8esin
!
   IF(kk == 342)THEN
      outstring3=' P8esin'
   END IF
!
!  tag kx, P8incl
!
   IF(kk == 343)THEN
      outstring3=' P8incl'
   END IF
!
!  tag ky, P8Omega
!
   IF(kk == 344)THEN
      outstring3=' P8Omega'
   END IF
!
!  tag kz, P8Q
!
   IF(kk == 345)THEN
      outstring3=' P8Q'
   END IF
!
!  tag kb, P8ratrad
!
   IF(kk == 321)THEN
      outstring3=' P8ratrad'
   END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
   IF(kk == 1208)THEN
      outstring3=' Tgrav1'
   END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
   IF(kk == 1209)THEN
      outstring3=' Tgrav2'
   END IF
!
!  tag s0, contamS0, contamination season 0
!
   IF(kk == 1591)THEN
      outstring3=' contamS0'
   END IF
!
!  tag s1, contamS1, contamination season 1
!
   IF(kk == 1592)THEN
      outstring3=' contamS1'
   END IF
!
!  tag s2, contamS2, contamination season 2
!
   IF(kk == 1593)THEN
      outstring3=' contamS2'
   END IF
!
!  tag s3, contamS3, contamination season 3
!
   IF(kk == 1594)THEN
      outstring3=' contamS3'
   END IF
!
!  tag do, omegadot
!
   IF(kk == 110)THEN
      outstring3=' omega_dot'
   END IF
!
!  tag tt, tertperiod, orbital period of body 3
!
   IF(kk == 627)THEN
      outstring3=' P1period'
   END IF
!
!  tag tu, tertT0, periastron passage of body 3 orbit
!
   IF(kk == 628)THEN
      outstring3=' P1T0'
   END IF
!
!  tag tj, tertconj, time of primary conjunction of body 3 orbit
!
   IF(kk == 617)THEN
      outstring3=' P1tconj'
   END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3 orbit
!
   IF(kk == 629)THEN
      outstring3=' P1ecos'
   END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3 orbit
!
   IF(kk == 630)THEN
      outstring3=' P1esin'
   END IF
!
!  tag tx, tertincl, inclination of body 3 orbit
!
   IF(kk == 631)THEN
      outstring3=' P1incl'
   END IF
!
!  tag ty, tertOmega, nodal angle of body 3 orbit
!
   IF(kk == 632)THEN
      outstring3=' P1Omega'
   END IF
!
!  tag tz, tertQ, mass ratio of body 3
!
   IF(kk == 633)THEN
      outstring3=' P1Q'
   END IF
!
!  tag tb, tertratrad, radius ratio of body 3
!
   IF(kk == 609)THEN
      outstring3=' P1ratrad'
   END IF
!
!  tag co, contam, Kepler contamination
!
   IF(kk == 78)THEN
      outstring3=' contam'
   END IF
!
!  tag e1, beam1, Doppler boosting coefficient for star 1
!
   IF(kk == 1144)THEN
      outstring3=' beam1'
   END IF
!
!  tag e2, beam2, Doppler boosting coefficient for star 2
!
   IF(kk == 1145)THEN
      outstring3=' beam2'
   END IF
!
!  tag pm, primmass, mass of star 1 in solar masses
!
   IF(kk == 492)THEN
      outstring3=' primmass'
   END IF
!
!  tag pr, primrad, radius of star in solar radii
!
   IF(kk == 497)THEN
      outstring3=' primrad'
   END IF
!
!  tag te, temprat, ratio of star 2 temperature to star 1 temperature
!
   IF(kk == 612)THEN
      outstring3=' temprat'
   END IF
!
!  tag pk, primK, K-velocity of star 1 in km/sec
!
   IF(kk == 490)THEN
      outstring3=' primK'
   END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
   IF(kk == 544)THEN
      outstring3=' ratrad'
   END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
   IF(kk == 1528)THEN
      outstring3=' frac1'
   END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
   IF(kk == 1529)THEN
      outstring3=' frac2'
   END IF
!
!  tag de, density, density of star 1 in cgs
!
   IF(kk == 100)THEN
      outstring3=' density'
   END IF
!
!  tag l1, alb1, albedo of star 1
!
   IF(kk == 1368)THEN
      outstring3=' al1'
   END IF
!
!  tag l2, alb2, albedo of star 2
!
   IF(kk == 1369)THEN
      outstring3=' al2'
   END IF
!
!  tag dp, dphi, phase difference between secondary and primary eclipse
!
   IF(kk == 111)THEN
      outstring3=' dphi'
   END IF
!
!  tag tc, Tconj, time of primary conjunction of the binary orbit
!
   IF(kk == 610)THEN
      outstring3=' Tconj'
   END IF
!
!  tag t0, T0, time of periastron passage of binary orbit
!
   IF(kk == 1623)THEN
      outstring3=' T0'
   END IF
!
!  tag p2, period, binary orbital period in days
!
   IF(kk == 484)THEN
      outstring3=' P'
   END IF
!
!  tag in, finc, inclination of binary in degrees
!
   IF(kk == 269)THEN
      outstring3=' i'
   END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
   IF(kk == 8)THEN
      outstring3=' bigI'
   END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
   IF(kk == 1)THEN
      outstring3=' bigbeta'
   END IF
!
!  tag ma, Q, mass ratio of binary
!
   IF(kk == 384)THEN
      outstring3=' Q'
   END IF
!
!  tag f1, fill1, Roche lobe filling factor of star 1
!
   IF(kk == 1176)THEN
      outstring3=' fi1'
   END IF
!
!  tag f2, fill2, Roche lobe filling factor of star 2
!
   IF(kk == 1177)THEN
      outstring3=' fi2'
   END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
   IF(kk == 552)THEN
      outstring3=' rin'
   END IF
!
!  tag o1, omega1, spin frequency of star 1
!
   IF(kk == 1464)THEN
      outstring3=' o1'
   END IF
!
!  tag o2, spin frequency of star 2
!
   IF(kk == 1465)THEN
      outstring3=' o2'
   END IF
!
!  tag ro, router, radius of outer edge of accretion disk
!
   IF(kk == 558)THEN
      outstring3=' rout'
   END IF
!
!  tag t3, Teff3, effective temperature of star 3
!
   IF(kk == 1626)THEN
      outstring3=' Teff3'
   END IF
!
!  tag t4, Teff4, effective temperature of star 4
!
   IF(kk == 1627)THEN
      outstring3=' Teff4'
   END IF
!
!  tag t5, Teff5, effective temperature of star 5
!
   IF(kk == 1628)THEN
      outstring3=' Teff5'
   END IF
!
!  tag g3, g3, gravity of star 3 (log(g))
!
   IF(kk == 1210)THEN
      outstring3=' g3'
   END IF
!
!  tag be, betarim, opening angle of accretion disk rim
!
   IF(kk == 36)THEN
      outstring3=' beta'
   END IF
!
!  tag t1, Teff1, effective temperature of star 1
!
   IF(kk == 1624)THEN
      outstring3=' Teff1'
   END IF
!
!  tag t2, Teff2, effective temperature of star 2
!
   IF(kk == 1625)THEN
      outstring3=' Teff2'
   END IF
!
!  tag xi, xi, power-law exponent of the disk temperature profile
!
   IF(kk == 744)THEN
      outstring3=' xi'
   END IF
!
!  tag td, Tdisk, temperature of the inner edge of the accretion disk
!
   IF(kk == 611)THEN
      outstring3=' Td'
   END IF
!
!  tag lx, rLx, log of the X-ray luminosity in cgs units
!
   IF(kk == 375)THEN
      outstring3=' Lx'
   END IF
!
!  tag se, separ, semimajor axis of binary orbit
!
   IF(kk == 580)THEN
      outstring3=' separ'
   END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
   IF(kk == 576)THEN
      outstring3=' SA3'
   END IF
!
!  tag ps, pshift
!
   IF(kk == 498)THEN
      outstring3=' pshift'
   END IF
!
!  tag ec, ecc, eccentricity of binary orbit
!
   IF(kk == 130)THEN
      outstring3=' e'
   END IF
!
!  tag ar, argper, argument of periastron of binary orbit
!
   IF(kk == 17)THEN
      outstring3=' argper'
   END IF
!
!  tag b1, temperature factor spot 1, star 1
!
   IF(kk == 1048)THEN
      outstring3=' TF_spot1_star1'
   END IF
!
!  tag b2, latitude spot 1, star 1
!
   IF(kk == 1049)THEN
      outstring3=' lat_spot1_star1'
   END IF
!
!  tag b3, longitude spot 1, star 1
!
   IF(kk == 1050)THEN
      outstring3=' lon_spot1_star1'
   END IF
!
!  tag  b4, radius spot 1, star 1
!
   IF(kk == 1051)THEN
      outstring3=' rad_spot1_star1'
   END IF
!
!  tag b5, temperature factor spot 2, star 1
!
   IF(kk == 1052)THEN
      outstring3=' TF_spot2_star1'
   END IF
!
!  tag b6,  latitude spot 2, star 1
!
   IF(kk == 1053)THEN
      outstring3=' lat_spot2_star1'
   END IF
!
!  tag b7, longitude spot 2, star 1
!
   IF(kk == 1054)THEN
      outstring3=' lon_spot2_star1'
   END IF
!
!  tag b8, radius spot 2, star 1
!
   IF(kk == 1055)THEN
      outstring3=' rad_spot2_star1'
   END IF
!
!  tag c1, temperature factor spot 1, star 2
!
   IF(kk == 1080)THEN
      outstring3=' TF_spot1_star2'
   END IF
!
!  tag c2, latitude spot 1, star 2
!
   IF(kk == 1081)THEN
      outstring3=' lat_spot1_star2'
   END IF
!
!  tag c3, longitude spot 1, star 2
!
   IF(kk == 1082)THEN
      outstring3=' lon_spot1_star2'
   END IF
!
!  tag c4, radius spot 1, star 2
!
   IF(kk == 1083)THEN
      outstring3=' rad_spot1_star2'
   END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
   IF(kk == 1084)THEN
      outstring3=' TF_spot2_star2'
   END IF
!
!  tag c6, latitude spot 2, star 2
!
   IF(kk == 1085)THEN
      outstring3=' lat_spot2_star2'
   END IF
!
!  tag c7, longitude spot 2, star 2
!
   IF(kk == 1086)THEN
      outstring3=' lon_spot2_star2'
   END IF
!
!  tag c8, radius spot 2, star 2
!
   IF(kk == 1087)THEN
      outstring3=' rad_spot2_star2'
   END IF
!
!  tag d1, temperature factor spot 1 on disk
!
   IF(kk == 1112)THEN
      outstring3=' TF_spot1_disk'
   END IF
!
!  tag d2, azimuth spot 1 on disk
!
   IF(kk == 1113)THEN
      outstring3=' azi_spot1_disk'
   END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
   IF(kk == 1114)THEN
      outstring3=' cut_spot1_disk'
   END IF
!
!  tag d4, angular width of spot 1 on disk
!
   IF(kk == 1115)THEN
      outstring3=' wid_spot1_disk'
   END IF
!
!  tag d5, temperature factor spot 2 on disk
!
   IF(kk == 1116)THEN
      outstring3=' TF_spot2_disk'
   END IF
!
!  tag d6, azimuth spot 2 on disk
!
   IF(kk == 1117)THEN
      outstring3=' azi_spot2_disk'
   END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
   IF(kk == 1118)THEN
      outstring3=' cut_spot2_disk'
   END IF
!
!  tag d8, angular width of spot 2 on disk
!
   IF(kk == 1119)THEN
      outstring3=' wid_spot2_disk'
   END IF
!
!  tag x1, limb darkening x-coefficient, band 1, star 1
!
   IF(kk == 1752)THEN
      outstring3=' x1(U)'
   END IF
!
!  tag x2, limb darkening x-coefficient, band 2, star 1
!
   IF(kk == 1753)THEN
      outstring3=' x1(B)'
   END IF
!
!  tag x3, limb darkening x-coefficient, band 3, star 1
!
   IF(kk == 1754)THEN
      outstring3=' x1(V)'
   END IF
!
!  tag x4, limb darkening x-coefficient, band 4, star 1
!
   IF(kk == 1755)THEN
      outstring3=' x1(R)'
   END IF
!
!  tag x5, limb darkening x-coefficient, band 5, star 1
!
   IF(kk == 1756)THEN
      outstring3=' x1(I)'
   END IF
!
!  tag x6, limb darkening x-coefficient, band 6, star 1
!
   IF(kk == 1757)THEN
      outstring3=' x1(J)'
   END IF
!
!  tag x7, limb darkening x-coefficient, band 7, star 1
!
   IF(kk == 1758)THEN
      outstring3=' x1(H)'
   END IF
!
!  tag x8, limb darkening x-coefficient, band 8, star 1
!
   IF(kk == 1759)THEN
      outstring3=' x1(K)'
   END IF
!
!  tag z1, limb darkening x-coefficient, band 1, star 2
!
   IF(kk == 1816)THEN
      outstring3=' x2(U)'
   END IF
!
!  tag z2, limb darkening x-coefficient, band 2, star 2
!
   IF(kk == 1817)THEN
      outstring3=' x2(B)'
   END IF
!
!  tag z3, limb darkening x-coefficient, band 3, star 2
!
   IF(kk == 1818)THEN
      outstring3=' x2(V)'
   END IF
!
!  tag z4, limb darkening x-coefficient, band 4, star 2
!
   IF(kk == 1819)THEN
      outstring3=' x2(R)'
   END IF
!
!  tag z5, limb darkening x-coefficient, band 5, star 2
!
   IF(kk == 1820)THEN
      outstring3=' x2(I)'
   END IF
!
!  tag z6, limb darkening x-coefficient, band 6, star 2
!
   IF(kk == 1821)THEN
      outstring3=' x2(J)'
   END IF
!
!  tag z7, limb darkening x-coefficient, band 7, star 2
!
   IF(kk == 1822)THEN
      outstring3=' x2(H)'
   END IF
!
!  tag z8, limb darkening x-coefficient, band 8, star 2
!
   IF(kk == 1823)THEN
      outstring3=' x2(K)'
   END IF
!
!  tag y1, limb darkening y-coefficient, band 1, star 1
!
   IF(kk == 1784)THEN
      outstring3=' y1(U)'
   END IF
!
!  tag y2, limb darkening y-coefficient, band 2, star 1
!
   IF(kk == 1785)THEN
      outstring3=' y1(B)'
   END IF
!
!  tag y3, limb darkening y-coefficient, band 3, star 1
!
   IF(kk == 1786)THEN
      outstring3=' y1(V)'
   END IF
!
!  tag y4, limb darkening y-coefficient, band 4, star 1
!
   IF(kk == 1787)THEN
      outstring3=' y1(R)'
   END IF
!
!  tag y5, limb darkening y-coefficient, band 5, star 1
!
   IF(kk == 1788)THEN
      outstring3=' y1(I)'
   END IF
!
!  tag y6, limb darkening y-coefficient, band 6, star 1
!
   IF(kk == 1789)THEN
      outstring3=' y1(J)'
   END IF
!
!  tag y7, limb darkening y-coefficient, band 7, star 1
!
   IF(kk == 1790)THEN
      outstring3=' y1(H)'
   END IF
!
!  tag y8, limb darkening y-coefficient, band 8, star 1
!
   IF(kk == 1791)THEN
      outstring3=' y1(K)'
   END IF
!
!  tag w1, limb darkening y-coefficient, band 1, star 2
!
   IF(kk == 1720)THEN
      outstring3=' y2(U)'
   END IF
!
!  tag w2, limb darkening y-coefficient, band 2, star 2
!
   IF(kk == 1721)THEN
      outstring3=' y2(B)'
   END IF
!
!  tag w3, limb darkening y-coefficient, band 3, star 2
!
   IF(kk == 1722)THEN
      outstring3=' y2(V)'
   END IF
!
!  tag w4, limb darkening y-coefficient, band 4, star 2
!
   IF(kk == 1723)THEN
      outstring3=' y2(R)'
   END IF
!
!  tag w5, limb darkening y-coefficient, band 5, star 2
!
   IF(kk == 1724)THEN
      outstring3=' y2(I)'
   END IF
!
!  tag w6, limb darkening y-coefficient, band 6, star 2
!
   IF(kk == 1725)THEN
      outstring3=' y2(J)'
   END IF
!
!  tag w7, limb darkening y-coefficient, band 7, star 2
!
   IF(kk == 1726)THEN
      outstring3=' y2(H)'
   END IF
!
!  tag w8, limb darkening y-coefficient, band 8, star 2
!
   IF(kk == 1727)THEN
      outstring3=' y2(K)'
   END IF
!
!  tag m1, limb darkening x-coefficient, band 1, star 3
!
   IF(kk == 1400)THEN
      outstring3=' x3(U)'
   END IF
!
!  tag m2, limb darkening x-coefficient, band 2, star 3
!
   IF(kk == 1401)THEN
      outstring3=' x3(B)'
   END IF
!
!  tag m3, limb darkening x-coefficient, band 3, star 3
!
   IF(kk == 1402)THEN
      outstring3=' x3(V)'
   END IF
!
!  tag m4, limb darkening x-coefficient, band 4, star 3
!
   IF(kk == 1403)THEN
      outstring3=' x3(R)'
   END IF
!
!  tag m5, limb darkening x-coefficient, band 5, star 3
!
   IF(kk == 1404)THEN
      outstring3=' x3(I)'
   END IF
!
!  tag m6, limb darkening x-coefficient, band 6, star 3
!
   IF(kk == 1405)THEN
      outstring3=' x3(J)'
   END IF
!
!  tag m7, limb darkening x-coefficient, band 7, star 3
!
   IF(kk == 1406)THEN
      outstring3=' x3(H)'
   END IF
!
!  tag m8, limb darkening x-coefficient, band 8, star 3
!
   IF(kk == 1407)THEN
      outstring3=' x3(K)'
   END IF
!
!  tag n1, limb darkening y-coefficient, band 1, star 3
!
   IF(kk == 1432)THEN
      outstring3=' y3(U)'
   END IF
!
!  tag n2, limb darkening y-coefficient, band 2, star 3
!
   IF(kk == 1433)THEN
      outstring3=' y3(B)'
   END IF
!
!  tag n3, limb darkening y-coefficient, band 3, star 3
!
   IF(kk == 1434)THEN
      outstring3=' y3(V)'
   END IF
!
!  tag n4, limb darkening y-coefficient, band 4, star 3
!
   IF(kk == 1435)THEN
      outstring3=' y3(R)'
   END IF
!
!  tag n5, limb darkening y-coefficient, band 5, star 3
!
   IF(kk == 1436)THEN
      outstring3=' y3(I)'
   END IF
!
!  tag n6, limb darkening y-coefficient, band 6, star 3
!
   IF(kk == 1437)THEN
      outstring3=' y3(J)'
   END IF
!
!  tag n7, limb darkening y-coefficient, band 7, star 3
!
   IF(kk == 1438)THEN
      outstring3=' y3(H)'
   END IF
!
!  tag n8, limb darkening y-coefficient, band 8, star 3
!
   IF(kk == 1439)THEN
      outstring3=' y3(K)'
   END IF
!
!  tag i1, limb darkening x-coefficient, band 1, star 4
!
   IF(kk == 1272)THEN
      outstring3=' x4(U)'
   END IF
!
!  tag i2, limb darkening x-coefficient, band 2, star 4
!
   IF(kk == 1273)THEN
      outstring3=' x4(B)'
   END IF
!
!  tag i3, limb darkening x-coefficient, band 3, star 4
!
   IF(kk == 1274)THEN
      outstring3=' x4(V)'
   END IF
!
!  tag i4, limb darkening x-coefficient, band 4, star 4
!
   IF(kk == 1275)THEN
      outstring3=' x4(R)'
   END IF
!
!  tag i5, limb darkening x-coefficient, band 5, star 4
!
   IF(kk == 1276)THEN
      outstring3=' x4(I)'
   END IF
!
!  tag i6, limb darkening x-coefficient, band 6, star 4
!
   IF(kk == 1277)THEN
      outstring3=' x4(J)'
   END IF
!
!  tag i7, limb darkening x-coefficient, band 7, star 4
!
   IF(kk == 1278)THEN
      outstring3=' x4(H)'
   END IF
!
!  tag i8, limb darkening x-coefficient, band 8, star 4
!
   IF(kk == 1279)THEN
      outstring3=' x4(K)'
   END IF
!
!  tag j1, limb darkening y-coefficient, band 1, star 4
!
   IF(kk == 1304)THEN
      outstring3=' y4(U)'
   END IF
!
!  tag j2, limb darkening y-coefficient, band 2, star 4
!
   IF(kk == 1305)THEN
      outstring3=' y4(B)'
   END IF
!
!  tag j3, limb darkening y-coefficient, band 3, star 4
!
   IF(kk == 1306)THEN
      outstring3=' y4(V)'
   END IF
!
!  tag j4, limb darkening y-coefficient, band 4, star 4
!
   IF(kk == 1307)THEN
      outstring3=' y4(R)'
   END IF
!
!  tag j5, limb darkening y-coefficient, band 5, star 4
!
   IF(kk == 1308)THEN
      outstring3=' y4(I)'
   END IF
!
!  tag j6, limb darkening y-coefficient, band 6, star 4
!
   IF(kk == 1309)THEN
      outstring3=' y4(J)'
   END IF
!
!  tag j7, limb darkening y-coefficient, band 7, star 4
!
   IF(kk == 1310)THEN
      outstring3=' y4(H)'
   END IF
!
!  tag j8, limb darkening y-coefficient, band 8, star 4
!
   IF(kk == 1311)THEN
      outstring3=' y4(K)'
   END IF
!
!  tag k1, limb darkening x-coefficient, band 1, star 5
!
   IF(kk == 1336)THEN
      outstring3=' x5(U)'
   END IF
!
!  tag k2, limb darkening x-coefficient, band 2, star 5
!
   IF(kk == 1337)THEN
      outstring3=' x5(B)'
   END IF
!
!  tag k3, limb darkening x-coefficient, band 3, star 5
!
   IF(kk == 1338)THEN
      outstring3=' x5(V)'
   END IF
!
!  tag k4, limb darkening x-coefficient, band 4, star 5
!
   IF(kk == 1339)THEN
      outstring3=' x5(R)'
   END IF
!
!  tag k5, limb darkening x-coefficient, band 5, star 5
!
   IF(kk == 1340)THEN
      outstring3=' x5(I)'
   END IF
!
!  tag k6, limb darkening x-coefficient, band 6, star 5
!
   IF(kk == 1341)THEN
      outstring3=' x5(J)'
   END IF
!
!  tag k7, limb darkening x-coefficient, band 7, star 5
!
   IF(kk == 1342)THEN
      outstring3=' x5(H)'
   END IF
!
!  tag k8, limb darkening x-coefficient, band 8, star 5
!
   IF(kk == 1343)THEN
      outstring3=' x5(K)'
   END IF
!
!  tag p1, limb darkening y-coefficient, band 1, star 5
!
   IF(kk == 1496)THEN
      outstring3=' y5(U)'
   END IF
!
!  tag p2, limb darkening y-coefficient, band 2, star 5
!
   IF(kk == 1497)THEN
      outstring3=' y5(B)'
   END IF
!
!  tag p3, limb darkening y-coefficient, band 3, star 5
!
   IF(kk == 1498)THEN
      outstring3=' y5(V)'
   END IF
!
!  tag p4, limb darkening y-coefficient, band 4, star 5
!
   IF(kk == 1499)THEN
      outstring3=' y5(R)'
   END IF
!
!  tag p5, limb darkening y-coefficient, band 5, star 5
!
   IF(kk == 1500)THEN
      outstring3=' y5(I)'
   END IF
!
!  tag p6, limb darkening y-coefficient, band 6, star 5
!
   IF(kk == 1501)THEN
      outstring3=' y5(J)'
   END IF
!
!  tag p7, limb darkening y-coefficient, band 7, star 5
!
   IF(kk == 1502)THEN
      outstring3=' y5(H)'
   END IF
!
!  tag p8, limb darkening y-coefficient, band 8, star 5
!
   IF(kk == 1503)THEN
      outstring3=' y5(K)'
   END IF
!
   IF(nn < 10)WRITE(*,10)nn,TRIM(outstring3)
   IF((nn >= 10).AND.(nn < 100))WRITE(*,20)nn,TRIM(outstring3)
   IF(nn >= 100)WRITE(*,30)nn,TRIM(outstring3)
!
   CALL pstring('low',7,vstart(nn),outstring1,lll1)
   CALL pstring('high',7,vstep(nn),outstring2,lll2)
!
   varxtemp=varx*(vstep(nn)-vstart(nn))+vstart(nn)
   CALL pstring(TRIM(outstring3),7,varxtemp,outstring,lll)
   WRITE(*,40)TRIM(outstring),TRIM(outstring1),TRIM(outstring2)
!
   WRITE(*,*)
!
10 FORMAT('Past bounds for variable index ',i1,', ','variable', a)
20 FORMAT('Past bounds for variable index ',i2,', ','variable', a)
30 FORMAT('Past bounds for variable index ',i3,', ','variable', a)
40 FORMAT(a,', ',a,', ',a)
!
   RETURN
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
!
END SUBROUTINE writebound
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writechi(icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk,  &
   icnrv1,icnrv2,chiu,chib,chiv,chir,chii,chij,chih,chik,chirv1,  &
   chirv2,icnrv3,chirv3,icnrv4,chirv4,ifixgamma,  &
   chirv1arry,chirv2arry,chirv3arry,chirv4arry,chirv5arry,  &
   icnrv1arry,icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry)
!
!   November 15, 1999
!
!   This routine will write chi^2 values to the screen in a compact way.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: icnu
   INTEGER, INTENT(IN)                      :: icnb
   INTEGER, INTENT(IN)                      :: icnv
   INTEGER, INTENT(IN)                      :: icnr
   INTEGER, INTENT(IN)                      :: icni
   INTEGER, INTENT(IN)                      :: icnj
   INTEGER, INTENT(IN)                      :: icnh
   INTEGER, INTENT(IN)                      :: icnk
   INTEGER, INTENT(IN)                      :: icnrv1
   INTEGER, INTENT(IN)                      :: icnrv2
   REAL(KIND=dp), INTENT(IN)                :: chiu
   REAL(KIND=dp), INTENT(IN)                :: chib
   REAL(KIND=dp), INTENT(IN)                :: chiv
   REAL(KIND=dp), INTENT(IN)                :: chir
   REAL(KIND=dp), INTENT(IN)                :: chii
   REAL(KIND=dp), INTENT(IN)                :: chij
   REAL(KIND=dp), INTENT(IN)                :: chih
   REAL(KIND=dp), INTENT(IN)                :: chik
   REAL(KIND=dp), INTENT(IN OUT)            :: chirv1
   REAL(KIND=dp), INTENT(IN OUT)            :: chirv2
   INTEGER, INTENT(IN)                      :: icnrv3
   REAL(KIND=dp), INTENT(IN OUT)            :: chirv3
   INTEGER, INTENT(IN)                      :: icnrv4
   REAL(KIND=dp), INTENT(IN OUT)            :: chirv4
   INTEGER, INTENT(IN)                      :: ifixgamma
   REAL(KIND=dp), INTENT(IN)                :: chirv1arry(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv2arry(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv3arry(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv4arry(5)
   REAL(KIND=dp), INTENT(IN)                :: chirv5arry(5)
   INTEGER, INTENT(IN)                      :: icnrv1arry(5)
   INTEGER, INTENT(IN)                      :: icnrv2arry(5)
   INTEGER, INTENT(IN)                      :: icnrv3arry(5)
   INTEGER, INTENT(IN)                      :: icnrv4arry(5)
   INTEGER, INTENT(IN)                      :: icnrv5arry(5)
!
   REAL(KIND=dp)  :: chirv5
!
   INTEGER :: iline,iwrite,ilength,lll
!
   CHARACTER(LEN=30) :: outstring
   CHARACTER(LEN=80) :: line
!
!   UPDATE May 27, 2002
!
!   Add this common block:
!
!   COMMON /medblock/ rmed
!
!   UPDATE May 27, 2002.
!
!   If the variable rmed > 1, then we are doing median fitting.
!   In that case, use different format statements.
!
   iline=0
   iwrite=0
   line='  -->'
   ilength=5
!
!  U data
!
   IF(icnu /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medU',chiu,outstring,lll)
      ELSE
         CALL chistring (' chiU',chiu,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  B data
!
   IF(icnb /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medB',chib,outstring,lll)
      ELSE
         CALL chistring (' chiB',chib,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  V data
!
   IF(icnv /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medV',chiv,outstring,lll)
      ELSE
         CALL chistring (' chiV',chiv,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  R data
!
   IF(icnr /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medR',chir,outstring,lll)
      ELSE
         CALL chistring (' chiR',chir,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  I data
!
   IF(icni /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medI',chii,outstring,lll)
      ELSE
         CALL chistring (' chiI',chii,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  J data
!
   IF(icnj /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medJ',chij,outstring,lll)
      ELSE
         CALL chistring (' chiJ',chij,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  H data
!
   IF(icnh /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medH',chih,outstring,lll)
      ELSE
         CALL chistring (' chiH',chih,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  K data
!
   IF(icnk /= 430)THEN
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring (' medK',chik,outstring,lll)
      ELSE
         CALL chistring (' chiK',chik,outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 51)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END IF
!
!  IF ifixgamma is 0, 1, or 2, then we have up to
!  1 chi^2 value per star.  If ifixgamma is 10, 11, or
!  12, we can have up to 5 chi^2 values per star.
!
   IF(ifixgamma < 10)THEN
!
!  star 1 RV data
!
      IF(icnrv1 /= 430)THEN
         iline=iline+1
         iwrite=0
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' medRV1',chirv1,outstring,lll)
         ELSE
            CALL chistring (' chiRV1',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 2 RV data
!
      IF(icnrv2 /= 430)THEN
         iline=iline+1
         iwrite=0
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' medRV2',chirv2,outstring,lll)
         ELSE
            CALL chistring (' chiRV2',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 3 RV data
!
      IF(icnrv3 /= 430)THEN
         iline=iline+1
         iwrite=0
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' medRV3',chirv3,outstring,lll)
         ELSE
            CALL chistring (' chiRV3',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 4 RV data
!
      IF(icnrv4 /= 430)THEN
         iline=iline+1
         iwrite=0
         IF(rmed >= 1.0_dp)THEN
            CALL chistring (' medRV4',chirv4,outstring,lll)
         ELSE
            CALL chistring (' chiRV4',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
   END IF
!
!  Here are the cases fitting sets of RV data
!
   IF(ifixgamma >= 10)THEN
!
!  star 1 RV data
!
      IF(icnrv1arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv1=chirv1arry(1)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV1A',chirv1,outstring,lll)
         ELSE
            CALL chistring(' chiRV1A',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv1arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv1=chirv1arry(2)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV1B',chirv1,outstring,lll)
         ELSE
            CALL chistring(' chiRV1B',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv1arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv1=chirv1arry(3)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV1C',chirv1,outstring,lll)
         ELSE
            CALL chistring(' chiRV1C',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv1arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv1=chirv1arry(4)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV1D',chirv1,outstring,lll)
         ELSE
            CALL chistring(' chiRV1D',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv1arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv1=chirv1arry(5)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV1E',chirv1,outstring,lll)
         ELSE
            CALL chistring(' chiRV1E',chirv1,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 2 RV data
!
      IF(icnrv2arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv2=chirv2arry(1)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV2A',chirv2,outstring,lll)
         ELSE
            CALL chistring(' chiRV2A',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv2arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv2=chirv2arry(2)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV2B',chirv2,outstring,lll)
         ELSE
            CALL chistring(' chiRV2B',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv2arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv2=chirv2arry(3)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV2C',chirv2,outstring,lll)
         ELSE
            CALL chistring(' chiRV2C',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv2arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv2=chirv2arry(4)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV2D',chirv2,outstring,lll)
         ELSE
            CALL chistring(' chiRV2D',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv2arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv2=chirv2arry(5)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV2E',chirv2,outstring,lll)
         ELSE
            CALL chistring(' chiRV2E',chirv2,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 3 RV data
!
      IF(icnrv3arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv3=chirv3arry(1)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV3A',chirv3,outstring,lll)
         ELSE
            CALL chistring(' chiRV3A',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv3arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv3=chirv3arry(2)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV3B',chirv3,outstring,lll)
         ELSE
            CALL chistring(' chiRV3B',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv3arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv3=chirv3arry(3)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV3C',chirv3,outstring,lll)
         ELSE
            CALL chistring(' chiRV3C',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv3arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv3=chirv3arry(4)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV3D',chirv3,outstring,lll)
         ELSE
            CALL chistring(' chiRV3D',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv3arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv3=chirv3arry(5)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV3E',chirv3,outstring,lll)
         ELSE
            CALL chistring(' chiRV3E',chirv3,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 4 RV data
!
      IF(icnrv4arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv4=chirv4arry(1)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV4A',chirv4,outstring,lll)
         ELSE
            CALL chistring(' chiRV4A',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv4arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv4=chirv4arry(2)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV4B',chirv4,outstring,lll)
         ELSE
            CALL chistring(' chiRV4B',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv4arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv4=chirv4arry(3)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV4C',chirv4,outstring,lll)
         ELSE
            CALL chistring(' chiRV4C',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv4arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv4=chirv4arry(4)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV4D',chirv4,outstring,lll)
         ELSE
            CALL chistring(' chiRV4D',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv4arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv4=chirv4arry(5)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV4E',chirv4,outstring,lll)
         ELSE
            CALL chistring(' chiRV4E',chirv4,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
!  star 5 RV data
!
      IF(icnrv5arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv5=chirv5arry(1)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV5A',chirv5,outstring,lll)
         ELSE
            CALL chistring(' chiRV5A',chirv5,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv5arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv5=chirv5arry(2)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV5B',chirv5,outstring,lll)
         ELSE
            CALL chistring(' chiRV5B',chirv5,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv5arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv5=chirv5arry(3)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV5C',chirv5,outstring,lll)
         ELSE
            CALL chistring(' chiRV5C',chirv5,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv5arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv5=chirv5arry(4)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV5D',chirv5,outstring,lll)
         ELSE
            CALL chistring(' chiRV5D',chirv5,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
      IF(icnrv5arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         chirv5=chirv5arry(5)
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(' medRV5E',chirv5,outstring,lll)
         ELSE
            CALL chistring(' chiRV5E',chirv5,outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 51)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
!
   END IF
!
   IF(ilength > 5.AND.iwrite == 0)WRITE(*,10)line
!
10 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE writechi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writegridout(nalph1,nbet1,nalph2,nbet2,fill1,  &
   fill2,omega1,omega2,dphase,q,finc,teff1,teff2,tgrav1,tgrav2,  &
   betarim,rinner,router,tdisk,xi,ntheta,nradius,alb1,alb2,nref,  &
   rlx,period,fm,separ,gamma,t3,g3,sa3,density,sw1,sw2,sw3,t0,  &
   idraw,iecheck,IDINT,iatm,ism1,icnu,icnb,icnv,icnr,icni,icnj,  &
   icnh,icnk,irvfilt,isw1,isw2,isw3,isw4,ilaw,wave,dbolx,dboly,  &
   dwavex,dwavey,ecc,argper,pshift,sw5,sw6,sw7,sw8,sw9,ikeep,  &
   isynch,isw5,isw6,isw7,isw8,isw9,spot1parm,spot2parm,  &
   spotdparm,primmass,primk,primrad,ratrad,frac1,frac2,ecosw,  &
   temprat,idark1,idark2,isw12,isw13,isw21,isw22,isw23,isw24,  &
   bigi,bigbeta,sw23,sw24,powercoeff,sw25,sw26,sw27,sw28,sw29,  &
   sw30,contam,tconj,beam1,beam2,isw25,isw26,isw27,isw28,isw29,  &
   isw30,isw31,isw32,isw33,isw34,ocose,osine,omegadot,contams0,  &
   contams1,contams2,contams3,sw47,sw48,sw49,sw80,sw81,sw82,  &
   sw83,sw84,sw85,sw86,sw87,sw88,sw89,isw80,isw81,isw82,isw83,  &
   isw84,isw85,isw86,isw87,isw88,isw89,sdarkint1,sdarkint2,  &
   sdarkint3,sdarkint4,sdarkint5)
!
!   November 15, 1999
!
!   This routine will write a file called 'gridELC.inp' which will be
!   of the same format as ELC.inp.  The parameters written will be those
!   found by gridELC.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nalph1
   INTEGER, INTENT(IN)                      :: nbet1
   INTEGER, INTENT(IN)                      :: nalph2
   INTEGER, INTENT(IN)                      :: nbet2
   REAL(KIND=dp), INTENT(IN)                :: fill1
   REAL(KIND=dp), INTENT(IN)                :: fill2
   REAL(KIND=dp), INTENT(IN)                :: omega1
   REAL(KIND=dp), INTENT(IN)                :: omega2
   REAL(KIND=dp), INTENT(IN)                :: dphase
   REAL(KIND=dp), INTENT(IN)                :: q
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: teff1
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN)                :: tgrav1
   REAL(KIND=dp), INTENT(IN)                :: tgrav2
   REAL(KIND=dp), INTENT(IN)                :: betarim
   REAL(KIND=dp), INTENT(IN)                :: rinner
   REAL(KIND=dp), INTENT(IN)                :: router
   REAL(KIND=dp), INTENT(IN)                :: tdisk
   REAL(KIND=dp), INTENT(IN)                :: xi
   INTEGER, INTENT(IN)                      :: ntheta
   INTEGER, INTENT(IN)                      :: nradius
   REAL(KIND=dp), INTENT(IN)                :: alb1
   REAL(KIND=dp), INTENT(IN)                :: alb2
   INTEGER, INTENT(IN)                      :: nref
   REAL(KIND=dp), INTENT(IN)                :: rlx
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: fm
   REAL(KIND=dp), INTENT(IN)                :: separ
   REAL(KIND=dp), INTENT(IN)                :: gamma
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: sa3
   REAL(KIND=dp), INTENT(IN)                :: density
   REAL(KIND=dp), INTENT(IN)                :: sw1
   REAL(KIND=dp), INTENT(IN)                :: sw2
   REAL(KIND=dp), INTENT(IN)                :: sw3
   REAL(KIND=dp), INTENT(IN)                :: t0
   INTEGER, INTENT(IN)                      :: idraw
   INTEGER, INTENT(IN)                      :: iecheck
   INTEGER, INTENT(IN)                      :: IDINT
   INTEGER, INTENT(IN)                      :: iatm
   INTEGER, INTENT(IN)                      :: ism1
   INTEGER, INTENT(OUT)                     :: icnu
   INTEGER, INTENT(OUT)                     :: icnb
   INTEGER, INTENT(OUT)                     :: icnv
   INTEGER, INTENT(OUT)                     :: icnr
   INTEGER, INTENT(OUT)                     :: icni
   INTEGER, INTENT(OUT)                     :: icnj
   INTEGER, INTENT(OUT)                     :: icnh
   INTEGER, INTENT(OUT)                     :: icnk
   INTEGER, INTENT(IN)                      :: irvfilt
   INTEGER, INTENT(IN)                      :: isw1
   INTEGER, INTENT(IN)                      :: isw2
   INTEGER, INTENT(IN)                      :: isw3
   INTEGER, INTENT(IN)                      :: isw4
   INTEGER, INTENT(IN)                      :: ilaw
   REAL(KIND=dp), INTENT(IN)                :: wave(8)
   REAL(KIND=dp), INTENT(IN)                :: dbolx(8,2)
   REAL(KIND=dp), INTENT(IN)                :: dboly(8,2)
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN)                :: argper
   REAL(KIND=dp), INTENT(IN)                :: pshift
   REAL(KIND=dp), INTENT(IN)                :: sw5
   REAL(KIND=dp), INTENT(IN)                :: sw6
   REAL(KIND=dp), INTENT(IN)                :: sw7
   REAL(KIND=dp), INTENT(IN)                :: sw8
   REAL(KIND=dp), INTENT(IN)                :: sw9
   INTEGER, INTENT(IN)                      :: ikeep
   INTEGER, INTENT(IN)                      :: isynch
   INTEGER, INTENT(IN)                      :: isw5
   INTEGER, INTENT(IN)                      :: isw6
   INTEGER, INTENT(IN)                      :: isw7
   INTEGER, INTENT(IN)                      :: isw8
   INTEGER, INTENT(IN)                      :: isw9
   REAL(KIND=dp), INTENT(IN)                :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: primmass
   REAL(KIND=dp), INTENT(IN)                :: primk
   REAL(KIND=dp), INTENT(IN)                :: primrad
   REAL(KIND=dp), INTENT(IN)                :: ratrad
   REAL(KIND=dp), INTENT(IN)                :: frac1
   REAL(KIND=dp), INTENT(IN)                :: frac2
   REAL(KIND=dp), INTENT(IN)                :: ecosw
   REAL(KIND=dp), INTENT(IN)                :: temprat
   INTEGER, INTENT(IN)                      :: idark1
   INTEGER, INTENT(IN)                      :: idark2
   INTEGER, INTENT(IN)                      :: isw12
   INTEGER, INTENT(IN)                      :: isw13
   INTEGER, INTENT(IN)                      :: isw21
   INTEGER, INTENT(IN)                      :: isw22
   INTEGER, INTENT(IN)                      :: isw23
   INTEGER, INTENT(IN)                      :: isw24
   REAL(KIND=dp), INTENT(IN)                :: bigi
   REAL(KIND=dp), INTENT(IN)                :: bigbeta
   REAL(KIND=dp), INTENT(IN)                :: sw23
   REAL(KIND=dp), INTENT(IN)                :: sw24
   REAL(KIND=dp), INTENT(IN)                :: powercoeff(8,9)
   REAL(KIND=dp), INTENT(IN)                :: sw25
   REAL(KIND=dp), INTENT(IN)                :: sw26
   REAL(KIND=dp), INTENT(IN)                :: sw27
   REAL(KIND=dp), INTENT(IN)                :: sw28
   REAL(KIND=dp), INTENT(IN)                :: sw29
   REAL(KIND=dp), INTENT(IN)                :: sw30
   REAL(KIND=dp), INTENT(IN)                :: contam
   REAL(KIND=dp), INTENT(IN)                :: tconj
   REAL(KIND=dp), INTENT(IN)                :: beam1
   REAL(KIND=dp), INTENT(IN)                :: beam2
   INTEGER, INTENT(IN)                      :: isw25
   INTEGER, INTENT(IN)                      :: isw26
   INTEGER, INTENT(IN)                      :: isw27
   INTEGER, INTENT(IN)                      :: isw28
   INTEGER, INTENT(IN)                      :: isw29
   INTEGER, INTENT(IN)                      :: isw30
   INTEGER, INTENT(IN)                      :: isw31
   INTEGER, INTENT(IN)                      :: isw32
   INTEGER, INTENT(IN)                      :: isw33
   INTEGER, INTENT(IN)                      :: isw34
   REAL(KIND=dp), INTENT(IN)                :: ocose
   REAL(KIND=dp), INTENT(IN)                :: osine
   REAL(KIND=dp), INTENT(IN)                :: omegadot
   REAL(KIND=dp), INTENT(IN)                :: contams0
   REAL(KIND=dp), INTENT(IN)                :: contams1
   REAL(KIND=dp), INTENT(IN)                :: contams2
   REAL(KIND=dp), INTENT(IN)                :: contams3
   REAL(KIND=dp), INTENT(IN)                :: sw47
   REAL(KIND=dp), INTENT(IN)                :: sw48
   REAL(KIND=dp), INTENT(IN)                :: sw49
   REAL(KIND=dp), INTENT(IN)                :: sw80
   REAL(KIND=dp), INTENT(IN)                :: sw81
   REAL(KIND=dp), INTENT(IN)                :: sw82
   REAL(KIND=dp), INTENT(IN)                :: sw83
   REAL(KIND=dp), INTENT(IN)                :: sw84
   REAL(KIND=dp), INTENT(IN)                :: sw85
   REAL(KIND=dp), INTENT(IN)                :: sw86
   REAL(KIND=dp), INTENT(IN)                :: sw87
   REAL(KIND=dp), INTENT(IN)                :: sw88
   REAL(KIND=dp), INTENT(IN)                :: sw89
   INTEGER, INTENT(IN)                      :: isw80
   INTEGER, INTENT(IN)                      :: isw81
   INTEGER, INTENT(IN)                      :: isw82
   INTEGER, INTENT(IN)                      :: isw83
   INTEGER, INTENT(IN)                      :: isw84
   INTEGER, INTENT(IN)                      :: isw85
   INTEGER, INTENT(IN)                      :: isw86
   INTEGER, INTENT(IN)                      :: isw87
   INTEGER, INTENT(IN)                      :: isw88
   INTEGER, INTENT(IN)                      :: isw89
   REAL(KIND=dp), INTENT(IN)                :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint5(8)
!
   INTEGER :: i,kkk,kk
!
   OPEN(UNIT=1,FILE='gridELC.inp',STATUS='unknown')
!
!   Set the icn? control numbers back to zeros and 1s.
!
   IF(icnu == 430)THEN
      icnu=0
   ELSE
      icnu=1
   END IF
   IF(icnb == 430)THEN
      icnb=0
   ELSE
      icnb=1
   END IF
   IF(icnv == 430)THEN
      icnv=0
   ELSE
      icnv=1
   END IF
   IF(icnr == 430)THEN
      icnr=0
   ELSE
      icnr=1
   END IF
   IF(icni == 430)THEN
      icni=0
   ELSE
      icni=1
   END IF
   IF(icnj == 430)THEN
      icnj=0
   ELSE
      icnj=1
   END IF
   IF(icnh == 430)THEN
      icnh=0
   ELSE
      icnh=1
   END IF
   IF(icnk == 430)THEN
      icnk=0
   ELSE
      icnk=1
   END IF
!
   WRITE(1,30)nalph1
   WRITE(1,40)nbet1
   WRITE(1,50)nalph2
   WRITE(1,60)nbet2
   WRITE(1,70)fill1
   WRITE(1,80)fill2
   WRITE(1,90)omega1
   WRITE(1,100)omega2
   WRITE(1,110)dphase
   WRITE(1,120)q
   WRITE(1,130)finc
   WRITE(1,140)teff1
   WRITE(1,150)teff2
   WRITE(1,160)tgrav1
   WRITE(1,170)tgrav2
   WRITE(1,180)betarim
   WRITE(1,190)rinner
   WRITE(1,200)router
   WRITE(1,210)tdisk
   WRITE(1,220)xi
   WRITE(1,230)ntheta
   WRITE(1,240)nradius
   WRITE(1,250)alb1
   WRITE(1,260)alb2
   WRITE(1,270)nref
   WRITE(1,280)rlx
   WRITE(1,290)period
   IF(fm > 1.0E-04_dp)THEN
      WRITE(1,300)fm
   ELSE
      WRITE(1,310)fm
   END IF
   WRITE(1,320)separ
   WRITE(1,330)gamma
   WRITE(1,340)t3
   WRITE(1,350)g3
   WRITE(1,360)sa3
   WRITE(1,370)density
   WRITE(1,380)sw1
   WRITE(1,390)sw2
   WRITE(1,400)sw3
   WRITE(1,410)t0
   WRITE(1,420)idraw
   WRITE(1,430)iecheck
   WRITE(1,440)IDINT
   WRITE(1,450)iatm
   WRITE(1,460)ism1
   WRITE(1,470)icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk
   WRITE(1,480)irvfilt
   WRITE(1,490)isw1
   WRITE(1,500)isw2
   WRITE(1,510)isw3
   WRITE(1,520)isw4
   WRITE(1,530)ilaw
!
   DO  i=1,8
      WRITE(1,540)wave(i),dbolx(i,1),dboly(i,1),dbolx(i,2),  &
         dboly(i,2),dwavex(i,1),dwavey(i,1),dwavex(i,2),dwavey(i,2)
   END DO
!
   WRITE(1,550)ecc
   WRITE(1,560)argper
   WRITE(1,570)pshift
   WRITE(1,580)sw5
   WRITE(1,590)sw6
   WRITE(1,600)sw7
   WRITE(1,610)sw8
   WRITE(1,620)sw9
   WRITE(1,630)ikeep
   WRITE(1,640)isynch
   WRITE(1,650)isw5
   WRITE(1,660)isw6
   WRITE(1,670)isw7
   WRITE(1,680)isw8
   WRITE(1,690)isw9
   WRITE(1,700)spot1parm(1,1)
   WRITE(1,710)spot1parm(1,2)
   WRITE(1,720)spot1parm(1,3)
   WRITE(1,730)spot1parm(1,4)
   WRITE(1,740)spot1parm(2,1)
   WRITE(1,750)spot1parm(2,2)
   WRITE(1,760)spot1parm(2,3)
   WRITE(1,770)spot1parm(2,4)
   WRITE(1,780)spot2parm(1,1)
   WRITE(1,790)spot2parm(1,2)
   WRITE(1,800)spot2parm(1,3)
   WRITE(1,810)spot2parm(1,4)
   WRITE(1,820)spot2parm(2,1)
   WRITE(1,830)spot2parm(2,2)
   WRITE(1,840)spot2parm(2,3)
   WRITE(1,850)spot2parm(2,4)
   WRITE(1,860)spotdparm(1,1)
   WRITE(1,870)spotdparm(1,2)
   WRITE(1,880)spotdparm(1,3)
   WRITE(1,890)spotdparm(1,4)
   WRITE(1,900)spotdparm(2,1)
   WRITE(1,910)spotdparm(2,2)
   WRITE(1,920)spotdparm(2,3)
   WRITE(1,930)spotdparm(2,4)
   WRITE(1,940)primmass
   WRITE(1,950)primk
   WRITE(1,960)primrad
   WRITE(1,970)ratrad
   WRITE(1,980)frac1
   WRITE(1,990)frac2
   WRITE(1,1000)ecosw
   WRITE(1,1010)temprat
   WRITE(1,1020)idark1
   WRITE(1,1030)idark2
   WRITE(1,1040)isw12
   WRITE(1,1050)isw13
   WRITE(1,1060)isw21
   WRITE(1,1070)isw22
   WRITE(1,1080)isw23
   WRITE(1,1090)isw24
!
   DO  kk=1,8
      WRITE(1,1100)powercoeff(kk,1),powercoeff(kk,2),  &
         powercoeff(kk,3),powercoeff(kk,4),powercoeff(kk,5),  &
         powercoeff(kk,6),powercoeff(kk,7),powercoeff(kk,8), &
         powercoeff(kk,9)
   END DO
!
   WRITE(1,1110)bigi
   WRITE(1,1120)bigbeta
   WRITE(1,1130)sw23
   WRITE(1,1140)sw24
   WRITE(1,1150)sw25
   WRITE(1,1160)sw26
   WRITE(1,1170)sw27
   WRITE(1,1180)sw28
   WRITE(1,1190)sw29
   WRITE(1,1200)sw30
   WRITE(1,1210)contam
   WRITE(1,1220)tconj
   WRITE(1,1230)beam1
   WRITE(1,1240)beam2
   WRITE(1,1250)isw25
   WRITE(1,1260)isw26
   WRITE(1,1270)isw27
   WRITE(1,1280)isw28
   WRITE(1,1290)isw29
   WRITE(1,1300)isw30
   WRITE(1,1310)isw31
   WRITE(1,1320)isw32
   WRITE(1,1330)isw33
   WRITE(1,1340)isw34
   WRITE(1,1350)ocose
   WRITE(1,1360)osine
   WRITE(1,1370)omegadot
   WRITE(1,1380)contams0
   WRITE(1,1390)contams1
   WRITE(1,1400)contams2
   WRITE(1,1410)contams3
   WRITE(1,1420)sw47
   WRITE(1,1430)sw48
   WRITE(1,1440)sw49
   WRITE(1,1450)sw80
   WRITE(1,1460)sw81
   WRITE(1,1470)sw82
   WRITE(1,1480)sw83
   WRITE(1,1490)sw84
   WRITE(1,1500)sw85
   WRITE(1,1510)sw86
   WRITE(1,1520)sw87
   WRITE(1,1530)sw88
   WRITE(1,1540)sw89
   WRITE(1,1550)isw80
   WRITE(1,1560)isw81
   WRITE(1,1570)isw82
   WRITE(1,1580)isw83
   WRITE(1,1590)isw84
   WRITE(1,1600)isw85
   WRITE(1,1610)isw86
   WRITE(1,1620)isw87
   WRITE(1,1630)isw88
   WRITE(1,1640)isw89
   WRITE(1,1650)(sdarkint1(kkk),kkk=1,8)
   WRITE(1,1660)(sdarkint2(kkk),kkk=1,8)
   WRITE(1,1670)(sdarkint3(kkk),kkk=1,8)
   WRITE(1,1680)(sdarkint4(kkk),kkk=1,8)
   WRITE(1,1690)(sdarkint5(kkk),kkk=1,8)
!
   CLOSE(1)
!
!  Reset the values of icnU, etc. in case they were 430
!   Set the icn? control numbers back to zeros and 1s.
!
   IF(icnu == 0)THEN
      icnu=430
   END IF
   IF(icnb == 0)THEN
      icnb=430
   END IF
   IF(icnv == 0)THEN
      icnv=430
   END IF
   IF(icnr == 0)THEN
      icnr=430
   END IF
   IF(icni == 0)THEN
      icni=430
   END IF
   IF(icnj == 0)THEN
      icnj=430
   END IF
   IF(icnh == 0)THEN
      icnh=430
   END IF
   IF(icnk == 0)THEN
      icnk=430
   END IF
!
30 FORMAT(i6,19X,'Nalph1')
40 FORMAT(i5,20X,'Nbet1')
50 FORMAT(i6,19X,'Nalph2')
60 FORMAT(i5,20X,'Nbet2')
70 FORMAT(f16.14,9X,'fill1')
80 FORMAT(f16.14,9X,'fill2')
90 FORMAT(f16.12,9X,'omega1')
100 FORMAT(f16.12,9X,'omega2')
110 FORMAT(f13.8,12X,'dphase')
120 FORMAT(f21.16,4X,'Q')
130 FORMAT(f21.16,4X,'finc')
140 FORMAT(f12.5,13X,'Teff1')
150 FORMAT(f12.5,13X,'Teff2')
160 FORMAT(f9.7,16X,'Tgrav1')
170 FORMAT(f9.7,16X,'Tgrav2')
180 FORMAT(f11.8,14X,'betarim')
190 FORMAT(f11.9,14X,'rinner')
200 FORMAT(f11.9,14X,'router')
210 FORMAT(f12.6,13X,'tdisk')
220 FORMAT(f12.9,13X,'xi')
230 FORMAT(i6,19X,'Ntheta')
240 FORMAT(i6,19X,'Nradius')
250 FORMAT(f12.10,13X,'alb1')
260 FORMAT(f12.10,13X,'alb2')
270 FORMAT(i2,23X,'Nref')
280 FORMAT(f13.8,12X,'Lx/Lopt')
290 FORMAT(f21.15,4X,'Period')
300 FORMAT(f8.5,17X,'fm')
310 FORMAT(1PE16.9,9X,'fm')
320 FORMAT(f20.11,5X,'separ')
330 FORMAT(f18.12,7X,'gamma velocity')
340 FORMAT(f18.10,7X,'t3')
350 FORMAT(f15.11,10X,'g3')
360 FORMAT(f22.16,3X,'SA3')
370 FORMAT(f12.6,13X,'density in g/cc')
380 FORMAT(f12.6,13X,'onephase')
390 FORMAT(f12.6,13X,'usepot1')
400 FORMAT(f12.6,13X,'usepot2')
410 FORMAT(f21.14,4X,'T0')
420 FORMAT(i1,24X,'idraw')
430 FORMAT(i1,24X,'iecheck')
440 FORMAT(i1,24X,'idint')
450 FORMAT(i1,24X,'iatm')
460 FORMAT(i1,24X,'ism1')
470 FORMAT(8(i1,1X),9X,'icnU,icnB,icnV,icnR,icnI,icnJ,icnH,icnK')
480 FORMAT(i1,24X,'iRVfilt')
490 FORMAT(i1,24X,'ionephase')
500 FORMAT(i1,24X,'isquare')
510 FORMAT(i1,24X,'iusepot')
520 FORMAT(i1,24X,'ifixgamma')
530 FORMAT(i2,23X,'ilaw  (1=lin. law, 2=log. law,',' 3=sqrt law, '  &
      ,'4=quad. law)')
540 FORMAT(f7.1,2X,4(f8.5,1X),4(f11.8,1X))
550 FORMAT(f18.12,7X,'eccentricity')
560 FORMAT(f19.14,6X,'argument of peristron in degrees')
570 FORMAT(f14.11,11X,'pshift')
580 FORMAT(f17.11,8X,'asini (projected semimajor axis in ','secon'  &
      ,'ds)')
590 FORMAT(f12.6,13X,'median fit (geneticELC only)')
600 FORMAT(f12.6,13X,'sw7 (currently inactive)')
610 FORMAT(f12.6,13X,'sw8 (currently inactive)')
620 FORMAT(f15.9,10X,'time step for itime=2')
630 FORMAT(i1,24X,'ikeep (1 to put eclipse at phase 0.0)')
640 FORMAT(i1,24X,'isynch (1 to keep rotation synchronous',' at p'  &
      ,'eriastron)')
650 FORMAT(i1,24X,'ispotprof')
660 FORMAT(i1,24X,'igrav')
670 FORMAT(i1,24X,'itime')
680 FORMAT(i6,19X,'MonteCarlo (0 for interpolation, >10 for ','Mo'  &
      ,'nte Carlo integration)')
690 FORMAT(i6,19X,'ielite')
700 FORMAT(f13.10,12X,'Temperature factor spot 1, star 1')
710 FORMAT(f13.9,12X,'Latitude of spot 1, star 1 (degrees)')
720 FORMAT(f13.9,12X,'Longitude of spot 1, star 1 (degrees)')
730 FORMAT(f13.9,12X,'Angular radius of spot 1, star 1 (degrees)')
740 FORMAT(f13.10,12X,'Temperature factor spot 2, star 1')
750 FORMAT(f13.9,12X,'Latitude of spot 2, star 1 (degrees)')
760 FORMAT(f13.9,12X,'Longitude of spot 2, star 1 (degrees)')
770 FORMAT(f13.9,12X,'Angular radius of spot 2, star 1 (degrees)')
780 FORMAT(f13.10,12X,'Temperature factor spot 1, star 2')
790 FORMAT(f13.9,12X,'Latitude of spot 1, star 2 (degrees)')
800 FORMAT(f13.9,12X,'Longitude of spot 1, star 2 (degrees)')
810 FORMAT(f13.9,12X,'Angular radius of spot 1, star 2 (degrees)')
820 FORMAT(f13.10,12X,'Temperature factor spot 2, star 2')
830 FORMAT(f13.9,12X,'Latitude of spot 2, star 2 (degrees)')
840 FORMAT(f13.9,12X,'Longitude of spot 2, star 2 (degrees)')
850 FORMAT(f13.9,12X,'Angular radius of spot 2, star 2 (degrees)')
860 FORMAT(f13.10,12X,'Temperature factor spot 1, disk')
870 FORMAT(f13.9,12X,'Azimuth of spot 1, disk (degrees)')
880 FORMAT(f13.9,12X,'Radial cutoff of spot 1, disk (0 <= ',' r_c'  &
      ,'ut <=1)')
890 FORMAT(f13.9,12X,'Angular size of spot 1, disk (degrees)')
900 FORMAT(f13.10,12X,'Temperature factor spot 2, disk')
910 FORMAT(f13.9,12X,'Azimuth of spot 2, disk (degrees)')
920 FORMAT(f13.9,12X,'Radial cutoff of spot 2, disk (0 <= r_cut',  &
      ' <=1)')
930 FORMAT(f13.9,12X,'Angular size of spot 2, disk (degrees)')
940 FORMAT(f20.16,5X,'primmass (star 1 mass in solar masses)')
950 FORMAT(f19.14,6X,'primK (K-velocity of star 1 in km/sec)')
960 FORMAT(f19.14,6X,'primrad (star 1 radius in solar radii)')
970 FORMAT(f21.14,4X,'ratrad (ratio of star 1 radius and star 2 r'  &
      ,'adius)')
980 FORMAT(f18.16,7X,'frac1 (fractional radius star 1: R_1/a)')
990 FORMAT(f18.16,7X,'frac2 (fractional radius star 2: R_2/a)')
1000 FORMAT(f17.14,8X,'ecosw (phase difference between eclipses)')
1010 FORMAT(f17.14,8X,'temprat (T_2/T_1)')
1020 FORMAT(i1,24X,'idark1')
1030 FORMAT(i1,24X,'idark2')
1040 FORMAT(i6,19X,'Npoly (0 for numerical integration)')
1050 FORMAT(i1,24X,'ifasttrans (>0 for fast transit mode)')
1060 FORMAT(i1,24X,'ialign (0 for rotation aligned with orbit)')
1070 FORMAT(i1,24X,'set to 1 to supress optimizer screen output')
1080 FORMAT(i1,24X,'iwriteeclipse (1 to fit eclipse times)')
1090 FORMAT(i1,24X,'frac switch (>1 to enable ELCratio.???? files)' )
1100 FORMAT(9(f7.4,1X))
1110 FORMAT(f14.10,11X,'axis_I (inclination of rotation axis if',''  &
      ,' ialign=1)')
1120 FORMAT(f14.10,11X,'axis_beta (angle of rotation axis wrt to ',  &
      ' orbit if ialign=1)')
1130 FORMAT(f18.7,7X,'t_start')
1140 FORMAT(f18.7,7X,'t_end')
1150 FORMAT(f13.10,12X,'asini error')
1160 FORMAT(f13.11,12X,'reference phase for disk fraction')
1170 FORMAT(f13.11,12X,'radfill1 (set to use fill1 in terms of R_e'  &
      ,'ff')
1180 FORMAT(f13.11,12X,'radfill2 (set to use fill2 in terms of R_e'  &
      ,'ff')
1190 FORMAT(f13.9,12X,'bin size for light curves (minutes)')
1200 FORMAT(f13.9,12X,'bin size for RV curves (minutes)')
1210 FORMAT(f16.14,9X,'Kepler contamination')
1220 FORMAT(f21.14,4X,'Tconj')
1230 FORMAT(f13.11,12X,'beam1 (Doppler boosting factor, star 1)')
1240 FORMAT(f13.11,12X,'beam2 (Doppler boosting factor, star 2)')
1250 FORMAT(i1,24X,'X-ray foreshortening switch',' (1 for point so'  &
      ,'urce)')
1260 FORMAT(i1,24X,'iGR (1 for GR, 2 for tidal, 3 for both)')
1270 FORMAT(i6,19X,'Nterms for fast analytic')
1280 FORMAT(i1,24X,'set to 1 to fit for Tconj')
1290 FORMAT(i1,24X,'set to 1 to fit for e*cos(omega), e*sin(omega)' )
1300 FORMAT(i1,24X,'body 3 switch')
1310 FORMAT(i6,19X,'Ngap')
1320 FORMAT(i16,9X,'jdum (seed for markovELC, geneticELC, ','rando'  &
      ,'mELC)')
1330 FORMAT(i1,24X,'mandel (0 for Gimenez, 1 for Mandel & Agol)')
1340 FORMAT(i1,24X,'Iseason (1 for seasonal Kepler contamination)')
1350 FORMAT(f20.16,5X,'e*cos(omega)')
1360 FORMAT(f20.16,5X,'e*sin(omega)')
1370 FORMAT(f17.13,8X,'omega_dot (degrees per year)')
1380 FORMAT(f17.13,8X,'contamS0 (season 0 contamination, tag s0)')
1390 FORMAT(f17.13,8X,'contamS1 (season 1 contamination, tag s1)')
1400 FORMAT(f17.13,8X,'contamS2 (season 2 contamination, tag s2)')
1410 FORMAT(f17.13,8X,'contamS3 (season 3 contamination, tag s3)')
1420 FORMAT(f19.8,6X,'Tref for dynamical integrator')
1430 FORMAT(f12.8,13X,'threshold to write chi^2')
1440 FORMAT(f13.10,12X,'Omega_bin ','(Nodal angle of binary in deg'  &
      ,'rees)')
1450 FORMAT(f10.4,15X,'Teff4       tag t4')
1460 FORMAT(f10.4,15X,'Teff5       tag t5')
1470 FORMAT(f7.4,18X,'g4')
1480 FORMAT(f7.4,18X,'g5')
1490 FORMAT(f12.2,13X,'chi^2 penalty for transit')
1500 FORMAT(f4.2,21X,'impact parameter threshold for ','eclipse ch'  &
      ,'ecking')
1510 FORMAT(f4.2,21X,'sw86 (currently inactive)')
1520 FORMAT(f4.2,21X,'sw87 (currently inactive)')
1530 FORMAT(f4.2,21X,'sw88 (currently inactive)')
1540 FORMAT(f4.2,21X,'sw89 (currently inactive)')
1550 FORMAT(i1,24X,'set to 1 for binary+binary mode (use',' body3 '  &
      ,'switch=4)')
1560 FORMAT(i1,24X,'set to 1 for transit penalty')
1570 FORMAT(i1,24X,'set to 1 to exclude body 3 eclipses')
1580 FORMAT(i1,24X,'set to 1 to exclude body 4 eclipses')
1590 FORMAT(i1,24X,'set to 1 to exclude body 5 eclipses')
1600 FORMAT(i1,24X,'set to 1 to exclude secondary eclipses')
1610 FORMAT(i1,24X,'set to 1 to use fluxes (needs Nterms>0)')
1620 FORMAT(i1,24X,'set to 1 for fast binning of Kepler models')
1630 FORMAT(i3,21X,'Ndynwin')
1640 FORMAT(i1,24X,'NSC')
1650 FORMAT(8(f11.7,1X),' fluxes for star 1')
1660 FORMAT(8(f11.7,1X),' fluxes for star 2')
1670 FORMAT(8(f11.7,1X),' fluxes for star 3')
1680 FORMAT(8(f11.7,1X),' fluxes for star 4')
1690 FORMAT(8(f11.7,1X),' fluxes for star 5')
!
   RETURN
!
END SUBROUTINE writegridout
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writejump(mmm,nnn,jumpindex)
!
!  Writes jump statistics for markovELC to the screen in a nice way.
!
   USE accur
!
   IMPLICIT NONE

   INTEGER, INTENT(IN)                      :: mmm
   INTEGER, INTENT(IN)                      :: nnn
   INTEGER, INTENT(IN)                      :: jumpindex
!
   IF(jumpindex >= 10)THEN
      IF((mmm == 1).AND.(nnn == 1))THEN
         WRITE(*,10)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,20)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 10).AND.(nnn < 100)))THEN
         WRITE(*,30)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,40)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 1000).AND.(nnn < 10000)))THEN
         WRITE(*,50)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,60)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 10).AND.(nnn.LT.100)))THEN
         WRITE(*,70)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 100).AND.(nnn.LT.1000)))THEN
         WRITE(*,80)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 1000).AND.(nnn.LT.10000)))THEN
         WRITE(*,90)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn > 1).AND.(nnn.LT.10)))THEN
         WRITE(*,100)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 10).AND.(nnn.LT.100)))THEN
         WRITE(*,110)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,120)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 1000).AND.(nnn < 10000)))THEN
         WRITE(*,130)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,140)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 10).AND.(nnn < 100)))THEN
         WRITE(*,150)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,160)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 1000).AND.  &
         (nnn < 10000)))THEN
         WRITE(*,170)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1000).AND.(mmm < 10000)).AND.((nnn >= 1000)  &
         .AND.(nnn < 10000)))THEN
         WRITE(*,180)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1000).AND.(mmm < 10000)).AND.((nnn >= 10000)  &
         .AND.(nnn < 100000)))THEN
         WRITE(*,190)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10000).AND.(mmm < 100000)).AND.((nnn >= 10000)  &
         .AND.(nnn < 100000)))THEN
         WRITE(*,200)mmm,nnn,jumpindex
      END IF
   END IF
   IF(jumpindex < 10)THEN
      IF((mmm == 1).AND.(nnn == 1))THEN
         WRITE(*,210)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,220)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 10).AND.(nnn < 100)))THEN
         WRITE(*,230)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,240)mmm,nnn,jumpindex
      END IF
      IF((mmm == 1).AND.((nnn >= 1000).AND.(nnn < 10000)))THEN
         WRITE(*,250)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,260)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 10).AND.(nnn.LT.100)))THEN
         WRITE(*,270)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 100).AND.(nnn.LT.1000)))THEN
         WRITE(*,280)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1).AND.(mmm < 10)).AND.((nnn >= 1000).AND.(nnn.LT.10000)))THEN
         WRITE(*,290)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn > 1).AND.(nnn.LT.10)))THEN
         WRITE(*,300)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 10).AND.(nnn.LT.100)))THEN
         WRITE(*,310)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,320)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10).AND.(mmm < 100)).AND.((nnn >= 1000).AND.(nnn < 10000)))THEN
         WRITE(*,330)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn > 1).AND.(nnn < 10)))THEN
         WRITE(*,340)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 10).AND.(nnn < 100)))THEN
         WRITE(*,350)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 100).AND.(nnn < 1000)))THEN
         WRITE(*,360)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 100).AND.(mmm < 1000)).AND.((nnn >= 1000).AND.  &
         (nnn < 10000)))THEN
         WRITE(*,370)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1000).AND.(mmm < 10000)).AND.((nnn >= 1000)  &
         .AND.(nnn < 10000)))THEN
         WRITE(*,380)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 1000).AND.(mmm < 10000)).AND.((nnn >= 10000)  &
         .AND.(nnn < 100000)))THEN
         WRITE(*,390)mmm,nnn,jumpindex
      END IF
      IF(((mmm > 10000).AND.(mmm < 100000)).AND.((nnn >= 10000)  &
         .AND.(nnn < 100000)))THEN
         WRITE(*,400)mmm,nnn,jumpindex
      END IF
   END IF
!
10 FORMAT(i1,' jump taken out of ',i1,' try for parameter #',i2)
20 FORMAT(i1,' jump taken out of ',i1,' tries for parameter #',i2)
30 FORMAT(i1,' jump taken out of ',i2,' tries for parameter #',i2)
40 FORMAT(i1,' jump taken out of ',i3,' tries for parameter #',i2)
50 FORMAT(i1,' jump taken out of ',i4,' tries for parameter #',i2)
60 FORMAT(i1,' jumps taken out of ',i1,' tries for parameter #',i2)
70 FORMAT(i1,' jumps taken out of ',i2,' tries for parameter #',i2)
80 FORMAT(i1,' jumps taken out of ',i3,' tries for parameter #',i2)
90 FORMAT(i1,' jumps taken out of ',i4,' tries for parameter #',i2)
100 FORMAT(i2,' jumps taken out of ',i1,' tries for parameter #',i2)
110 FORMAT(i2,' jumps taken out of ',i2,' tries for parameter #',i2)
120 FORMAT(i2,' jumps taken out of ',i3,' tries for parameter #',i2)
130 FORMAT(i2,' jumps taken out of ',i4,' tries for parameter #',i2)
140 FORMAT(i3,' jumps taken out of ',i1,' tries for parameter #',i2)
150 FORMAT(i3,' jumps taken out of ',i2,' tries for parameter #',i2)
160 FORMAT(i3,' jumps taken out of ',i3,' tries for parameter #',i2)
170 FORMAT(i3,' jumps taken out of ',i4,' tries for parameter #',i2)
180 FORMAT(i4,' jumps taken out of ',i4,' tries for parameter #',i2)
190 FORMAT(i4,' jumps taken out of ',i5,' tries for parameter #',i2)
200 FORMAT(i5,' jumps taken out of ',i5,' tries for parameter #',i2)
210 FORMAT(i1,' jump taken out of ',i1,' try for parameter #',i1)
220 FORMAT(i1,' jump taken out of ',i1,' tries for parameter #',i1)
230 FORMAT(i1,' jump taken out of ',i2,' tries for parameter #',i1)
240 FORMAT(i1,' jump taken out of ',i3,' tries for parameter #',i1)
250 FORMAT(i1,' jump taken out of ',i4,' tries for parameter #',i1)
260 FORMAT(i1,' jumps taken out of ',i1,' tries for parameter #',i1)
270 FORMAT(i1,' jumps taken out of ',i2,' tries for parameter #',i1)
280 FORMAT(i1,' jumps taken out of ',i3,' tries for parameter #',i1)
290 FORMAT(i1,' jumps taken out of ',i4,' tries for parameter #',i1)
300 FORMAT(i2,' jumps taken out of ',i1,' tries for parameter #',i1)
310 FORMAT(i2,' jumps taken out of ',i2,' tries for parameter #',i1)
320 FORMAT(i2,' jumps taken out of ',i3,' tries for parameter #',i1)
330 FORMAT(i2,' jumps taken out of ',i4,' tries for parameter #',i1)
340 FORMAT(i3,' jumps taken out of ',i1,' tries for parameter #',i1)
350 FORMAT(i3,' jumps taken out of ',i2,' tries for parameter #',i1)
360 FORMAT(i3,' jumps taken out of ',i3,' tries for parameter #',i1)
370 FORMAT(i3,' jumps taken out of ',i4,' tries for parameter #',i1)
380 FORMAT(i4,' jumps taken out of ',i4,' tries for parameter #',i1)
390 FORMAT(i4,' jumps taken out of ',i5,' tries for parameter #',i1)
400 FORMAT(i5,' jumps taken out of ',i5,' tries for parameter #',i1)
!
   RETURN
!
END SUBROUTINE writejump
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writemodels(nphase,isw7,xmod,ymodu,ymodb,ymodv,ymodr,ymodi,  &
   ymodj,ymodh,ymodk,ymods1,ymods2,ymods3,ymods4,ymods5,t3,g3,sa3,iidint,  &
   ymodd,nrvphase,xrvmod,rv1,rv2,rv3,rv4,isw30,ggamma1,ggamma2,ggamma3,  &
   itime,ndatamax,ndatau,ndatab,ndatav,ndatar,ndatai,ndataj,ndatah,ndatak,  &
   nrv1,nrv2,nrv3,nrv4,xdatau,ydatau,erru,xdatab,ydatab,errb,xdatav,ydatav,  &
   errv,xdatar,ydatar,errr,xdatai,ydatai,erri,xdataj,ydataj,errj,xdatah,  &
   ydatah,errh,xdatak,ydatak,errk,xrv1,yrv1,errrv1,xrv2,yrv2,errrv2,xrv3,  &
   yrv3,errrv3,xrv4,yrv4,errrv4,resu,resb,resv,resr,resi,resj,resh,resk,  &
   icnu,icnb,icnv,icnr,icni,icnj,icnh,icnk,icnrv1,icnrv2,icnrv3,icnrv4,  &
   zerou,zerob,zerov,zeror,zeroi,zeroj,zeroh,zerok,resrv1,resrv2,resrv3,  &
   resrv4,drv1,drv2,imag,resttimes,icnarry,nobscycle,obsterr,nmeclps,  &
   obsttimes,drv3,drv4,drv5,rv5,resrv1arry,resrv2arry,resrv3arry,resrv4arry,  &
   resrv5arry,gamma1arry,gamma2arry,gamma3arry,gamma4arry,gamma5arry,  &
   ifixgamma,nset,nrv1arry,icnrv1arry,xrv1arry,yrv1arry,errrv1arry,nrv2arry,  &
   icnrv2arry,xrv2arry,yrv2arry,errrv2arry,nrv3arry,icnrv3arry,xrv3arry,  &
   yrv3arry,errrv3arry,nrv4arry,icnrv4arry,xrv4arry,yrv4arry,errrv4arry,  &
   nrv5arry,icnrv5arry,xrv5arry,yrv5arry,errrv5arry)                            
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nmeclps
   INTEGER, INTENT(IN)                      :: nphase
   INTEGER, INTENT(IN)                      :: isw7
   REAL(KIND=dp), INTENT(IN)                :: xmod(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodu(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodb(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodv(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodr(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodi(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodj(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodh(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymodk(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods1(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods2(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods3(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods4(nphase)
   REAL(KIND=dp), INTENT(IN)                :: ymods5(nphase)
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: sa3
   INTEGER, INTENT(IN)                      :: iidint
   REAL(KIND=dp), INTENT(IN)                :: ymodd(nphase)
   INTEGER, INTENT(IN)                      :: nrvphase
   REAL(KIND=dp), INTENT(IN)                :: xrvmod(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: rv1(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: rv2(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: rv3(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: rv4(nrvphase)
   INTEGER, INTENT(IN)                      :: isw30
   REAL(KIND=dp), INTENT(IN)                :: ggamma1
   REAL(KIND=dp), INTENT(IN)                :: ggamma2
   REAL(KIND=dp), INTENT(IN)                :: ggamma3
   INTEGER, INTENT(IN)                      :: itime
   INTEGER, INTENT(IN)                      :: ndatamax
   INTEGER, INTENT(IN)                      :: ndatau
   INTEGER, INTENT(IN)                      :: ndatab
   INTEGER, INTENT(IN)                      :: ndatav
   INTEGER, INTENT(IN)                      :: ndatar
   INTEGER, INTENT(IN)                      :: ndatai
   INTEGER, INTENT(IN)                      :: ndataj
   INTEGER, INTENT(IN)                      :: ndatah
   INTEGER, INTENT(IN)                      :: ndatak
   INTEGER, INTENT(IN OUT)                 :: nrv1
   INTEGER, INTENT(IN OUT)                 :: nrv2
   INTEGER, INTENT(IN OUT)                 :: nrv3
   INTEGER, INTENT(IN OUT)                 :: nrv4
   REAL(KIND=dp), INTENT(IN)                :: xdatau(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatau(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: erru(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatab(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatab(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errb(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatav(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatav(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errv(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatar(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatar(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errr(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatai(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatai(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: erri(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdataj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydataj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatah(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatah(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errh(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: xdatak(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: ydatak(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: errk(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: xrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: yrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: errrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resu(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resb(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resv(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resr(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resi(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resj(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resh(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: resk(ndatamax)
   INTEGER, INTENT(IN)                      :: icnu
   INTEGER, INTENT(IN)                      :: icnb
   INTEGER, INTENT(IN)                      :: icnv
   INTEGER, INTENT(IN)                      :: icnr
   INTEGER, INTENT(IN)                      :: icni
   INTEGER, INTENT(IN)                      :: icnj
   INTEGER, INTENT(IN)                      :: icnh
   INTEGER, INTENT(IN)                      :: icnk
   INTEGER, INTENT(IN)                      :: icnrv1
   INTEGER, INTENT(IN)                      :: icnrv2
   INTEGER, INTENT(IN)                      :: icnrv3
   INTEGER, INTENT(IN)                      :: icnrv4
   REAL(KIND=dp), INTENT(IN)                :: zerou
   REAL(KIND=dp), INTENT(IN)                :: zerob
   REAL(KIND=dp), INTENT(IN)                :: zerov
   REAL(KIND=dp), INTENT(IN)                :: zeror
   REAL(KIND=dp), INTENT(IN)                :: zeroi
   REAL(KIND=dp), INTENT(IN)                :: zeroj
   REAL(KIND=dp), INTENT(IN)                :: zeroh
   REAL(KIND=dp), INTENT(IN)                :: zerok
   REAL(KIND=dp), INTENT(IN OUT)            :: resrv1(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: resrv2(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: resrv3(ndatamax)
   REAL(KIND=dp), INTENT(IN OUT)            :: resrv4(ndatamax)
   REAL(KIND=dp), INTENT(IN)                :: drv1(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: drv2(nrvphase)
   INTEGER, INTENT(IN)                      :: imag
   REAL(KIND=dp), INTENT(IN)                :: resttimes(40,nmeclps)
   INTEGER, INTENT(IN)                      :: icnarry(40)
   INTEGER, INTENT(IN)                      :: nobscycle(40)
   REAL(KIND=dp), INTENT(IN)                :: obsterr(40,nmeclps)
   REAL(KIND=dp), INTENT(IN)                :: obsttimes(40,nmeclps)
   REAL(KIND=dp), INTENT(IN)                :: drv3(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: drv4(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: drv5(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: rv5(nrvphase)
   REAL(KIND=dp), INTENT(IN)                :: resrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: resrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: resrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: resrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: resrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: gamma1arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma2arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma3arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma4arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma5arry(5)
   INTEGER, INTENT(IN)                      :: ifixgamma
   INTEGER, INTENT(IN)                      :: nset
   INTEGER, INTENT(IN)                      :: nrv1arry(5)
   INTEGER, INTENT(IN)                      :: icnrv1arry(5)
   REAL(KIND=dp), INTENT(IN)                :: xrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: yrv1arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: errrv1arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv2arry(5)
   INTEGER, INTENT(IN)                      :: icnrv2arry(5)
   REAL(KIND=dp), INTENT(IN)                :: xrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: yrv2arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: errrv2arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv3arry(5)
   INTEGER, INTENT(IN)                      :: icnrv3arry(5)
   REAL(KIND=dp), INTENT(IN)                :: xrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: yrv3arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: errrv3arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv4arry(5)
   INTEGER, INTENT(IN)                      :: icnrv4arry(5)
   REAL(KIND=dp), INTENT(IN)                :: xrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: yrv4arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: errrv4arry(ndatamax,5)
   INTEGER, INTENT(IN)                      :: nrv5arry(5)
   INTEGER, INTENT(IN)                      :: icnrv5arry(5)
   REAL(KIND=dp), INTENT(IN)                :: xrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: yrv5arry(ndatamax,5)
   REAL(KIND=dp), INTENT(IN)                :: errrv5arry(ndatamax,5)
!
   REAL(KIND=dp), DIMENSION(ndatamax)  :: xrv5,yrv5,errrv5,resrv5
!
   INTEGER :: kflag,i,j,nrv5
!
!   DIMENSION  yrv5(ndatamax),errrv5(ndatamax),resrv5(ndatamax),xrv5(ndatamax)
!
   IF(imag == 0)THEN
      IF(icnu /= 430)CALL wlinmod(nphase,xmod,ymodu,'modelU.linear',isw7,1.0_dp)
      IF(icnb /= 430)CALL wlinmod(nphase,xmod,ymodb,'modelB.linear',isw7,1.0_dp)
      IF(icnv /= 430)CALL wlinmod(nphase,xmod,ymodv,'modelV.linear',isw7,1.0_dp)
      IF(icnr /= 430)CALL wlinmod(nphase,xmod,ymodr,'modelR.linear',isw7,1.0_dp)
      IF(icni /= 430)CALL wlinmod(nphase,xmod,ymodi,'modelI.linear',isw7,1.0_dp)
      IF(icnj /= 430)CALL wlinmod(nphase,xmod,ymodj,'modelJ.linear',isw7,1.0_dp)
      IF(icnh /= 430)CALL wlinmod(nphase,xmod,ymodh,'modelH.linear',isw7,1.0_dp)
      IF(icnk /= 430)CALL wlinmod(nphase,xmod,ymodk,'modelK.linear',isw7,1.0_dp)
   END IF
!
   IF(imag > 0)THEN
      IF(icnu /= 430)CALL wlinmod(nphase,xmod,ymodu,'modelU.linear',isw7,zerou)
      IF(icnb /= 430)CALL wlinmod(nphase,xmod,ymodb,'modelB.linear',isw7,zerob)
      IF(icnv /= 430)CALL wlinmod(nphase,xmod,ymodv,'modelV.linear',isw7,zerov)
      IF(icnr /= 430)CALL wlinmod(nphase,xmod,ymodr,'modelR.linear',isw7,zeror)
      IF(icni /= 430)CALL wlinmod(nphase,xmod,ymodi,'modelI.linear',isw7,zeroi)
      IF(icnj /= 430)CALL wlinmod(nphase,xmod,ymodj,'modelJ.linear',isw7,zeroj)
      IF(icnh /= 430)CALL wlinmod(nphase,xmod,ymodh,'modelH.linear',isw7,zeroh)
      IF(icnk /= 430)CALL wlinmod(nphase,xmod,ymodk,'modelK.linear',isw7,zerok)
   END IF
!
   IF(imag == 0)THEN
      IF(icnu /= 430)CALL wmagmod(nphase,xmod,ymodu,'modelU.mag', isw7,zerou)
      IF(icnb /= 430)CALL wmagmod(nphase,xmod,ymodb,'modelB.mag', isw7,zerob)
      IF(icnv /= 430)CALL wmagmod(nphase,xmod,ymodv,'modelV.mag', isw7,zerov)
      IF(icnr /= 430)CALL wmagmod(nphase,xmod,ymodr,'modelR.mag', isw7,zeror)
      IF(icni /= 430)CALL wmagmod(nphase,xmod,ymodi,'modelI.mag', isw7,zeroi)
      IF(icnj /= 430)CALL wmagmod(nphase,xmod,ymodj,'modelJ.mag', isw7,zeroj)
      IF(icnh /= 430)CALL wmagmod(nphase,xmod,ymodh,'modelH.mag', isw7,zeroh)
      IF(icnk /= 430)CALL wmagmod(nphase,xmod,ymodk,'modelK.mag', isw7,zerok)
   END IF
!
   IF(imag > 0)THEN
      IF(icnu /= 430)CALL wmagmod(nphase,xmod,ymodu,'modelU.mag', isw7,80.0_dp)
      IF(icnb /= 430)CALL wmagmod(nphase,xmod,ymodb,'modelB.mag', isw7,80.0_dp)
      IF(icnv /= 430)CALL wmagmod(nphase,xmod,ymodv,'modelV.mag', isw7,80.0_dp)
      IF(icnr /= 430)CALL wmagmod(nphase,xmod,ymodr,'modelR.mag', isw7,80.0_dp)
      IF(icni /= 430)CALL wmagmod(nphase,xmod,ymodi,'modelI.mag', isw7,80.0_dp)
      IF(icnj /= 430)CALL wmagmod(nphase,xmod,ymodj,'modelJ.mag', isw7,80.0_dp)
      IF(icnh /= 430)CALL wmagmod(nphase,xmod,ymodh,'modelH.mag', isw7,80.0_dp)
      IF(icnk /= 430)CALL wmagmod(nphase,xmod,ymodk,'modelK.mag', isw7,80.0_dp)
   END IF
!
   CALL wlinmod(nphase,xmod,ymods1,'lcstar1.linear',isw7,1.0_dp)
   CALL wlinmod(nphase,xmod,ymods2,'lcstar2.linear',isw7,1.0_dp)
!
   IF((t3 > 0.0_dp).AND.(g3 > 0.0_dp).AND.(sa3 > 0.0_dp))THEN
      kflag=1
   ELSE
      kflag=0
   END IF
   IF((isw30 >= 3).OR.(kflag == 1))THEN
      CALL wlinmod(nphase,xmod,ymods3,'lcstar3.linear',isw7,1.0_dp)
   END IF
   IF(isw30 >= 4)THEN
      CALL wlinmod(nphase,xmod,ymods4,'lcstar4.linear',isw7,1.0_dp)
   END IF
   IF(isw30 >= 5)THEN
      CALL wlinmod(nphase,xmod,ymods5,'lcstar5.linear',isw7,1.0_dp)
   END IF
!
   IF(iidint >= 1)CALL wlinmod(nphase,xmod,ymodd,'lcdisk.linear' ,isw7,1.0_dp)
!
   IF(itime > 0)THEN
      IF(icnu /= 430)CALL welcdata(ndatamax,ndatau,xdatau,ydatau,  &
         erru,'ELCdataU.fold')
      IF(icnb /= 430)CALL welcdata(ndatamax,ndatab,xdatab,ydatab,  &
         errb,'ELCdataB.fold')
      IF(icnv /= 430)CALL welcdata(ndatamax,ndatav,xdatav,ydatav,  &
         errv,'ELCdataV.fold')
      IF(icnr /= 430)CALL welcdata(ndatamax,ndatar,xdatar,ydatar,  &
         errr,'ELCdataR.fold')
      IF(icni /= 430)CALL welcdata(ndatamax,ndatai,xdatai,ydatai,  &
         erri,'ELCdataI.fold')
      IF(icnj /= 430)CALL welcdata(ndatamax,ndataj,xdataj,ydataj,  &
         errj,'ELCdataJ.fold')
      IF(icnh /= 430)CALL welcdata(ndatamax,ndatah,xdatah,ydatah,  &
         errh,'ELCdataH.fold')
      IF(icnk /= 430)CALL welcdata(ndatamax,ndatak,xdatak,ydatak,  &
         errk,'ELCdataK.fold')
!
!  If ifixgamma is 0, 1, or 2, we have only at most one gamma
!  value per body.  If ifixgamma is 10, 11, or 12, we can
!  have up to 5 gamma velocities per body.
!
      IF(ifixgamma < 10)THEN
!
         IF(icnrv1 /= 430)CALL welcdata(ndatamax,nrv1,xrv1,yrv1,  &
            errrv1,'ELCdataRV1.fold')
         IF(icnrv2 /= 430)CALL welcdata(ndatamax,nrv2,xrv2,yrv2,  &
            errrv2,'ELCdataRV2.fold')
         IF(icnrv3 /= 430)CALL welcdata(ndatamax,nrv3,xrv3,yrv3,  &
            errrv3,'ELCdataRV3.fold')
         IF(icnrv4 /= 430)CALL welcdata(ndatamax,nrv4,xrv4,yrv4,  &
            errrv4,'ELCdataRV4.fold')
!
         IF(icnrv1 /= 430)CALL welcdata(ndatamax,nrv1,xrv1,resrv1,  &
            errrv1,'ELCresidualsRV1.fold')
         IF(icnrv2 /= 430)CALL welcdata(ndatamax,nrv2,xrv2,resrv2,  &
            errrv2,'ELCresidualsRV2.fold')
         IF(icnrv3 /= 430)CALL welcdata(ndatamax,nrv3,xrv3,resrv3,  &
            errrv3,'ELCresidualsRV3.fold')
         IF(icnrv4 /= 430)CALL welcdata(ndatamax,nrv4,xrv4,resrv4,  &
            errrv4,'ELCresidualsRV4.fold')
!
         IF(icnRV1.ne.430)CALL wrvmod(nrvphase,xrvmod,rv1,'star1.RV',isw7,ggamma1)
         IF(icnRV2.ne.430)CALL wrvmod(nrvphase,xrvmod,rv2,'star2.RV',isw7,ggamma2)
         IF(isw30 >= 3)CALL wrvmod(nrvphase,xrvmod,rv3,'star3.RV', isw7,ggamma3)
         IF(isw30 >= 3)CALL wlinmod(nrvphase,xrvmod,drv3,  &
            'star3.delRV',isw7,1.0_dp)
         IF(isw30 >= 4)CALL wrvmod(nrvphase,xrvmod,rv4,'star4.RV', isw7,ggamma1)
         IF(isw30 >= 4)CALL wlinmod(nrvphase,xrvmod,drv4,  &
            'star4.delRV',isw7,1.0_dp)
         IF(isw30 >= 5)CALL wrvmod(nrvphase,xrvmod,rv5,'star5.RV', isw7,ggamma1)
         IF(isw30 >= 5)CALL wlinmod(nrvphase,xrvmod,drv5,  &
            'star5.delRV',isw7,1.0_dp)
         IF(icnRV1.ne.430)CALL wlinmod(nrvphase,xrvmod,drv1,'star1.delRV',isw7,1.0_dp)
         IF(icnRV2.ne.430)CALL wlinmod(nrvphase,xrvmod,drv2,'star2.delRV',isw7,1.0_dp)
!
      ELSE
!
!  fitting for RV sets
!
         DO i=1,nset
!
!   loop over the sets and check case by case
!
            IF(icnRV1.ne.430)CALL wrvmod(nrvphase,xrvmod,rv1,'star1.RV',isw7,0.0_dp)
            IF(icnRV2.ne.430)CALL wrvmod(nrvphase,xrvmod,rv2,'star2.RV',isw7,0.0_dp)
            IF(isw30 >= 3)CALL wrvmod(nrvphase,xrvmod,rv3,'star3.RV',isw7,0.0_dp)
            IF(isw30 >= 4)CALL wrvmod(nrvphase,xrvmod,rv4,'star4.RV',isw7,0.0_dp)
            IF(isw30 >= 5)CALL wrvmod(nrvphase,xrvmod,rv5,'star5.RV',isw7,0.0_dp)
            IF(icnRV1.ne.430)CALL wlinmod(nrvphase,xrvmod,drv1,'star1.delRV',isw7,1.0_dp)
            IF(icnRV2.ne.430)CALL wlinmod(nrvphase,xrvmod,drv2,'star2.delRV',isw7,1.0_dp)
            IF(isw30 >= 3)CALL wlinmod(nrvphase,xrvmod,drv3,  &
               'star3.delRV',isw7,1.0_dp)
            IF(isw30 >= 4)CALL wlinmod(nrvphase,xrvmod,drv4,  &
               'star4.delRV',isw7,1.0_dp)
            IF(isw30 >= 5)CALL wlinmod(nrvphase,xrvmod,drv5,  &
               'star5.delRV',isw7,1.0_dp)
!
            IF(icnrv1arry(i) /= 430)THEN
               DO j=1,nrv1arry(i)
                  xrv1(j)=xrv1arry(j,i)
                  yrv1(j)=yrv1arry(j,i)-gamma1arry(i)
                  resrv1(j)=resrv1arry(j,i)
                  errrv1(j)=errrv1arry(j,i)
               END DO
               nrv1=nrv1arry(i)
               IF(i == 1)THEN
                  CALL welcdata(ndatamax,nrv1,xrv1,yrv1,errrv1,'ELCdataRV1A.fold')
                  CALL welcdata(ndatamax,nrv1,xrv1,resrv1,errrv1,  &
                     'ELCresidualsRV1A.fold')
               END IF
               IF(i == 2)THEN
                  CALL welcdata(ndatamax,nrv1,xrv1,yrv1,errrv1,'ELCdataRV1B.fold')
                  CALL welcdata(ndatamax,nrv1,xrv1,resrv1,errrv1,  &
                     'ELCresidualsRV1B.fold')
               END IF
               IF(i == 3)THEN
                  CALL welcdata(ndatamax,nrv1,xrv1,yrv1,errrv1,'ELCdataRV1C.fold')
                  CALL welcdata(ndatamax,nrv1,xrv1,resrv1,errrv1,  &
                     'ELCresidualsRV1C.fold')
               END IF
               IF(i == 4)THEN
                  CALL welcdata(ndatamax,nrv1,xrv1,yrv1,errrv1,'ELCdataRV1D.fold')
                  CALL welcdata(ndatamax,nrv1,xrv1,resrv1,errrv1,  &
                     'ELCresidualsRV1D.fold')
               END IF
               IF(i == 5)THEN
                  CALL welcdata(ndatamax,nrv1,xrv1,yrv1,errrv1,'ELCdataRV1E.fold')
                  CALL welcdata(ndatamax,nrv1,xrv1,resrv1,errrv1,  &
                     'ELCresidualsRV1E.fold')
               END IF
!
            END IF
!
            IF(icnrv2arry(i) /= 430)THEN
               DO j=1,nrv2arry(i)
                  xrv2(j)=xrv2arry(j,i)
                  yrv2(j)=yrv2arry(j,i)-gamma2arry(i)
                  resrv2(j)=resrv2arry(j,i)
                  errrv2(j)=errrv2arry(j,i)
               END DO
               nrv2=nrv2arry(i)
               IF(i == 1)THEN
                  CALL welcdata(ndatamax,nrv2,xrv2,yrv2,errrv2,'ELCdataRV2A.fold')
                  CALL welcdata(ndatamax,nrv2,xrv2,resrv2,errrv2,  &
                     'ELCresidualsRV2A.fold')
               END IF
               IF(i == 2)THEN
                  CALL welcdata(ndatamax,nrv2,xrv2,yrv2,errrv2,'ELCdataRV2B.fold')
                  CALL welcdata(ndatamax,nrv2,xrv2,resrv2,errrv2,  &
                     'ELCresidualsRV2B.fold')
               END IF
               IF(i == 3)THEN
                  CALL welcdata(ndatamax,nrv2,xrv2,yrv2,errrv2,'ELCdataRV2C.fold')
                  CALL welcdata(ndatamax,nrv2,xrv2,resrv2,errrv2,  &
                     'ELCresidualsRV2C.fold')
               END IF
               IF(i == 4)THEN
                  CALL welcdata(ndatamax,nrv2,xrv2,yrv2,errrv2,'ELCdataRV2D.fold')
                  CALL welcdata(ndatamax,nrv2,xrv2,resrv2,errrv2,  &
                     'ELCresidualsRV2D.fold')
               END IF
               IF(i == 5)THEN
                  CALL welcdata(ndatamax,nrv2,xrv2,yrv2,errrv2,'ELCdataRV2E.fold')
                  CALL welcdata(ndatamax,nrv2,xrv2,resrv2,errrv2,  &
                     'ELCresidualsRV2E.fold')
               END IF
            END IF
!
            IF(icnrv3arry(i) /= 430)THEN
               DO j=1,nrv3arry(i)
                  xrv3(j)=xrv3arry(j,i)
                  yrv3(j)=yrv3arry(j,i)-gamma3arry(i)
                  resrv3(j)=resrv3arry(j,i)
                  errrv3(j)=errrv3arry(j,i)
               END DO
               nrv3=nrv3arry(i)
               IF(i == 1)THEN
                  CALL welcdata(ndatamax,nrv3,xrv3,yrv3,errrv3,'ELCdataRV3A.fold')
                  CALL welcdata(ndatamax,nrv3,xrv3,resrv3,errrv3,  &
                     'ELCresidualsRV3A.fold')
               END IF
               IF(i == 2)THEN
                  CALL welcdata(ndatamax,nrv3,xrv3,yrv3,errrv3,'ELCdataRV3B.fold')
                  CALL welcdata(ndatamax,nrv3,xrv3,resrv3,errrv3,  &
                     'ELCresidualsRV3B.fold')
               END IF
               IF(i == 3)THEN
                  CALL welcdata(ndatamax,nrv3,xrv3,yrv3,errrv3,'ELCdataRV3C.fold')
                  CALL welcdata(ndatamax,nrv3,xrv3,resrv3,errrv3,  &
                     'ELCresidualsRV3C.fold')
               END IF
               IF(i == 4)THEN
                  CALL welcdata(ndatamax,nrv3,xrv3,yrv3,errrv3,'ELCdataRV3D.fold')
                  CALL welcdata(ndatamax,nrv3,xrv3,resrv3,errrv3,  &
                     'ELCresidualsRV3D.fold')
               END IF
               IF(i == 5)THEN
                  CALL welcdata(ndatamax,nrv3,xrv3,yrv3,errrv3,'ELCdataRV3E.fold')
                  CALL welcdata(ndatamax,nrv3,xrv3,resrv3,errrv3,  &
                     'ELCresidualsRV3E.fold')
               END IF
            END IF
!
            IF(icnrv4arry(i) /= 430)THEN
               DO j=1,nrv4arry(i)
                  xrv4(j)=xrv4arry(j,i)
                  yrv4(j)=yrv4arry(j,i)-gamma4arry(i)
                  resrv4(j)=resrv4arry(j,i)
                  errrv4(j)=errrv4arry(j,i)
               END DO
               nrv4=nrv4arry(i)
               IF(i == 1)THEN
                  CALL welcdata(ndatamax,nrv4,xrv4,yrv4,errrv4,'ELCdataRV4A.fold')
                  CALL welcdata(ndatamax,nrv4,xrv4,resrv4,errrv4,  &
                     'ELCresidualsRV4A.fold')
               END IF
               IF(i == 2)THEN
                  CALL welcdata(ndatamax,nrv4,xrv4,yrv4,errrv4,'ELCdataRV4B.fold')
                  CALL welcdata(ndatamax,nrv4,xrv4,resrv4,errrv4,  &
                     'ELCresidualsRV4B.fold')
               END IF
               IF(i == 3)THEN
                  CALL welcdata(ndatamax,nrv4,xrv4,yrv4,errrv4,'ELCdataRV4C.fold')
                  CALL welcdata(ndatamax,nrv4,xrv4,resrv4,errrv4,  &
                     'ELCresidualsRV4C.fold')
               END IF
               IF(i == 4)THEN
                  CALL welcdata(ndatamax,nrv4,xrv4,yrv4,errrv4,'ELCdataRV4D.fold')
                  CALL welcdata(ndatamax,nrv4,xrv4,resrv4,errrv4,  &
                     'ELCresidualsRV4D.fold')
               END IF
               IF(i == 5)THEN
                  CALL welcdata(ndatamax,nrv4,xrv4,yrv4,errrv4,'ELCdataRV4E.fold')
                  CALL welcdata(ndatamax,nrv4,xrv4,resrv4,errrv4,  &
                     'ELCresidualsRV4E.fold')
               END IF
            END IF
!
            IF(icnrv5arry(i) /= 430)THEN
               DO j=1,nrv5arry(i)
                  xrv5(j)=xrv5arry(j,i)
                  yrv5(j)=yrv5arry(j,i)-gamma5arry(i)
                  resrv5(j)=resrv5arry(j,i)
                  errrv5(j)=errrv5arry(j,i)
               END DO
               nrv5=nrv5arry(i)
               IF(i == 1)THEN
                  CALL welcdata(ndatamax,nrv5,xrv5,yrv5,errrv5,'ELCdataRV5A.fold')
                  CALL welcdata(ndatamax,nrv5,xrv5,resrv5,errrv5,  &
                     'ELCresidualsRV5A.fold')
               END IF
               IF(i == 2)THEN
                  CALL welcdata(ndatamax,nrv5,xrv5,yrv5,errrv5,'ELCdataRV5B.fold')
                  CALL welcdata(ndatamax,nrv5,xrv5,resrv5,errrv5,  &
                     'ELCresidualsRV5B.fold')
               END IF
               IF(i == 3)THEN
                  CALL welcdata(ndatamax,nrv5,xrv5,yrv5,errrv5,'ELCdataRV5C.fold')
                  CALL welcdata(ndatamax,nrv5,xrv5,resrv5,errrv5,  &
                     'ELCresidualsRV5C.fold')
               END IF
               IF(i == 4)THEN
                  CALL welcdata(ndatamax,nrv5,xrv5,yrv5,errrv5,'ELCdataRV5D.fold')
                  CALL welcdata(ndatamax,nrv5,xrv5,resrv5,errrv5,  &
                     'ELCresidualsRV5D.fold')
               END IF
               IF(i == 5)THEN
                  CALL welcdata(ndatamax,nrv5,xrv5,yrv5,errrv5,'ELCdataRV5E.fold')
                  CALL welcdata(ndatamax,nrv5,xrv5,resrv5,errrv5,  &
                     'ELCresidualsRV5E.fold')
               END IF
            END IF
!
!   END DO over i = 1, Nset
!
         END DO
!
!  end if ifixgamma < 10
!
      END IF

!  end if itime > 0

   END IF
!
   IF(icnu /= 430)CALL welcdata(ndatamax,ndatau,xdatau,resu,  &
      erru,'ELCresidualsU.fold')
   IF(icnb /= 430)CALL welcdata(ndatamax,ndatab,xdatab,resb,  &
      errb,'ELCresidualsB.fold')
   IF(icnv /= 430)CALL welcdata(ndatamax,ndatav,xdatav,resv,  &
      errv,'ELCresidualsV.fold')
   IF(icnr /= 430)CALL welcdata(ndatamax,ndatar,xdatar,resr,  &
      errr,'ELCresidualsR.fold')
   IF(icni /= 430)CALL welcdata(ndatamax,ndatai,xdatai,resi,  &
      erri,'ELCresidualsI.fold')
   IF(icnj /= 430)CALL welcdata(ndatamax,ndataj,xdataj,resj,  &
      errj,'ELCresidualsJ.fold')
   IF(icnh /= 430)CALL welcdata(ndatamax,ndatah,xdatah,resh,  &
      errh,'ELCresidualsH.fold')
   IF(icnk /= 430)CALL welcdata(ndatamax,ndatak,xdatak,resk,  &
      errk,'ELCresidualsK.fold')
!
   IF(icnrv1 /= 430)CALL welcdata(ndatamax,nrv1,xrv1,resrv1,  &
      errrv1,'ELCresidualsRV1.fold')
   IF(icnrv2 /= 430)CALL welcdata(ndatamax,nrv2,xrv2,resrv2,  &
      errrv2,'ELCresidualsRV2.fold')
!
!
!   write out residuals for eclipse times, if any
!
   DO i=1,40
      IF(icnarry(i) /= 430)THEN
!
         IF(i == 1)OPEN(UNIT=20,FILE='ELCprimtime_res.dat',STATUS='unknown')
!
         IF(i == 2)OPEN(UNIT=20,FILE='ELCsectime_res.dat',STATUS='unknown')
!
         IF(i == 3)OPEN(UNIT=20,FILE='ELC3tran1time_res.dat',STATUS='unknown')
!
         IF(i == 4)OPEN(UNIT=20,FILE='ELC1occul3time_res.dat',STATUS='unknown')
!
         IF(i == 5)OPEN(UNIT=20,FILE='ELC3tran2time_res.dat',STATUS='unknown')
!
         IF(i == 6)OPEN(UNIT=20,FILE='ELC2occul3time_res.dat',STATUS='unknown')
!
         IF(i == 7)OPEN(UNIT=20,FILE='ELC4tran1time_res.dat',STATUS='unknown')
!
         IF(i == 8)OPEN(UNIT=20,FILE='ELC1occul4time_res.dat',STATUS='unknown')
!
         IF(i == 9)OPEN(UNIT=20,FILE='ELC4tran2time_res.dat',STATUS='unknown')
!
         IF(i == 10)OPEN(UNIT=20,FILE='ELC2occul4time_res.dat',STATUS='unknown')
!
         IF(i == 35)OPEN(UNIT=20,FILE='ELC4tran3time_res.dat',STATUS='unknown')
!
         IF(i == 36)OPEN(UNIT=20,FILE='ELC3occul4time_res.dat',STATUS='unknown')
!
         IF(i == 37)OPEN(UNIT=20,FILE='ELC5tran3time_res.dat',STATUS='unknown')
!
         IF(i == 38)OPEN(UNIT=20,FILE='ELC3occul5time_res.dat',STATUS='unknown')
!
         IF(i == 39)OPEN(UNIT=20,FILE='ELC5tran4time_res.dat',STATUS='unknown')
!
         IF(i == 40)OPEN(UNIT=20,FILE='ELC4occul5time_res.dat',STATUS='unknown')
!
         IF(i == 11)OPEN(UNIT=20,FILE='ELC5tran1time_res.dat',STATUS='unknown')
!
         IF(i == 12)OPEN(UNIT=20,FILE='ELC1occul5time_res.dat',STATUS='unknown')
!
         IF(i == 13)OPEN(UNIT=20,FILE='ELC5tran2time_res.dat',STATUS='unknown')
!
         IF(i == 14)OPEN(UNIT=20,FILE='ELC2occul5time_res.dat',STATUS='unknown')
!
         IF(i == 15)OPEN(UNIT=20,FILE='ELC6tran1time_res.dat',STATUS='unknown')
!
         IF(i == 16)OPEN(UNIT=20,FILE='ELC1occul6time_res.dat',STATUS='unknown')
!
         IF(i == 17)OPEN(UNIT=20,FILE='ELC6tran2time_res.dat',STATUS='unknown')
!
         IF(i == 18)OPEN(UNIT=20,FILE='ELC2occul6time_res.dat',STATUS='unknown')
!
         IF(i == 19)OPEN(UNIT=20,FILE='ELC7tran1time_res.dat',STATUS='unknown')
!
         IF(i == 20)OPEN(UNIT=20,FILE='ELC1occul7time_res.dat',STATUS='unknown')
!
         IF(i == 21)OPEN(UNIT=20,FILE='ELC7tran2time_res.dat',STATUS='unknown')
!
         IF(i == 22)OPEN(UNIT=20,FILE='ELC2occul7time_res.dat',STATUS='unknown')
!
         IF(i == 23)OPEN(UNIT=20,FILE='ELC8tran1time_res.dat',STATUS='unknown')
!
         IF(i == 24)OPEN(UNIT=20,FILE='ELC1occul8time_res.dat',STATUS='unknown')
!
         IF(i == 25)OPEN(UNIT=20,FILE='ELC8tran2time_res.dat',STATUS='unknown')
!
         IF(i == 26)OPEN(UNIT=20,FILE='ELC2occul8time_res.dat',STATUS='unknown')
!
         IF(i == 27)OPEN(UNIT=20,FILE='ELC9tran1time_res.dat',STATUS='unknown')
!
         IF(i == 28)OPEN(UNIT=20,FILE='ELC1occul9time_res.dat',STATUS='unknown')
!
         IF(i == 29)OPEN(UNIT=20,FILE='ELC9tran2time_res.dat',STATUS='unknown')
!
         IF(i == 30)OPEN(UNIT=20,FILE='ELC2occul9time_res.dat',STATUS='unknown')
!
         IF(i == 31)OPEN(UNIT=20,FILE='ELC10tran1time_res.dat',STATUS='unknown')
!
         IF(i == 32)OPEN(UNIT=20,FILE='ELC1occul10time_res.dat',STATUS='unknown')
!
         IF(i == 33)OPEN(UNIT=20,FILE='ELC10tran2time_res.dat',STATUS='unknown')
!
         IF(i == 34)OPEN(UNIT=20,FILE='ELC2occul10time_res.dat',STATUS='unknown')
!
         DO j=1,nobscycle(i)
            WRITE(20,100)obsttimes(i,j),resttimes(i,j),obsterr(i,j)
         END DO
!
         CLOSE(20)
      END IF
   END DO
!
100 FORMAT(3(f20.10,3X))
!
   RETURN
!
END SUBROUTINE writemodels
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writepenaltychi(penaltyarr)
!
!  This routine will write chi^2 penalties associated with transits
!  and eclipses to the screen output.
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: penaltyarr(3)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: iwrite,ilength,lll,iline,ii
!
   CHARACTER(LEN=80) :: line
   CHARACTER(LEN=30) :: outstring
   CHARACTER(LEN=13) :: instringmed(36),instringchi(36)
!
!   COMMON /medblock/ rmed
!
   instringmed(1)=' med_penalty1'
   instringmed(2)=' med_penalty2'
   instringmed(3)=' med_ecl03'
   instringmed(4)=' med_ecl04'
   instringmed(5)=' med_ecl05'
   instringmed(6)=' med_ecl06'
   instringmed(7)=' med_ecl07'
   instringmed(8)=' med_ecl08'
   instringmed(9)=' med_ecl09'
   instringmed(10)=' med_ecl10'
   instringmed(11)=' med_ecl11'
   instringmed(12)=' med_ecl12'
   instringmed(13)=' med_ecl13'
   instringmed(14)=' med_ecl14'
   instringmed(15)=' med_ecl15'
   instringmed(16)=' med_ecl16'
   instringmed(17)=' med_ecl17'
   instringmed(18)=' med_ecl18'
   instringmed(19)=' med_ecl19'
   instringmed(20)=' med_ecl20'
   instringmed(21)=' med_ecl21'
   instringmed(22)=' med_ecl22'
   instringmed(23)=' med_ecl23'
   instringmed(24)=' med_ecl24'
   instringmed(25)=' med_ecl25'
   instringmed(26)=' med_ecl26'
   instringmed(27)=' med_ecl27'
   instringmed(28)=' med_ecl28'
   instringmed(29)=' med_ecl29'
   instringmed(30)=' med_ecl30'
   instringmed(31)=' med_ecl31'
   instringmed(32)=' med_ecl32'
   instringmed(33)=' med_ecl33'
   instringmed(34)=' med_ecl34'
   instringmed(35)=' med_ecl35'
   instringmed(36)=' med_ecl36'
!
   instringchi(1)=' chi_penalty1'
   instringchi(2)=' chi_penalty2'
   instringchi(3)=' secl_penalty'
   instringchi(4)=' chi_ecl04'
   instringchi(5)=' chi_ecl05'
   instringchi(6)=' chi_ecl06'
   instringchi(7)=' chi_ecl07'
   instringchi(8)=' chi_ecl08'
   instringchi(9)=' chi_ecl09'
   instringchi(10)=' chi_ecl10'
   instringchi(11)=' chi_ecl11'
   instringchi(12)=' chi_ecl12'
   instringchi(13)=' chi_ecl13'
   instringchi(14)=' chi_ecl14'
   instringchi(15)=' chi_ecl15'
   instringchi(16)=' chi_ecl16'
   instringchi(17)=' chi_ecl17'
   instringchi(18)=' chi_ecl18'
   instringchi(19)=' chi_ecl19'
   instringchi(20)=' chi_ecl20'
   instringchi(21)=' chi_ecl21'
   instringchi(22)=' chi_ecl22'
   instringchi(23)=' chi_ecl23'
   instringchi(24)=' chi_ecl24'
   instringchi(25)=' chi_ecl25'
   instringchi(26)=' chi_ecl26'
   instringchi(27)=' chi_ecl27'
   instringchi(28)=' chi_ecl28'
   instringchi(29)=' chi_ecl29'
   instringchi(30)=' chi_ecl30'
   instringchi(31)=' chi_ecl31'
   instringchi(32)=' chi_ecl32'
   instringchi(33)=' chi_ecl33'
   instringchi(34)=' chi_ecl34'
   instringchi(35)=' chi_ecl35'
   instringchi(36)=' chi_ecl36'
!
   iline=0
   iwrite=0
   line='  -->'
   ilength=5
!
   DO ii=1,2
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring(instringmed(ii),penaltyarr(ii),outstring, lll)
      ELSE
         CALL chistring(instringchi(ii),penaltyarr(ii),outstring, lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,10) line
         ilength=5
         line='  -->'
      END IF
   END DO
!
   IF(ilength > 5.AND.iwrite == 0)WRITE(*,10)line
!
10 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE writepenaltychi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writesecpenaltychi(penaltyarr)
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN)                :: penaltyarr(3)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: iwrite,ilength,lll,iline,ii
!
   CHARACTER(LEN=80) :: line
   CHARACTER(LEN=50) :: outstring
   CHARACTER(LEN=16) :: instringmed(36),instringchi(36)
!
!   COMMON /medblock/ rmed
!
   instringmed(1)=' med_penalty1'
   instringmed(2)=' med_penalty2'
   instringmed(3)=' sec_ecl_penalty'
   instringmed(4)=' med_ecl04'
   instringmed(5)=' med_ecl05'
   instringmed(6)=' med_ecl06'
   instringmed(7)=' med_ecl07'
   instringmed(8)=' med_ecl08'
   instringmed(9)=' med_ecl09'
   instringmed(10)=' med_ecl10'
   instringmed(11)=' med_ecl11'
   instringmed(12)=' med_ecl12'
   instringmed(13)=' med_ecl13'
   instringmed(14)=' med_ecl14'
   instringmed(15)=' med_ecl15'
   instringmed(16)=' med_ecl16'
   instringmed(17)=' med_ecl17'
   instringmed(18)=' med_ecl18'
   instringmed(19)=' med_ecl19'
   instringmed(20)=' med_ecl20'
   instringmed(21)=' med_ecl21'
   instringmed(22)=' med_ecl22'
   instringmed(23)=' med_ecl23'
   instringmed(24)=' med_ecl24'
   instringmed(25)=' med_ecl25'
   instringmed(26)=' med_ecl26'
   instringmed(27)=' med_ecl27'
   instringmed(28)=' med_ecl28'
   instringmed(29)=' med_ecl29'
   instringmed(30)=' med_ecl30'
   instringmed(31)=' med_ecl31'
   instringmed(32)=' med_ecl32'
   instringmed(33)=' med_ecl33'
   instringmed(34)=' med_ecl34'
   instringmed(35)=' med_ecl35'
   instringmed(36)=' med_ecl36'
!
   instringchi(1)=' chi_penalty1'
   instringchi(2)=' chi_penalty2'
   instringchi(3)=' sec_ecl_penalty'
   instringchi(4)=' chi_ecl04'
   instringchi(5)=' chi_ecl05'
   instringchi(6)=' chi_ecl06'
   instringchi(7)=' chi_ecl07'
   instringchi(8)=' chi_ecl08'
   instringchi(9)=' chi_ecl09'
   instringchi(10)=' chi_ecl10'
   instringchi(11)=' chi_ecl11'
   instringchi(12)=' chi_ecl12'
   instringchi(13)=' chi_ecl13'
   instringchi(14)=' chi_ecl14'
   instringchi(15)=' chi_ecl15'
   instringchi(16)=' chi_ecl16'
   instringchi(17)=' chi_ecl17'
   instringchi(18)=' chi_ecl18'
   instringchi(19)=' chi_ecl19'
   instringchi(20)=' chi_ecl20'
   instringchi(21)=' chi_ecl21'
   instringchi(22)=' chi_ecl22'
   instringchi(23)=' chi_ecl23'
   instringchi(24)=' chi_ecl24'
   instringchi(25)=' chi_ecl25'
   instringchi(26)=' chi_ecl26'
   instringchi(27)=' chi_ecl27'
   instringchi(28)=' chi_ecl28'
   instringchi(29)=' chi_ecl29'
   instringchi(30)=' chi_ecl30'
   instringchi(31)=' chi_ecl31'
   instringchi(32)=' chi_ecl32'
   instringchi(33)=' chi_ecl33'
   instringchi(34)=' chi_ecl34'
   instringchi(35)=' chi_ecl35'
   instringchi(36)=' chi_ecl36'
!
   iline=0
   iwrite=0
   line='  -->'
   ilength=5
!
   DO ii=3,3
      iline=iline+1
      iwrite=0
      IF(rmed >= 1.0_dp)THEN
         CALL chistring(instringmed(ii),penaltyarr(ii),outstring,lll)
      ELSE
         CALL chistring(instringchi(ii),penaltyarr(ii),outstring,lll)
      END IF
      line=TRIM(line)//outstring
      ilength=ilength+lll
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,10)line
         ilength=5
         line='  -->'
      END IF
   END DO
!
   IF(ilength > 5.AND.iwrite == 0)WRITE(*,10)line
!
10 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE writesecpenaltychi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writeshrink(index,number)
!
!   Used by simplexELC
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN OUT)                  :: index
   INTEGER, INTENT(IN OUT)                  :: number
!
   IF((index < 10).AND.(number < 10))THEN
      WRITE(*,10)index,number
   END IF
!
   IF((index >= 10).AND.(index < 100).AND.(number < 10))THEN
      WRITE(*,20)index,number
   END IF
!
   IF((index >= 100).AND.(number < 10))THEN
      WRITE(*,30)index,number
   END IF
!
   IF((index < 10).AND.(number >= 10).AND.(number < 100))THEN
      WRITE(*,40)index,number
   END IF
!
   IF((index >= 10).AND.(index < 100).AND.(number >= 10).AND.  &
      (number < 100))THEN
      WRITE(*,50)index,number
   END IF
!
   IF((index >= 100).AND.(number >= 10).AND.(number < 100))THEN
      WRITE(*,60)index,number
   END IF
!
   IF((index < 10).AND.(number >= 100))THEN
      WRITE(*,70)index,number
   END IF
!
   IF((index >= 10).AND.(index < 100).AND.(number >= 100))THEN
      WRITE(*,80)index,number
   END IF
!
   IF((index >= 100).AND.(number >= 100))THEN
      WRITE(*,90)index,number
   END IF
!
10 FORMAT('Shrinking vertex ',i1,' out of ',i1)
20 FORMAT('Shrinking vertex ',i2,' out of ',i1)
30 FORMAT('Shrinking vertex ',i3,' out of ',i1)
40 FORMAT('Shrinking vertex ',i1,' out of ',i2)
50 FORMAT('Shrinking vertex ',i2,' out of ',i2)
60 FORMAT('Shrinking vertex ',i3,' out of ',i2)
70 FORMAT('Shrinking vertex ',i1,' out of ',i2)
80 FORMAT('Shrinking vertex ',i2,' out of ',i2)
90 FORMAT('Shrinking vertex ',i3,' out of ',i2)
!
   RETURN
!
END SUBROUTINE writeshrink
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writetimechi(icnarray,chitimearray)
!
!  Will write the chi^2 values of the eclipse time fits
!
   USE accur
   USE medblock
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: icnarray(40)
   REAL(KIND=dp), INTENT(IN)                :: chitimearray(40)
!
!   REAL(KIND=dp)  :: rmed
!
   INTEGER :: iline,iwrite,ilength,ii,lll
!
   CHARACTER(LEN=10) :: instringmed(40),instringchi(40)
   CHARACTER(LEN=30) :: outstring
   CHARACTER(LEN=80) :: line
!
!   COMMON /medblock/ rmed
!
   instringmed(1)=' med_ecl01'
   instringmed(2)=' med_ecl02'
   instringmed(3)=' med_ecl03'
   instringmed(4)=' med_ecl04'
   instringmed(5)=' med_ecl05'
   instringmed(6)=' med_ecl06'
   instringmed(7)=' med_ecl07'
   instringmed(8)=' med_ecl08'
   instringmed(9)=' med_ecl09'
   instringmed(10)=' med_ecl10'
   instringmed(11)=' med_ecl11'
   instringmed(12)=' med_ecl12'
   instringmed(13)=' med_ecl13'
   instringmed(14)=' med_ecl14'
   instringmed(15)=' med_ecl15'
   instringmed(16)=' med_ecl16'
   instringmed(17)=' med_ecl17'
   instringmed(18)=' med_ecl18'
   instringmed(19)=' med_ecl19'
   instringmed(20)=' med_ecl20'
   instringmed(21)=' med_ecl21'
   instringmed(22)=' med_ecl22'
   instringmed(23)=' med_ecl23'
   instringmed(24)=' med_ecl24'
   instringmed(25)=' med_ecl25'
   instringmed(26)=' med_ecl26'
   instringmed(27)=' med_ecl27'
   instringmed(28)=' med_ecl28'
   instringmed(29)=' med_ecl29'
   instringmed(30)=' med_ecl30'
   instringmed(31)=' med_ecl31'
   instringmed(32)=' med_ecl32'
   instringmed(33)=' med_ecl33'
   instringmed(34)=' med_ecl34'
   instringmed(35)=' med_ecl35'
   instringmed(36)=' med_ecl36'
   instringmed(37)=' med_ecl37'
   instringmed(38)=' med_ecl38'
   instringmed(39)=' med_ecl39'
   instringmed(40)=' med_ecl40'
!
   instringchi(1)=' chi_ecl01'
   instringchi(2)=' chi_ecl02'
   instringchi(3)=' chi_ecl03'
   instringchi(4)=' chi_ecl04'
   instringchi(5)=' chi_ecl05'
   instringchi(6)=' chi_ecl06'
   instringchi(7)=' chi_ecl07'
   instringchi(8)=' chi_ecl08'
   instringchi(9)=' chi_ecl09'
   instringchi(10)=' chi_ecl10'
   instringchi(11)=' chi_ecl11'
   instringchi(12)=' chi_ecl12'
   instringchi(13)=' chi_ecl13'
   instringchi(14)=' chi_ecl14'
   instringchi(15)=' chi_ecl15'
   instringchi(16)=' chi_ecl16'
   instringchi(17)=' chi_ecl17'
   instringchi(18)=' chi_ecl18'
   instringchi(19)=' chi_ecl19'
   instringchi(20)=' chi_ecl20'
   instringchi(21)=' chi_ecl21'
   instringchi(22)=' chi_ecl22'
   instringchi(23)=' chi_ecl23'
   instringchi(24)=' chi_ecl24'
   instringchi(25)=' chi_ecl25'
   instringchi(26)=' chi_ecl26'
   instringchi(27)=' chi_ecl27'
   instringchi(28)=' chi_ecl28'
   instringchi(29)=' chi_ecl29'
   instringchi(30)=' chi_ecl30'
   instringchi(31)=' chi_ecl31'
   instringchi(32)=' chi_ecl32'
   instringchi(33)=' chi_ecl33'
   instringchi(34)=' chi_ecl34'
   instringchi(35)=' chi_ecl35'
   instringchi(36)=' chi_ecl36'
   instringchi(37)=' chi_ecl37'
   instringchi(38)=' chi_ecl38'
   instringchi(39)=' chi_ecl39'
   instringchi(40)=' chi_ecl40'
!
   iline=0
   iwrite=0
   line='  -->'
   ilength=5
!
   DO ii=1,40
      IF(icnarray(ii) /= 430)THEN
         iline=iline+1
         iwrite=0
         IF(rmed >= 1.0_dp)THEN
            CALL chistring(instringmed(ii),chitimearray(ii),outstring,lll)
         ELSE
            CALL chistring(instringchi(ii),chitimearray(ii),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,10)line
            ilength=5
            line='  -->'
         END IF
      END IF
   END DO
!
   IF(ilength > 5.AND.iwrite == 0)WRITE(*,10)line
!
10 FORMAT(a80)
!
   RETURN
!
END SUBROUTINE writetimechi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE writevar(nvarmax,svar,fill1,fill2,omega1,  &
   omega2,q,finc,teff1,teff2,betarim,rinner,router,tdisk,xi,rlx,  &
   separ,isvel1,gamma1,isvel2,gamma2,t3,g3,sa3,ecc,argper,  &
   pshift,spot1parm,spot2parm,spotdparm,period,t0,alb1,alb2,  &
   dwavex,dwavey,primmass,primk,primrad,ratrad,frac1,frac2,  &
   ecosw,temprat,bigi,bigbeta,density,tconj,beam1,  &
   beam2,contam,ocose,osine,isw29,tertperiod,tertt0,tertecos,  &
   tertesin,tertincl,tertomega,tertq,tgrav1,tgrav2,tertconj,  &
   omegadot,contams0,contams1,contams2,contams3,p2tconj,  &
   p2period,p2t0,p2ecos,p2esin,p2incl,p2omega,p2q,p2ratrad,  &
   p3tconj,p3period,p3t0,p3ecos,p3esin,p3incl,p3omega,p3q,  &
   p3ratrad,p4tconj,p4period,p4t0,p4ecos,p4esin,p4incl,p4omega,  &
   p4q,p4ratrad,p5tconj,p5period,p5t0,p5ecos,p5esin,p5incl,  &
   p5omega,p5q,p5ratrad,p6tconj,p6period,p6t0,p6ecos,p6esin,  &
   p6incl,p6omega,p6q,p6ratrad,p7tconj,p7period,p7t0,p7ecos,  &
   p7esin,p7incl,p7omega,p7q,p7ratrad,p8tconj,p8period,p8t0,  &
   p8ecos,p8esin,p8incl,p8omega,p8q,p8ratrad,gamma3,isvel3,sw72,  &
   sw73,sw49,sw80,sw81,sdarkint1,sdarkint2,sdarkint3,sdarkint4,  &
   sdarkint5,gamma4,isvel4,tertratrad,p1mtc,p1ptc,p2mtc,p2ptc,  &
   p3mtc,p3ptc,p4mtc,p4ptc,p5mtc,p5ptc,p6mtc,p6ptc,p7mtc,p7ptc,  &
   p8mtc,p8ptc,pbmtc,pbptc,bigi2,bigi3,bigi4,bigbeta2,bigbeta3,  &
   bigbeta4,bin2q,b2massdiff,b2masssum,b2raddiff,  &
   b2radsum,bin2ratrad,g10,g6,g7,g8,g9,massdiff,masssum,  &
   omega3,omega4,omega5,omega6,omega7,omega8,omega9,omega10,  &
   raddiff,radsum,rk3,rk4,rk5,rk6,rk7,rk8,rk9,rk10,sdarkint6,  &
   sdarkint7,sdarkint8,sdarkint9,sdarkint10,secmass,secrad,t10,  &
   t6,t7,t8,t9,fracsum,fracdiff,bin2m3,bin2m4,bin2r3,bin2r4,  &
   sqecos,sqesin,sqtertecos,sqtertesin,sqp2ecos,sqp2esin,  &
   sqp3ecos,sqp3esin,sqp4ecos,sqp4esin,sqp5ecos,sqp5esin,  &
   sqp6ecos,sqp6esin,sqp7ecos,sqp7esin,sqp8ecos,sqp8esin,  &
   angsum1,angdiff1,angsum2,angdiff2,angsum3,angdiff3,angsum4,  &
   angdiff4,angsum5,angdiff5,angsum6,angdiff6,angsum7,angdiff7,  &
   angsum8,angdiff8,isw86,fillsum,filldiff,binqtc,p1qtc,p2qtc,  &
   p3qtc,p4qtc,p5qtc,p6qtc,p7qtc,p8qtc,tbinoff,t1off,t2off,  &
   t3off,t4off,t5off,t6off,t7off,t8off,ifixgamma,  &
   gamma1arry,gamma2arry,gamma3arry,gamma4arry,gamma5arry,  &
   icnrv1arry,icnrv2arry,icnrv3arry,icnrv4arry,icnrv5arry,iGR, &
   tesscontam)
!
!   November 15, 1999
!
!   This routine will determine which variables need to be printed on the
!   screen based on the string codes in svar(1:Nvarmax).  The output
!   printed on the screen will be compact.
!
   USE accur
!
   IMPLICIT NONE
!
   INTEGER, INTENT(IN)                      :: nvarmax
   CHARACTER (LEN=40), INTENT(IN)           :: svar(nvarmax)
   REAL(KIND=dp), INTENT(IN)                :: fill1
   REAL(KIND=dp), INTENT(IN)                :: fill2
   REAL(KIND=dp), INTENT(IN)                :: omega1
   REAL(KIND=dp), INTENT(IN)                :: omega2
   REAL(KIND=dp), INTENT(IN)                :: q
   REAL(KIND=dp), INTENT(IN)                :: finc
   REAL(KIND=dp), INTENT(IN)                :: teff1
   REAL(KIND=dp), INTENT(IN)                :: teff2
   REAL(KIND=dp), INTENT(IN)                :: betarim
   REAL(KIND=dp), INTENT(IN)                :: rinner
   REAL(KIND=dp), INTENT(IN)                :: router
   REAL(KIND=dp), INTENT(IN)                :: tdisk
   REAL(KIND=dp), INTENT(IN)                :: xi
   REAL(KIND=dp), INTENT(IN)                :: rlx
   REAL(KIND=dp), INTENT(IN)                :: separ
   INTEGER, INTENT(IN)                      :: isvel1
   REAL(KIND=dp), INTENT(IN OUT)            :: gamma1
   INTEGER, INTENT(IN)                      :: isvel2
   REAL(KIND=dp), INTENT(IN)                :: gamma2
   REAL(KIND=dp), INTENT(IN)                :: t3
   REAL(KIND=dp), INTENT(IN)                :: g3
   REAL(KIND=dp), INTENT(IN)                :: sa3
   REAL(KIND=dp), INTENT(IN)                :: ecc
   REAL(KIND=dp), INTENT(IN OUT)            :: argper
   REAL(KIND=dp), INTENT(IN)                :: pshift
   REAL(KIND=dp), INTENT(IN)                :: spot1parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spot2parm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: spotdparm(2,4)
   REAL(KIND=dp), INTENT(IN)                :: period
   REAL(KIND=dp), INTENT(IN)                :: t0
   REAL(KIND=dp), INTENT(IN)                :: alb1
   REAL(KIND=dp), INTENT(IN)                :: alb2
   REAL(KIND=dp), INTENT(IN)                :: dwavex(8,10)
   REAL(KIND=dp), INTENT(IN)                :: dwavey(8,10)
   REAL(KIND=dp), INTENT(IN)                :: primmass
   REAL(KIND=dp), INTENT(IN)                :: primk
   REAL(KIND=dp), INTENT(IN)                :: primrad
   REAL(KIND=dp), INTENT(IN)                :: ratrad
   REAL(KIND=dp), INTENT(IN)                :: frac1
   REAL(KIND=dp), INTENT(IN)                :: frac2
   REAL(KIND=dp), INTENT(IN)                :: ecosw
   REAL(KIND=dp), INTENT(IN)                :: temprat
   REAL(KIND=dp), INTENT(IN)                :: bigi
   REAL(KIND=dp), INTENT(IN)                :: bigbeta
   REAL(KIND=dp), INTENT(IN)                :: density
   REAL(KIND=dp), INTENT(IN)                :: tconj
   REAL(KIND=dp), INTENT(IN)                :: beam1
   REAL(KIND=dp), INTENT(IN)                :: beam2
   REAL(KIND=dp), INTENT(IN)                :: contam
   REAL(KIND=dp), INTENT(IN)                :: ocose
   REAL(KIND=dp), INTENT(IN)                :: osine
   INTEGER, INTENT(IN)                      :: isw29
   REAL(KIND=dp), INTENT(IN)                :: tertperiod
   REAL(KIND=dp), INTENT(IN)                :: tertt0
   REAL(KIND=dp), INTENT(IN)                :: tertecos
   REAL(KIND=dp), INTENT(IN)                :: tertesin
   REAL(KIND=dp), INTENT(IN)                :: tertincl
   REAL(KIND=dp), INTENT(IN)                :: tertomega
   REAL(KIND=dp), INTENT(IN)                :: tertq
   REAL(KIND=dp), INTENT(IN)                :: tgrav1
   REAL(KIND=dp), INTENT(IN)                :: tgrav2
   REAL(KIND=dp), INTENT(IN)                :: tertconj
   REAL(KIND=dp), INTENT(IN)                :: omegadot
   REAL(KIND=dp), INTENT(IN)                :: contams0
   REAL(KIND=dp), INTENT(IN)                :: contams1
   REAL(KIND=dp), INTENT(IN)                :: contams2
   REAL(KIND=dp), INTENT(IN)                :: contams3
   REAL(KIND=dp), INTENT(IN)                :: p2tconj
   REAL(KIND=dp), INTENT(IN)                :: p2period
   REAL(KIND=dp), INTENT(IN)                :: p2t0
   REAL(KIND=dp), INTENT(IN)                :: p2ecos
   REAL(KIND=dp), INTENT(IN)                :: p2esin
   REAL(KIND=dp), INTENT(IN)                :: p2incl
   REAL(KIND=dp), INTENT(IN)                :: p2omega
   REAL(KIND=dp), INTENT(IN)                :: p2q
   REAL(KIND=dp), INTENT(IN)                :: p2ratrad
   REAL(KIND=dp), INTENT(IN)                :: p3tconj
   REAL(KIND=dp), INTENT(IN)                :: p3period
   REAL(KIND=dp), INTENT(IN)                :: p3t0
   REAL(KIND=dp), INTENT(IN)                :: p3ecos
   REAL(KIND=dp), INTENT(IN)                :: p3esin
   REAL(KIND=dp), INTENT(IN)                :: p3incl
   REAL(KIND=dp), INTENT(IN)                :: p3omega
   REAL(KIND=dp), INTENT(IN)                :: p3q
   REAL(KIND=dp), INTENT(IN)                :: p3ratrad
   REAL(KIND=dp), INTENT(IN)                :: p4tconj
   REAL(KIND=dp), INTENT(IN)                :: p4period
   REAL(KIND=dp), INTENT(IN)                :: p4t0
   REAL(KIND=dp), INTENT(IN)                :: p4ecos
   REAL(KIND=dp), INTENT(IN)                :: p4esin
   REAL(KIND=dp), INTENT(IN)                :: p4incl
   REAL(KIND=dp), INTENT(IN)                :: p4omega
   REAL(KIND=dp), INTENT(IN)                :: p4q
   REAL(KIND=dp), INTENT(IN)                :: p4ratrad
   REAL(KIND=dp), INTENT(IN)                :: p5tconj
   REAL(KIND=dp), INTENT(IN)                :: p5period
   REAL(KIND=dp), INTENT(IN)                :: p5t0
   REAL(KIND=dp), INTENT(IN)                :: p5ecos
   REAL(KIND=dp), INTENT(IN)                :: p5esin
   REAL(KIND=dp), INTENT(IN)                :: p5incl
   REAL(KIND=dp), INTENT(IN)                :: p5omega
   REAL(KIND=dp), INTENT(IN)                :: p5q
   REAL(KIND=dp), INTENT(IN)                :: p5ratrad
   REAL(KIND=dp), INTENT(IN)                :: p6tconj
   REAL(KIND=dp), INTENT(IN)                :: p6period
   REAL(KIND=dp), INTENT(IN)                :: p6t0
   REAL(KIND=dp), INTENT(IN)                :: p6ecos
   REAL(KIND=dp), INTENT(IN)                :: p6esin
   REAL(KIND=dp), INTENT(IN)                :: p6incl
   REAL(KIND=dp), INTENT(IN)                :: p6omega
   REAL(KIND=dp), INTENT(IN)                :: p6q
   REAL(KIND=dp), INTENT(IN)                :: p6ratrad
   REAL(KIND=dp), INTENT(IN)                :: p7tconj
   REAL(KIND=dp), INTENT(IN)                :: p7period
   REAL(KIND=dp), INTENT(IN)                :: p7t0
   REAL(KIND=dp), INTENT(IN)                :: p7ecos
   REAL(KIND=dp), INTENT(IN)                :: p7esin
   REAL(KIND=dp), INTENT(IN)                :: p7incl
   REAL(KIND=dp), INTENT(IN)                :: p7omega
   REAL(KIND=dp), INTENT(IN)                :: p7q
   REAL(KIND=dp), INTENT(IN)                :: p7ratrad
   REAL(KIND=dp), INTENT(IN)                :: p8tconj
   REAL(KIND=dp), INTENT(IN)                :: p8period
   REAL(KIND=dp), INTENT(IN)                :: p8t0
   REAL(KIND=dp), INTENT(IN)                :: p8ecos
   REAL(KIND=dp), INTENT(IN)                :: p8esin
   REAL(KIND=dp), INTENT(IN)                :: p8incl
   REAL(KIND=dp), INTENT(IN)                :: p8omega
   REAL(KIND=dp), INTENT(IN)                :: p8q
   REAL(KIND=dp), INTENT(IN)                :: p8ratrad
   REAL(KIND=dp), INTENT(IN)                :: gamma3
   INTEGER, INTENT(IN)                      :: isvel3
   REAL(KIND=dp), INTENT(IN)                :: sw72
   REAL(KIND=dp), INTENT(IN)                :: sw73
   REAL(KIND=dp), INTENT(IN)                :: sw49
   REAL(KIND=dp), INTENT(IN)                :: sw80
   REAL(KIND=dp), INTENT(IN)                :: sw81
   REAL(KIND=dp), INTENT(IN)                :: sdarkint1(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint2(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint3(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint4(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint5(8)
   REAL(KIND=dp), INTENT(IN)                :: gamma4
   INTEGER, INTENT(IN)                      :: isvel4
   REAL(KIND=dp), INTENT(IN)                :: tertratrad
   REAL(KIND=dp), INTENT(IN)                :: p1mtc
   REAL(KIND=dp), INTENT(IN)                :: p1ptc
   REAL(KIND=dp), INTENT(IN)                :: p2mtc
   REAL(KIND=dp), INTENT(IN)                :: p2ptc
   REAL(KIND=dp), INTENT(IN)                :: p3mtc
   REAL(KIND=dp), INTENT(IN)                :: p3ptc
   REAL(KIND=dp), INTENT(IN)                :: p4mtc
   REAL(KIND=dp), INTENT(IN)                :: p4ptc
   REAL(KIND=dp), INTENT(IN)                :: p5mtc
   REAL(KIND=dp), INTENT(IN)                :: p5ptc
   REAL(KIND=dp), INTENT(IN)                :: p6mtc
   REAL(KIND=dp), INTENT(IN)                :: p6ptc
   REAL(KIND=dp), INTENT(IN)                :: p7mtc
   REAL(KIND=dp), INTENT(IN)                :: p7ptc
   REAL(KIND=dp), INTENT(IN)                :: p8mtc
   REAL(KIND=dp), INTENT(IN)                :: p8ptc
   REAL(KIND=dp), INTENT(IN)                :: pbmtc
   REAL(KIND=dp), INTENT(IN)                :: pbptc
   REAL(KIND=dp), INTENT(IN)                :: bigi2
   REAL(KIND=dp), INTENT(IN)                :: bigi3
   REAL(KIND=dp), INTENT(IN)                :: bigi4
   REAL(KIND=dp), INTENT(IN)                :: bigbeta2
   REAL(KIND=dp), INTENT(IN)                :: bigbeta3
   REAL(KIND=dp), INTENT(IN)                :: bigbeta4
   REAL(KIND=dp), INTENT(IN)                :: bin2q
   REAL(KIND=dp), INTENT(IN)                :: b2massdiff
   REAL(KIND=dp), INTENT(IN)                :: b2masssum
   REAL(KIND=dp), INTENT(IN)                :: b2raddiff
   REAL(KIND=dp), INTENT(IN)                :: b2radsum
   REAL(KIND=dp), INTENT(IN)                :: bin2ratrad
   REAL(KIND=dp), INTENT(IN)                :: g10
   REAL(KIND=dp), INTENT(IN)                :: g6
   REAL(KIND=dp), INTENT(IN)                :: g7
   REAL(KIND=dp), INTENT(IN)                :: g8
   REAL(KIND=dp), INTENT(IN)                :: g9
   REAL(KIND=dp), INTENT(IN)                :: massdiff
   REAL(KIND=dp), INTENT(IN)                :: masssum
   REAL(KIND=dp), INTENT(IN)                :: omega3
   REAL(KIND=dp), INTENT(IN)                :: omega4
   REAL(KIND=dp), INTENT(IN)                :: omega5
   REAL(KIND=dp), INTENT(IN)                :: omega6
   REAL(KIND=dp), INTENT(IN)                :: omega7
   REAL(KIND=dp), INTENT(IN)                :: omega8
   REAL(KIND=dp), INTENT(IN)                :: omega9
   REAL(KIND=dp), INTENT(IN)                :: omega10
   REAL(KIND=dp), INTENT(IN)                :: raddiff
   REAL(KIND=dp), INTENT(IN)                :: radsum
   REAL(KIND=dp), INTENT(IN)                :: rk3
   REAL(KIND=dp), INTENT(IN)                :: rk4
   REAL(KIND=dp), INTENT(IN)                :: rk5
   REAL(KIND=dp), INTENT(IN)                :: rk6
   REAL(KIND=dp), INTENT(IN)                :: rk7
   REAL(KIND=dp), INTENT(IN)                :: rk8
   REAL(KIND=dp), INTENT(IN)                :: rk9
   REAL(KIND=dp), INTENT(IN)                :: rk10
   REAL(KIND=dp), INTENT(IN)                :: sdarkint6(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint7(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint8(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint9(8)
   REAL(KIND=dp), INTENT(IN)                :: sdarkint10(8)
   REAL(KIND=dp), INTENT(IN)                :: secmass
   REAL(KIND=dp), INTENT(IN)                :: secrad
   REAL(KIND=dp), INTENT(IN)                :: t10
   REAL(KIND=dp), INTENT(IN)                :: t6
   REAL(KIND=dp), INTENT(IN)                :: t7
   REAL(KIND=dp), INTENT(IN)                :: t8
   REAL(KIND=dp), INTENT(IN)                :: t9
   REAL(KIND=dp), INTENT(IN)                :: fracsum
   REAL(KIND=dp), INTENT(IN)                :: fracdiff
   REAL(KIND=dp), INTENT(IN)                :: bin2m3
   REAL(KIND=dp), INTENT(IN)                :: bin2m4
   REAL(KIND=dp), INTENT(IN)                :: bin2r3
   REAL(KIND=dp), INTENT(IN)                :: bin2r4
   REAL(KIND=dp), INTENT(IN)                :: sqecos
   REAL(KIND=dp), INTENT(IN)                :: sqesin
   REAL(KIND=dp), INTENT(IN)                :: sqtertecos
   REAL(KIND=dp), INTENT(IN)                :: sqtertesin
   REAL(KIND=dp), INTENT(IN)                :: sqp2ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp2esin
   REAL(KIND=dp), INTENT(IN)                :: sqp3ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp3esin
   REAL(KIND=dp), INTENT(IN)                :: sqp4ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp4esin
   REAL(KIND=dp), INTENT(IN)                :: sqp5ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp5esin
   REAL(KIND=dp), INTENT(IN)                :: sqp6ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp6esin
   REAL(KIND=dp), INTENT(IN)                :: sqp7ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp7esin
   REAL(KIND=dp), INTENT(IN)                :: sqp8ecos
   REAL(KIND=dp), INTENT(IN)                :: sqp8esin
   REAL(KIND=dp), INTENT(IN)                :: angsum1
   REAL(KIND=dp), INTENT(IN)                :: angdiff1
   REAL(KIND=dp), INTENT(IN)                :: angsum2
   REAL(KIND=dp), INTENT(IN)                :: angdiff2
   REAL(KIND=dp), INTENT(IN)                :: angsum3
   REAL(KIND=dp), INTENT(IN)                :: angdiff3
   REAL(KIND=dp), INTENT(IN)                :: angsum4
   REAL(KIND=dp), INTENT(IN)                :: angdiff4
   REAL(KIND=dp), INTENT(IN)                :: angsum5
   REAL(KIND=dp), INTENT(IN)                :: angdiff5
   REAL(KIND=dp), INTENT(IN)                :: angsum6
   REAL(KIND=dp), INTENT(IN)                :: angdiff6
   REAL(KIND=dp), INTENT(IN)                :: angsum7
   REAL(KIND=dp), INTENT(IN)                :: angdiff7
   REAL(KIND=dp), INTENT(IN)                :: angsum8
   REAL(KIND=dp), INTENT(IN)                :: angdiff8
   INTEGER, INTENT(IN)                      :: isw86
   REAL(KIND=dp), INTENT(IN)                :: fillsum
   REAL(KIND=dp), INTENT(IN)                :: filldiff
   REAL(KIND=dp), INTENT(IN)                :: binqtc
   REAL(KIND=dp), INTENT(IN)                :: p1qtc
   REAL(KIND=dp), INTENT(IN)                :: p2qtc
   REAL(KIND=dp), INTENT(IN)                :: p3qtc
   REAL(KIND=dp), INTENT(IN)                :: p4qtc
   REAL(KIND=dp), INTENT(IN)                :: p5qtc
   REAL(KIND=dp), INTENT(IN)                :: p6qtc
   REAL(KIND=dp), INTENT(IN)                :: p7qtc
   REAL(KIND=dp), INTENT(IN)                :: p8qtc
   REAL(KIND=dp), INTENT(IN)                :: tbinoff
   REAL(KIND=dp), INTENT(IN)                :: t1off
   REAL(KIND=dp), INTENT(IN)                :: t2off
   REAL(KIND=dp), INTENT(IN)                :: t3off
   REAL(KIND=dp), INTENT(IN)                :: t4off
   REAL(KIND=dp), INTENT(IN)                :: t5off
   REAL(KIND=dp), INTENT(IN)                :: t6off
   REAL(KIND=dp), INTENT(IN)                :: t7off
   REAL(KIND=dp), INTENT(IN)                :: t8off
   INTEGER, INTENT(IN)                      :: ifixgamma
   REAL(KIND=dp), INTENT(IN)                :: gamma1arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma2arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma3arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma4arry(5)
   REAL(KIND=dp), INTENT(IN)                :: gamma5arry(5)
   INTEGER, INTENT(IN)                      :: icnrv1arry(5)
   INTEGER, INTENT(IN)                      :: icnrv2arry(5)
   INTEGER, INTENT(IN)                      :: icnrv3arry(5)
   INTEGER, INTENT(IN)                      :: icnrv4arry(5)
   INTEGER, INTENT(IN)                      :: icnrv5arry(5)
   INTEGER, INTENT(IN)                      :: iGR
   REAL(KIND=dp), INTENT(IN)                :: tesscontam
!
   REAL(KIND=dp)  :: tconj1,tconj2,g4,g5
!
   INTEGER :: iline,iwrite,ilength,i,iargper
   INTEGER :: kk, icnvrt,lll
!
   CHARACTER(LEN=30) :: outstring
   CHARACTER(LEN=80) :: line
!
   line='**'
   iline=0
   iwrite=0
   ilength=2
!
!  flag for ecosw being assigned.
!
   iargper=0
!
!  loop over the strings and match tags.  When a tag matches,
!  add a string to the end of 'line'.  Once the length of 'line'
!  exceeds a certain amount, write it to the screen.
!
   DO  i=1,nvarmax
      kk=icnvrt(svar(i)(1:2))
!
!  tag ct, tesscontam
!
      IF(kk == 83)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' tesscontam',5,tesscontam,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bq, binqTc, (slope in P-Tc plane for binary)
!
      IF(kk == 48)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' binqTc',6,binqtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1q, P1qTc, (slope in P-Tc plane for body 3)
!
      IF(kk == 3528)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1qTc',6,p1qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2q, P2qTc, (slope in P-Tc plane for body 4)
!
      IF(kk == 3560)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2qTc',6,p2qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3q, P3qTc, (slope in P-Tc plane for body 5)
!
      IF(kk == 3592)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3qTc',6,p3qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4q, P4qTc, (slope in P-Tc plane for body 6)
!
      IF(kk == 3624)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4qTc',6,p4qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5q, P5qTc, (slope in P-Tc plane for body 7)
!
      IF(kk == 3656)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5qTc',6,p5qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6q, P6qTc, (slope in P-Tc plane for body 8)
!
      IF(kk == 3688)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6qTc',6,p6qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7q, P7qTc, (slope in P-Tc plane for body 9)
!
      IF(kk == 3720)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7qTc',6,p7qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8q, P8qTc, (slope in P-Tc plane for body 10)
!
      IF(kk == 3752)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8qTc',6,p8qtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bt, Tbinoff, (offset in P-Tc plane for binary)
!
      IF(kk == 51)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Tbinoff',4,tbinoff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1t, T1off, (offset in P-Tc plane for body 3)
!
      IF(kk == 3531)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T1off',4,t1off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2t, T2off, (offset in P-Tc plane for body 4)
!
      IF(kk == 3563)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T2off',4,t2off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3t, T3off, (offset in P-Tc plane for body 5)
!
      IF(kk == 3595)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T3off',4,t3off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4t, T4off, (offset in P-Tc plane for body 6)
!
      IF(kk == 3627)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T4off',4,t4off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5t, T5off, (offset in P-Tc plane for body 7)
!
      IF(kk == 3659)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T5off',4,t5off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6t, T6off, (offset in P-Tc plane for body 8)
!
      IF(kk == 3691)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T6off',4,t6off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7t, T7off, (offset in P-Tc plane for body 9)
!
      IF(kk == 3723)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T7off',4,t7off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8t, T8off, (offset in P-Tc plane for body 10)
!
      IF(kk == 3755)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T8off',4,t8off,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sf, fillsum (sum of fill1 and fill2)
!
      IF(kk == 581)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' fillsum',6,fillsum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sd, filldiff (difference of fill1 and fill2)
!
      IF(kk == 579)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' filldiff',6,filldiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1a, angsum1 (sum of P1incl and P1Omega)
!
      IF(kk == 3512)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum1',7,angsum1,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2a, angsum2 (sum of P2incl and P2Omega)
!
      IF(kk == 3544)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum2',7,angsum2,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3a, angsum3 (sum of P3incl and P3Omega)
!
      IF(kk == 3576)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum3',7,angsum3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4a, angsum4 (sum of P4incl and P4Omega)
!
      IF(kk == 3608)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum4',7,angsum4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5a, angsum5 (sum of P5incl and P5Omega)
!
      IF(kk == 3640)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum5',7,angsum5,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6a, angsum6 (sum of P6incl and P6Omega)
!
      IF(kk == 3672)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum6',7,angsum6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7a, angsum7 (sum of P7incl and P7Omega)
!
      IF(kk == 3704)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum7',7,angsum7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8a, angsum8 (sum of P8incl and P8Omega)
!
      IF(kk == 3736)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angsum8',7,angsum8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1d, angdiff1 (difference of P1incl and P1Omega)
!
      IF(kk == 3515)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff1',7,angdiff1,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2d, angdiff2 (difference of P2incl and P2Omega)
!
      IF(kk == 3547)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff2',7,angdiff2,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3d, angdiff3 (difference of P3incl and P3Omega)
!
      IF(kk == 3579)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff3',7,angdiff3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4d, angdiff4 (difference of P4incl and P4Omega)
!
      IF(kk == 3611)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff4',7,angdiff4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5d, angdiff5 (difference of P5incl and P5Omega)
!
      IF(kk == 3643)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff5',7,angdiff5,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6d, angdiff6 (difference of P6incl and P6Omega)
!
      IF(kk == 3675)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff6',7,angdiff6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7d, angdiff7 (difference of P7incl and P7Omega)
!
      IF(kk == 3707)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff7',7,angdiff7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8d, angdiff8 (difference of P8incl and P8Omega)
!
      IF(kk == 3739)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' angdiff8',7,angdiff8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag fs, fracsum (sum of fractional radii)
!
      IF(kk == 178)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' fracsum',7,fracsum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag fd, fracdiff (difference of fractional radii)
!
      IF(kk == 163)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' fracdiff',7,fracdiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 97, bin2M3 (M3 in solar masses in binary+binary)
!
      IF(kk == 4790)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2M3',5,bin2m3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 98, bin2M4 (M4 in solar masses in binary+binary)
!
      IF(kk == 4791)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2M4',5,bin2m4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 99, bin2R3 (R3 in solar radii in binary+binary)
!
      IF(kk == 4792)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2R3',5,bin2r3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 90, bin2R4 (R4 in solar radii in binary+binary)
!
      IF(kk == 4783)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2R4',5,bin2r4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bs, sqesin, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 50)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqrt(e)sin(omega)',6,sqesin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bc, sqecos, (sqrt(e)*sin(omega), binary)
!
      IF(kk == 34)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqrt(e)cos(omega)',6,sqecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1s, sqtertesin, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3530)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP1esin',6,sqtertesin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1c, sqtertecos, (sqrt(e)*sin(omega), body 3)
!
      IF(kk == 3514)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP1ecos',6,sqtertecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2s, sqP2esin, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3562)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP2esin',6,sqp2esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2c, sqP2ecos, (sqrt(e)*sin(omega), body 4)
!
      IF(kk == 3546)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP2ecos',6,sqp2ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3s, sqP3tesin, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3594)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP3esin',6,sqp3esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3c, sqP3tecos, (sqrt(e)*sin(omega), body 5)
!
      IF(kk == 3578)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP3ecos',6,sqp3ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4s, sqP4tesin, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3626)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP4esin',6,sqp4esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4c, sqP4tecos, (sqrt(e)*sin(omega), body 6)
!
      IF(kk == 3610)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP4ecos',6,sqp4ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5s, sqP5tesin, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3658)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP5esin',6,sqp5esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5c, sqP5tecos, (sqrt(e)*sin(omega), body 7)
!
      IF(kk == 3642)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP5ecos',6,sqp5ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6s, sqP6tesin, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3690)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP6esin',6,sqp6esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6c, sqP6tecos, (sqrt(e)*sin(omega), body 8)
!
      IF(kk == 3674)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP6ecos',6,sqp6ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7s, sqP7tesin, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3722)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP7esin',6,sqp7esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7c, sqP7tecos, (sqrt(e)*sin(omega), body 9)
!
      IF(kk == 3706)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP7ecos',6,sqp7ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8s, sqP8tesin, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3754)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP8esin',6,sqp8esin,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8c, sqP8tecos, (sqrt(e)*sin(omega), body 10)
!
      IF(kk == 3738)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' sqP8ecos',6,sqp8ecos,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1m, P1mTc, period-Tconj, body 3
!
      IF(kk == 3524)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1-Tc',5,p1mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 1p, P1pTc, period+Tconj, body 3
!
      IF(kk == 3527)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1+Tc',5,p1ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2m, P2mTc, period-Tconj, body 3
!
      IF(kk == 3556)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2-Tc',5,p2mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 2p, P2pTc, period+Tconj, body 4
!
      IF(kk == 3559)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2+Tc',5,p2ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3m, P3mTc, period-Tconj, body 5
!
      IF(kk == 3588)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3-Tc',5,p3mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 3p, P2pTc, period+Tconj, body 5
!
      IF(kk == 3591)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3+Tc',5,p3ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4m, P4mTc, period-Tconj, body 6
!
      IF(kk == 3620)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4-Tc',5,p4mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 4p, P4pTc, period+Tconj, body 6
!
      IF(kk == 3623)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4+Tc',5,p4ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5m, P5mTc, period-Tconj, body 7
!
      IF(kk == 3652)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5-Tc',5,p5mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 5p, P5pTc, period+Tconj, body 7
!
      IF(kk == 3655)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5+Tc',5,p5ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6m, P6mTc, period-Tconj, body 8
!
      IF(kk == 3684)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6-Tc',5,p6mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 6p, P6pTc, period+Tconj, body 8
!
      IF(kk == 3687)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6+Tc',5,p6ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7m, P7mTc, period-Tconj, body 9
!
      IF(kk == 3716)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7-Tc',5,p7mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 7p, P7pTc, period+Tconj, body 9
!
      IF(kk == 3719)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7+Tc',5,p7ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8m, P8mTc, period-Tconj, body 10
!
      IF(kk == 3748)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8-Tc',5,p8mtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 8p, P8pTc, period+Tconj, body 10
!
      IF(kk == 3751)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8+Tc',5,p8ptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bm, PbmTc, period-Tconj, binary
!
      IF(kk == 44)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Pbin-Tc',5,pbmtc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bp, PbpTc, period+Tconj, binary
!
      IF(kk == 47)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Pbin+Tc',5,pbptc,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bi, axis_I2, inclination of rot. axis star 2
!
      IF(kk == 40)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_I2',4,bigi2,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag bb, axis_beta2, position angle of rot. axis star 2
!
      IF(kk == 33)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_beta2',4,bigbeta2,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ci, axis_I3, inclination of rot. axis star 3
!
      IF(kk == 72)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_I3',4,bigi3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag cb, axis_beta3, position angle of rot. axis star 3
!
      IF(kk == 65)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_beta3',4,bigbeta3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag di, axis_I4, inclination of rot. axis star 4
!
      IF(kk == 104)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_I4',4,bigi4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag db, axis_beta4, position angle of rot. axis star 4
!
      IF(kk == 97)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_beta4',4,bigbeta4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 91, b2masssum (M3+M4 in binary+binary)
!
      IF(kk == 4784)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2masssum',5,b2masssum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 92, b2massdiff (M3-M4 in binary+binary)
!
      IF(kk == 4785)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2massdiff',5,b2massdiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 93, bin2Q (M4/M3 in binary+binary)
!
      IF(kk == 4786)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2Q',8,bin2q,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 94, bin2radsum (R3+R4 in binary+binary)
!
      IF(kk == 4787)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2radsum',5,b2radsum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 95, bin2raddiff (R3-R4 in binary+binary)
!
      IF(kk == 4788)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2raddiff',5,b2raddiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 96, bin2ratrad (R3/R4 in binary+binary)
!
      IF(kk == 4789)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' bin2ratrad',6,bin2ratrad,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g4, g4
!
      IF(kk == 1211)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g4',4,g4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g5, g5
!
      IF(kk == 1212)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g5',4,g5,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g6, g6
!
      IF(kk == 1213)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g6',4,g6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g7, g7
!
      IF(kk == 1214)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g7',4,g7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g8, g8
!
      IF(kk == 1215)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g8',4,g8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g9, g9
!
      IF(kk == 1216)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g9',4,g9,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag g0, g10
!
      IF(kk == 1207)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g10',4,g10,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag md, massdiff (M1-M2 for binary)
!
      IF(kk == 387)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' massdiff',5,massdiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag ms, masssum (M1+M2 for binary)
!
      IF(kk == 402)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' masssum',5,masssum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o3, omega3
!
      IF(kk == 1466)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega3',4,omega3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o4, omega4
!
      IF(kk == 1467)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega4',4,omega4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o5, omega5
!
      IF(kk == 1468)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega5',4,omega5,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o6, omega6
!
      IF(kk == 1469)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega6',4,omega6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o7, omega7
!
      IF(kk == 1470)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega7',4,omega7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o8, omega8
!
      IF(kk == 1471)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega8',4,omega8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o9, omega9
!
      IF(kk == 1472)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega9',4,omega9,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag o0, omega10
!
      IF(kk == 1463)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega10',4,omega10,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag rs, radsum (R1+R2 for binary)
!
      IF(kk == 562)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' radsum',5,radsum,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag rd, raddiff (R1-R2 for binary)
!
      IF(kk == 547)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' raddiff',5,raddiff,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a3, rk3 (apsidal constant, body 3)
!
      IF(kk == 1018)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk3',6,rk3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a4, rk4 (apsidal constant, body 4)
!
      IF(kk == 1019)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk4',6,rk4,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a5, rk5 (apsidal constant, body 5)
!
      IF(kk == 1020)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk5',6,rk5,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a6, rk6 (apsidal constant, body 6)
!
      IF(kk == 1021)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk6',6,rk6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a7, rk7 (apsidal constant, body 7)
!
      IF(kk == 1022)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk7',6,rk7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a8, rk8 (apsidal constant, body 8)
!
      IF(kk == 1023)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk8',6,rk8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a9, rk9 (apsidal constant, body 9)
!
      IF(kk == 1024)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk9',6,rk9,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag a0, rk10 (apsidal constant, body 10)
!
      IF(kk == 1015)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk10',6,rk10,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag sm, secmass
!
      IF(kk == 588)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' secmass',5,secmass,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag sr, secrad
!
      IF(kk == 593)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' secrad',5,secrad,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag t6, t6 (Teff6)
!
      IF(kk == 1629)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff6',2,t6,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag t7, t7 (Teff7)
!
      IF(kk == 1630)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff7',2,t7,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag t8, t8 (Teff8)
!
      IF(kk == 1631)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff8',2,t8,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag t9, t9 (Teff9)
!
      IF(kk == 1632)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff9',2,t9,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!   tag ta, t10 (Teff10)
!
      IF(kk == 608)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff10',2,t10,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 61, flux star 6, band 1
!
      IF(kk == 4688)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_U',5,sdarkint6(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_U',5,sdarkint6(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 62, flux star 6, band 2
!
      IF(kk == 4689)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_B',5,sdarkint6(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_B',5,sdarkint6(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 63, flux star 6, band 3
!
      IF(kk == 4690)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_V',5,sdarkint6(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_V',5,sdarkint6(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 64, flux star 6, band 4
!
      IF(kk == 4691)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_R',5,sdarkint6(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_R',5,sdarkint6(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 65, flux star 6, band 5
!
      IF(kk == 4692)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_I',5,sdarkint6(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_I',5,sdarkint6(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 66, flux star 6, band 6
!
      IF(kk == 4693)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_J',5,sdarkint6(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_J',5,sdarkint6(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 67, flux star 6, band 7
!
      IF(kk == 4694)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_H',5,sdarkint6(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_H',5,sdarkint6(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 68, flux star 6, band 8
!
      IF(kk == 4695)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux6_K',5,sdarkint6(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat6_K',5,sdarkint6(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 71, flux star 7, band 1
!
      IF(kk == 4720)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_U',5,sdarkint7(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_U',5,sdarkint7(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 72, flux star 7, band 2
!
      IF(kk == 4721)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_B',5,sdarkint7(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_B',5,sdarkint7(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 73, flux star 7, band 3
!
      IF(kk == 4722)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_V',5,sdarkint7(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_V',5,sdarkint7(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 74, flux star 7, band 4
!
      IF(kk == 4723)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_R',5,sdarkint7(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_R',5,sdarkint7(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 75, flux star 7, band 5
!
      IF(kk == 4724)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_I',5,sdarkint7(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_I',5,sdarkint7(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 76, flux star 7, band 6
!
      IF(kk == 4725)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_J',5,sdarkint7(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_J',5,sdarkint7(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 77, flux star 7, band 7
!
      IF(kk == 4726)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_H',5,sdarkint7(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_H',5,sdarkint7(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 78, flux star 7, band 8
!
      IF(kk == 4727)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux7_K',5,sdarkint7(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat7_K',5,sdarkint7(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 81, flux star 8, band 1
!
      IF(kk == 4752)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_U',5,sdarkint8(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_U',5,sdarkint8(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 82, flux star 8, band 2
!
      IF(kk == 4753)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_B',5,sdarkint8(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_B',5,sdarkint8(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 83, flux star 8, band 3
!
      IF(kk == 4754)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_V',5,sdarkint8(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_V',5,sdarkint8(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 84, flux star 8, band 4
!
      IF(kk == 4755)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_R',5,sdarkint8(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_R',5,sdarkint8(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 85, flux star 8, band 5
!
      IF(kk == 4756)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_I',5,sdarkint8(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_I',5,sdarkint8(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 86, flux star 8, band 6
!
      IF(kk == 4757)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_J',5,sdarkint8(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_J',5,sdarkint8(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 87, flux star 8, band 7
!
      IF(kk == 4758)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_H',5,sdarkint8(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_H',5,sdarkint8(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 88, flux star 8, band 8
!
      IF(kk == 4759)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux8_K',5,sdarkint8(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat8_K',5,sdarkint8(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 91, flux star 9, band 1
!
      IF(kk == 2784)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_U',5,sdarkint9(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_U',5,sdarkint9(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 92, flux star 9, band 2
!
      IF(kk == 2785)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_B',5,sdarkint9(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_B',5,sdarkint9(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 93, flux star 9, band 3
!
      IF(kk == 2786)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_V',5,sdarkint9(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_V',5,sdarkint9(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 94, flux star 9, band 4
!
      IF(kk == 2787)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_R',5,sdarkint9(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_R',5,sdarkint9(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 95, flux star 9, band 5
!
      IF(kk == 2788)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_I',5,sdarkint9(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_I',5,sdarkint9(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 96, flux star 9, band 6
!
      IF(kk == 2789)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_J',5,sdarkint9(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_J',5,sdarkint9(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 97, flux star 9, band 7
!
      IF(kk == 2790)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_H',5,sdarkint9(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_H',5,sdarkint9(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 98, flux star 9, band 8
!
      IF(kk == 2791)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux9_K',5,sdarkint9(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat9_K',5,sdarkint9(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 01, flux star 10, band 1
!
      IF(kk == 4496)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_U',5,sdarkint10(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_U',5,sdarkint10(1),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 02, flux star 10, band 2
!
      IF(kk == 4497)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_B',5,sdarkint10(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_B',5,sdarkint10(2),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 03, flux star 10, band 3
!
      IF(kk == 4498)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_V',5,sdarkint10(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_V',5,sdarkint10(3),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 04, flux star 10, band 4
!
      IF(kk == 4499)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_R',5,sdarkint10(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_R',5,sdarkint10(4),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 05, flux star 10, band 5
!
      IF(kk == 4500)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_I',5,sdarkint10(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_I',5,sdarkint10(5),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 06, flux star 10, band 6
!
      IF(kk == 4501)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_J',5,sdarkint10(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_J',5,sdarkint10(6),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 07, flux star 10, band 7
!
      IF(kk == 4502)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_H',5,sdarkint10(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_H',5,sdarkint10(7),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 08, flux star 10, band 8
!
      IF(kk == 4503)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux10_K',5,sdarkint10(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat10_K',5,sdarkint10(8),outstring, lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 11, flux star 1, band 1
!
      IF(kk == 4528)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_U',5,sdarkint1(1),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 12, flux star 1, band 2
!
      IF(kk == 4529)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_B',5,sdarkint1(2),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 13, flux star 1, band 3
!
      IF(kk == 4530)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_V',5,sdarkint1(3),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 14, flux star 1, band 4
!
      IF(kk == 4531)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_R',5,sdarkint1(4),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 15, flux star 1, band 5
!
      IF(kk == 4532)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_I',5,sdarkint1(5),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 16, flux star 1, band 6
!
      IF(kk == 4533)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_J',5,sdarkint1(6),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 17, flux star 1, band 7
!
      IF(kk == 4534)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_H',5,sdarkint1(7),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 18, flux star 1, band 8
!
      IF(kk == 4535)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' flux1_K',5,sdarkint1(8),outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 21, flux star 2, band 1
!
      IF(kk == 4560)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_U',5,sdarkint2(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_U',5,sdarkint2(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 22, flux star 2, band 2
!
      IF(kk == 4561)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_B',5,sdarkint2(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_B',5,sdarkint2(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 23, flux star 2, band 3
!
      IF(kk == 4562)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_V',5,sdarkint2(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_V',5,sdarkint2(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 24, flux star 2, band 4
!
      IF(kk == 4563)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_R',5,sdarkint2(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_R',5,sdarkint2(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 25, flux star 2, band 5
!
      IF(kk == 4564)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_I',5,sdarkint2(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_I',5,sdarkint2(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 26, flux star 2, band 6
!
      IF(kk == 4565)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_J',5,sdarkint2(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_J',5,sdarkint2(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 27, flux star 2, band 7
!
      IF(kk == 4566)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_H',5,sdarkint2(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_H',5,sdarkint2(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 28, flux star 2, band 8
!
      IF(kk == 4567)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux2_K',5,sdarkint2(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat2_K',5,sdarkint2(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 31, flux star 3, band 1
!
      IF(kk == 4592)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_U',5,sdarkint3(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_U',5,sdarkint3(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 32, flux star 3, band 2
!
      IF(kk == 4593)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_B',5,sdarkint3(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_B',5,sdarkint3(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 33, flux star 3, band 3
!
      IF(kk == 4594)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_V',5,sdarkint3(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_V',5,sdarkint3(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 34, flux star 3, band 4
!
      IF(kk == 4595)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_R',5,sdarkint3(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_R',5,sdarkint3(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 35, flux star 3, band 5
!
      IF(kk == 4596)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_I',5,sdarkint3(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_I',5,sdarkint3(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 36, flux star 3, band 6
!
      IF(kk == 4597)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_J',5,sdarkint3(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_J',5,sdarkint3(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 37, flux star 3, band 7
!
      IF(kk == 4598)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_H',5,sdarkint3(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_H',5,sdarkint3(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 38, flux star 3, band 8
!
      IF(kk == 4599)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux3_K',5,sdarkint3(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat3_K',5,sdarkint3(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 41, flux star 4, band 1
!
      IF(kk == 4624)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_U',5,sdarkint4(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_U',5,sdarkint4(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 42, flux star 4, band 2
!
      IF(kk == 4625)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_B',5,sdarkint4(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_B',5,sdarkint4(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 43, flux star 4, band 3
!
      IF(kk == 4626)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_V',5,sdarkint4(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_V',5,sdarkint4(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 44, flux star 4, band 4
!
      IF(kk == 4627)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_R',5,sdarkint4(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_R',5,sdarkint4(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 45, flux star 4, band 5
!
      IF(kk == 4628)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_I',5,sdarkint4(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_I',5,sdarkint4(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 46, flux star 4, band 6
!
      IF(kk == 4629)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_J',5,sdarkint4(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_J',5,sdarkint4(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 47, flux star 4, band 7
!
      IF(kk == 4630)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_H',5,sdarkint4(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_H',5,sdarkint4(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 48, flux star 4, band 8
!
      IF(kk == 4631)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux4_K',5,sdarkint4(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat4_K',5,sdarkint4(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 51, flux star 5, band 1
!
      IF(kk == 4656)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_U',5,sdarkint5(1),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_U',5,sdarkint5(1),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 52, flux star 5, band 2
!
      IF(kk == 4657)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_B',5,sdarkint5(2),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_B',5,sdarkint5(2),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 53, flux star 5, band 3
!
      IF(kk == 4658)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_V',5,sdarkint5(3),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_V',5,sdarkint5(3),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 54, flux star 5, band 4
!
      IF(kk == 4659)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_R',5,sdarkint5(4),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_R',5,sdarkint5(4),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 55, flux star 5, band 5
!
      IF(kk == 4660)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_I',5,sdarkint5(5),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_I',5,sdarkint5(5),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 56, flux star 6, band 6
!
      IF(kk == 4661)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_J',5,sdarkint5(6),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_J',5,sdarkint5(6),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 57, flux star 5, band 7
!
      IF(kk == 4662)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_H',5,sdarkint5(7),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_H',5,sdarkint5(7),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag 58, flux star 5, band 8
!
      IF(kk == 4663)THEN
         iline=iline+1
         iwrite=0
         IF(isw86 == 0)THEN
            CALL pstring(' flux5_K',5,sdarkint5(8),outstring,lll)
         ELSE
            CALL pstring(' fluxrat5_K',5,sdarkint5(8),outstring,lll)
         END IF
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ob, Omega_bin, nodal angle of binary
!
      IF(kk == 449)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Omega_bin',7,sw49,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag oc, ocose, e*cos(omega) for binary
!
      IF((kk == 450).AND.(isw29 > 0))THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' ecos(omega)',8,ocose,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag os, osine, e*sin(omega) for binary
!
      IF((kk == 466).AND.(isw29 > 0))THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' esin(omega)',8,osine,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1
!
      IF(kk == 1016)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk1',6,sw72,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag a1, rk1, tidal apsidal constant for star 1,
!  print out rk2 if iGR = 4
!
      IF((kk == 1016).and.(iGR == 4))THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk2',6,sw73,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag a2, rk2, tidal apsidal constant for star 2
!
      IF(kk == 1017)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rk2',6,sw73,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 2 parameters
!
!  tag uj, P2tconj
!
      IF(kk == 649)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2tconj',6,p2tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ut, P2period
!
      IF(kk == 659)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2period',9,p2period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag uu, P2T0
!
      IF(kk == 660)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2T0',6,p2t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag uv, P2ecos
!
      IF(kk == 661)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2ecos',7,p2ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag uw, P2esin
!
      IF(kk == 662)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2esin',7,p2esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ux, P2incl
!
      IF(kk == 663)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2incl',7,p2incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag uy, P2Omega
!
      IF(kk == 664)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2Omega',6,p2omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag uz, P2Q
!
      IF(kk == 665)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2Q',6,p2q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ub, P2ratrad
!
      IF(kk == 641)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P2ratrad',7,p2ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 3 parameters
!
!  tag vj, P3tconj
!
      IF(kk == 681)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3tconj',6,p3tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vt, P3period
!
      IF(kk == 691)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3period',9,p3period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vu, P3T0
!
      IF(kk == 692)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3T0',6,p3t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vv, P3ecos
!
      IF(kk == 693)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3ecos',7,p3ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vw, P3esin
!
      IF(kk == 694)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3esin',7,p3esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vx, P3incl
!
      IF(kk == 695)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3incl',7,p3incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vy, P3Omega
!
      IF(kk == 696)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3Omega',6,p3omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vz, P3Q
!
      IF(kk == 697)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3Q',6,p3q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag vb, P3ratrad
!
      IF(kk == 673)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P3ratrad',7,p3ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 4 parameters
!
!  tag wj, P4tconj
!
      IF(kk == 713)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4tconj',6,p4tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wt, P4period
!
      IF(kk == 723)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4period',9,p4period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wu, P4T0
!
      IF(kk == 724)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4T0',6,p4t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wv, P4ecos
!
      IF(kk == 725)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4ecos',7,p4ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ww, P4esin
!
      IF(kk == 726)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4esin',7,p4esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wx, P4incl
!
      IF(kk == 727)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4incl',7,p4incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wy, P4Omega
!
      IF(kk == 728)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4Omega',6,p4omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wz, P4Q
!
      IF(kk == 729)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4Q',6,p4q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag wb, P4ratrad
!
      IF(kk == 705)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P4ratrad',7,p4ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 5 parameters
!
!  tag xj, P5tconj
!
      IF(kk == 745)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5tconj',6,p5tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xt, P5period
!
      IF(kk == 755)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5period',9,p5period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xu, P5T0
!
      IF(kk == 756)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5T0',6,p5t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xv, P5ecos
!
      IF(kk == 757)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5ecos',7,p5ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xw, P5esin
!
      IF(kk == 758)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5esin',7,p5esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xx, P5incl
!
      IF(kk == 759)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5incl',7,p5incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xy, P5Omega
!
      IF(kk == 760)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5Omega',6,p5omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xz, P5Q
!
      IF(kk == 761)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5Q',6,p5q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xb, P5ratrad
!
      IF(kk == 737)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P5ratrad',7,p5ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 6 parameters
!
!  tag sj, P6tconj
!
      IF(kk == 585)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6tconj',6,p6tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag st, P6period
!
      IF(kk == 595)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6period',9,p6period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag su, P6T0
!
      IF(kk == 596)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6T0',6,p6t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sv, P6ecos
!
      IF(kk == 597)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6ecos',7,p6ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sw, P6esin
!
      IF(kk == 598)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6esin',7,p6esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sx, P6incl
!
      IF(kk == 599)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6incl',7,p6incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sy, P6Omega
!
      IF(kk == 600)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6Omega',6,p6omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sz, P6Q
!
      IF(kk == 601)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6Q',6,p6q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sb, P6ratrad
!
      IF(kk == 577)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P6ratrad',7,p6ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 7 parameters
!
!  tag hj, P7tconj
!
      IF(kk == 233)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7tconj',6,p7tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ht, P7period
!
      IF(kk == 243)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7period',9,p7period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hu, P7T0
!
      IF(kk == 244)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7T0',6,p7t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hv, P7ecos
!
      IF(kk == 245)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7ecos',7,p7ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hw, P7esin
!
      IF(kk == 246)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7esin',7,p7esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hx, P7incl
!
      IF(kk == 247)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7incl',7,p7incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hy, P7Omega
!
      IF(kk == 248)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7Omega',6,p7omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hz, P7Q
!
      IF(kk == 249)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7Q',6,p7q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag hb, P7ratrad
!
      IF(kk == 225)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P7ratrad',7,p7ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  planet 8 parameters
!
!  tag kj, P8tconj
!
      IF(kk == 329)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8tconj',6,p8tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kt, P8period
!
      IF(kk == 339)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8period',9,p8period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ku, P8T0
!
      IF(kk == 340)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8T0',6,p8t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kv, P8ecos
!
      IF(kk == 341)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8ecos',7,p8ecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kw, P8esin
!
      IF(kk == 342)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8esin',7,p8esin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kx, P8incl
!
      IF(kk == 343)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8incl',7,p8incl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ky, P8Omega
!
      IF(kk == 344)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8Omega',6,p8omega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kz, P8Q
!
      IF(kk == 345)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8Q',6,p8q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag kb, P8ratrad
!
      IF(kk == 321)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P8ratrad',7,p8ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag g1, Tgrav1, gravity darkening exponent star 1
!
      IF(kk == 1208)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Tgrav1',5,tgrav1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag g2, Tgrav2, gravity darkening exponent star 2
!
      IF(kk == 1209)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Tgrav2',5,tgrav2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag s0, contamS0, contamination season 0
!
      IF(kk == 1591)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' contamS0',5,contams0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag s1, contamS1, contamination season 1
!
      IF(kk == 1592)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' contamS1',5,contams1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag s2, contamS2, contamination season 2
!
      IF(kk == 1593)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' contamS2',5,contams2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag s3, contamS3, contamination season 3
!
      IF(kk == 1594)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' contamS3',5,contams3,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag do, omegadot
!
      IF(kk == 110)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' omega_dot',8,omegadot,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tt, pertperiod, orbital period of body 3
!
      IF(kk == 627)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1period',9,tertperiod,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tu, tertT0, periastron passage of body 3 orbit
!
      IF(kk == 628)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1T0',6,tertt0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tj, tertconj, time of primary conjunction of body 3 orbit
!
      IF(kk == 617)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1tconj',6,tertconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tv, tertecos, e*cos(omega) for body 3 orbit
!
      IF(kk == 629)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1ecos',7,tertecos,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tw, tertesin, e*sin(omega) for body 3 orbit
!
      IF(kk == 630)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1esin',7,tertesin,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tx, tertincl, inclination of body 3 orbit
!
      IF(kk == 631)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1incl',7,tertincl,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ty, tertOmega, nodal angle of body 3 orbit
!
      IF(kk == 632)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1Omega',6,tertomega,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tz, tertQ, mass ratio of body 3
!
      IF(kk == 633)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1Q',6,tertq,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag tb, tertratrad, radius ratio of body 3
!
      IF(kk == 609)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P1ratrad',7,tertratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag co, contam, Kepler contamination
!
      IF(kk == 78)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' contam',5,contam,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag e1, beam1, Doppler boosting coefficient for star 1
!
      IF(kk == 1144)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' beam1',3,beam1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag e2, beam2, Doppler boosting coefficient for star 2
!
      IF(kk == 1145)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' beam2',3,beam2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag pm, primmass, mass of star 1 in solar masses
!
      IF(kk == 492)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' primmass',5,primmass,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag pr, primrad, radius of star in solar radii
!
      IF(kk == 497)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' primrad',5,primrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag te, temprat, ratio of star 2 temperature to star 1 temperature
!
      IF(kk == 612)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' temprat',7,temprat,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag pk, primK, K-velocity of star 1 in km/sec
!
      IF(kk == 490)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' primK',6,primk,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ra, ratrad, ratio of star 1 radius to star 2 radius
!
      IF(kk == 544)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' ratrad',6,ratrad,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag q1, frac1, fractional radius of star 1 (R_1/a)
!
      IF(kk == 1528)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' frac1',7,frac1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag q2, frac2, fractional radius of star 2 (R_2/a)
!
      IF(kk == 1529)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' frac2',7,frac2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag de, density, density of star 1 in cgs
!
      IF(kk == 100)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' density',7,density,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag l1, alb1, albedo of star 1
!
      IF(kk == 1368)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' al1',5,alb1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag l2, alb2, albedo of star 2
!
      IF(kk == 1369)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' al2',5,alb2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag dp, dphi, phase difference between secondary and primary eclipse
!
      IF(kk == 111)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' dphi',5,ecosw,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
         iargper=100
      END IF
!
!  tag tc, Tconj, time of primary conjunction of the binary orbit
!
      IF(kk == 610)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Tconj',6,tconj,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t0, T0, time of periastron passage of binary orbit
!
      IF(kk == 1623)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' T0',6,t0,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p2, period, binary orbital period in days
!
      IF(kk == 484)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' P',9,period,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag in, finc, inclination of binary in degrees
!
      IF(kk == 269)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' i',4,finc,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ai, bigI, inclination of star 1's spin axis
!
      IF(kk == 8)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_I1',4,bigi,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ab, bigbeta, position angle of star 1's spin axis
!
      IF(kk == 1)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' axis_beta1',4,bigbeta,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ma, Q, mass ratio of binary
!
      IF(kk == 384)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Q',8,q,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag f1, fill1, Roche lobe filling factor of star 1
!
      IF(kk == 1176)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' fi1',7,fill1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag f2, fill2, Roche lobe filling factor of star 2
!
      IF(kk == 1177)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' fi2',7,fill2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ri, rinner, inner radius of accretion disk
!
      IF(kk == 552)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rin',5,rinner,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag o1, omega1, spin frequency of star 1
!
      IF(kk == 1464)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' o1',4,omega1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag o2, spin frequency of star 2
!
      IF(kk == 1465)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' o2',4,omega2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ro, router, radius of outer edge of accretion disk
!
      IF(kk == 558)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rout',5,router,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t3, Teff3, effective temperature of star 3
!
      IF(kk == 1626)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff3',2,t3,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t4, Teff4, effective temperature of star 4
!
      IF(kk == 1627)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff4',2,sw80,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t5, Teff5, effective temperature of star 5
!
      IF(kk == 1628)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff5',2,sw81,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag g3, g3, gravity of star 3 (log(g))
!
      IF(kk == 1210)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' g3',3,g3,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag be, betarim, opening angle of accretion disk rim
!
      IF(kk == 36)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' beta',3,betarim,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t1, Teff1, effective temperature of star 1
!
      IF(kk == 1624)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff1',2,teff1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag t2, Teff2, effective temperature of star 2
!
      IF(kk == 1625)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Teff2',2,teff2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag xi, xi, power-law exponent of the disk temperature profile
!
      IF(kk == 744)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' xi',3,xi,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag td, Tdisk, temperature of the inner edge of the accretion disk
!
      IF(kk == 611)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Td',2,tdisk,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag lx, rLx, log of the X-ray luminosity in cgs units
!
      IF(kk == 375)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' Lx',4,rlx,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag se, separ, semimajor axis of binary orbit
!
      IF(kk == 580)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' separ',6,separ,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag sa, SA3, ratio of area of star 3 to area of star 1
!
      IF(kk == 576)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' SA3',6,sa3,outstring,lll)
         line=TRIM(line)//outstring
         ilength=ilength+lll
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ps, pshift
!
      IF(kk == 498)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' pshift',5,pshift,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ec, ecc, eccentricity of binary orbit
!
      IF(kk == 130)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' e',6,ecc,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag ar, argper, argument of periastron of binary orbit
!
      IF(kk == 17)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' argper',3,argper,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b1, temperature factor spot 1, star 1
!
      IF(kk == 1048)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot1_star1',4,spot1parm(1,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b2, latitude spot 1, star 1
!
      IF(kk == 1049)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lat_spot1_star1',2,spot1parm(1,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b3, longitude spot 1, star 1
!
      IF(kk == 1050)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lon_spot1_star1',2,spot1parm(1,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag  b4, radius spot 1, star 1
!
      IF(kk == 1051)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rad_spot1_star1',3,spot1parm(1,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b5, temperature factor spot 2, star 1
!
      IF(kk == 1052)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot2_star1',4,spot1parm(2,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b6,  latitude spot 2, star 1
!
      IF(kk == 1053)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lat_spot2_star1',2,spot1parm(2,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b7, longitude spot 2, star 1
!
      IF(kk == 1054)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lon_spot2_star1',2,spot1parm(2,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag b8, radius spot 2, star 1
!
      IF(kk == 1055)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rad_spot2_star1',3,spot1parm(2,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c1, temperature factor spot 1, star 2
!
      IF(kk == 1080)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot1_star2',4,spot2parm(1,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c2, latitude spot 1, star 2
!
      IF(kk == 1081)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lat_spot1_star2',2,spot2parm(1,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c3, longitude spot 1, star 2
!
      IF(kk == 1082)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lon_spot1_star2',2,spot2parm(1,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c4, radius spot 1, star 2
!
      IF(kk == 1083)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rad_spot1_star2',3,spot2parm(1,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c5,  temperature factor spot 2, star 2
!
      IF(kk == 1084)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot2_star2',4,spot2parm(2,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c6, latitude spot 2, star 2
!
      IF(kk == 1085)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lat_spot2_star2',2,spot2parm(2,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c7, longitude spot 2, star 2
!
      IF(kk == 1086)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' lon_spot2_star2',2,spot2parm(2,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag c8, radius spot 2, star 2
!
      IF(kk == 1087)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' rad_spot2_star2',3,spot2parm(2,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d1, temperature factor spot 1 on disk
!
      IF(kk == 1112)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot1_disk',4,spotdparm(1,1),outstring, lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d2, azimuth spot 1 on disk
!
      IF(kk == 1113)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' azi_spot1_disk',2,spotdparm(1,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d3, cutoff radius for spot 1 on disk
!
      IF(kk == 1114)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' cut_spot1_disk',4,spotdparm(1,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d4, angular width of spot 1 on disk
!
      IF(kk == 1115)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' wid_spot1_disk',2,spotdparm(1,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d5, temperature factor spot 2 on disk
!
      IF(kk == 1116)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' TF_spot2_disk',4,spotdparm(2,1),outstring, lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d6, azimuth spot 2 on disk
!
      IF(kk == 1117)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' azi_spot2_disk',2,spotdparm(2,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d7, cutoff radius for spot 2 on disk
!
      IF(kk == 1118)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' cut_spot2_disk',4,spotdparm(2,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag d8, angular width of spot 2 on disk
!
      IF(kk == 1119)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' wid_spot2_disk',3,spotdparm(2,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x1, limb darkening x-coefficient, band 1, star 1
!
      IF(kk == 1752)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(U)',3,dwavex(1,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x2, limb darkening x-coefficient, band 2, star 1
!
      IF(kk == 1753)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(B)',3,dwavex(2,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x3, limb darkening x-coefficient, band 3, star 1
!
      IF(kk == 1754)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(V)',3,dwavex(3,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x4, limb darkening x-coefficient, band 4, star 1
!
      IF(kk == 1755)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(R)',3,dwavex(4,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x5, limb darkening x-coefficient, band 5, star 1
!
      IF(kk == 1756)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(I)',3,dwavex(5,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x6, limb darkening x-coefficient, band 6, star 1
!
      IF(kk == 1757)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(J)',3,dwavex(6,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x7, limb darkening x-coefficient, band 7, star 1
!
      IF(kk == 1758)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(H)',3,dwavex(7,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag x8, limb darkening x-coefficient, band 8, star 1
!
      IF(kk == 1759)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x1(K)',3,dwavex(8,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z1, limb darkening x-coefficient, band 1, star 2
!
      IF(kk == 1816)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(U)',3,dwavex(1,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z2, limb darkening x-coefficient, band 2, star 2
!
      IF(kk == 1817)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(B)',3,dwavex(2,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z3, limb darkening x-coefficient, band 3, star 2
!
      IF(kk == 1818)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(V)',3,dwavex(3,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z4, limb darkening x-coefficient, band 4, star 2
!
      IF(kk == 1819)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(R)',3,dwavex(4,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z5, limb darkening x-coefficient, band 5, star 2
!
      IF(kk == 1820)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(I)',3,dwavex(5,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z6, limb darkening x-coefficient, band 6, star 2
!
      IF(kk == 1821)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(J)',3,dwavex(6,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z7, limb darkening x-coefficient, band 7, star 2
!
      IF(kk == 1822)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(H)',3,dwavex(7,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag z8, limb darkening x-coefficient, band 8, star 2
!
      IF(kk == 1823)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x2(K)',3,dwavex(8,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y1, limb darkening y-coefficient, band 1, star 1
!
      IF(kk == 1784)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(U)',3,dwavey(1,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y2, limb darkening y-coefficient, band 2, star 1
!
      IF(kk == 1785)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(B)',3,dwavey(2,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y3, limb darkening y-coefficient, band 3, star 1
!
      IF(kk == 1786)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(V)',3,dwavey(3,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y4, limb darkening y-coefficient, band 4, star 1
!
      IF(kk == 1787)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(R)',3,dwavey(4,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y5, limb darkening y-coefficient, band 5, star 1
!
      IF(kk == 1788)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(I)',3,dwavey(5,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y6, limb darkening y-coefficient, band 6, star 1
!
      IF(kk == 1789)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(J)',3,dwavey(6,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y7, limb darkening y-coefficient, band 7, star 1
!
      IF(kk == 1790)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(H)',3,dwavey(7,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag y8, limb darkening y-coefficient, band 8, star 1
!
      IF(kk == 1791)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y1(K)',3,dwavey(8,1),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w1, limb darkening y-coefficient, band 1, star 2
!
      IF(kk == 1720)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(U)',3,dwavey(1,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w2, limb darkening y-coefficient, band 2, star 2
!
      IF(kk == 1721)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(B)',3,dwavey(2,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w3, limb darkening y-coefficient, band 3, star 2
!
      IF(kk == 1722)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(V)',3,dwavey(3,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w4, limb darkening y-coefficient, band 4, star 2
!
      IF(kk == 1723)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(R)',3,dwavey(4,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w5, limb darkening y-coefficient, band 5, star 2
!
      IF(kk == 1724)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(I)',3,dwavey(5,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w6, limb darkening y-coefficient, band 6, star 2
!
      IF(kk == 1725)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(J)',3,dwavey(6,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w7, limb darkening y-coefficient, band 7, star 2
!
      IF(kk == 1726)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(H)',3,dwavey(7,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag w8, limb darkening y-coefficient, band 8, star 2
!
      IF(kk == 1727)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y2(K)',3,dwavey(8,2),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m1, limb darkening x-coefficient, band 1, star 3
!
      IF(kk == 1400)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(U)',3,dwavex(1,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m2, limb darkening x-coefficient, band 2, star 3
!
      IF(kk == 1401)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(B)',3,dwavex(2,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m3, limb darkening x-coefficient, band 3, star 3
!
      IF(kk == 1402)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(V)',3,dwavex(3,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m4, limb darkening x-coefficient, band 4, star 3
!
      IF(kk == 1403)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(R)',3,dwavex(4,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m5, limb darkening x-coefficient, band 5, star 3
!
      IF(kk == 1404)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(I)',3,dwavex(5,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m6, limb darkening x-coefficient, band 6, star 3
!
      IF(kk == 1405)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(J)',3,dwavex(6,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m7, limb darkening x-coefficient, band 7, star 3
!
      IF(kk == 1406)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(H)',3,dwavex(7,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag m8, limb darkening x-coefficient, band 8, star 3
!
      IF(kk == 1407)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x3(K)',3,dwavex(8,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n1, limb darkening y-coefficient, band 1, star 3
!
      IF(kk == 1432)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(U)',3,dwavey(1,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n2, limb darkening y-coefficient, band 2, star 3
!
      IF(kk == 1433)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(B)',3,dwavey(2,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n3, limb darkening y-coefficient, band 3, star 3
!
      IF(kk == 1434)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(V)',3,dwavey(3,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n4, limb darkening y-coefficient, band 4, star 3
!
      IF(kk == 1435)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(R)',3,dwavey(4,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n5, limb darkening y-coefficient, band 5, star 3
!
      IF(kk == 1436)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(I)',3,dwavey(5,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n6, limb darkening y-coefficient, band 6, star 3
!
      IF(kk == 1437)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(J)',3,dwavey(6,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n7, limb darkening y-coefficient, band 7, star 3
!
      IF(kk == 1438)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(H)',3,dwavey(7,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag n8, limb darkening y-coefficient, band 8, star 3
!
      IF(kk == 1439)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y3(K)',3,dwavey(8,3),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i1, limb darkening x-coefficient, band 1, star 4
!
      IF(kk == 1272)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(U)',3,dwavex(1,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i2, limb darkening x-coefficient, band 2, star 4
!
      IF(kk == 1273)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(B)',3,dwavex(2,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i3, limb darkening x-coefficient, band 3, star 4
!
      IF(kk == 1274)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(V)',3,dwavex(3,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i4, limb darkening x-coefficient, band 4, star 4
!
      IF(kk == 1275)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(R)',3,dwavex(4,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i5, limb darkening x-coefficient, band 5, star 4
!
      IF(kk == 1276)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(I)',3,dwavex(5,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i6, limb darkening x-coefficient, band 6, star 4
!
      IF(kk == 1277)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(J)',3,dwavex(6,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i7, limb darkening x-coefficient, band 7, star 4
!
      IF(kk == 1278)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(H)',3,dwavex(7,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag i8, limb darkening x-coefficient, band 8, star 4
!
      IF(kk == 1279)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x4(K)',3,dwavex(8,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j1, limb darkening y-coefficient, band 1, star 4
!
      IF(kk == 1304)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(U)',3,dwavey(1,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j2, limb darkening y-coefficient, band 2, star 4
!
      IF(kk == 1305)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(B)',3,dwavey(2,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j3, limb darkening y-coefficient, band 3, star 4
!
      IF(kk == 1306)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(V)',3,dwavey(3,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j4, limb darkening y-coefficient, band 4, star 4
!
      IF(kk == 1307)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(R)',3,dwavey(4,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j5, limb darkening y-coefficient, band 5, star 4
!
      IF(kk == 1308)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(I)',3,dwavey(5,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j6, limb darkening y-coefficient, band 6, star 4
!
      IF(kk == 1309)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(J)',3,dwavey(6,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j7, limb darkening y-coefficient, band 7, star 4
!
      IF(kk == 1310)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(H)',3,dwavey(7,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag j8, limb darkening y-coefficient, band 8, star 4
!
      IF(kk == 1311)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y4(K)',3,dwavey(8,4),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k1, limb darkening x-coefficient, band 1, star 5
!
      IF(kk == 1336)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(U)',3,dwavex(1,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k2, limb darkening x-coefficient, band 2, star 5
!
      IF(kk == 1337)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(B)',3,dwavex(2,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k3, limb darkening x-coefficient, band 3, star 5
!
      IF(kk == 1338)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(V)',3,dwavex(3,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k4, limb darkening x-coefficient, band 4, star 5
!
      IF(kk == 1339)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(R)',3,dwavex(4,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k5, limb darkening x-coefficient, band 5, star 5
!
      IF(kk == 1340)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(I)',3,dwavex(5,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k6, limb darkening x-coefficient, band 6, star 5
!
      IF(kk == 1341)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(J)',3,dwavex(6,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k7, limb darkening x-coefficient, band 7, star 5
!
      IF(kk == 1342)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(H)',3,dwavex(7,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag k8, limb darkening x-coefficient, band 8, star 5
!
      IF(kk == 1343)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' x5(K)',3,dwavex(8,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p1, limb darkening y-coefficient, band 1, star 5
!
      IF(kk == 1496)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(U)',3,dwavey(1,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p2, limb darkening y-coefficient, band 2, star 5
!
      IF(kk == 1497)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(B)',3,dwavey(2,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p3, limb darkening y-coefficient, band 3, star 5
!
      IF(kk == 1498)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(V)',3,dwavey(3,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p4, limb darkening y-coefficient, band 4, star 5
!
      IF(kk == 1499)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(R)',3,dwavey(4,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p5, limb darkening y-coefficient, band 5, star 5
!
      IF(kk == 1500)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(I)',3,dwavey(5,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p6, limb darkening y-coefficient, band 6, star 5
!
      IF(kk == 1501)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(J)',3,dwavey(6,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p7, limb darkening y-coefficient, band 7, star 5
!
      IF(kk == 1502)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(H)',3,dwavey(7,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  tag p8, limb darkening y-coefficient, band 8, star 5
!
      IF(kk == 1503)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' y5(K)',3,dwavey(8,5),outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
   END DO
!
   IF(ilength > 48)THEN
      iwrite=100
      WRITE(*,20)line
      ilength=2
      line=' *'
   END IF
!
!   Update July 29, 2005
!
!   If the variable ecosw was assigned, then also print out the argument
!   of periastron.
!
   IF(iargper > 0)THEN
      CALL getom(ecc,ecosw,argper)
      iline=iline+1
      iwrite=0
      CALL pstring(' argper',3,argper,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
   END IF
!
!  if fitting for e*cos(omega) and e*sin(omega), print out
!  the eccentricity and argument of periastron
!
   IF(isw29 > 0)THEN
      iline=iline+1
      iwrite=0
      CALL pstring(' e',7,ecc,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
      iline=iline+1
      iwrite=0
      CALL pstring(' argper',3,argper,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 45)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
   END IF
!
!   Print out the gamma values, if fitting RV curves.
!   If ifixgamma is less than 10, we have one
!   gamma value per star.  If ifixgamma is 10 or more,
!   we are fitting RV sets, and we need to print
!   out Nset gamma values per star.
!
   IF(ifixgamma < 10)THEN
      IF(isvel1 > 0)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' gam1',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
   END IF
!
   IF(ifixgamma < 10)THEN
      IF(isvel2 > 0)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' gam2',4,gamma2,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
   END IF
!
   IF(ifixgamma < 10)THEN
      IF(isvel3 > 0)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' gam3',4,gamma3,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
   END IF
!
   IF(ifixgamma < 10)THEN
      IF(isvel4 > 0)THEN
         iline=iline+1
         iwrite=0
         CALL pstring(' gam4',4,gamma4,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
   END IF
!
   IF(ifixgamma >= 10)THEN
!
!   star 1 gammas
!
      IF(icnrv1arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma1arry(1)
         CALL pstring(' gam1A',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv1arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma1arry(2)
         CALL pstring(' gam1B',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv1arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma1arry(3)
         CALL pstring(' gam1C',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv1arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma1arry(4)
         CALL pstring(' gam1D',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv1arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma1arry(5)
         CALL pstring(' gam1E',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  star 2 gammas
!
      IF(icnrv2arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma2arry(1)
         CALL pstring(' gam2A',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv2arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma2arry(2)
         CALL pstring(' gam2B',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv2arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma2arry(3)
         CALL pstring(' gam2C',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv2arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma2arry(4)
         CALL pstring(' gam2D',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv2arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma2arry(5)
         CALL pstring(' gam2E',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  star 3 gammas
!
      IF(icnrv3arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma3arry(1)
         CALL pstring(' gam3A',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv3arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma3arry(2)
         CALL pstring(' gam3B',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv3arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma3arry(3)
         CALL pstring(' gam3C',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv3arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma3arry(4)
         CALL pstring(' gam3D',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv3arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma3arry(5)
         CALL pstring(' gam3E',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  star 4 gammas
!
      IF(icnrv4arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma4arry(1)
         CALL pstring(' gam4A',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv4arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma4arry(2)
         CALL pstring(' gam4B',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv4arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma4arry(3)
         CALL pstring(' gam4C',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv4arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma4arry(4)
         CALL pstring(' gam4D',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv4arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma4arry(5)
         CALL pstring(' gam4E',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
!  star 5 gammas
!
      IF(icnrv5arry(1) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma5arry(1)
         CALL pstring(' gam5A',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv5arry(2) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma5arry(2)
         CALL pstring(' gam5B',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv5arry(3) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma5arry(3)
         CALL pstring(' gam5C',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv5arry(4) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma5arry(4)
         CALL pstring(' gam5D',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
!
      IF(icnrv5arry(5) /= 430)THEN
         iline=iline+1
         iwrite=0
         gamma1=gamma5arry(5)
         CALL pstring(' gam5E',4,gamma1,outstring,lll)
         ilength=ilength+lll
         line=TRIM(line)//outstring
         IF(ilength > 48)THEN
            iwrite=100
            WRITE(*,20)line
            ilength=2
            line=' *'
         END IF
      END IF
   END IF
!
!  If ecc > 0, record the times of inferior and superior
!  conjunction
!
   IF(ecc > 0.0_dp)THEN
      CALL getcontimes(finc,period,ecc,argper,t0,tconj1,tconj2)
      iline=iline+1
      iwrite=0
      CALL pstring(' T_peri',4,t0,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
      iwrite=0
      CALL pstring(' Tconj1',4,tconj1,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
      iwrite=0
      CALL pstring(' Tconj2',4,tconj2,outstring,lll)
      ilength=ilength+lll
      line=TRIM(line)//outstring
      IF(ilength > 48)THEN
         iwrite=100
         WRITE(*,20)line
         ilength=2
         line=' *'
      END IF
   END IF
!
   IF(ilength > 8.AND.iwrite == 0)WRITE(*,20)line
!
20 FORMAT(a80)
   RETURN
!
END SUBROUTINE writevar
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE cygchi(tin,radin,chiout)
!
   USE accur
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN OUT)                   :: tin
   REAL(KIND=dp), INTENT(IN)                       :: radin
   REAL(KIND=dp), INTENT(OUT)                      :: chiout
!
   REAL(KIND=dp)  :: cygrad,cygerr
!
   INTEGER :: i
!
   chiout=0.0_dp
   CALL cygx1radius(tin,cygrad,cygerr)
   chiout=(radin-cygrad)/cygerr
   chiout=chiout**2
!
   RETURN
!
END SUBROUTINE cygchi
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
SUBROUTINE cygx1radius(tin,cygrad,cygerr)
!
   USE accur
!
!    Will return the radius and error bar
!    given the input temperature
!
   IMPLICIT NONE
!
   REAL(KIND=dp), INTENT(IN OUT)                   :: tin
   REAL(KIND=dp), INTENT(OUT)                      :: cygrad
   REAL(KIND=dp), INTENT(OUT)                      :: cygerr
!
   REAL(KIND=dp)  :: xx,yy,ee,y2
!
   INTEGER :: nn
!
   DIMENSION xx(35),yy(35),ee(35),y2(35)
!
   DATA xx/27500.0_dp,27750.0_dp,28000.0_dp,28250.0_dp,28500.0_dp,28750.0_dp,29000.0_dp,  &
      29250.0_dp,29500.0_dp,29750.0_dp,30000.0_dp,30250.0_dp,30500.0_dp,  &
      30750.0_dp,31000.0_dp,31250.0_dp,31500.0_dp,31750.0_dp,32000.0_dp,  &
      32250.0_dp,32500.0_dp,32750.0_dp,33000.0_dp,33250.0_dp,33500.0_dp,  &
      33750.0_dp,34000.0_dp,34250.0_dp,34500.0_dp,34750.0_dp,35000.0_dp,  &
      35250.0_dp,35500.0_dp,35750.0_dp,36000.0_dp/

   DATA yy/24.9537411_dp,24.7700682_dp, 24.5952742_dp,24.4210697_dp,24.2547800_dp,24.0869212_dp,  &
      23.9260989_dp,23.7674120_dp,23.6117351_dp,23.4550872_dp,  &
      23.3020976_dp,23.1481255_dp,22.9975706_dp,22.8487480_dp,  &
      22.7031848_dp,22.5648606_dp,22.4297572_dp,22.2970701_dp,  &
      22.1735572_dp,22.0531896_dp,21.9410334_dp,21.8400573_dp,  &
      21.7410149_dp,21.6541366_dp,21.5689046_dp,21.4880980_dp, 21.4102173_dp , &
      21.3351160_dp,21.2609378_dp,21.1851242_dp,21.1109398_dp,  &
      21.0399859_dp,20.9624853_dp,20.8839635_dp,20.8104368_dp/
!
   DATA ee/2.0409506_dp,2.0263388_dp,2.0116312_dp,1.9977842_dp,1.9840103_dp,1.9699847_dp,  &
      1.9565978_dp,1.9447919_dp,1.9298868_dp,1.9184269_dp,  &
      1.9055683_dp,1.8940451_dp,1.8815181_dp,1.8688774_dp,  &
      1.8573227_dp,1.8451887_dp,1.8349550_dp,1.8238399_dp,  &
      1.8131083_dp,1.8033434_dp,1.7951232_dp,1.7853581_dp,  &
      1.7778961_dp,1.7702334_dp,1.7634825_dp,1.7571230_dp, 1.7511809_dp, &
      1.7445216_dp,1.7389772_dp,1.7318247_dp,1.7265020_dp,1.7208115_dp,   &
      1.7147661_dp,1.7081040_dp,1.7024240_dp/
!
   nn=35
!
   IF(tin < 27500.0_dp)tin=27501.0_dp
   IF(tin > 36000.0_dp)tin=35999.0_dp
!
   CALL spline (xx,yy,nn,0.0_dp,0.0_dp,y2)
   CALL splint (xx,yy,y2,nn,tin,cygrad)
!
   CALL spline (xx,ee,nn,0.0_dp,0.0_dp,y2)
   CALL splint (xx,ee,y2,nn,tin,cygerr)
!
   RETURN
!
END SUBROUTINE cygx1radius
!
!   !@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()!@#$%^&*()
!
